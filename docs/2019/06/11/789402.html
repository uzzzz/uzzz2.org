<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>wordcount多种写法（单机版、MapReduce、Hive、Spark、Scala） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="wordcount多种写法（单机版、MapReduce、Hive、Spark、Scala）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="单机版 public class WordCount { public static void main(String[] args) throws IOException { Map&lt;String, Integer&gt;[] maps=new HashMap[5]; int a=0; for (int i = 1; i &lt;=5; i++) { maps[a++] = docunment(i); } Map&lt;String, Integer&gt; merge = merge(maps); Set&lt;Map.Entry&lt;String, Integer&gt;&gt; entrySet = merge.entrySet(); entrySet.forEach(System.out::println); } public static Map&lt;String, Integer&gt; docunment(int i) throws IOException { Map&lt;String, Integer&gt; map=new HashMap&lt;String, Integer&gt;(); BufferedReader br=new BufferedReader(new FileReader(&quot;D:\\bd_example\\data\\wordcount\\&quot;+i+&quot;.txt&quot;)); String s=null; while ((s=br.readLine())!=null) { String[] split = s.split(&quot;\t&quot;); for (String string : split) { if (map.containsKey(string)) { map.put(string, map.get(string)+1); }else { map.put(string, 1); } } } return map; } public static Map&lt;String, Integer&gt; merge(Map&lt;String, Integer&gt;...maps) { Map&lt;String, Integer&gt; map=new HashMap&lt;String, Integer&gt;(); for (Map&lt;String, Integer&gt; current_map : maps) { Set&lt;String&gt; current_keys = current_map.keySet(); for (String k : current_keys) { Integer old_count = current_map.get(k); if (map.containsKey(k)) { Integer current_count = map.get(k); map.put(k, old_count+current_count); }else { map.put(k, old_count); } } } return map; } } MapReduce public class WC { public class WCMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt;{ @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException { String string = value.toString(); String[] words = string.split(&quot;\t&quot;); for (String s : words) { //java-&gt;hadoop Text mtText=new Text(s); IntWritable iWritable=new IntWritable(1); context.write(mtText, iWritable); } } } public class WCReduce extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt;{ @Override protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException { int sum=0; for (IntWritable v : values) { sum+=v.get(); } IntWritable resIntWritable=new IntWritable(sum); context.write(key, resIntWritable); } } public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException { Configuration conf=new Configuration(); Job job=Job.getInstance(conf); job.setJarByClass(WC.class); job.setMapperClass(WCMapper.class); job.setReducerClass(WCReduce.class); job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(IntWritable.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); FileInputFormat.addInputPath(job,new Path(args[0])); FileOutputFormat.setOutputPath(job, new Path(args[1])); job.waitForCompletion(true); } } Hive create database wc; use wc; create table wordcount(word string) row format delimited fields terminated by &quot;\n&quot; location &#39;/wordcount&#39;; load data local inpath &quot;/home/fanger/example/wordcount&quot; into table wordcount; select * from wordcount; select a.word as word,count(*) as num from( select wc.word as word from wordcount lateral view explode(split(word,&quot;\t&quot;)) wc as word) a group by a.word; Spark /* 基于java的spark编程 */ public class _01sparkCount { public static void main(String[] args) { SparkConf conf=new SparkConf(); conf.setMaster(&quot;local[*]&quot;); conf.setAppName(_01sparkCount.class.getSimpleName()); JavaSparkContext jsc=new JavaSparkContext(conf); JavaRDD&lt;String&gt; text = jsc.textFile(&quot;D:\\bd_example\\data\\wordcount\\&quot;); //方法一 int numPartitions = text.getNumPartitions(); System.out.println(numPartitions); JavaRDD&lt;String&gt; lines = text.flatMap(new FlatMapFunction&lt;String, String&gt;() { @Override public Iterator&lt;String&gt; call(String s) throws Exception { return Arrays.asList(s.split(&quot;\t&quot;)).iterator(); } }); JavaPairRDD&lt;String, Integer&gt; maps = lines.mapToPair(new PairFunction&lt;String, String, Integer&gt;() { @Override public Tuple2&lt;String, Integer&gt; call(String s) throws Exception { return new Tuple2(s, 1); } }); JavaPairRDD&lt;String, Integer&gt; reduces = maps.reduceByKey(new Function2&lt;Integer, Integer, Integer&gt;() { @Override public Integer call(Integer v1, Integer v2) throws Exception { return v1 + v2; } }); reduces.foreach(new VoidFunction&lt;Tuple2&lt;String, Integer&gt;&gt;() { @Override public void call(Tuple2&lt;String, Integer&gt; t) throws Exception { System.out.println(t._1+&quot;----&gt;&quot;+t._2); } }); //方法二 jsc.textFile(&quot;D:\\bd_example\\data\\wordcount\\&quot;).flatMap(x-&gt;Arrays.asList(x.split(&quot;\t&quot;)).iterator()). mapToPair(v-&gt;new Tuple2&lt;&gt;(v,1)).reduceByKey((v1,v2)-&gt;v1+v2).foreach(t-&gt;{ System.out.println(t._1+&quot;\t&quot;+t._2); }); jsc.stop(); } } Scala /* 结果： List((s,1), (g,1), (e,2), (d,2), (c,2), (b,1), (a,3)) */ //方法一 val array2=Array(&quot;a b c&quot;,&quot;a c d e s&quot;,&quot;a d e g&quot;) print(array .map(x=&gt;x.split(&quot; &quot;)) .flatten .map(x=&gt;(x,1)) .groupBy(x=&gt;x._1) .map(x=&gt;(x._1,x._2.length)) .toList .sortWith((x,y)=&gt;x._1&gt;y._1)) //方法二 val stringToInt = array2 .flatMap(_.split(&quot; &quot;)) .map((_,1)) .groupBy(_._1) .map(t=&gt;(t._1,t._2.length)) .toList .sortWith((x,y)=&gt;x._1&gt;y._1) println(stringToInt) //方法三 val conf=new SparkConf().setAppName(AggreatBy.getClass.getSimpleName).setMaster(&quot;local[1]&quot;) val sc=new SparkContext(conf) val array2=Array(&quot;a b c&quot;,&quot;a c d e s&quot;,&quot;a d e g&quot;) val valuerdd: RDD[String] = sc.parallelize(array2) val value = valuerdd.flatMap(_.split(&quot;\\s+&quot;)).map((_,1)) val stringToLong: collection.Map[String, Long] = value.countByKey() for((k,v)&lt;-stringToLong){ println(s&quot;${k},${v}&quot;) }" />
<meta property="og:description" content="单机版 public class WordCount { public static void main(String[] args) throws IOException { Map&lt;String, Integer&gt;[] maps=new HashMap[5]; int a=0; for (int i = 1; i &lt;=5; i++) { maps[a++] = docunment(i); } Map&lt;String, Integer&gt; merge = merge(maps); Set&lt;Map.Entry&lt;String, Integer&gt;&gt; entrySet = merge.entrySet(); entrySet.forEach(System.out::println); } public static Map&lt;String, Integer&gt; docunment(int i) throws IOException { Map&lt;String, Integer&gt; map=new HashMap&lt;String, Integer&gt;(); BufferedReader br=new BufferedReader(new FileReader(&quot;D:\\bd_example\\data\\wordcount\\&quot;+i+&quot;.txt&quot;)); String s=null; while ((s=br.readLine())!=null) { String[] split = s.split(&quot;\t&quot;); for (String string : split) { if (map.containsKey(string)) { map.put(string, map.get(string)+1); }else { map.put(string, 1); } } } return map; } public static Map&lt;String, Integer&gt; merge(Map&lt;String, Integer&gt;...maps) { Map&lt;String, Integer&gt; map=new HashMap&lt;String, Integer&gt;(); for (Map&lt;String, Integer&gt; current_map : maps) { Set&lt;String&gt; current_keys = current_map.keySet(); for (String k : current_keys) { Integer old_count = current_map.get(k); if (map.containsKey(k)) { Integer current_count = map.get(k); map.put(k, old_count+current_count); }else { map.put(k, old_count); } } } return map; } } MapReduce public class WC { public class WCMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt;{ @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException { String string = value.toString(); String[] words = string.split(&quot;\t&quot;); for (String s : words) { //java-&gt;hadoop Text mtText=new Text(s); IntWritable iWritable=new IntWritable(1); context.write(mtText, iWritable); } } } public class WCReduce extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt;{ @Override protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException { int sum=0; for (IntWritable v : values) { sum+=v.get(); } IntWritable resIntWritable=new IntWritable(sum); context.write(key, resIntWritable); } } public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException { Configuration conf=new Configuration(); Job job=Job.getInstance(conf); job.setJarByClass(WC.class); job.setMapperClass(WCMapper.class); job.setReducerClass(WCReduce.class); job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(IntWritable.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); FileInputFormat.addInputPath(job,new Path(args[0])); FileOutputFormat.setOutputPath(job, new Path(args[1])); job.waitForCompletion(true); } } Hive create database wc; use wc; create table wordcount(word string) row format delimited fields terminated by &quot;\n&quot; location &#39;/wordcount&#39;; load data local inpath &quot;/home/fanger/example/wordcount&quot; into table wordcount; select * from wordcount; select a.word as word,count(*) as num from( select wc.word as word from wordcount lateral view explode(split(word,&quot;\t&quot;)) wc as word) a group by a.word; Spark /* 基于java的spark编程 */ public class _01sparkCount { public static void main(String[] args) { SparkConf conf=new SparkConf(); conf.setMaster(&quot;local[*]&quot;); conf.setAppName(_01sparkCount.class.getSimpleName()); JavaSparkContext jsc=new JavaSparkContext(conf); JavaRDD&lt;String&gt; text = jsc.textFile(&quot;D:\\bd_example\\data\\wordcount\\&quot;); //方法一 int numPartitions = text.getNumPartitions(); System.out.println(numPartitions); JavaRDD&lt;String&gt; lines = text.flatMap(new FlatMapFunction&lt;String, String&gt;() { @Override public Iterator&lt;String&gt; call(String s) throws Exception { return Arrays.asList(s.split(&quot;\t&quot;)).iterator(); } }); JavaPairRDD&lt;String, Integer&gt; maps = lines.mapToPair(new PairFunction&lt;String, String, Integer&gt;() { @Override public Tuple2&lt;String, Integer&gt; call(String s) throws Exception { return new Tuple2(s, 1); } }); JavaPairRDD&lt;String, Integer&gt; reduces = maps.reduceByKey(new Function2&lt;Integer, Integer, Integer&gt;() { @Override public Integer call(Integer v1, Integer v2) throws Exception { return v1 + v2; } }); reduces.foreach(new VoidFunction&lt;Tuple2&lt;String, Integer&gt;&gt;() { @Override public void call(Tuple2&lt;String, Integer&gt; t) throws Exception { System.out.println(t._1+&quot;----&gt;&quot;+t._2); } }); //方法二 jsc.textFile(&quot;D:\\bd_example\\data\\wordcount\\&quot;).flatMap(x-&gt;Arrays.asList(x.split(&quot;\t&quot;)).iterator()). mapToPair(v-&gt;new Tuple2&lt;&gt;(v,1)).reduceByKey((v1,v2)-&gt;v1+v2).foreach(t-&gt;{ System.out.println(t._1+&quot;\t&quot;+t._2); }); jsc.stop(); } } Scala /* 结果： List((s,1), (g,1), (e,2), (d,2), (c,2), (b,1), (a,3)) */ //方法一 val array2=Array(&quot;a b c&quot;,&quot;a c d e s&quot;,&quot;a d e g&quot;) print(array .map(x=&gt;x.split(&quot; &quot;)) .flatten .map(x=&gt;(x,1)) .groupBy(x=&gt;x._1) .map(x=&gt;(x._1,x._2.length)) .toList .sortWith((x,y)=&gt;x._1&gt;y._1)) //方法二 val stringToInt = array2 .flatMap(_.split(&quot; &quot;)) .map((_,1)) .groupBy(_._1) .map(t=&gt;(t._1,t._2.length)) .toList .sortWith((x,y)=&gt;x._1&gt;y._1) println(stringToInt) //方法三 val conf=new SparkConf().setAppName(AggreatBy.getClass.getSimpleName).setMaster(&quot;local[1]&quot;) val sc=new SparkContext(conf) val array2=Array(&quot;a b c&quot;,&quot;a c d e s&quot;,&quot;a d e g&quot;) val valuerdd: RDD[String] = sc.parallelize(array2) val value = valuerdd.flatMap(_.split(&quot;\\s+&quot;)).map((_,1)) val stringToLong: collection.Map[String, Long] = value.countByKey() for((k,v)&lt;-stringToLong){ println(s&quot;${k},${v}&quot;) }" />
<link rel="canonical" href="https://uzzz.org/2019/06/11/789402.html" />
<meta property="og:url" content="https://uzzz.org/2019/06/11/789402.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-11T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"单机版 public class WordCount { public static void main(String[] args) throws IOException { Map&lt;String, Integer&gt;[] maps=new HashMap[5]; int a=0; for (int i = 1; i &lt;=5; i++) { maps[a++] = docunment(i); } Map&lt;String, Integer&gt; merge = merge(maps); Set&lt;Map.Entry&lt;String, Integer&gt;&gt; entrySet = merge.entrySet(); entrySet.forEach(System.out::println); } public static Map&lt;String, Integer&gt; docunment(int i) throws IOException { Map&lt;String, Integer&gt; map=new HashMap&lt;String, Integer&gt;(); BufferedReader br=new BufferedReader(new FileReader(&quot;D:\\\\bd_example\\\\data\\\\wordcount\\\\&quot;+i+&quot;.txt&quot;)); String s=null; while ((s=br.readLine())!=null) { String[] split = s.split(&quot;\\t&quot;); for (String string : split) { if (map.containsKey(string)) { map.put(string, map.get(string)+1); }else { map.put(string, 1); } } } return map; } public static Map&lt;String, Integer&gt; merge(Map&lt;String, Integer&gt;...maps) { Map&lt;String, Integer&gt; map=new HashMap&lt;String, Integer&gt;(); for (Map&lt;String, Integer&gt; current_map : maps) { Set&lt;String&gt; current_keys = current_map.keySet(); for (String k : current_keys) { Integer old_count = current_map.get(k); if (map.containsKey(k)) { Integer current_count = map.get(k); map.put(k, old_count+current_count); }else { map.put(k, old_count); } } } return map; } } MapReduce public class WC { public class WCMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt;{ @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException { String string = value.toString(); String[] words = string.split(&quot;\\t&quot;); for (String s : words) { //java-&gt;hadoop Text mtText=new Text(s); IntWritable iWritable=new IntWritable(1); context.write(mtText, iWritable); } } } public class WCReduce extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt;{ @Override protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException { int sum=0; for (IntWritable v : values) { sum+=v.get(); } IntWritable resIntWritable=new IntWritable(sum); context.write(key, resIntWritable); } } public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException { Configuration conf=new Configuration(); Job job=Job.getInstance(conf); job.setJarByClass(WC.class); job.setMapperClass(WCMapper.class); job.setReducerClass(WCReduce.class); job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(IntWritable.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); FileInputFormat.addInputPath(job,new Path(args[0])); FileOutputFormat.setOutputPath(job, new Path(args[1])); job.waitForCompletion(true); } } Hive create database wc; use wc; create table wordcount(word string) row format delimited fields terminated by &quot;\\n&quot; location &#39;/wordcount&#39;; load data local inpath &quot;/home/fanger/example/wordcount&quot; into table wordcount; select * from wordcount; select a.word as word,count(*) as num from( select wc.word as word from wordcount lateral view explode(split(word,&quot;\\t&quot;)) wc as word) a group by a.word; Spark /* 基于java的spark编程 */ public class _01sparkCount { public static void main(String[] args) { SparkConf conf=new SparkConf(); conf.setMaster(&quot;local[*]&quot;); conf.setAppName(_01sparkCount.class.getSimpleName()); JavaSparkContext jsc=new JavaSparkContext(conf); JavaRDD&lt;String&gt; text = jsc.textFile(&quot;D:\\\\bd_example\\\\data\\\\wordcount\\\\&quot;); //方法一 int numPartitions = text.getNumPartitions(); System.out.println(numPartitions); JavaRDD&lt;String&gt; lines = text.flatMap(new FlatMapFunction&lt;String, String&gt;() { @Override public Iterator&lt;String&gt; call(String s) throws Exception { return Arrays.asList(s.split(&quot;\\t&quot;)).iterator(); } }); JavaPairRDD&lt;String, Integer&gt; maps = lines.mapToPair(new PairFunction&lt;String, String, Integer&gt;() { @Override public Tuple2&lt;String, Integer&gt; call(String s) throws Exception { return new Tuple2(s, 1); } }); JavaPairRDD&lt;String, Integer&gt; reduces = maps.reduceByKey(new Function2&lt;Integer, Integer, Integer&gt;() { @Override public Integer call(Integer v1, Integer v2) throws Exception { return v1 + v2; } }); reduces.foreach(new VoidFunction&lt;Tuple2&lt;String, Integer&gt;&gt;() { @Override public void call(Tuple2&lt;String, Integer&gt; t) throws Exception { System.out.println(t._1+&quot;----&gt;&quot;+t._2); } }); //方法二 jsc.textFile(&quot;D:\\\\bd_example\\\\data\\\\wordcount\\\\&quot;).flatMap(x-&gt;Arrays.asList(x.split(&quot;\\t&quot;)).iterator()). mapToPair(v-&gt;new Tuple2&lt;&gt;(v,1)).reduceByKey((v1,v2)-&gt;v1+v2).foreach(t-&gt;{ System.out.println(t._1+&quot;\\t&quot;+t._2); }); jsc.stop(); } } Scala /* 结果： List((s,1), (g,1), (e,2), (d,2), (c,2), (b,1), (a,3)) */ //方法一 val array2=Array(&quot;a b c&quot;,&quot;a c d e s&quot;,&quot;a d e g&quot;) print(array .map(x=&gt;x.split(&quot; &quot;)) .flatten .map(x=&gt;(x,1)) .groupBy(x=&gt;x._1) .map(x=&gt;(x._1,x._2.length)) .toList .sortWith((x,y)=&gt;x._1&gt;y._1)) //方法二 val stringToInt = array2 .flatMap(_.split(&quot; &quot;)) .map((_,1)) .groupBy(_._1) .map(t=&gt;(t._1,t._2.length)) .toList .sortWith((x,y)=&gt;x._1&gt;y._1) println(stringToInt) //方法三 val conf=new SparkConf().setAppName(AggreatBy.getClass.getSimpleName).setMaster(&quot;local[1]&quot;) val sc=new SparkContext(conf) val array2=Array(&quot;a b c&quot;,&quot;a c d e s&quot;,&quot;a d e g&quot;) val valuerdd: RDD[String] = sc.parallelize(array2) val value = valuerdd.flatMap(_.split(&quot;\\\\s+&quot;)).map((_,1)) val stringToLong: collection.Map[String, Long] = value.countByKey() for((k,v)&lt;-stringToLong){ println(s&quot;${k},${v}&quot;) }","@type":"BlogPosting","url":"https://uzzz.org/2019/06/11/789402.html","headline":"wordcount多种写法（单机版、MapReduce、Hive、Spark、Scala）","dateModified":"2019-06-11T00:00:00+08:00","datePublished":"2019-06-11T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/06/11/789402.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>wordcount多种写法（单机版、MapReduce、Hive、Spark、Scala）</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-cd6c485e8b.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-light"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <h3><a id="_0"></a>单机版</h3> 
  <pre><code class="prism language-java">

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordCount</span> <span class="token punctuation">{</span>

        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>
            Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> maps<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                maps<span class="token punctuation">[</span>a<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">docunment</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
            Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> merge <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>maps<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Set<span class="token operator">&lt;</span>Map<span class="token punctuation">.</span>Entry<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> entrySet <span class="token operator">=</span> merge<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            entrySet<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> <span class="token function">docunment</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>
            Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            BufferedReader br<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">"D:\\bd_example\\data\\wordcount\\"</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">".txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            String s<span class="token operator">=</span>null<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">=</span>br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                String<span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>String string <span class="token operator">:</span> split<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> map<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> <span class="token function">merge</span><span class="token punctuation">(</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>maps<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> current_map <span class="token operator">:</span> maps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Set<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> current_keys <span class="token operator">=</span> current_map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>String	 k <span class="token operator">:</span> current_keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Integer old_count <span class="token operator">=</span> current_map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        Integer current_count <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> old_count<span class="token operator">+</span>current_count<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> old_count<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> map<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
  <h3><a id="MapReduce_56"></a>MapReduce</h3> 
  <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WC</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WCMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token generics function"><span class="token punctuation">&lt;</span>LongWritable<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> IntWritable<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
	
		<span class="token annotation punctuation">@Override</span>
		<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">map</span><span class="token punctuation">(</span>LongWritable key<span class="token punctuation">,</span> Text value<span class="token punctuation">,</span> Mapper<span class="token generics function"><span class="token punctuation">&lt;</span>LongWritable<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> IntWritable<span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span>Context context<span class="token punctuation">)</span>
				<span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> InterruptedException <span class="token punctuation">{</span>
	
	
			String string <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			String<span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
			<span class="token keyword">for</span> <span class="token punctuation">(</span>String s <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//java-&gt;hadoop</span>
				Text mtText<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
				IntWritable iWritable<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">IntWritable</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				context<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>mtText<span class="token punctuation">,</span> iWritable<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WCReduce</span> <span class="token keyword">extends</span> <span class="token class-name">Reducer</span><span class="token generics function"><span class="token punctuation">&lt;</span>Text<span class="token punctuation">,</span> IntWritable<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> IntWritable<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
	
		<span class="token annotation punctuation">@Override</span>
		<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">reduce</span><span class="token punctuation">(</span>Text key<span class="token punctuation">,</span> Iterable<span class="token generics function"><span class="token punctuation">&lt;</span>IntWritable<span class="token punctuation">&gt;</span></span> values<span class="token punctuation">,</span>
				Reducer<span class="token generics function"><span class="token punctuation">&lt;</span>Text<span class="token punctuation">,</span> IntWritable<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> IntWritable<span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span>Context context<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> InterruptedException <span class="token punctuation">{</span>
	
			<span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>IntWritable v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				
				sum<span class="token operator">+=</span>v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			IntWritable resIntWritable<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">IntWritable</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
			context<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> resIntWritable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>


	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ClassNotFoundException<span class="token punctuation">,</span> InterruptedException <span class="token punctuation">{</span>
	
		Configuration conf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		Job job<span class="token operator">=</span>Job<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>

		job<span class="token punctuation">.</span><span class="token function">setJarByClass</span><span class="token punctuation">(</span>WC<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		job<span class="token punctuation">.</span><span class="token function">setMapperClass</span><span class="token punctuation">(</span>WCMapper<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		job<span class="token punctuation">.</span><span class="token function">setReducerClass</span><span class="token punctuation">(</span>WCReduce<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		job<span class="token punctuation">.</span><span class="token function">setMapOutputKeyClass</span><span class="token punctuation">(</span>Text<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		job<span class="token punctuation">.</span><span class="token function">setMapOutputValueClass</span><span class="token punctuation">(</span>IntWritable<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		job<span class="token punctuation">.</span><span class="token function">setOutputKeyClass</span><span class="token punctuation">(</span>Text<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		job<span class="token punctuation">.</span><span class="token function">setOutputValueClass</span><span class="token punctuation">(</span>IntWritable<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		
		FileInputFormat<span class="token punctuation">.</span><span class="token function">addInputPath</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		FileOutputFormat<span class="token punctuation">.</span><span class="token function">setOutputPath</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		job<span class="token punctuation">.</span><span class="token function">waitForCompletion</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
  <h3><a id="Hive_123"></a>Hive</h3> 
  <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> wc<span class="token punctuation">;</span>

<span class="token keyword">use</span> wc<span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> wordcount<span class="token punctuation">(</span>word string<span class="token punctuation">)</span> 
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span>  <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">"\n"</span> location <span class="token string">'/wordcount'</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">"/home/fanger/example/wordcount"</span> <span class="token keyword">into</span> <span class="token keyword">table</span> wordcount<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> wordcount<span class="token punctuation">;</span>

<span class="token keyword">select</span>
a<span class="token punctuation">.</span>word <span class="token keyword">as</span> word<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num
<span class="token keyword">from</span><span class="token punctuation">(</span>
<span class="token keyword">select</span> 
wc<span class="token punctuation">.</span>word <span class="token keyword">as</span> word
<span class="token keyword">from</span> wordcount 
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>split<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> wc <span class="token keyword">as</span> word<span class="token punctuation">)</span> a
<span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>word<span class="token punctuation">;</span>    
</code></pre> 
  <h3><a id="Spark_146"></a>Spark</h3> 
  <pre><code class="prism language-kotlin"><span class="token comment">/* 基于java的spark编程 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> _01sparkCount <span class="token punctuation">{</span>
    <span class="token keyword">public</span> static void <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>      
        SparkConf conf<span class="token operator">=</span>new <span class="token function">SparkConf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conf<span class="token punctuation">.</span><span class="token function">setMaster</span><span class="token punctuation">(</span><span class="token string">"local[*]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conf<span class="token punctuation">.</span><span class="token function">setAppName</span><span class="token punctuation">(</span>_01sparkCount<span class="token punctuation">.</span>class<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        JavaSparkContext jsc<span class="token operator">=</span>new <span class="token function">JavaSparkContext</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        JavaRDD<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> text <span class="token operator">=</span> jsc<span class="token punctuation">.</span><span class="token function">textFile</span><span class="token punctuation">(</span><span class="token string">"D:\\bd_example\\data\\wordcount\\"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//方法一</span>
        int numPartitions <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">getNumPartitions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>numPartitions<span class="token punctuation">)</span><span class="token punctuation">;</span>
        JavaRDD<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> lines <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>new FlatMapFunction<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> Iterator<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> <span class="token function">call</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> throws Exception <span class="token punctuation">{</span>
                <span class="token keyword">return</span> Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        JavaPairRDD<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span> maps <span class="token operator">=</span> lines<span class="token punctuation">.</span><span class="token function">mapToPair</span><span class="token punctuation">(</span>new PairFunction<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> Tuple2<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span> <span class="token function">call</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> throws Exception <span class="token punctuation">{</span>
                <span class="token keyword">return</span> new <span class="token function">Tuple2</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        JavaPairRDD<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span> reduces <span class="token operator">=</span> maps<span class="token punctuation">.</span><span class="token function">reduceByKey</span><span class="token punctuation">(</span>new Function2<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> Integer <span class="token function">call</span><span class="token punctuation">(</span>Integer v1<span class="token punctuation">,</span> Integer v2<span class="token punctuation">)</span> throws Exception <span class="token punctuation">{</span>
                <span class="token keyword">return</span> v1 <span class="token operator">+</span> v2<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        reduces<span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span>new VoidFunction<span class="token operator">&lt;</span>Tuple2<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">call</span><span class="token punctuation">(</span>Tuple2<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span> t<span class="token punctuation">)</span> throws Exception <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token operator">+</span><span class="token string">"----&gt;"</span><span class="token operator">+</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//方法二</span>
        jsc<span class="token punctuation">.</span><span class="token function">textFile</span><span class="token punctuation">(</span><span class="token string">"D:\\bd_example\\data\\wordcount\\"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">mapToPair</span><span class="token punctuation">(</span>v<span class="token operator">-&gt;</span>new Tuple2<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduceByKey</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">)</span><span class="token operator">-&gt;</span>v1<span class="token operator">+</span>v2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span>t<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token operator">+</span><span class="token string">"\t"</span><span class="token operator">+</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        jsc<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
  <h3><a id="Scala_197"></a>Scala</h3> 
  <pre><code class="prism language-kotlin"> <span class="token comment">/* 结果： List((s,1), (g,1), (e,2), (d,2), (c,2), (b,1), (a,3)) */</span>
<span class="token comment">//方法一</span>
  <span class="token keyword">val</span> array2<span class="token operator">=</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token string">"a b c"</span><span class="token punctuation">,</span><span class="token string">"a c d e s"</span><span class="token punctuation">,</span><span class="token string">"a d e g"</span><span class="token punctuation">)</span>
  <span class="token function">print</span><span class="token punctuation">(</span>array
  	<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token operator">&gt;</span>x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>flatten
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token operator">&gt;</span>x<span class="token punctuation">.</span>_1<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>_1<span class="token punctuation">,</span>x<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>toList
    <span class="token punctuation">.</span><span class="token function">sortWith</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span>x<span class="token punctuation">.</span>_1<span class="token operator">&gt;</span>y<span class="token punctuation">.</span>_1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//方法二</span>
  <span class="token keyword">val</span> stringToInt <span class="token operator">=</span> array2
	<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token punctuation">,</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span>toList
	<span class="token punctuation">.</span><span class="token function">sortWith</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span>x<span class="token punctuation">.</span>_1<span class="token operator">&gt;</span>y<span class="token punctuation">.</span>_1<span class="token punctuation">)</span>
   <span class="token function">println</span><span class="token punctuation">(</span>stringToInt<span class="token punctuation">)</span>
<span class="token comment">//方法三</span>
<span class="token keyword">val</span> conf<span class="token operator">=</span>new <span class="token function">SparkConf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAppName</span><span class="token punctuation">(</span>AggreatBy<span class="token punctuation">.</span>getClass<span class="token punctuation">.</span>getSimpleName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMaster</span><span class="token punctuation">(</span><span class="token string">"local[1]"</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> sc<span class="token operator">=</span>new <span class="token function">SparkContext</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span>
    <span class="token keyword">val</span> array2<span class="token operator">=</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token string">"a b c"</span><span class="token punctuation">,</span><span class="token string">"a c d e s"</span><span class="token punctuation">,</span><span class="token string">"a d e g"</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> valuerdd<span class="token operator">:</span> RDD<span class="token punctuation">[</span>String<span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function">parallelize</span><span class="token punctuation">(</span>array2<span class="token punctuation">)</span>
    <span class="token keyword">val</span> value <span class="token operator">=</span> valuerdd<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> stringToLong<span class="token operator">:</span> collection<span class="token punctuation">.</span>Map<span class="token punctuation">[</span>String<span class="token punctuation">,</span> Long<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">countByKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span>stringToLong<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">println</span><span class="token punctuation">(</span>s<span class="token string">"<span class="token interpolation"><span class="token delimiter variable">${</span>k<span class="token delimiter variable">}</span></span>,<span class="token interpolation"><span class="token delimiter variable">${</span>v<span class="token delimiter variable">}</span></span>"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

</code></pre> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
