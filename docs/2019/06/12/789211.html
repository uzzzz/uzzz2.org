<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>动手学深度学习 - 3.1 线性回归 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="动手学深度学习 - 3.1 线性回归" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="动手学深度学习 - 3.1 线性回归 动手学深度学习 - Dive into Deep Learning Aston Zhang, Zachary C. Lipton, Mu Li, and Alexander J. Smola https://zh.d2l.ai/ 3.1. 线性回归 线性回归输出是一个连续值，因此适用于回归问题。回归问题在实际中很常见，例如预测房屋价格、气温、销售额等连续值的问题。分类问题中模型的最终输出是一个离散值。图像分类、垃圾邮件识别、疾病检测等输出为离散值的问题都属于分类问题的范畴。softmax 回归则适用于分类问题。 线性回归和 softmax 回归都是单层神经网络。 3.1.1. 线性回归的基本要素 我们以一个简单的房屋价格预测作为例子来解释线性回归的基本要素。这个应用的目标是预测一栋房子的售出价格 (元)。我们知道这个价格取决于很多因素，如房屋状况、地段、市场行情等。为了简单起见，这里我们假设价格只取决于房屋状况的两个因素，即面积 (平方米) 和房龄 (年)。接下来我们希望探索价格与这两个因素的具体关系。 3.1.1.1. 模型 设房屋的面积为 x 1 x_{1} x1​，房龄为 x 2 x_{2} x2​，售出价格为 y y y。我们需要建立基于输入 x 1 x_{1} x1​ 和 x 2 x_{2} x2​ 来计算输出 y y y 的表达式，也就是模型 (model)。线性回归假设输出与各个输入之间是线性关系： y ^ = x 1 w 1 + x 2 w 2 + b , \hat{y} = x_1 w_1 + x_2 w_2 + b, y^​=x1​w1​+x2​w2​+b, 其中 w 1 w_{1} w1​ 和 w 2 w_{2} w2​ 是权重 (weight)， b b b 是偏差 (bias)，且均为标量。它们是线性回归模型的参数 (parameter)。模型输出 y ^ \hat{y} y^​ 是线性回归对真实价格 y y y 的预测或估计。我们通常允许它们之间有一定误差。 3.1.1.2. 模型训练 我们需要通过数据来寻找特定的模型参数值，使模型在数据上的误差尽可能小。这个过程叫做模型训练 (model training)。下面是模型训练所涉及的 3 个要素。 3.1.1.2.1. 训练数据 我们通常收集一系列的真实数据，例如多栋房屋的真实售出价格和它们对应的面积和房龄。我们希望在这个数据上面寻找模型参数来使模型的预测价格与真实价格的误差最小。在机器学习术语里，该数据集被称为训练数据集 (training data set) 或训练集 (training set)，一栋房屋被称为一个样本 (sample)，其真实售出价格叫做标签 (label)，用来预测标签的两个因素叫作特征 (feature)。特征用来表征样本的特点。 假设我们采集的样本数为 n n n，索引为 i i i 的样本的特征为 x 1 ( i ) x^{(i)}_{1} x1(i)​ 和 x 2 ( i ) x^{(i)}_{2} x2(i)​，标签为 y ( i ) y^{(i)} y(i)。对于索引为 i i i 的房屋，线性回归模型的房屋价格预测表达式为 y ^ ( i ) = x 1 ( i ) w 1 + x 2 ( i ) w 2 + b . \hat{y}^{(i)} = x_1^{(i)} w_1 + x_2^{(i)} w_2 + b. y^​(i)=x1(i)​w1​+x2(i)​w2​+b. 3.1.1.2.2. 损失函数 在模型训练中，我们需要衡量价格预测值与真实值之间的误差。通常我们会选取一个非负数作为误差，且数值越小表示误差越小。一个常用的选择是平方函数。它在评估索引为 i i i 的样本误差的表达式为 ℓ ( i ) ( w 1 , w 2 , b ) = 1 2 ( y ^ ( i ) − y ( i ) ) 2 = 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 , \ell^{(i)}(w_1, w_2, b) = \frac{1}{2} \left(\hat{y}^{(i)} - y^{(i)}\right)^2= \frac{1}{2}\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right)^{2}, ℓ(i)(w1​,w2​,b)=21​(y^​(i)−y(i))2=21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2, 其中常数 1/2 使对平方项求导后的常数系数为 1，这样在形式上稍微简单一些。显然，误差越小表示预测价格与真实价格越相近，且当二者相等时误差为 0。给定训练数据集，这个误差只与模型参数相关，因此我们将它记为以模型参数为参数的函数。在机器学习里，将衡量误差的函数称为损失函数 (loss function)。这里使用的平方误差函数也称为平方损失 (square loss)。 通常，我们用训练数据集中所有样本误差的平均来衡量模型预测的质量，即 ℓ ( w 1 , w 2 , b ) = 1 n ∑ i = 1 n ℓ ( i ) ( w 1 , w 2 , b ) = 1 n ∑ i = 1 n 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 . \ell(w_1, w_2, b) =\frac{1}{n} \sum_{i=1}^n \ell^{(i)}(w_1, w_2, b) =\frac{1}{n} \sum_{i=1}^n \frac{1}{2}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right)^2. ℓ(w1​,w2​,b)=n1​i=1∑n​ℓ(i)(w1​,w2​,b)=n1​i=1∑n​21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2. 在模型训练中，我们希望找出一组模型参数，记为 w 1 ∗ w^{∗}_{1} w1∗​, w 2 ∗ w^{∗}_{2} w2∗​, b ∗ b^{∗} b∗，来使训练样本平均损失最小： w 1 ∗ , w 2 ∗ , b ∗ = a r g m i n w 1 , w 2 , b &nbsp; ℓ ( w 1 , w 2 , b ) . w^{∗}_{1}, w^{∗}_{2}, b^{∗} = \underset{w_{1}, w_{2}, b}{argmin}\ \ell(w_{1}, w_{2}, b). w1∗​,w2∗​,b∗=w1​,w2​,bargmin​&nbsp;ℓ(w1​,w2​,b). 3.1.1.2.3. 优化算法 当模型和损失函数形式较为简单时，上面的误差最小化问题的解可以直接用公式表达出来。这类解叫作解析解 (analytical solution)。线性回归和平方误差刚好属于这个范畴。然而，大多数深度学习模型并没有解析解，只能通过优化算法有限次迭代模型参数来尽可能降低损失函数的值。这类解叫作数值解 (numerical solution)。 在求数值解的优化算法中，小批量随机梯度下降 (mini-batch stochastic gradient descent) 在深度学习中被广泛使用。它的算法很简单：先选取一组模型参数的初始值，如随机选取；接下来对参数进行多次迭代，使每次迭代都可能降低损失函数的值。在每次迭代中，先随机均匀采样一个由固定数目训练数据样本所组成的小批量 (mini-batch) B \mathcal{B} B，然后求小批量中数据样本的平均损失有关模型参数的导数 (梯度)，最后用此结果与预先设定的一个正数的乘积作为模型参数在本次迭代的减小量。 在训练本节讨论的线性回归模型的过程中，模型的每个参数将作如下迭代： w 1 ← w 1 − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 = w 1 − η ∣ B ∣ ∑ i ∈ B x 1 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) , w 2 ← w 2 − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 = w 2 − η ∣ B ∣ ∑ i ∈ B x 2 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) , b ← b − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b = b − η ∣ B ∣ ∑ i ∈ B ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) . \begin{aligned} w_1 &amp;amp;\leftarrow w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_1} = w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_1^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ w_2 &amp;amp;\leftarrow w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_2} = w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_2^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ b &amp;amp;\leftarrow b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial b} = b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right). \end{aligned} w1​w2​b​←w1​−∣B∣η​i∈B∑​∂w1​∂ℓ(i)(w1​,w2​,b)​=w1​−∣B∣η​i∈B∑​x1(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i)),←w2​−∣B∣η​i∈B∑​∂w2​∂ℓ(i)(w1​,w2​,b)​=w2​−∣B∣η​i∈B∑​x2(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i)),←b−∣B∣η​i∈B∑​∂b∂ℓ(i)(w1​,w2​,b)​=b−∣B∣η​i∈B∑​(x1(i)​w1​+x2(i)​w2​+b−y(i)).​ 其中 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ w 1 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ w 1 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 1 ( i ) , \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial w_{1}} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial w_{1}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial w_{1}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) x^{(i)}_{1}, \end{aligned} ∂w1​∂ℓ(i)(w1​,w2​,b)​​=∂w1​∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂w1​∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i))x1(i)​,​ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ w 2 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ w 2 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 2 ( i ) , \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial w_{2}} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial w_{2}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial w_{2}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) x^{(i)}_{2}, \end{aligned} ∂w2​∂ℓ(i)(w1​,w2​,b)​​=∂w2​∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂w2​∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i))x2(i)​,​ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ b = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ b = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) . \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial b} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial b} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial b} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right). \end{aligned} ∂b∂ℓ(i)(w1​,w2​,b)​​=∂b∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂b∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i)).​ 在上式中， ∣ B ∣ |\mathcal{B}| ∣B∣ 代表每个小批量中的样本个数 (批量大小，batch size)， η \eta η 称作学习率 (learning rate) 并取正数。需要强调的是，这里的批量大小和学习率的值是人为设定的，并不是通过模型训练学出的，因此叫作超参数 (hyperparameter)。我们通常所说的调参指的正是调节超参数，例如通过反复试错来找到超参数合适的值。在少数情况下，超参数也可以通过模型训练学出。 3.1.1.3. 模型预测 模型训练完成后，我们将模型参数 w 1 w_{1} w1​, w 2 w_{2} w2​, b b b 在优化算法停止时的值分别记作 w ^ 1 \hat{w}_{1} w^1​, w ^ 2 \hat{w}_{2} w^2​, b ^ \hat{b} b^。注意，这里我们得到的并不一定是最小化损失函数的最优解 w 1 ∗ w^{∗}_{1} w1∗​, w 2 ∗ w^{∗}_{2} w2∗​, b ∗ b^{∗} b∗，而是对最优解的一个近似。然后，我们就可以使用学出的线性回归模型 x 1 w ^ 1 + x 2 w ^ 2 + b ^ x_{1}\hat{w}_{1} + x_{2}\hat{w}_{2} +\hat{b} x1​w^1​+x2​w^2​+b^ 来估算训练数据集以外任意一栋面积 (平方米) 为 x 1 x_{1} x1​、房龄 (年) 为 x 2 x_{2} x2​ 的房屋的价格了。这里的估算也叫作模型预测、模型推断或模型测试。 3.1.2. 线性回归的表示方法 3.1.2.1. 神经网络图 在深度学习中，我们可以使用神经网络图直观地表现模型结构。为了更清晰地展示线性回归作为神经网络的结构，图 3.1 使用神经网络图表示本节中介绍的线性回归模型。神经网络图隐去了模型参数权重和偏差。 图 3.1 线性回归是一个单层神经网络 在图 3.1 所示的神经网络中，输入分别为 x 1 x_{1} x1​ 和 x 2 x_{2} x2​，因此输入层的输入个数为 2。输入个数也叫特征数或特征向量维度。图 3.1 中网络的输出为 o o o，输出层的输出个数为 1。需要注意的是，我们直接将图 3.1 中神经网络的输出 o o o 作为线性回归的输出，即 y ^ = o \hat{y} = o y^​=o。由于输入层并不涉及计算，按照惯例，图 3.1 所示的神经网络的层数为 1。所以线性回归是一个单层神经网络。输出层中负责计算 o o o 的单元又叫神经元。在线性回归中， o o o 的计算依赖于 x 1 x_{1} x1​ 和 x 2 x_{2} x2​。输出层中的神经元和输入层中各个输入完全连接。因此，这里的输出层又叫全连接层 (fully-connected layer) 或稠密层 (dense layer)。 3.1.2.2. 矢量计算表达式 在模型训练或预测时，我们常常会同时处理多个数据样本并用到矢量计算。在介绍线性回归的矢量计算表达式之前，让我们先考虑对两个向量相加的两种方法。 下面先定义两个 1000 维的向量。 In [1]: from mxnet import nd from time import time a = nd.ones(shape=1000) b = nd.ones(shape=1000) 向量相加的一种方法是，将这两个向量按元素逐一做标量加法。 In [2]: start = time() c = nd.zeros(shape=1000) for i in range(1000): c[i] = a[i] + b[i] time() - start Out[2]: 0.15223002433776855 向量相加的另一种方法是，将这两个向量直接做矢量加法。 In [3]: start = time() d = a + b time() - start Out[3]: 0.00029015541076660156 结果很明显，后者比前者更省时。因此，我们应该尽可能采用矢量计算，以提升计算效率。 如果我们对训练数据集里的 3 个房屋样本 (索引分别为 1、2 和 3) 逐一预测价格，将得到 y ^ ( 1 ) = x 1 ( 1 ) w 1 + x 2 ( 1 ) w 2 + b , y ^ ( 2 ) = x 1 ( 2 ) w 1 + x 2 ( 2 ) w 2 + b , y ^ ( 3 ) = x 1 ( 3 ) w 1 + x 2 ( 3 ) w 2 + b . \begin{aligned} \hat{y}^{(1)} &amp;amp;= x_1^{(1)} w_1 + x_2^{(1)} w_2 + b,\\ \hat{y}^{(2)} &amp;amp;= x_1^{(2)} w_1 + x_2^{(2)} w_2 + b,\\ \hat{y}^{(3)} &amp;amp;= x_1^{(3)} w_1 + x_2^{(3)} w_2 + b. \end{aligned} y^​(1)y^​(2)y^​(3)​=x1(1)​w1​+x2(1)​w2​+b,=x1(2)​w1​+x2(2)​w2​+b,=x1(3)​w1​+x2(3)​w2​+b.​ 现在，我们将上面 3 个等式转化成矢量计算。设 y ^ = [ y ^ ( 1 ) y ^ ( 2 ) y ^ ( 3 ) ] , X = [ x 1 ( 1 ) x 2 ( 1 ) x 1 ( 2 ) x 2 ( 2 ) x 1 ( 3 ) x 2 ( 3 ) ] , w = [ w 1 w 2 ] , \boldsymbol{\hat{y}} = \begin{bmatrix} \hat{y}^{(1)} \\ \hat{y}^{(2)} \\ \hat{y}^{(3)} \end{bmatrix},\quad \boldsymbol{X} = \begin{bmatrix} x_1^{(1)} &amp;amp; x_2^{(1)} \\ x_1^{(2)} &amp;amp; x_2^{(2)} \\ x_1^{(3)} &amp;amp; x_2^{(3)} \end{bmatrix},\quad \boldsymbol{w} = \begin{bmatrix} w_1 \\ w_2 \end{bmatrix}, y^​=⎣⎡​y^​(1)y^​(2)y^​(3)​⎦⎤​,X=⎣⎢⎡​x1(1)​x1(2)​x1(3)​​x2(1)​x2(2)​x2(3)​​⎦⎥⎤​,w=[w1​w2​​], y = [ y ( 1 ) y ( 2 ) y ( 3 ) ] . \boldsymbol{y} = \begin{bmatrix} {y}^{(1)} \\ {y}^{(2)} \\ {y}^{(3)} \\ \end{bmatrix}. y=⎣⎡​y(1)y(2)y(3)​⎦⎤​. 对 3 个房屋样本预测价格的矢量计算表达式为 y ^ = X w + b \boldsymbol{\hat{y}} = \boldsymbol{X} \boldsymbol{w} + b y^​=Xw+b，其中的加法运算使用了广播机制。例如： In [4]: a = nd.ones(shape=3) b = 10 a + b Out[4]: [11. 11. 11.] &lt;NDArray 3 @cpu(0)&gt; 广义上讲，当数据样本数为 n n n，特征数为 d d d 时，线性回归的矢量计算表达式为 y ^ = X w + b , \boldsymbol{\hat{y}} = \boldsymbol{X} \boldsymbol{w} + b, y^​=Xw+b, 其中模型输出 y ^ ∈ R n × 1 \boldsymbol {\hat{y}} \in \mathbb{R}^{n\times1} y^​∈Rn×1， 批量数据样本特征 X ∈ R n × d \boldsymbol{X} \in \mathbb{R}^{n\times d} X∈Rn×d，权重 w ∈ R d × 1 \boldsymbol{w} \in \mathbb{R}^{d \times 1} w∈Rd×1， 偏差 b ∈ R \boldsymbol {b} \in \mathbb{R} b∈R。相应地，批量数据样本标签 y ∈ R n × 1 \boldsymbol {y} \in \mathbb{R}^{n\times1} y∈Rn×1。设模型参数 θ = [ w 1 , w 2 , b ] ⊤ \boldsymbol{\theta} = [w_1, w_2, b]^\top θ=[w1​,w2​,b]⊤，我们可以重写损失函数为 ℓ ( θ ) = 1 2 n ( y ^ − y ) ⊤ ( y ^ − y ) = 1 2 n ( ( y ^ ( 1 ) − y ( 1 ) ) 2 + ( y ^ ( 2 ) − y ( 2 ) ) 2 + ( y ^ ( 3 ) − y ( 3 ) ) 2 ) = 1 2 n ∑ i = 1 n ( y ^ ( i ) − y ( i ) ) 2 = 1 n ∑ i = 1 n 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 . \begin{aligned} \ell(\boldsymbol{\theta}) &amp;amp; =\frac{1}{2n}(\boldsymbol{\hat{y}}-\boldsymbol{y})^\top(\boldsymbol{\hat{y}}-\boldsymbol{y}) \\ &amp;amp; = \frac{1}{2n} \left((\hat{y}^{(1)} - {y}^{(1)})^{2} + (\hat{y}^{(2)} - {y}^{(2)})^{2} + (\hat{y}^{(3)} - {y}^{(3)})^{2}\right) \\ &amp;amp; = \frac{1}{2n} \sum_{i=1}^{n} (\hat{y}^{(i)} - y^{(i)})^{2} \\ &amp;amp; = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{2}\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right)^{2}. \end{aligned} ℓ(θ)​=2n1​(y^​−y)⊤(y^​−y)=2n1​((y^​(1)−y(1))2+(y^​(2)−y(2))2+(y^​(3)−y(3))2)=2n1​i=1∑n​(y^​(i)−y(i))2=n1​i=1∑n​21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2.​ 小批量随机梯度下降的迭代步骤将相应地改写为 θ ← θ − η ∣ B ∣ ∑ i ∈ B ∇ θ ℓ ( i ) ( θ ) , \boldsymbol{\theta} \leftarrow \boldsymbol{\theta} - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \nabla_{\boldsymbol{\theta}} \ell^{(i)}(\boldsymbol{\theta}), θ←θ−∣B∣η​i∈B∑​∇θ​ℓ(i)(θ), 其中梯度是损失有关 3 个为标量的模型参数的偏导数组成的向量： ∇ θ ℓ ( i ) ( θ ) = [ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b ] = [ x 1 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 2 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ] = [ x 1 ( i ) x 2 ( i ) 1 ] ( y ^ ( i ) − y ( i ) ) . \nabla_{\boldsymbol{\theta}} \ell^{(i)}(\boldsymbol{\theta})= \begin{bmatrix} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_1} \\ \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_2} \\ \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial b} \end{bmatrix} = \begin{bmatrix} x_1^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\ x_2^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\ x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)} \end{bmatrix} = \begin{bmatrix} x_1^{(i)} \\ x_2^{(i)} \\ 1 \end{bmatrix} (\hat{y}^{(i)} - y^{(i)}). ∇θ​ℓ(i)(θ)=⎣⎢⎢⎡​∂w1​∂ℓ(i)(w1​,w2​,b)​∂w2​∂ℓ(i)(w1​,w2​,b)​∂b∂ℓ(i)(w1​,w2​,b)​​⎦⎥⎥⎤​=⎣⎢⎡​x1(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i))x2(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i))x1(i)​w1​+x2(i)​w2​+b−y(i)​⎦⎥⎤​=⎣⎢⎡​x1(i)​x2(i)​1​⎦⎥⎤​(y^​(i)−y(i)). 3.1.3. 小结 对于线性回归这样一种单层神经网络，它的基本要素包括模型、训练数据、损失函数和优化算法。 既可以用神经网络图表示线性回归，又可以用矢量计算表示该模型。 应该尽可能采用矢量计算，以提升计算效率。" />
<meta property="og:description" content="动手学深度学习 - 3.1 线性回归 动手学深度学习 - Dive into Deep Learning Aston Zhang, Zachary C. Lipton, Mu Li, and Alexander J. Smola https://zh.d2l.ai/ 3.1. 线性回归 线性回归输出是一个连续值，因此适用于回归问题。回归问题在实际中很常见，例如预测房屋价格、气温、销售额等连续值的问题。分类问题中模型的最终输出是一个离散值。图像分类、垃圾邮件识别、疾病检测等输出为离散值的问题都属于分类问题的范畴。softmax 回归则适用于分类问题。 线性回归和 softmax 回归都是单层神经网络。 3.1.1. 线性回归的基本要素 我们以一个简单的房屋价格预测作为例子来解释线性回归的基本要素。这个应用的目标是预测一栋房子的售出价格 (元)。我们知道这个价格取决于很多因素，如房屋状况、地段、市场行情等。为了简单起见，这里我们假设价格只取决于房屋状况的两个因素，即面积 (平方米) 和房龄 (年)。接下来我们希望探索价格与这两个因素的具体关系。 3.1.1.1. 模型 设房屋的面积为 x 1 x_{1} x1​，房龄为 x 2 x_{2} x2​，售出价格为 y y y。我们需要建立基于输入 x 1 x_{1} x1​ 和 x 2 x_{2} x2​ 来计算输出 y y y 的表达式，也就是模型 (model)。线性回归假设输出与各个输入之间是线性关系： y ^ = x 1 w 1 + x 2 w 2 + b , \hat{y} = x_1 w_1 + x_2 w_2 + b, y^​=x1​w1​+x2​w2​+b, 其中 w 1 w_{1} w1​ 和 w 2 w_{2} w2​ 是权重 (weight)， b b b 是偏差 (bias)，且均为标量。它们是线性回归模型的参数 (parameter)。模型输出 y ^ \hat{y} y^​ 是线性回归对真实价格 y y y 的预测或估计。我们通常允许它们之间有一定误差。 3.1.1.2. 模型训练 我们需要通过数据来寻找特定的模型参数值，使模型在数据上的误差尽可能小。这个过程叫做模型训练 (model training)。下面是模型训练所涉及的 3 个要素。 3.1.1.2.1. 训练数据 我们通常收集一系列的真实数据，例如多栋房屋的真实售出价格和它们对应的面积和房龄。我们希望在这个数据上面寻找模型参数来使模型的预测价格与真实价格的误差最小。在机器学习术语里，该数据集被称为训练数据集 (training data set) 或训练集 (training set)，一栋房屋被称为一个样本 (sample)，其真实售出价格叫做标签 (label)，用来预测标签的两个因素叫作特征 (feature)。特征用来表征样本的特点。 假设我们采集的样本数为 n n n，索引为 i i i 的样本的特征为 x 1 ( i ) x^{(i)}_{1} x1(i)​ 和 x 2 ( i ) x^{(i)}_{2} x2(i)​，标签为 y ( i ) y^{(i)} y(i)。对于索引为 i i i 的房屋，线性回归模型的房屋价格预测表达式为 y ^ ( i ) = x 1 ( i ) w 1 + x 2 ( i ) w 2 + b . \hat{y}^{(i)} = x_1^{(i)} w_1 + x_2^{(i)} w_2 + b. y^​(i)=x1(i)​w1​+x2(i)​w2​+b. 3.1.1.2.2. 损失函数 在模型训练中，我们需要衡量价格预测值与真实值之间的误差。通常我们会选取一个非负数作为误差，且数值越小表示误差越小。一个常用的选择是平方函数。它在评估索引为 i i i 的样本误差的表达式为 ℓ ( i ) ( w 1 , w 2 , b ) = 1 2 ( y ^ ( i ) − y ( i ) ) 2 = 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 , \ell^{(i)}(w_1, w_2, b) = \frac{1}{2} \left(\hat{y}^{(i)} - y^{(i)}\right)^2= \frac{1}{2}\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right)^{2}, ℓ(i)(w1​,w2​,b)=21​(y^​(i)−y(i))2=21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2, 其中常数 1/2 使对平方项求导后的常数系数为 1，这样在形式上稍微简单一些。显然，误差越小表示预测价格与真实价格越相近，且当二者相等时误差为 0。给定训练数据集，这个误差只与模型参数相关，因此我们将它记为以模型参数为参数的函数。在机器学习里，将衡量误差的函数称为损失函数 (loss function)。这里使用的平方误差函数也称为平方损失 (square loss)。 通常，我们用训练数据集中所有样本误差的平均来衡量模型预测的质量，即 ℓ ( w 1 , w 2 , b ) = 1 n ∑ i = 1 n ℓ ( i ) ( w 1 , w 2 , b ) = 1 n ∑ i = 1 n 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 . \ell(w_1, w_2, b) =\frac{1}{n} \sum_{i=1}^n \ell^{(i)}(w_1, w_2, b) =\frac{1}{n} \sum_{i=1}^n \frac{1}{2}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right)^2. ℓ(w1​,w2​,b)=n1​i=1∑n​ℓ(i)(w1​,w2​,b)=n1​i=1∑n​21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2. 在模型训练中，我们希望找出一组模型参数，记为 w 1 ∗ w^{∗}_{1} w1∗​, w 2 ∗ w^{∗}_{2} w2∗​, b ∗ b^{∗} b∗，来使训练样本平均损失最小： w 1 ∗ , w 2 ∗ , b ∗ = a r g m i n w 1 , w 2 , b &nbsp; ℓ ( w 1 , w 2 , b ) . w^{∗}_{1}, w^{∗}_{2}, b^{∗} = \underset{w_{1}, w_{2}, b}{argmin}\ \ell(w_{1}, w_{2}, b). w1∗​,w2∗​,b∗=w1​,w2​,bargmin​&nbsp;ℓ(w1​,w2​,b). 3.1.1.2.3. 优化算法 当模型和损失函数形式较为简单时，上面的误差最小化问题的解可以直接用公式表达出来。这类解叫作解析解 (analytical solution)。线性回归和平方误差刚好属于这个范畴。然而，大多数深度学习模型并没有解析解，只能通过优化算法有限次迭代模型参数来尽可能降低损失函数的值。这类解叫作数值解 (numerical solution)。 在求数值解的优化算法中，小批量随机梯度下降 (mini-batch stochastic gradient descent) 在深度学习中被广泛使用。它的算法很简单：先选取一组模型参数的初始值，如随机选取；接下来对参数进行多次迭代，使每次迭代都可能降低损失函数的值。在每次迭代中，先随机均匀采样一个由固定数目训练数据样本所组成的小批量 (mini-batch) B \mathcal{B} B，然后求小批量中数据样本的平均损失有关模型参数的导数 (梯度)，最后用此结果与预先设定的一个正数的乘积作为模型参数在本次迭代的减小量。 在训练本节讨论的线性回归模型的过程中，模型的每个参数将作如下迭代： w 1 ← w 1 − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 = w 1 − η ∣ B ∣ ∑ i ∈ B x 1 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) , w 2 ← w 2 − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 = w 2 − η ∣ B ∣ ∑ i ∈ B x 2 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) , b ← b − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b = b − η ∣ B ∣ ∑ i ∈ B ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) . \begin{aligned} w_1 &amp;amp;\leftarrow w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_1} = w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_1^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ w_2 &amp;amp;\leftarrow w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_2} = w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_2^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ b &amp;amp;\leftarrow b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial b} = b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right). \end{aligned} w1​w2​b​←w1​−∣B∣η​i∈B∑​∂w1​∂ℓ(i)(w1​,w2​,b)​=w1​−∣B∣η​i∈B∑​x1(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i)),←w2​−∣B∣η​i∈B∑​∂w2​∂ℓ(i)(w1​,w2​,b)​=w2​−∣B∣η​i∈B∑​x2(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i)),←b−∣B∣η​i∈B∑​∂b∂ℓ(i)(w1​,w2​,b)​=b−∣B∣η​i∈B∑​(x1(i)​w1​+x2(i)​w2​+b−y(i)).​ 其中 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ w 1 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ w 1 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 1 ( i ) , \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial w_{1}} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial w_{1}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial w_{1}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) x^{(i)}_{1}, \end{aligned} ∂w1​∂ℓ(i)(w1​,w2​,b)​​=∂w1​∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂w1​∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i))x1(i)​,​ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ w 2 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ w 2 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 2 ( i ) , \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial w_{2}} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial w_{2}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial w_{2}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) x^{(i)}_{2}, \end{aligned} ∂w2​∂ℓ(i)(w1​,w2​,b)​​=∂w2​∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂w2​∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i))x2(i)​,​ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ b = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ b = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) . \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial b} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial b} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial b} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right). \end{aligned} ∂b∂ℓ(i)(w1​,w2​,b)​​=∂b∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂b∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i)).​ 在上式中， ∣ B ∣ |\mathcal{B}| ∣B∣ 代表每个小批量中的样本个数 (批量大小，batch size)， η \eta η 称作学习率 (learning rate) 并取正数。需要强调的是，这里的批量大小和学习率的值是人为设定的，并不是通过模型训练学出的，因此叫作超参数 (hyperparameter)。我们通常所说的调参指的正是调节超参数，例如通过反复试错来找到超参数合适的值。在少数情况下，超参数也可以通过模型训练学出。 3.1.1.3. 模型预测 模型训练完成后，我们将模型参数 w 1 w_{1} w1​, w 2 w_{2} w2​, b b b 在优化算法停止时的值分别记作 w ^ 1 \hat{w}_{1} w^1​, w ^ 2 \hat{w}_{2} w^2​, b ^ \hat{b} b^。注意，这里我们得到的并不一定是最小化损失函数的最优解 w 1 ∗ w^{∗}_{1} w1∗​, w 2 ∗ w^{∗}_{2} w2∗​, b ∗ b^{∗} b∗，而是对最优解的一个近似。然后，我们就可以使用学出的线性回归模型 x 1 w ^ 1 + x 2 w ^ 2 + b ^ x_{1}\hat{w}_{1} + x_{2}\hat{w}_{2} +\hat{b} x1​w^1​+x2​w^2​+b^ 来估算训练数据集以外任意一栋面积 (平方米) 为 x 1 x_{1} x1​、房龄 (年) 为 x 2 x_{2} x2​ 的房屋的价格了。这里的估算也叫作模型预测、模型推断或模型测试。 3.1.2. 线性回归的表示方法 3.1.2.1. 神经网络图 在深度学习中，我们可以使用神经网络图直观地表现模型结构。为了更清晰地展示线性回归作为神经网络的结构，图 3.1 使用神经网络图表示本节中介绍的线性回归模型。神经网络图隐去了模型参数权重和偏差。 图 3.1 线性回归是一个单层神经网络 在图 3.1 所示的神经网络中，输入分别为 x 1 x_{1} x1​ 和 x 2 x_{2} x2​，因此输入层的输入个数为 2。输入个数也叫特征数或特征向量维度。图 3.1 中网络的输出为 o o o，输出层的输出个数为 1。需要注意的是，我们直接将图 3.1 中神经网络的输出 o o o 作为线性回归的输出，即 y ^ = o \hat{y} = o y^​=o。由于输入层并不涉及计算，按照惯例，图 3.1 所示的神经网络的层数为 1。所以线性回归是一个单层神经网络。输出层中负责计算 o o o 的单元又叫神经元。在线性回归中， o o o 的计算依赖于 x 1 x_{1} x1​ 和 x 2 x_{2} x2​。输出层中的神经元和输入层中各个输入完全连接。因此，这里的输出层又叫全连接层 (fully-connected layer) 或稠密层 (dense layer)。 3.1.2.2. 矢量计算表达式 在模型训练或预测时，我们常常会同时处理多个数据样本并用到矢量计算。在介绍线性回归的矢量计算表达式之前，让我们先考虑对两个向量相加的两种方法。 下面先定义两个 1000 维的向量。 In [1]: from mxnet import nd from time import time a = nd.ones(shape=1000) b = nd.ones(shape=1000) 向量相加的一种方法是，将这两个向量按元素逐一做标量加法。 In [2]: start = time() c = nd.zeros(shape=1000) for i in range(1000): c[i] = a[i] + b[i] time() - start Out[2]: 0.15223002433776855 向量相加的另一种方法是，将这两个向量直接做矢量加法。 In [3]: start = time() d = a + b time() - start Out[3]: 0.00029015541076660156 结果很明显，后者比前者更省时。因此，我们应该尽可能采用矢量计算，以提升计算效率。 如果我们对训练数据集里的 3 个房屋样本 (索引分别为 1、2 和 3) 逐一预测价格，将得到 y ^ ( 1 ) = x 1 ( 1 ) w 1 + x 2 ( 1 ) w 2 + b , y ^ ( 2 ) = x 1 ( 2 ) w 1 + x 2 ( 2 ) w 2 + b , y ^ ( 3 ) = x 1 ( 3 ) w 1 + x 2 ( 3 ) w 2 + b . \begin{aligned} \hat{y}^{(1)} &amp;amp;= x_1^{(1)} w_1 + x_2^{(1)} w_2 + b,\\ \hat{y}^{(2)} &amp;amp;= x_1^{(2)} w_1 + x_2^{(2)} w_2 + b,\\ \hat{y}^{(3)} &amp;amp;= x_1^{(3)} w_1 + x_2^{(3)} w_2 + b. \end{aligned} y^​(1)y^​(2)y^​(3)​=x1(1)​w1​+x2(1)​w2​+b,=x1(2)​w1​+x2(2)​w2​+b,=x1(3)​w1​+x2(3)​w2​+b.​ 现在，我们将上面 3 个等式转化成矢量计算。设 y ^ = [ y ^ ( 1 ) y ^ ( 2 ) y ^ ( 3 ) ] , X = [ x 1 ( 1 ) x 2 ( 1 ) x 1 ( 2 ) x 2 ( 2 ) x 1 ( 3 ) x 2 ( 3 ) ] , w = [ w 1 w 2 ] , \boldsymbol{\hat{y}} = \begin{bmatrix} \hat{y}^{(1)} \\ \hat{y}^{(2)} \\ \hat{y}^{(3)} \end{bmatrix},\quad \boldsymbol{X} = \begin{bmatrix} x_1^{(1)} &amp;amp; x_2^{(1)} \\ x_1^{(2)} &amp;amp; x_2^{(2)} \\ x_1^{(3)} &amp;amp; x_2^{(3)} \end{bmatrix},\quad \boldsymbol{w} = \begin{bmatrix} w_1 \\ w_2 \end{bmatrix}, y^​=⎣⎡​y^​(1)y^​(2)y^​(3)​⎦⎤​,X=⎣⎢⎡​x1(1)​x1(2)​x1(3)​​x2(1)​x2(2)​x2(3)​​⎦⎥⎤​,w=[w1​w2​​], y = [ y ( 1 ) y ( 2 ) y ( 3 ) ] . \boldsymbol{y} = \begin{bmatrix} {y}^{(1)} \\ {y}^{(2)} \\ {y}^{(3)} \\ \end{bmatrix}. y=⎣⎡​y(1)y(2)y(3)​⎦⎤​. 对 3 个房屋样本预测价格的矢量计算表达式为 y ^ = X w + b \boldsymbol{\hat{y}} = \boldsymbol{X} \boldsymbol{w} + b y^​=Xw+b，其中的加法运算使用了广播机制。例如： In [4]: a = nd.ones(shape=3) b = 10 a + b Out[4]: [11. 11. 11.] &lt;NDArray 3 @cpu(0)&gt; 广义上讲，当数据样本数为 n n n，特征数为 d d d 时，线性回归的矢量计算表达式为 y ^ = X w + b , \boldsymbol{\hat{y}} = \boldsymbol{X} \boldsymbol{w} + b, y^​=Xw+b, 其中模型输出 y ^ ∈ R n × 1 \boldsymbol {\hat{y}} \in \mathbb{R}^{n\times1} y^​∈Rn×1， 批量数据样本特征 X ∈ R n × d \boldsymbol{X} \in \mathbb{R}^{n\times d} X∈Rn×d，权重 w ∈ R d × 1 \boldsymbol{w} \in \mathbb{R}^{d \times 1} w∈Rd×1， 偏差 b ∈ R \boldsymbol {b} \in \mathbb{R} b∈R。相应地，批量数据样本标签 y ∈ R n × 1 \boldsymbol {y} \in \mathbb{R}^{n\times1} y∈Rn×1。设模型参数 θ = [ w 1 , w 2 , b ] ⊤ \boldsymbol{\theta} = [w_1, w_2, b]^\top θ=[w1​,w2​,b]⊤，我们可以重写损失函数为 ℓ ( θ ) = 1 2 n ( y ^ − y ) ⊤ ( y ^ − y ) = 1 2 n ( ( y ^ ( 1 ) − y ( 1 ) ) 2 + ( y ^ ( 2 ) − y ( 2 ) ) 2 + ( y ^ ( 3 ) − y ( 3 ) ) 2 ) = 1 2 n ∑ i = 1 n ( y ^ ( i ) − y ( i ) ) 2 = 1 n ∑ i = 1 n 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 . \begin{aligned} \ell(\boldsymbol{\theta}) &amp;amp; =\frac{1}{2n}(\boldsymbol{\hat{y}}-\boldsymbol{y})^\top(\boldsymbol{\hat{y}}-\boldsymbol{y}) \\ &amp;amp; = \frac{1}{2n} \left((\hat{y}^{(1)} - {y}^{(1)})^{2} + (\hat{y}^{(2)} - {y}^{(2)})^{2} + (\hat{y}^{(3)} - {y}^{(3)})^{2}\right) \\ &amp;amp; = \frac{1}{2n} \sum_{i=1}^{n} (\hat{y}^{(i)} - y^{(i)})^{2} \\ &amp;amp; = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{2}\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right)^{2}. \end{aligned} ℓ(θ)​=2n1​(y^​−y)⊤(y^​−y)=2n1​((y^​(1)−y(1))2+(y^​(2)−y(2))2+(y^​(3)−y(3))2)=2n1​i=1∑n​(y^​(i)−y(i))2=n1​i=1∑n​21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2.​ 小批量随机梯度下降的迭代步骤将相应地改写为 θ ← θ − η ∣ B ∣ ∑ i ∈ B ∇ θ ℓ ( i ) ( θ ) , \boldsymbol{\theta} \leftarrow \boldsymbol{\theta} - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \nabla_{\boldsymbol{\theta}} \ell^{(i)}(\boldsymbol{\theta}), θ←θ−∣B∣η​i∈B∑​∇θ​ℓ(i)(θ), 其中梯度是损失有关 3 个为标量的模型参数的偏导数组成的向量： ∇ θ ℓ ( i ) ( θ ) = [ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b ] = [ x 1 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 2 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ] = [ x 1 ( i ) x 2 ( i ) 1 ] ( y ^ ( i ) − y ( i ) ) . \nabla_{\boldsymbol{\theta}} \ell^{(i)}(\boldsymbol{\theta})= \begin{bmatrix} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_1} \\ \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_2} \\ \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial b} \end{bmatrix} = \begin{bmatrix} x_1^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\ x_2^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\ x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)} \end{bmatrix} = \begin{bmatrix} x_1^{(i)} \\ x_2^{(i)} \\ 1 \end{bmatrix} (\hat{y}^{(i)} - y^{(i)}). ∇θ​ℓ(i)(θ)=⎣⎢⎢⎡​∂w1​∂ℓ(i)(w1​,w2​,b)​∂w2​∂ℓ(i)(w1​,w2​,b)​∂b∂ℓ(i)(w1​,w2​,b)​​⎦⎥⎥⎤​=⎣⎢⎡​x1(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i))x2(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i))x1(i)​w1​+x2(i)​w2​+b−y(i)​⎦⎥⎤​=⎣⎢⎡​x1(i)​x2(i)​1​⎦⎥⎤​(y^​(i)−y(i)). 3.1.3. 小结 对于线性回归这样一种单层神经网络，它的基本要素包括模型、训练数据、损失函数和优化算法。 既可以用神经网络图表示线性回归，又可以用矢量计算表示该模型。 应该尽可能采用矢量计算，以提升计算效率。" />
<link rel="canonical" href="https://uzzz.org/2019/06/12/789211.html" />
<meta property="og:url" content="https://uzzz.org/2019/06/12/789211.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-12T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"动手学深度学习 - 3.1 线性回归 动手学深度学习 - Dive into Deep Learning Aston Zhang, Zachary C. Lipton, Mu Li, and Alexander J. Smola https://zh.d2l.ai/ 3.1. 线性回归 线性回归输出是一个连续值，因此适用于回归问题。回归问题在实际中很常见，例如预测房屋价格、气温、销售额等连续值的问题。分类问题中模型的最终输出是一个离散值。图像分类、垃圾邮件识别、疾病检测等输出为离散值的问题都属于分类问题的范畴。softmax 回归则适用于分类问题。 线性回归和 softmax 回归都是单层神经网络。 3.1.1. 线性回归的基本要素 我们以一个简单的房屋价格预测作为例子来解释线性回归的基本要素。这个应用的目标是预测一栋房子的售出价格 (元)。我们知道这个价格取决于很多因素，如房屋状况、地段、市场行情等。为了简单起见，这里我们假设价格只取决于房屋状况的两个因素，即面积 (平方米) 和房龄 (年)。接下来我们希望探索价格与这两个因素的具体关系。 3.1.1.1. 模型 设房屋的面积为 x 1 x_{1} x1​，房龄为 x 2 x_{2} x2​，售出价格为 y y y。我们需要建立基于输入 x 1 x_{1} x1​ 和 x 2 x_{2} x2​ 来计算输出 y y y 的表达式，也就是模型 (model)。线性回归假设输出与各个输入之间是线性关系： y ^ = x 1 w 1 + x 2 w 2 + b , \\hat{y} = x_1 w_1 + x_2 w_2 + b, y^​=x1​w1​+x2​w2​+b, 其中 w 1 w_{1} w1​ 和 w 2 w_{2} w2​ 是权重 (weight)， b b b 是偏差 (bias)，且均为标量。它们是线性回归模型的参数 (parameter)。模型输出 y ^ \\hat{y} y^​ 是线性回归对真实价格 y y y 的预测或估计。我们通常允许它们之间有一定误差。 3.1.1.2. 模型训练 我们需要通过数据来寻找特定的模型参数值，使模型在数据上的误差尽可能小。这个过程叫做模型训练 (model training)。下面是模型训练所涉及的 3 个要素。 3.1.1.2.1. 训练数据 我们通常收集一系列的真实数据，例如多栋房屋的真实售出价格和它们对应的面积和房龄。我们希望在这个数据上面寻找模型参数来使模型的预测价格与真实价格的误差最小。在机器学习术语里，该数据集被称为训练数据集 (training data set) 或训练集 (training set)，一栋房屋被称为一个样本 (sample)，其真实售出价格叫做标签 (label)，用来预测标签的两个因素叫作特征 (feature)。特征用来表征样本的特点。 假设我们采集的样本数为 n n n，索引为 i i i 的样本的特征为 x 1 ( i ) x^{(i)}_{1} x1(i)​ 和 x 2 ( i ) x^{(i)}_{2} x2(i)​，标签为 y ( i ) y^{(i)} y(i)。对于索引为 i i i 的房屋，线性回归模型的房屋价格预测表达式为 y ^ ( i ) = x 1 ( i ) w 1 + x 2 ( i ) w 2 + b . \\hat{y}^{(i)} = x_1^{(i)} w_1 + x_2^{(i)} w_2 + b. y^​(i)=x1(i)​w1​+x2(i)​w2​+b. 3.1.1.2.2. 损失函数 在模型训练中，我们需要衡量价格预测值与真实值之间的误差。通常我们会选取一个非负数作为误差，且数值越小表示误差越小。一个常用的选择是平方函数。它在评估索引为 i i i 的样本误差的表达式为 ℓ ( i ) ( w 1 , w 2 , b ) = 1 2 ( y ^ ( i ) − y ( i ) ) 2 = 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 , \\ell^{(i)}(w_1, w_2, b) = \\frac{1}{2} \\left(\\hat{y}^{(i)} - y^{(i)}\\right)^2= \\frac{1}{2}\\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right)^{2}, ℓ(i)(w1​,w2​,b)=21​(y^​(i)−y(i))2=21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2, 其中常数 1/2 使对平方项求导后的常数系数为 1，这样在形式上稍微简单一些。显然，误差越小表示预测价格与真实价格越相近，且当二者相等时误差为 0。给定训练数据集，这个误差只与模型参数相关，因此我们将它记为以模型参数为参数的函数。在机器学习里，将衡量误差的函数称为损失函数 (loss function)。这里使用的平方误差函数也称为平方损失 (square loss)。 通常，我们用训练数据集中所有样本误差的平均来衡量模型预测的质量，即 ℓ ( w 1 , w 2 , b ) = 1 n ∑ i = 1 n ℓ ( i ) ( w 1 , w 2 , b ) = 1 n ∑ i = 1 n 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 . \\ell(w_1, w_2, b) =\\frac{1}{n} \\sum_{i=1}^n \\ell^{(i)}(w_1, w_2, b) =\\frac{1}{n} \\sum_{i=1}^n \\frac{1}{2}\\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\\right)^2. ℓ(w1​,w2​,b)=n1​i=1∑n​ℓ(i)(w1​,w2​,b)=n1​i=1∑n​21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2. 在模型训练中，我们希望找出一组模型参数，记为 w 1 ∗ w^{∗}_{1} w1∗​, w 2 ∗ w^{∗}_{2} w2∗​, b ∗ b^{∗} b∗，来使训练样本平均损失最小： w 1 ∗ , w 2 ∗ , b ∗ = a r g m i n w 1 , w 2 , b &nbsp; ℓ ( w 1 , w 2 , b ) . w^{∗}_{1}, w^{∗}_{2}, b^{∗} = \\underset{w_{1}, w_{2}, b}{argmin}\\ \\ell(w_{1}, w_{2}, b). w1∗​,w2∗​,b∗=w1​,w2​,bargmin​&nbsp;ℓ(w1​,w2​,b). 3.1.1.2.3. 优化算法 当模型和损失函数形式较为简单时，上面的误差最小化问题的解可以直接用公式表达出来。这类解叫作解析解 (analytical solution)。线性回归和平方误差刚好属于这个范畴。然而，大多数深度学习模型并没有解析解，只能通过优化算法有限次迭代模型参数来尽可能降低损失函数的值。这类解叫作数值解 (numerical solution)。 在求数值解的优化算法中，小批量随机梯度下降 (mini-batch stochastic gradient descent) 在深度学习中被广泛使用。它的算法很简单：先选取一组模型参数的初始值，如随机选取；接下来对参数进行多次迭代，使每次迭代都可能降低损失函数的值。在每次迭代中，先随机均匀采样一个由固定数目训练数据样本所组成的小批量 (mini-batch) B \\mathcal{B} B，然后求小批量中数据样本的平均损失有关模型参数的导数 (梯度)，最后用此结果与预先设定的一个正数的乘积作为模型参数在本次迭代的减小量。 在训练本节讨论的线性回归模型的过程中，模型的每个参数将作如下迭代： w 1 ← w 1 − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 = w 1 − η ∣ B ∣ ∑ i ∈ B x 1 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) , w 2 ← w 2 − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 = w 2 − η ∣ B ∣ ∑ i ∈ B x 2 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) , b ← b − η ∣ B ∣ ∑ i ∈ B ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b = b − η ∣ B ∣ ∑ i ∈ B ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) . \\begin{aligned} w_1 &amp;amp;\\leftarrow w_1 - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}} \\frac{ \\partial \\ell^{(i)}(w_1, w_2, b) }{\\partial w_1} = w_1 - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}}x_1^{(i)} \\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\\right),\\\\ w_2 &amp;amp;\\leftarrow w_2 - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}} \\frac{ \\partial \\ell^{(i)}(w_1, w_2, b) }{\\partial w_2} = w_2 - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}}x_2^{(i)} \\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\\right),\\\\ b &amp;amp;\\leftarrow b - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}} \\frac{ \\partial \\ell^{(i)}(w_1, w_2, b) }{\\partial b} = b - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}}\\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\\right). \\end{aligned} w1​w2​b​←w1​−∣B∣η​i∈B∑​∂w1​∂ℓ(i)(w1​,w2​,b)​=w1​−∣B∣η​i∈B∑​x1(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i)),←w2​−∣B∣η​i∈B∑​∂w2​∂ℓ(i)(w1​,w2​,b)​=w2​−∣B∣η​i∈B∑​x2(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i)),←b−∣B∣η​i∈B∑​∂b∂ℓ(i)(w1​,w2​,b)​=b−∣B∣η​i∈B∑​(x1(i)​w1​+x2(i)​w2​+b−y(i)).​ 其中 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ w 1 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ w 1 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 1 ( i ) , \\begin{aligned} \\frac{\\partial \\ell^{(i)}(w_{1}, w_{2}, b)}{\\partial w_{1}} &amp;amp; = \\frac{\\partial (\\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\\partial w_{1}} \\\\ &amp;amp; = \\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right) \\frac{\\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\\partial w_{1}} \\\\ &amp;amp; = \\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right) x^{(i)}_{1}, \\end{aligned} ∂w1​∂ℓ(i)(w1​,w2​,b)​​=∂w1​∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂w1​∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i))x1(i)​,​ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ w 2 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ w 2 = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 2 ( i ) , \\begin{aligned} \\frac{\\partial \\ell^{(i)}(w_{1}, w_{2}, b)}{\\partial w_{2}} &amp;amp; = \\frac{\\partial (\\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\\partial w_{2}} \\\\ &amp;amp; = \\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right) \\frac{\\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\\partial w_{2}} \\\\ &amp;amp; = \\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right) x^{(i)}_{2}, \\end{aligned} ∂w2​∂ℓ(i)(w1​,w2​,b)​​=∂w2​∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂w2​∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i))x2(i)​,​ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b = ∂ ( 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 ) ∂ b = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) ∂ b = ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) . \\begin{aligned} \\frac{\\partial \\ell^{(i)}(w_{1}, w_{2}, b)}{\\partial b} &amp;amp; = \\frac{\\partial (\\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\\partial b} \\\\ &amp;amp; = \\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right) \\frac{\\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\\partial b} \\\\ &amp;amp; = \\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right). \\end{aligned} ∂b∂ℓ(i)(w1​,w2​,b)​​=∂b∂(21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2)​=(x1(i)​w1​+x2(i)​w2​+b−y(i))∂b∂(x1(i)​w1​+x2(i)​w2​+b−y(i))​=(x1(i)​w1​+x2(i)​w2​+b−y(i)).​ 在上式中， ∣ B ∣ |\\mathcal{B}| ∣B∣ 代表每个小批量中的样本个数 (批量大小，batch size)， η \\eta η 称作学习率 (learning rate) 并取正数。需要强调的是，这里的批量大小和学习率的值是人为设定的，并不是通过模型训练学出的，因此叫作超参数 (hyperparameter)。我们通常所说的调参指的正是调节超参数，例如通过反复试错来找到超参数合适的值。在少数情况下，超参数也可以通过模型训练学出。 3.1.1.3. 模型预测 模型训练完成后，我们将模型参数 w 1 w_{1} w1​, w 2 w_{2} w2​, b b b 在优化算法停止时的值分别记作 w ^ 1 \\hat{w}_{1} w^1​, w ^ 2 \\hat{w}_{2} w^2​, b ^ \\hat{b} b^。注意，这里我们得到的并不一定是最小化损失函数的最优解 w 1 ∗ w^{∗}_{1} w1∗​, w 2 ∗ w^{∗}_{2} w2∗​, b ∗ b^{∗} b∗，而是对最优解的一个近似。然后，我们就可以使用学出的线性回归模型 x 1 w ^ 1 + x 2 w ^ 2 + b ^ x_{1}\\hat{w}_{1} + x_{2}\\hat{w}_{2} +\\hat{b} x1​w^1​+x2​w^2​+b^ 来估算训练数据集以外任意一栋面积 (平方米) 为 x 1 x_{1} x1​、房龄 (年) 为 x 2 x_{2} x2​ 的房屋的价格了。这里的估算也叫作模型预测、模型推断或模型测试。 3.1.2. 线性回归的表示方法 3.1.2.1. 神经网络图 在深度学习中，我们可以使用神经网络图直观地表现模型结构。为了更清晰地展示线性回归作为神经网络的结构，图 3.1 使用神经网络图表示本节中介绍的线性回归模型。神经网络图隐去了模型参数权重和偏差。 图 3.1 线性回归是一个单层神经网络 在图 3.1 所示的神经网络中，输入分别为 x 1 x_{1} x1​ 和 x 2 x_{2} x2​，因此输入层的输入个数为 2。输入个数也叫特征数或特征向量维度。图 3.1 中网络的输出为 o o o，输出层的输出个数为 1。需要注意的是，我们直接将图 3.1 中神经网络的输出 o o o 作为线性回归的输出，即 y ^ = o \\hat{y} = o y^​=o。由于输入层并不涉及计算，按照惯例，图 3.1 所示的神经网络的层数为 1。所以线性回归是一个单层神经网络。输出层中负责计算 o o o 的单元又叫神经元。在线性回归中， o o o 的计算依赖于 x 1 x_{1} x1​ 和 x 2 x_{2} x2​。输出层中的神经元和输入层中各个输入完全连接。因此，这里的输出层又叫全连接层 (fully-connected layer) 或稠密层 (dense layer)。 3.1.2.2. 矢量计算表达式 在模型训练或预测时，我们常常会同时处理多个数据样本并用到矢量计算。在介绍线性回归的矢量计算表达式之前，让我们先考虑对两个向量相加的两种方法。 下面先定义两个 1000 维的向量。 In [1]: from mxnet import nd from time import time a = nd.ones(shape=1000) b = nd.ones(shape=1000) 向量相加的一种方法是，将这两个向量按元素逐一做标量加法。 In [2]: start = time() c = nd.zeros(shape=1000) for i in range(1000): c[i] = a[i] + b[i] time() - start Out[2]: 0.15223002433776855 向量相加的另一种方法是，将这两个向量直接做矢量加法。 In [3]: start = time() d = a + b time() - start Out[3]: 0.00029015541076660156 结果很明显，后者比前者更省时。因此，我们应该尽可能采用矢量计算，以提升计算效率。 如果我们对训练数据集里的 3 个房屋样本 (索引分别为 1、2 和 3) 逐一预测价格，将得到 y ^ ( 1 ) = x 1 ( 1 ) w 1 + x 2 ( 1 ) w 2 + b , y ^ ( 2 ) = x 1 ( 2 ) w 1 + x 2 ( 2 ) w 2 + b , y ^ ( 3 ) = x 1 ( 3 ) w 1 + x 2 ( 3 ) w 2 + b . \\begin{aligned} \\hat{y}^{(1)} &amp;amp;= x_1^{(1)} w_1 + x_2^{(1)} w_2 + b,\\\\ \\hat{y}^{(2)} &amp;amp;= x_1^{(2)} w_1 + x_2^{(2)} w_2 + b,\\\\ \\hat{y}^{(3)} &amp;amp;= x_1^{(3)} w_1 + x_2^{(3)} w_2 + b. \\end{aligned} y^​(1)y^​(2)y^​(3)​=x1(1)​w1​+x2(1)​w2​+b,=x1(2)​w1​+x2(2)​w2​+b,=x1(3)​w1​+x2(3)​w2​+b.​ 现在，我们将上面 3 个等式转化成矢量计算。设 y ^ = [ y ^ ( 1 ) y ^ ( 2 ) y ^ ( 3 ) ] , X = [ x 1 ( 1 ) x 2 ( 1 ) x 1 ( 2 ) x 2 ( 2 ) x 1 ( 3 ) x 2 ( 3 ) ] , w = [ w 1 w 2 ] , \\boldsymbol{\\hat{y}} = \\begin{bmatrix} \\hat{y}^{(1)} \\\\ \\hat{y}^{(2)} \\\\ \\hat{y}^{(3)} \\end{bmatrix},\\quad \\boldsymbol{X} = \\begin{bmatrix} x_1^{(1)} &amp;amp; x_2^{(1)} \\\\ x_1^{(2)} &amp;amp; x_2^{(2)} \\\\ x_1^{(3)} &amp;amp; x_2^{(3)} \\end{bmatrix},\\quad \\boldsymbol{w} = \\begin{bmatrix} w_1 \\\\ w_2 \\end{bmatrix}, y^​=⎣⎡​y^​(1)y^​(2)y^​(3)​⎦⎤​,X=⎣⎢⎡​x1(1)​x1(2)​x1(3)​​x2(1)​x2(2)​x2(3)​​⎦⎥⎤​,w=[w1​w2​​], y = [ y ( 1 ) y ( 2 ) y ( 3 ) ] . \\boldsymbol{y} = \\begin{bmatrix} {y}^{(1)} \\\\ {y}^{(2)} \\\\ {y}^{(3)} \\\\ \\end{bmatrix}. y=⎣⎡​y(1)y(2)y(3)​⎦⎤​. 对 3 个房屋样本预测价格的矢量计算表达式为 y ^ = X w + b \\boldsymbol{\\hat{y}} = \\boldsymbol{X} \\boldsymbol{w} + b y^​=Xw+b，其中的加法运算使用了广播机制。例如： In [4]: a = nd.ones(shape=3) b = 10 a + b Out[4]: [11. 11. 11.] &lt;NDArray 3 @cpu(0)&gt; 广义上讲，当数据样本数为 n n n，特征数为 d d d 时，线性回归的矢量计算表达式为 y ^ = X w + b , \\boldsymbol{\\hat{y}} = \\boldsymbol{X} \\boldsymbol{w} + b, y^​=Xw+b, 其中模型输出 y ^ ∈ R n × 1 \\boldsymbol {\\hat{y}} \\in \\mathbb{R}^{n\\times1} y^​∈Rn×1， 批量数据样本特征 X ∈ R n × d \\boldsymbol{X} \\in \\mathbb{R}^{n\\times d} X∈Rn×d，权重 w ∈ R d × 1 \\boldsymbol{w} \\in \\mathbb{R}^{d \\times 1} w∈Rd×1， 偏差 b ∈ R \\boldsymbol {b} \\in \\mathbb{R} b∈R。相应地，批量数据样本标签 y ∈ R n × 1 \\boldsymbol {y} \\in \\mathbb{R}^{n\\times1} y∈Rn×1。设模型参数 θ = [ w 1 , w 2 , b ] ⊤ \\boldsymbol{\\theta} = [w_1, w_2, b]^\\top θ=[w1​,w2​,b]⊤，我们可以重写损失函数为 ℓ ( θ ) = 1 2 n ( y ^ − y ) ⊤ ( y ^ − y ) = 1 2 n ( ( y ^ ( 1 ) − y ( 1 ) ) 2 + ( y ^ ( 2 ) − y ( 2 ) ) 2 + ( y ^ ( 3 ) − y ( 3 ) ) 2 ) = 1 2 n ∑ i = 1 n ( y ^ ( i ) − y ( i ) ) 2 = 1 n ∑ i = 1 n 1 2 ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) 2 . \\begin{aligned} \\ell(\\boldsymbol{\\theta}) &amp;amp; =\\frac{1}{2n}(\\boldsymbol{\\hat{y}}-\\boldsymbol{y})^\\top(\\boldsymbol{\\hat{y}}-\\boldsymbol{y}) \\\\ &amp;amp; = \\frac{1}{2n} \\left((\\hat{y}^{(1)} - {y}^{(1)})^{2} + (\\hat{y}^{(2)} - {y}^{(2)})^{2} + (\\hat{y}^{(3)} - {y}^{(3)})^{2}\\right) \\\\ &amp;amp; = \\frac{1}{2n} \\sum_{i=1}^{n} (\\hat{y}^{(i)} - y^{(i)})^{2} \\\\ &amp;amp; = \\frac{1}{n} \\sum_{i=1}^{n} \\frac{1}{2}\\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\\right)^{2}. \\end{aligned} ℓ(θ)​=2n1​(y^​−y)⊤(y^​−y)=2n1​((y^​(1)−y(1))2+(y^​(2)−y(2))2+(y^​(3)−y(3))2)=2n1​i=1∑n​(y^​(i)−y(i))2=n1​i=1∑n​21​(x1(i)​w1​+x2(i)​w2​+b−y(i))2.​ 小批量随机梯度下降的迭代步骤将相应地改写为 θ ← θ − η ∣ B ∣ ∑ i ∈ B ∇ θ ℓ ( i ) ( θ ) , \\boldsymbol{\\theta} \\leftarrow \\boldsymbol{\\theta} - \\frac{\\eta}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}} \\nabla_{\\boldsymbol{\\theta}} \\ell^{(i)}(\\boldsymbol{\\theta}), θ←θ−∣B∣η​i∈B∑​∇θ​ℓ(i)(θ), 其中梯度是损失有关 3 个为标量的模型参数的偏导数组成的向量： ∇ θ ℓ ( i ) ( θ ) = [ ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 1 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ w 2 ∂ ℓ ( i ) ( w 1 , w 2 , b ) ∂ b ] = [ x 1 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 2 ( i ) ( x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ) x 1 ( i ) w 1 + x 2 ( i ) w 2 + b − y ( i ) ] = [ x 1 ( i ) x 2 ( i ) 1 ] ( y ^ ( i ) − y ( i ) ) . \\nabla_{\\boldsymbol{\\theta}} \\ell^{(i)}(\\boldsymbol{\\theta})= \\begin{bmatrix} \\frac{ \\partial \\ell^{(i)}(w_1, w_2, b) }{\\partial w_1} \\\\ \\frac{ \\partial \\ell^{(i)}(w_1, w_2, b) }{\\partial w_2} \\\\ \\frac{ \\partial \\ell^{(i)}(w_1, w_2, b) }{\\partial b} \\end{bmatrix} = \\begin{bmatrix} x_1^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\\\ x_2^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\\\ x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)} \\end{bmatrix} = \\begin{bmatrix} x_1^{(i)} \\\\ x_2^{(i)} \\\\ 1 \\end{bmatrix} (\\hat{y}^{(i)} - y^{(i)}). ∇θ​ℓ(i)(θ)=⎣⎢⎢⎡​∂w1​∂ℓ(i)(w1​,w2​,b)​∂w2​∂ℓ(i)(w1​,w2​,b)​∂b∂ℓ(i)(w1​,w2​,b)​​⎦⎥⎥⎤​=⎣⎢⎡​x1(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i))x2(i)​(x1(i)​w1​+x2(i)​w2​+b−y(i))x1(i)​w1​+x2(i)​w2​+b−y(i)​⎦⎥⎤​=⎣⎢⎡​x1(i)​x2(i)​1​⎦⎥⎤​(y^​(i)−y(i)). 3.1.3. 小结 对于线性回归这样一种单层神经网络，它的基本要素包括模型、训练数据、损失函数和优化算法。 既可以用神经网络图表示线性回归，又可以用矢量计算表示该模型。 应该尽可能采用矢量计算，以提升计算效率。","@type":"BlogPosting","url":"https://uzzz.org/2019/06/12/789211.html","headline":"动手学深度学习 - 3.1 线性回归","dateModified":"2019-06-12T00:00:00+08:00","datePublished":"2019-06-12T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/06/12/789211.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>动手学深度学习 - 3.1 线性回归</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-cd6c485e8b.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <h1><a id="center__31_center_0"></a>
   <center>
    动手学深度学习 - 3.1 线性回归
   </center></h1> 
  <p><font color="purple"><strong>动手学深度学习 - Dive into Deep Learning</strong></font><br> Aston Zhang, Zachary C. Lipton, Mu Li, and Alexander J. Smola<br> <a href="https://zh.d2l.ai/" rel="nofollow">https://zh.d2l.ai/</a></p> 
  <h2><a id="31__6"></a>3.1. 线性回归</h2> 
  <p><font color="blue">线性回归输出是一个连续值，因此适用于回归问题。</font>回归问题在实际中很常见，例如预测房屋价格、气温、销售额等连续值的问题。分类问题中模型的最终输出是一个离散值。图像分类、垃圾邮件识别、疾病检测等输出为离散值的问题都属于分类问题的范畴。<font color="blue">softmax 回归则适用于分类问题。</font><br> 线性回归和 softmax 回归都是单层神经网络。</p> 
  <h3><a id="311__10"></a>3.1.1. 线性回归的基本要素</h3> 
  <p>我们以一个简单的房屋价格预测作为例子来解释线性回归的基本要素。这个应用的目标是预测一栋房子的售出价格 (元)。我们知道这个价格取决于很多因素，如房屋状况、地段、市场行情等。为了简单起见，这里我们假设价格只取决于房屋状况的两个因素，即面积 (平方米) 和房龄 (年)。接下来我们希望探索价格与这两个因素的具体关系。</p> 
  <h4><a id="3111__13"></a>3.1.1.1. 模型</h4> 
  <p>设房屋的面积为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，房龄为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，售出价格为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>。我们需要建立基于输入 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 来计算输出 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span> 的表达式，也就是模型 (model)。线性回归假设输出与各个输入之间是线性关系：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mover accent="true">
           <mi>
            y
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           +
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           +
          </mo>
          <mi>
           b
          </mi>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \hat{y} = x_1 w_1 + x_2 w_2 + b,
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit">b</span><span class="mpunct">,</span></span></span></span></span></span></p> 
  <p>其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是权重 (weight)，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span> 是偏差 (bias)，且均为标量。它们是线性回归模型的参数 (parameter)。模型输出 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi>
           y
          </mi>
          <mo>
           ^
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{y}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span> 是线性回归对真实价格 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span> 的预测或估计。我们通常允许它们之间有一定误差。</p> 
  <h4><a id="3112__20"></a>3.1.1.2. 模型训练</h4> 
  <p>我们需要通过数据来寻找特定的模型参数值，使模型在数据上的误差尽可能小。这个过程叫做模型训练 (model training)。下面是模型训练所涉及的 3 个要素。</p> 
  <h5><a id="31121__23"></a>3.1.1.2.1. 训练数据</h5> 
  <p>我们通常收集一系列的真实数据，例如多栋房屋的真实售出价格和它们对应的面积和房龄。我们希望在这个数据上面寻找模型参数来使模型的预测价格与真实价格的误差最小。在机器学习术语里，该数据集被称为训练数据集 (training data set) 或训练集 (training set)，一栋房屋被称为一个样本 (sample)，其真实售出价格叫做标签 (label)，用来预测标签的两个因素叫作特征 (feature)。特征用来表征样本的特点。<br> 假设我们采集的样本数为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          n
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         n
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span>，索引为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 的样本的特征为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         x^{(i)}_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.31111em; vertical-align: -0.266308em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         x^{(i)}_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.31111em; vertical-align: -0.266308em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，标签为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           y
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         y^{(i)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>。对于索引为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 的房屋，线性回归模型的房屋价格预测表达式为</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msup>
           <mover accent="true">
            <mi>
             y
            </mi>
            <mo>
             ^
            </mo>
           </mover>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           =
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mn>
            1
           </mn>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msubsup>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           +
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mn>
            2
           </mn>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msubsup>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           +
          </mo>
          <mi>
           b
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \hat{y}^{(i)} = x_1^{(i)} w_1 + x_2^{(i)} w_2 + b.
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.13244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.31111em; vertical-align: -0.266308em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.31111em; vertical-align: -0.266308em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span><span class="mord">.</span></span></span></span></span></span></p> 
  <h5><a id="31122__29"></a>3.1.1.2.2. 损失函数</h5> 
  <p>在模型训练中，我们需要衡量价格预测值与真实值之间的误差。通常我们会选取一个非负数作为误差，且数值越小表示误差越小。一个常用的选择是平方函数。它在评估索引为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 的样本误差的表达式为</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msup>
           <mi mathvariant="normal">
            ℓ
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           b
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
          <msup>
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msup>
             <mover accent="true">
              <mi>
               y
              </mi>
              <mo>
               ^
              </mo>
             </mover>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo>
             −
            </mo>
            <msup>
             <mi>
              y
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo fence="true">
             )
            </mo>
           </mrow>
           <mn>
            2
           </mn>
          </msup>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
          <msup>
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mn>
              1
             </mn>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <msub>
             <mi>
              w
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo>
             +
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mn>
              2
             </mn>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <msub>
             <mi>
              w
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <mo>
             +
            </mo>
            <mi>
             b
            </mi>
            <mo>
             −
            </mo>
            <msup>
             <mi>
              y
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo fence="true">
             )
            </mo>
           </mrow>
           <mn>
            2
           </mn>
          </msup>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \ell^{(i)}(w_1, w_2, b) = \frac{1}{2} \left(\hat{y}^{(i)} - y^{(i)}\right)^2= \frac{1}{2}\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right)^{2}, 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.04001em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.35401em;"><span class="" style="top: -3.6029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.04001em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.35401em;"><span class="" style="top: -3.6029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span></span></p> 
  <p>其中常数 1/2 使对平方项求导后的常数系数为 1，这样在形式上稍微简单一些。显然，误差越小表示预测价格与真实价格越相近，且当二者相等时误差为 0。给定训练数据集，这个误差只与模型参数相关，因此我们将它记为以模型参数为参数的函数。在机器学习里，将衡量误差的函数称为损失函数 (loss function)。这里使用的平方误差函数也称为平方损失 (square loss)。<br> 通常，我们用训练数据集中所有样本误差的平均来衡量模型预测的质量，即</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="normal">
           ℓ
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           b
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mi>
            n
           </mi>
          </mfrac>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            n
           </mi>
          </munderover>
          <msup>
           <mi mathvariant="normal">
            ℓ
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           b
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mi>
            n
           </mi>
          </mfrac>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            n
           </mi>
          </munderover>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
          <msup>
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mn>
              1
             </mn>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <msub>
             <mi>
              w
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo>
             +
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mn>
              2
             </mn>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <msub>
             <mi>
              w
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <mo>
             +
            </mo>
            <mi>
             b
            </mi>
            <mo>
             −
            </mo>
            <msup>
             <mi>
              y
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               i
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo fence="true">
             )
            </mo>
           </mrow>
           <mn>
            2
           </mn>
          </msup>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \ell(w_1, w_2, b) =\frac{1}{n} \sum_{i=1}^n \ell^{(i)}(w_1, w_2, b) =\frac{1}{n} \sum_{i=1}^n \frac{1}{2}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right)^2.
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">ℓ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.92907em; vertical-align: -1.27767em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.92907em; vertical-align: -1.27767em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.35401em;"><span class="" style="top: -3.6029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span></span></span></p> 
  <p>在模型训练中，我们希望找出一组模型参数，记为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
          <mi mathvariant="normal">
           ∗
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^{∗}_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.936804em; vertical-align: -0.248108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.45189em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           w
          </mi>
          <mn>
           2
          </mn>
          <mi mathvariant="normal">
           ∗
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^{∗}_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.936804em; vertical-align: -0.248108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.45189em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           b
          </mi>
          <mi mathvariant="normal">
           ∗
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         b^{∗}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>，来使训练样本平均损失最小：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
           <mi mathvariant="normal">
            ∗
           </mi>
          </msubsup>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
           <mi mathvariant="normal">
            ∗
           </mi>
          </msubsup>
          <mo separator="true">
           ,
          </mo>
          <msup>
           <mi>
            b
           </mi>
           <mi mathvariant="normal">
            ∗
           </mi>
          </msup>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            <mi>
             a
            </mi>
            <mi>
             r
            </mi>
            <mi>
             g
            </mi>
            <mi>
             m
            </mi>
            <mi>
             i
            </mi>
            <mi>
             n
            </mi>
           </mo>
           <mrow>
            <msub>
             <mi>
              w
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              w
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <mo separator="true">
             ,
            </mo>
            <mi>
             b
            </mi>
           </mrow>
          </munder>
          <mtext>
           &nbsp;
          </mtext>
          <mi mathvariant="normal">
           ℓ
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           b
          </mi>
          <mo>
           )
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          w^{∗}_{1}, w^{∗}_{2}, b^{∗} = \underset{w_{1}, w_{2}, b}{argmin}\ \ell(w_{1}, w_{2}, b). 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.83266em; vertical-align: -1.08266em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.65952em;"><span class="" style="top: -2.15345em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight">b</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop"><span class="mord mathit">a</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.08266em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord">ℓ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span></p> 
  <h5><a id="31123__43"></a>3.1.1.2.3. 优化算法</h5> 
  <p>当模型和损失函数形式较为简单时，上面的误差最小化问题的解可以直接用公式表达出来。这类解叫作解析解 (analytical solution)。线性回归和平方误差刚好属于这个范畴。然而，大多数深度学习模型并没有解析解，只能通过优化算法有限次迭代模型参数来尽可能降低损失函数的值。这类解叫作数值解 (numerical solution)。<br> 在求数值解的优化算法中，小批量随机梯度下降 (mini-batch stochastic gradient descent) 在深度学习中被广泛使用。它的算法很简单：<font color="blue">先选取一组模型参数的初始值，如随机选取；接下来对参数进行多次迭代，使每次迭代都可能降低损失函数的值。在每次迭代中，先随机均匀采样一个由固定数目训练数据样本所组成的小批量 (mini-batch) <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="script">
           B
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \mathcal{B}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span></span></span></span></span>，然后求小批量中数据样本的平均损失有关模型参数的导数 (梯度)，最后用此结果与预先设定的一个正数的乘积作为模型参数在本次迭代的<code>减小量</code>。</font><br> 在训练本节讨论的线性回归模型的过程中，模型的每个参数将作如下迭代：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <msub>
              <mi>
               w
              </mi>
              <mn>
               1
              </mn>
             </msub>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               ←
              </mo>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                1
               </mn>
              </msub>
              <mo>
               −
              </mo>
              <mfrac>
               <mi>
                η
               </mi>
               <mrow>
                <mi mathvariant="normal">
                 ∣
                </mi>
                <mi mathvariant="script">
                 B
                </mi>
                <mi mathvariant="normal">
                 ∣
                </mi>
               </mrow>
              </mfrac>
              <munder>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 ∈
                </mo>
                <mi mathvariant="script">
                 B
                </mi>
               </mrow>
              </munder>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msup>
                 <mi mathvariant="normal">
                  ℓ
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 (
                </mo>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo separator="true">
                 ,
                </mo>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
               </mrow>
              </mfrac>
              <mo>
               =
              </mo>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                1
               </mn>
              </msub>
              <mo>
               −
              </mo>
              <mfrac>
               <mi>
                η
               </mi>
               <mrow>
                <mi mathvariant="normal">
                 ∣
                </mi>
                <mi mathvariant="script">
                 B
                </mi>
                <mi mathvariant="normal">
                 ∣
                </mi>
               </mrow>
              </mfrac>
              <munder>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 ∈
                </mo>
                <mi mathvariant="script">
                 B
                </mi>
               </mrow>
              </munder>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                1
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 i
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <msub>
              <mi>
               w
              </mi>
              <mn>
               2
              </mn>
             </msub>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               ←
              </mo>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                2
               </mn>
              </msub>
              <mo>
               −
              </mo>
              <mfrac>
               <mi>
                η
               </mi>
               <mrow>
                <mi mathvariant="normal">
                 ∣
                </mi>
                <mi mathvariant="script">
                 B
                </mi>
                <mi mathvariant="normal">
                 ∣
                </mi>
               </mrow>
              </mfrac>
              <munder>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 ∈
                </mo>
                <mi mathvariant="script">
                 B
                </mi>
               </mrow>
              </munder>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msup>
                 <mi mathvariant="normal">
                  ℓ
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 (
                </mo>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo separator="true">
                 ,
                </mo>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
               </mrow>
              </mfrac>
              <mo>
               =
              </mo>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                2
               </mn>
              </msub>
              <mo>
               −
              </mo>
              <mfrac>
               <mi>
                η
               </mi>
               <mrow>
                <mi mathvariant="normal">
                 ∣
                </mi>
                <mi mathvariant="script">
                 B
                </mi>
                <mi mathvariant="normal">
                 ∣
                </mi>
               </mrow>
              </mfrac>
              <munder>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 ∈
                </mo>
                <mi mathvariant="script">
                 B
                </mi>
               </mrow>
              </munder>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 i
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mi>
              b
             </mi>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               ←
              </mo>
              <mi>
               b
              </mi>
              <mo>
               −
              </mo>
              <mfrac>
               <mi>
                η
               </mi>
               <mrow>
                <mi mathvariant="normal">
                 ∣
                </mi>
                <mi mathvariant="script">
                 B
                </mi>
                <mi mathvariant="normal">
                 ∣
                </mi>
               </mrow>
              </mfrac>
              <munder>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 ∈
                </mo>
                <mi mathvariant="script">
                 B
                </mi>
               </mrow>
              </munder>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msup>
                 <mi mathvariant="normal">
                  ℓ
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 (
                </mo>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo separator="true">
                 ,
                </mo>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mi>
                 b
                </mi>
               </mrow>
              </mfrac>
              <mo>
               =
              </mo>
              <mi>
               b
              </mi>
              <mo>
               −
              </mo>
              <mfrac>
               <mi>
                η
               </mi>
               <mrow>
                <mi mathvariant="normal">
                 ∣
                </mi>
                <mi mathvariant="script">
                 B
                </mi>
                <mi mathvariant="normal">
                 ∣
                </mi>
               </mrow>
              </mfrac>
              <munder>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 ∈
                </mo>
                <mi mathvariant="script">
                 B
                </mi>
               </mrow>
              </munder>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mi mathvariant="normal">
               .
              </mi>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
          \begin{aligned} w_1 &amp;amp;\leftarrow w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_1} = w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_1^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ w_2 &amp;amp;\leftarrow w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_2} = w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_2^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ b &amp;amp;\leftarrow b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial b} = b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right). \end{aligned}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.56012em; vertical-align: -4.53006em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.03006em;"><span class="" style="top: -7.03006em;"><span class="pstrut" style="height: 3.565em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.84335em;"><span class="pstrut" style="height: 3.565em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -0.656647em;"><span class="pstrut" style="height: 3.565em;"></span><span class="mord"><span class="mord mathit">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.53006em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.03006em;"><span class="" style="top: -7.03006em;"><span class="pstrut" style="height: 3.565em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.565em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span><span class="" style="top: -3.84335em;"><span class="pstrut" style="height: 3.565em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.565em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span><span class="" style="top: -0.656647em;"><span class="pstrut" style="height: 3.565em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.565em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">b</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.53006em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>其中</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                ∂
               </mi>
               <msup>
                <mi mathvariant="normal">
                 ℓ
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                (
               </mo>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo separator="true">
                ,
               </mo>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo separator="true">
                ,
               </mo>
               <mi>
                b
               </mi>
               <mo>
                )
               </mo>
              </mrow>
              <mrow>
               <mi mathvariant="normal">
                ∂
               </mi>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
              </mrow>
             </mfrac>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mo>
                 (
                </mo>
                <mfrac>
                 <mn>
                  1
                 </mn>
                 <mn>
                  2
                 </mn>
                </mfrac>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <msup>
                 <mo>
                  )
                 </mo>
                 <mn>
                  2
                 </mn>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
               </mrow>
              </mfrac>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
               </mrow>
              </mfrac>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                1
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 i
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
          \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial w_{1}} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial w_{1}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial w_{1}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) x^{(i)}_{1}, \end{aligned}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.87362em; vertical-align: -3.68681em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.18681em;"><span class="" style="top: -6.18681em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.565em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.32901em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"></span></span><span class="" style="top: -1.04301em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.68681em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.18681em;"><span class="" style="top: -6.18681em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7798em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7798em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.32901em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7218em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7218em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.04301em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.68681em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                ∂
               </mi>
               <msup>
                <mi mathvariant="normal">
                 ℓ
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                (
               </mo>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo separator="true">
                ,
               </mo>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo separator="true">
                ,
               </mo>
               <mi>
                b
               </mi>
               <mo>
                )
               </mo>
              </mrow>
              <mrow>
               <mi mathvariant="normal">
                ∂
               </mi>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
              </mrow>
             </mfrac>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mo>
                 (
                </mo>
                <mfrac>
                 <mn>
                  1
                 </mn>
                 <mn>
                  2
                 </mn>
                </mfrac>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <msup>
                 <mo>
                  )
                 </mo>
                 <mn>
                  2
                 </mn>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
               </mrow>
              </mfrac>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
               </mrow>
              </mfrac>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 i
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
          \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial w_{2}} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial w_{2}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial w_{2}} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) x^{(i)}_{2}, \end{aligned}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.87362em; vertical-align: -3.68681em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.18681em;"><span class="" style="top: -6.18681em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.565em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.32901em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"></span></span><span class="" style="top: -1.04301em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.68681em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.18681em;"><span class="" style="top: -6.18681em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7798em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7798em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.32901em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7218em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7218em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.04301em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.68681em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                ∂
               </mi>
               <msup>
                <mi mathvariant="normal">
                 ℓ
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                (
               </mo>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo separator="true">
                ,
               </mo>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo separator="true">
                ,
               </mo>
               <mi>
                b
               </mi>
               <mo>
                )
               </mo>
              </mrow>
              <mrow>
               <mi mathvariant="normal">
                ∂
               </mi>
               <mi>
                b
               </mi>
              </mrow>
             </mfrac>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mo>
                 (
                </mo>
                <mfrac>
                 <mn>
                  1
                 </mn>
                 <mn>
                  2
                 </mn>
                </mfrac>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <msup>
                 <mo>
                  )
                 </mo>
                 <mn>
                  2
                 </mn>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mi>
                 b
                </mi>
               </mrow>
              </mfrac>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
               <mrow>
                <mi mathvariant="normal">
                 ∂
                </mi>
                <mi>
                 b
                </mi>
               </mrow>
              </mfrac>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
               <mo>
                +
               </mo>
               <mi>
                b
               </mi>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
              <mi mathvariant="normal">
               .
              </mi>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
          \begin{aligned} \frac{\partial \ell^{(i)}(w_{1}, w_{2}, b)}{\partial b} &amp;amp; = \frac{\partial (\frac{1}{2}(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})^{2})}{\partial b} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right) \frac{\partial (x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)})}{\partial b} \\ &amp;amp; = \left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right). \end{aligned}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.57362em; vertical-align: -3.53681em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.03681em;"><span class="" style="top: -6.03681em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.565em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">b</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.32901em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"></span></span><span class="" style="top: -1.19301em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.53681em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.03681em;"><span class="" style="top: -6.03681em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7798em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">b</span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7798em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.32901em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7218em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">b</span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7218em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.19301em;"><span class="pstrut" style="height: 3.7798em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.53681em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>在上式中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi mathvariant="script">
          B
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         |\mathcal{B}|
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span></span></span> 代表每个小批量中的样本个数 (批量大小，batch size)，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          η
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \eta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span></span> 称作学习率 (learning rate) 并取正数。需要强调的是，这里的批量大小和学习率的值是人为设定的，并不是通过模型训练学出的，因此叫作超参数 (hyperparameter)。我们通常所说的<code>调参</code>指的正是调节超参数，例如通过反复试错来找到超参数合适的值。在少数情况下，超参数也可以通过模型训练学出。</p> 
  <h4><a id="3113__79"></a>3.1.1.3. 模型预测</h4> 
  <p>模型训练完成后，我们将模型参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span> 在优化算法停止时的值分别记作 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mover accent="true">
           <mi>
            w
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{w}_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mover accent="true">
           <mi>
            w
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{w}_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi>
           b
          </mi>
          <mo>
           ^
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{b}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.95788em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.95788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">b</span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span></span></span></span></span>。注意，这里我们得到的并不一定是最小化损失函数的最优解 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
          <mi mathvariant="normal">
           ∗
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^{∗}_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.936804em; vertical-align: -0.248108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.45189em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           w
          </mi>
          <mn>
           2
          </mn>
          <mi mathvariant="normal">
           ∗
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^{∗}_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.936804em; vertical-align: -0.248108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.45189em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           b
          </mi>
          <mi mathvariant="normal">
           ∗
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         b^{∗}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>，而是对最优解的一个近似。然后，我们就可以使用学出的线性回归模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <msub>
          <mover accent="true">
           <mi>
            w
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <msub>
          <mover accent="true">
           <mi>
            w
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          +
         </mo>
         <mover accent="true">
          <mi>
           b
          </mi>
          <mo>
           ^
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{1}\hat{w}_{1} + x_{2}\hat{w}_{2} +\hat{b}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.95788em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.95788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">b</span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span></span></span></span></span> 来估算训练数据集以外任意一栋面积 (平方米) 为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>、房龄 (年) 为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的房屋的价格了。这里的估算也叫作模型预测、模型推断或模型测试。</p> 
  <h3><a id="312__82"></a>3.1.2. 线性回归的表示方法</h3> 
  <h4><a id="3121__84"></a>3.1.2.1. 神经网络图</h4> 
  <p>在深度学习中，我们可以使用神经网络图直观地表现模型结构。为了更清晰地展示线性回归作为神经网络的结构，图 3.1 使用神经网络图表示本节中介绍的线性回归模型。神经网络图隐去了模型参数权重和偏差。</p> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019061220343438.png#pic_center" alt="在这里插入图片描述"></p> 
  <center>
   图 3.1 线性回归是一个单层神经网络
  </center> 
  <p>在图 3.1 所示的神经网络中，输入分别为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，因此输入层的输入个数为 2。输入个数也叫特征数或特征向量维度。图 3.1 中网络的输出为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">o</span></span></span></span></span>，输出层的输出个数为 1。需要注意的是，我们直接将图 3.1 中神经网络的输出 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">o</span></span></span></span></span> 作为线性回归的输出，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi>
           y
          </mi>
          <mo>
           ^
          </mo>
         </mover>
         <mo>
          =
         </mo>
         <mi>
          o
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{y} = o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">o</span></span></span></span></span>。由于输入层并不涉及计算，按照惯例，图 3.1 所示的神经网络的层数为 1。所以线性回归是一个单层神经网络。输出层中负责计算 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">o</span></span></span></span></span> 的单元又叫神经元。在线性回归中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">o</span></span></span></span></span> 的计算依赖于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。输出层中的神经元和输入层中各个输入完全连接。因此，这里的输出层又叫全连接层 (fully-connected layer) 或稠密层 (dense layer)。</p> 
  <h4><a id="3122__92"></a>3.1.2.2. 矢量计算表达式</h4> 
  <p>在模型训练或预测时，我们常常会同时处理多个数据样本并用到矢量计算。在介绍线性回归的矢量计算表达式之前，让我们先考虑对两个向量相加的两种方法。</p> 
  <p>下面先定义两个 1000 维的向量。</p> 
  <pre><code>In [1]:
from mxnet import nd
from time import time

a = nd.ones(shape=1000)
b = nd.ones(shape=1000)
</code></pre> 
  <p>向量相加的一种方法是，将这两个向量按元素逐一做标量加法。</p> 
  <pre><code>In [2]:
start = time()
c = nd.zeros(shape=1000)
for i in range(1000):
    c[i] = a[i] + b[i]
time() - start

Out[2]:
0.15223002433776855
</code></pre> 
  <p>向量相加的另一种方法是，将这两个向量直接做矢量加法。</p> 
  <pre><code>In [3]:
start = time()
d = a + b
time() - start

Out[3]:
0.00029015541076660156
</code></pre> 
  <p>结果很明显，后者比前者更省时。因此，我们应该尽可能采用矢量计算，以提升计算效率。</p> 
  <p>如果我们对训练数据集里的 3 个房屋样本 (索引分别为 1、2 和 3) 逐一预测价格，将得到</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <msup>
              <mover accent="true">
               <mi>
                y
               </mi>
               <mo>
                ^
               </mo>
              </mover>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                1
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mn>
                 1
                </mn>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                1
               </mn>
              </msub>
              <mo>
               +
              </mo>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mn>
                 1
                </mn>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                2
               </mn>
              </msub>
              <mo>
               +
              </mo>
              <mi>
               b
              </mi>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <msup>
              <mover accent="true">
               <mi>
                y
               </mi>
               <mo>
                ^
               </mo>
              </mover>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                1
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mn>
                 2
                </mn>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                1
               </mn>
              </msub>
              <mo>
               +
              </mo>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mn>
                 2
                </mn>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                2
               </mn>
              </msub>
              <mo>
               +
              </mo>
              <mi>
               b
              </mi>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <msup>
              <mover accent="true">
               <mi>
                y
               </mi>
               <mo>
                ^
               </mo>
              </mover>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                3
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                1
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mn>
                 3
                </mn>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                1
               </mn>
              </msub>
              <mo>
               +
              </mo>
              <msubsup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
               <mrow>
                <mo>
                 (
                </mo>
                <mn>
                 3
                </mn>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <msub>
               <mi>
                w
               </mi>
               <mn>
                2
               </mn>
              </msub>
              <mo>
               +
              </mo>
              <mi>
               b
              </mi>
              <mi mathvariant="normal">
               .
              </mi>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
          \begin{aligned} \hat{y}^{(1)} &amp;amp;= x_1^{(1)} w_1 + x_2^{(1)} w_2 + b,\\ \hat{y}^{(2)} &amp;amp;= x_1^{(2)} w_1 + x_2^{(2)} w_2 + b,\\ \hat{y}^{(3)} &amp;amp;= x_1^{(3)} w_1 + x_2^{(3)} w_2 + b. \end{aligned}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.1144em; vertical-align: -2.3072em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.8072em;"><span class="" style="top: -4.8072em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.1024em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.3976em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.3072em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.8072em;"><span class="" style="top: -4.8072em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mpunct">,</span></span></span><span class="" style="top: -3.1024em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mpunct">,</span></span></span><span class="" style="top: -1.3976em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.3072em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>现在，我们将上面 3 个等式转化成矢量计算。设</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mover accent="true">
           <mi mathvariant="bold-italic">
            y
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msup>
                <mover accent="true">
                 <mi>
                  y
                 </mi>
                 <mo>
                  ^
                 </mo>
                </mover>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msup>
                <mover accent="true">
                 <mi>
                  y
                 </mi>
                 <mo>
                  ^
                 </mo>
                </mover>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  2
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msup>
                <mover accent="true">
                 <mi>
                  y
                 </mi>
                 <mo>
                  ^
                 </mo>
                </mover>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  3
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi mathvariant="bold-italic">
           X
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  2
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  2
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  3
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  3
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi mathvariant="bold-italic">
           w
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 1
                </mn>
               </msub>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msub>
                <mi>
                 w
                </mi>
                <mn>
                 2
                </mn>
               </msub>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           \boldsymbol{\hat{y}} = \begin{bmatrix} \hat{y}^{(1)} \\ \hat{y}^{(2)} \\ \hat{y}^{(3)} \end{bmatrix},\quad \boldsymbol{X} = \begin{bmatrix} x_1^{(1)} &amp;amp; x_2^{(1)} \\ x_1^{(2)} &amp;amp; x_2^{(2)} \\ x_1^{(3)} &amp;amp; x_2^{(3)} \end{bmatrix},\quad \boldsymbol{w} = \begin{bmatrix} w_1 \\ w_2 \end{bmatrix}, 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.744em; vertical-align: -1.622em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.122em;"><span class="" style="top: -4.234em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.986em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.738em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.622em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.07778em;">X</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.2144em; vertical-align: -1.8572em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35101em;"><span class="" style="top: -1.95em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.105em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.35102em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.3572em;"><span class="" style="top: -4.3572em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.9524em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.5476em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.8572em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.3572em;"><span class="" style="top: -4.3572em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.9524em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.5476em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.8572em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35101em;"><span class="" style="top: -1.95em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.105em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.35102em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85003em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.02778em;">w</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span></span></p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="bold-italic">
           y
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  2
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  3
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           \boldsymbol{y} = \begin{bmatrix} {y}^{(1)} \\ {y}^{(2)} \\ {y}^{(3)} \\ \end{bmatrix}. 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.744em; vertical-align: -1.622em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.122em;"><span class="" style="top: -4.234em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.986em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.738em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.622em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span></span></span></p> 
  <p>对 3 个房屋样本预测价格的矢量计算表达式为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi mathvariant="bold-italic">
           y
          </mi>
          <mo>
           ^
          </mo>
         </mover>
         <mo>
          =
         </mo>
         <mi mathvariant="bold-italic">
          X
         </mi>
         <mi mathvariant="bold-italic">
          w
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol{\hat{y}} = \boldsymbol{X} \boldsymbol{w} + b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76944em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.02778em;">w</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>，其中的加法运算使用了广播机制。例如：</p> 
  <pre><code>In [4]:
a = nd.ones(shape=3)
b = 10
a + b

Out[4]:
[11. 11. 11.]
&lt;NDArray 3 @cpu(0)&gt;
</code></pre> 
  <p>广义上讲，当数据样本数为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          n
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         n
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span>，特征数为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          d
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         d
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">d</span></span></span></span></span> 时，线性回归的矢量计算表达式为</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mover accent="true">
           <mi mathvariant="bold-italic">
            y
           </mi>
           <mo>
            ^
           </mo>
          </mover>
          <mo>
           =
          </mo>
          <mi mathvariant="bold-italic">
           X
          </mi>
          <mi mathvariant="bold-italic">
           w
          </mi>
          <mo>
           +
          </mo>
          <mi>
           b
          </mi>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \boldsymbol{\hat{y}} = \boldsymbol{X} \boldsymbol{w} + b,
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76944em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.02778em;">w</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit">b</span><span class="mpunct">,</span></span></span></span></span></span></p> 
  <p>其中模型输出 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi mathvariant="bold-italic">
           y
          </mi>
          <mo>
           ^
          </mo>
         </mover>
         <mo>
          ∈
         </mo>
         <msup>
          <mi mathvariant="double-struck">
           R
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mo>
            ×
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol {\hat{y}} \in \mathbb{R}^{n\times1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.90232em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>， 批量数据样本特征 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold-italic">
          X
         </mi>
         <mo>
          ∈
         </mo>
         <msup>
          <mi mathvariant="double-struck">
           R
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mo>
            ×
           </mo>
           <mi>
            d
           </mi>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol{X} \in \mathbb{R}^{n\times d}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72521em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.07778em;">X</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">×</span><span class="mord mathit mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span>，权重 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold-italic">
          w
         </mi>
         <mo>
          ∈
         </mo>
         <msup>
          <mi mathvariant="double-struck">
           R
          </mi>
          <mrow>
           <mi>
            d
           </mi>
           <mo>
            ×
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol{w} \in \mathbb{R}^{d \times 1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.02778em;">w</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">d</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>， 偏差 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold-italic">
          b
         </mi>
         <mo>
          ∈
         </mo>
         <mi mathvariant="double-struck">
          R
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol {b} \in \mathbb{R}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68889em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span></span>。相应地，批量数据样本标签 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold-italic">
          y
         </mi>
         <mo>
          ∈
         </mo>
         <msup>
          <mi mathvariant="double-struck">
           R
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mo>
            ×
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol {y} \in \mathbb{R}^{n\times1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>。设模型参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold-italic">
          θ
         </mi>
         <mo>
          =
         </mo>
         <mo>
          [
         </mo>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi>
          b
         </mi>
         <msup>
          <mo>
           ]
          </mo>
          <mi mathvariant="normal">
           ⊤
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \boldsymbol{\theta} = [w_1, w_2, b]^\top
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span></span>，我们可以重写损失函数为</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mi mathvariant="normal">
               ℓ
              </mi>
              <mo>
               (
              </mo>
              <mi mathvariant="bold-italic">
               θ
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mn>
                1
               </mn>
               <mrow>
                <mn>
                 2
                </mn>
                <mi>
                 n
                </mi>
               </mrow>
              </mfrac>
              <mo>
               (
              </mo>
              <mover accent="true">
               <mi mathvariant="bold-italic">
                y
               </mi>
               <mo>
                ^
               </mo>
              </mover>
              <mo>
               −
              </mo>
              <mi mathvariant="bold-italic">
               y
              </mi>
              <msup>
               <mo>
                )
               </mo>
               <mi mathvariant="normal">
                ⊤
               </mi>
              </msup>
              <mo>
               (
              </mo>
              <mover accent="true">
               <mi mathvariant="bold-italic">
                y
               </mi>
               <mo>
                ^
               </mo>
              </mover>
              <mo>
               −
              </mo>
              <mi mathvariant="bold-italic">
               y
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mn>
                1
               </mn>
               <mrow>
                <mn>
                 2
                </mn>
                <mi>
                 n
                </mi>
               </mrow>
              </mfrac>
              <mrow>
               <mo fence="true">
                (
               </mo>
               <mo>
                (
               </mo>
               <msup>
                <mover accent="true">
                 <mi>
                  y
                 </mi>
                 <mo>
                  ^
                 </mo>
                </mover>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <mn>
                 2
                </mn>
               </msup>
               <mo>
                +
               </mo>
               <mo>
                (
               </mo>
               <msup>
                <mover accent="true">
                 <mi>
                  y
                 </mi>
                 <mo>
                  ^
                 </mo>
                </mover>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  2
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  2
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <mn>
                 2
                </mn>
               </msup>
               <mo>
                +
               </mo>
               <mo>
                (
               </mo>
               <msup>
                <mover accent="true">
                 <mi>
                  y
                 </mi>
                 <mo>
                  ^
                 </mo>
                </mover>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  3
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 y
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mn>
                  3
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <mn>
                 2
                </mn>
               </msup>
               <mo fence="true">
                )
               </mo>
              </mrow>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mn>
                1
               </mn>
               <mrow>
                <mn>
                 2
                </mn>
                <mi>
                 n
                </mi>
               </mrow>
              </mfrac>
              <munderover>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 =
                </mo>
                <mn>
                 1
                </mn>
               </mrow>
               <mi>
                n
               </mi>
              </munderover>
              <mo>
               (
              </mo>
              <msup>
               <mover accent="true">
                <mi>
                 y
                </mi>
                <mo>
                 ^
                </mo>
               </mover>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 i
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msup>
              <mo>
               −
              </mo>
              <msup>
               <mi>
                y
               </mi>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 i
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msup>
              <msup>
               <mo>
                )
               </mo>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mn>
                1
               </mn>
               <mi>
                n
               </mi>
              </mfrac>
              <munderover>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 =
                </mo>
                <mn>
                 1
                </mn>
               </mrow>
               <mi>
                n
               </mi>
              </munderover>
              <mfrac>
               <mn>
                1
               </mn>
               <mn>
                2
               </mn>
              </mfrac>
              <msup>
               <mrow>
                <mo fence="true">
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo fence="true">
                 )
                </mo>
               </mrow>
               <mn>
                2
               </mn>
              </msup>
              <mi mathvariant="normal">
               .
              </mi>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
          \begin{aligned} \ell(\boldsymbol{\theta}) &amp;amp; =\frac{1}{2n}(\boldsymbol{\hat{y}}-\boldsymbol{y})^\top(\boldsymbol{\hat{y}}-\boldsymbol{y}) \\ &amp;amp; = \frac{1}{2n} \left((\hat{y}^{(1)} - {y}^{(1)})^{2} + (\hat{y}^{(2)} - {y}^{(2)})^{2} + (\hat{y}^{(3)} - {y}^{(3)})^{2}\right) \\ &amp;amp; = \frac{1}{2n} \sum_{i=1}^{n} (\hat{y}^{(i)} - y^{(i)})^{2} \\ &amp;amp; = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{2}\left(x^{(i)}_{1}w_{1} + x^{(i)}_{2}w_{2} + b - y^{(i)}\right)^{2}. \end{aligned}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 11.073em; vertical-align: -5.28651em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.78651em;"><span class="" style="top: -8.11646em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"><span class="mord">ℓ</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -5.80902em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"></span></span><span class="" style="top: -3.17163em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"></span></span><span class="" style="top: 0.05744em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.28651em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.78651em;"><span class="" style="top: -8.11646em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathit">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.70788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="" style="top: -3.01344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03704em;">y</span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -5.80902em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathit">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -3.17163em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathit">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 0.05744em;"><span class="pstrut" style="height: 3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.35401em;"><span class="" style="top: -3.6029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.28651em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>小批量随机梯度下降的迭代步骤将相应地改写为</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="bold-italic">
           θ
          </mi>
          <mo>
           ←
          </mo>
          <mi mathvariant="bold-italic">
           θ
          </mi>
          <mo>
           −
          </mo>
          <mfrac>
           <mi>
            η
           </mi>
           <mrow>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mi mathvariant="script">
             B
            </mi>
            <mi mathvariant="normal">
             ∣
            </mi>
           </mrow>
          </mfrac>
          <munder>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ∈
            </mo>
            <mi mathvariant="script">
             B
            </mi>
           </mrow>
          </munder>
          <msub>
           <mi mathvariant="normal">
            ∇
           </mi>
           <mi mathvariant="bold-italic">
            θ
           </mi>
          </msub>
          <msup>
           <mi mathvariant="normal">
            ℓ
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           (
          </mo>
          <mi mathvariant="bold-italic">
           θ
          </mi>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \boldsymbol{\theta} \leftarrow \boldsymbol{\theta} - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \nabla_{\boldsymbol{\theta}} \ell^{(i)}(\boldsymbol{\theta}),
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.42927em; vertical-align: -1.32171em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></span></p> 
  <p>其中梯度是损失有关 3 个为标量的模型参数的偏导数组成的向量：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi mathvariant="normal">
            ∇
           </mi>
           <mi mathvariant="bold-italic">
            θ
           </mi>
          </msub>
          <msup>
           <mi mathvariant="normal">
            ℓ
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           (
          </mo>
          <mi mathvariant="bold-italic">
           θ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mfrac>
                <mrow>
                 <mi mathvariant="normal">
                  ∂
                 </mi>
                 <msup>
                  <mi mathvariant="normal">
                   ℓ
                  </mi>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mi>
                    i
                   </mi>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msup>
                 <mo>
                  (
                 </mo>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   1
                  </mn>
                 </msub>
                 <mo separator="true">
                  ,
                 </mo>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   2
                  </mn>
                 </msub>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  b
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
                <mrow>
                 <mi mathvariant="normal">
                  ∂
                 </mi>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   1
                  </mn>
                 </msub>
                </mrow>
               </mfrac>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mfrac>
                <mrow>
                 <mi mathvariant="normal">
                  ∂
                 </mi>
                 <msup>
                  <mi mathvariant="normal">
                   ℓ
                  </mi>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mi>
                    i
                   </mi>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msup>
                 <mo>
                  (
                 </mo>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   1
                  </mn>
                 </msub>
                 <mo separator="true">
                  ,
                 </mo>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   2
                  </mn>
                 </msub>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  b
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
                <mrow>
                 <mi mathvariant="normal">
                  ∂
                 </mi>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   2
                  </mn>
                 </msub>
                </mrow>
               </mfrac>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mfrac>
                <mrow>
                 <mi mathvariant="normal">
                  ∂
                 </mi>
                 <msup>
                  <mi mathvariant="normal">
                   ℓ
                  </mi>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mi>
                    i
                   </mi>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msup>
                 <mo>
                  (
                 </mo>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   1
                  </mn>
                 </msub>
                 <mo separator="true">
                  ,
                 </mo>
                 <msub>
                  <mi>
                   w
                  </mi>
                  <mn>
                   2
                  </mn>
                 </msub>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  b
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
                <mrow>
                 <mi mathvariant="normal">
                  ∂
                 </mi>
                 <mi>
                  b
                 </mi>
                </mrow>
               </mfrac>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mrow>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mrow>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <mo>
                 (
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
                <mo>
                 )
                </mo>
               </mrow>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mrow>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  1
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  1
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <msubsup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msubsup>
                <msub>
                 <mi>
                  w
                 </mi>
                 <mn>
                  2
                 </mn>
                </msub>
                <mo>
                 +
                </mo>
                <mi>
                 b
                </mi>
                <mo>
                 −
                </mo>
                <msup>
                 <mi>
                  y
                 </mi>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mi>
                   i
                  </mi>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </msup>
               </mrow>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mtable>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 1
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <msubsup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mstyle>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mstyle scriptlevel="0" displaystyle="false">
               <mn>
                1
               </mn>
              </mstyle>
             </mtd>
            </mtr>
           </mtable>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mo>
           (
          </mo>
          <msup>
           <mover accent="true">
            <mi>
             y
            </mi>
            <mo>
             ^
            </mo>
           </mover>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           −
          </mo>
          <msup>
           <mi>
            y
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           )
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           \nabla_{\boldsymbol{\theta}} \ell^{(i)}(\boldsymbol{\theta})= \begin{bmatrix} \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_1} \\ \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial w_2} \\ \frac{ \partial \ell^{(i)}(w_1, w_2, b) }{\partial b} \end{bmatrix} = \begin{bmatrix} x_1^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\ x_2^{(i)} (x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}) \\ x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)} \end{bmatrix} = \begin{bmatrix} x_1^{(i)} \\ x_2^{(i)} \\ 1 \end{bmatrix} (\hat{y}^{(i)} - y^{(i)}). 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.80204em; vertical-align: -2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.61765em;"><span class="" style="top: -4.61765em;"><span class="pstrut" style="height: 3.1617em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1617em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.966714em;"><span class="" style="top: -2.96671em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.01085em;"><span class="pstrut" style="height: 3.1617em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1617em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.966714em;"><span class="" style="top: -2.96671em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.40405em;"><span class="pstrut" style="height: 3.1617em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1617em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathit mtight">b</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.966714em;"><span class="" style="top: -2.96671em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.11765em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.2144em; vertical-align: -1.8572em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35101em;"><span class="" style="top: -1.95em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.105em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.35102em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.3572em;"><span class="" style="top: -4.3572em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.9524em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.5476em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.8572em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35101em;"><span class="" style="top: -1.95em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.105em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.35102em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85003em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.20104em; vertical-align: -1.85003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35101em;"><span class="" style="top: -1.95em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.105em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.35102em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.2548em;"><span class="" style="top: -4.2548em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.85em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.7548em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35101em;"><span class="" style="top: -1.95em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.105em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.35102em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85003em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span></p> 
  <h3><a id="313__226"></a>3.1.3. 小结</h3> 
  <ul> 
   <li>对于线性回归这样一种单层神经网络，它的基本要素包括模型、训练数据、损失函数和优化算法。</li> 
   <li>既可以用神经网络图表示线性回归，又可以用矢量计算表示该模型。</li> 
   <li>应该尽可能采用矢量计算，以提升计算效率。</li> 
  </ul> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
