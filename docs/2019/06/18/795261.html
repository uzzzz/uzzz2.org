<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>面板平滑转移回归(PSTR)分析案例实现 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="面板平滑转移回归(PSTR)分析案例实现" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="原文链接：http://tecdat.cn/?p=3765 &nbsp; 建模过程包括三个阶段：规范，估计和评估。该软件包提供的工具可帮助用户进行模型规范测试，进行PSTR模型评估以及进行模型评估。 在程序包中实现了集群依赖性和异方差性一致性测试。 还实现了wild bootstrap和cluster wild bootstrap测试。 并行计算（作为选项）在某些函数中实现，尤其是引导测试。因此，该程序包适合在超级计算服务器上运行多个核心的任务。 &nbsp;&nbsp; 数据 &nbsp;“Hansen99”的数据集来提供示例。&nbsp; 初始化 您可以通过执行创建PSTR类的新对象 #&gt; Summary of the model: #&gt; --------------------------------------------------------------------------- #&gt; time horizon sample size = 14, number of individuals = 560 #&gt; --------------------------------------------------------------------------- #&gt; Dependent variable: inva #&gt; --------------------------------------------------------------------------- #&gt; Explanatory variables in the linear part: #&gt; dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala debta cfa sales #&gt; --------------------------------------------------------------------------- #&gt; Explanatory variables in the non-linear part: #&gt; vala debta cfa sales #&gt; --------------------------------------------------------------------------- #&gt; Potential transition variable(s) to be tested: #&gt; vala #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the linearity (homogeneity) tests: #&gt; *************************************************************************** #&gt; Sequence of homogeneity tests for selecting number of switches &#39;m&#39;: #&gt; *************************************************************************** #&gt; ########################################################################### 它说使用了数据集“Hansen99”，因变量是“inva”，第4列到第20列的数据中的变量是线性部分的解释变量（尽管你可以写下它们的名称），非线性部分中的解释变量是“indep_k”中的四个，潜在的转换变量是“vala”（Tobin的Q）。 &nbsp; &nbsp; 以下代码执行线性测试 #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the linearity (homogeneity) tests: #&gt; --------------------------------------------------------------------------- #&gt; LM tests based on transition variable &#39;vala&#39; #&gt; m LM_X PV LM_F PV HAC_X PV HAC_F PV #&gt; 1 125.3 0 28.99 0 30.03 4.819e-06 6.952 1.396e-05 #&gt; *************************************************************************** #&gt; Sequence of homogeneity tests for selecting number of switches &#39;m&#39;: #&gt; --------------------------------------------------------------------------- #&gt; LM tests based on transition variable &#39;vala&#39; #&gt; m LM_X PV LM_F PV HAC_X PV HAC_F PV #&gt; 1 125.3 0 28.99 0 30.03 4.819e-06 6.952 1.396e-05 #&gt; *************************************************************************** #&gt; ########################################################################### 您可以看到函数“LinTest”获取PSTR对象“pstr”并在返回时覆盖它。这是我推荐的方式，因为处理包中PSTR对象的函数通过添加新的atrributes或成员来更新对象。但是，相同的函数将更改它添加的属性的值。您当然可以创建新的PSTR对象来获取返回值，以便保存模型的不同设置的结果。 &nbsp;可以通过运行以下代码来执行wild bootstrap和wild cluster bootstrap。&nbsp; &nbsp; 估计 当您确定要用于估计的转换变量时，在本例中为“inva”，您可以估计PSTR模型 print(pstr,&quot;estimates&quot;) 默认情况下，使用“optim”方法“L-BFGS-B”，但您可以通过执行更改方法进行估算 print(pstr,&quot;estimates&quot;) #&gt; ########################################################################### #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the PSTR estimation: #&gt; --------------------------------------------------------------------------- #&gt; Transition variable &#39;vala&#39; is used in the estimation. #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the linear part (first extreme regime) are #&gt; dt_75_0 dt_76_0 dt_77_0 dt_78_0 dt_79_0 dt_80_0 dt_81_0 #&gt; Est -0.002827 -0.007512 -0.005812 0.0003951 0.002464 0.006085 0.0004164 #&gt; s.e. 0.002431 0.002577 0.002649 0.0027950 0.002708 0.002910 0.0029220 #&gt; dt_82_0 dt_83_0 dt_84_0 dt_85_0 dt_86_0 dt_87_0 vala_0 #&gt; Est -0.007802 -0.014410 -0.0009146 0.003467 -0.001591 -0.008606 0.11500 #&gt; s.e. 0.002609 0.002701 0.0030910 0.003232 0.003202 0.003133 0.04073 #&gt; debta_0 cfa_0 sales_0 #&gt; Est -0.03392 0.10980 0.002978 #&gt; s.e. 0.03319 0.04458 0.008221 #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the non-linear part are #&gt; vala_1 debta_1 cfa_1 sales_1 #&gt; Est -0.10370 0.02892 -0.08801 0.005945 #&gt; s.e. 0.03981 0.04891 0.05672 0.012140 #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the second extreme regime are #&gt; vala_{0+1} debta_{0+1} cfa_{0+1} sales_{0+1} #&gt; Est 0.011300 -0.00500 0.02183 0.008923 #&gt; s.e. 0.001976 0.01739 0.01885 0.004957 #&gt; --------------------------------------------------------------------------- #&gt; Non-linear parameter estimates are #&gt; gamma c_1 #&gt; Est 0.6299 -0.0002008 #&gt; s.e. 0.1032 0.7252000 #&gt; --------------------------------------------------------------------------- #&gt; Estimated standard deviation of the residuals is 0.04301 #&gt; *************************************************************************** #&gt; ########################################################################### &nbsp; &nbsp;还实现了线性面板回归模型的估计。&nbsp; print(pstr0,&quot;estimates&quot;) #&gt; ########################################################################### #&gt; ## PSTR 1.2.4 (Orange Panel) #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; A linear panel regression with fixed effects is estimated. #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates are #&gt; dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 #&gt; Est -0.007759 -0.008248 -0.004296 0.002356 0.004370 0.008246 0.004164 #&gt; s.e. 0.002306 0.002544 0.002718 0.002820 0.002753 0.002959 0.002992 #&gt; dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala #&gt; Est -0.005294 -0.010040 0.006864 0.009740 0.007027 0.0004091 0.008334 #&gt; s.e. 0.002664 0.002678 0.003092 0.003207 0.003069 0.0030080 0.001259 #&gt; debta cfa sales #&gt; Est -0.016380 0.06506 0.007957 #&gt; s.e. 0.005725 0.01079 0.002412 #&gt; --------------------------------------------------------------------------- #&gt; Estimated standard deviation of the residuals is 0.04375 #&gt; *************************************************************************** #&gt; ########################################################################### 评估 可以基于估计的模型进行评估测试 &nbsp; 请注意，在“EvalTest”中，每次只有一个转换变量用于无剩余非线性测试。这与“LinTest”函数不同，后者可以采用多个转换变量。这就是为什么我将结果保存到新的PSTR对象“pstr1”而不是覆盖的原因。通过这样做，我可以在新对象中保存来自不同转换变量的更多测试结果。 iB = 5000 cpus = 50 ## wild bootstrap time-varyint evaluation test pstr = WCB_TVTest(use=pstr,iB=iB,parallel=T,cpus=cpus) ## wild bootstrap heterogeneity evaluation test pstr1 = WCB_HETest(use=pstr1,vq=pstr$mQ[,1],iB=iB,parallel=T,cpus=cpus) 请注意，评估函数不接受线性面板回归模型中返回的对象“pstr0”，因为评估测试是针对估计的PSTR模型设计的，而不是线性模型。 绘制 估算PSTR模型后，您可以通过运行绘制估计的过渡函数 &nbsp; &nbsp; 您还可以根据转换变量绘制系数曲线，标准误差和p值。 &nbsp; 绘图功能plot_response，描述了其中我称为响应，一些解释性变量和过渡可变在PSTR模型。 &nbsp; &nbsp;我们可以看到，如果没有非线性，对变量的响应是一条直线。如果变量和转换变量是不同的，我们可以绘制曲面，z轴为响应，x轴和y轴为两个变量。如果变量和转换变量相同，则变为曲线。X我Ťxitq我ŤqitX我Ťxitq我Ťqit 我们通过运行来制作图表 &nbsp; x轴上的数字看起来不太好，因为很难找到转折点的位置。 该ggplot2软件包允许我们手动绘制数字（PSTR包与一些预先包装的软件包很好地协作），甚至是x轴上的标签（以及更多）。 &nbsp; 现在我们非常清楚地看到，大约0.5的转折点将曲线切割成两种状态，并且两种状态的行为完全不同。该图表是关于托宾Q对预期投资的贡献滞后。低Q值公司（其潜力被金融市场评估为低）看起来不太愿意改变他们未来的投资计划，或者可能会改变。 &nbsp;&nbsp; &nbsp; &nbsp;" />
<meta property="og:description" content="原文链接：http://tecdat.cn/?p=3765 &nbsp; 建模过程包括三个阶段：规范，估计和评估。该软件包提供的工具可帮助用户进行模型规范测试，进行PSTR模型评估以及进行模型评估。 在程序包中实现了集群依赖性和异方差性一致性测试。 还实现了wild bootstrap和cluster wild bootstrap测试。 并行计算（作为选项）在某些函数中实现，尤其是引导测试。因此，该程序包适合在超级计算服务器上运行多个核心的任务。 &nbsp;&nbsp; 数据 &nbsp;“Hansen99”的数据集来提供示例。&nbsp; 初始化 您可以通过执行创建PSTR类的新对象 #&gt; Summary of the model: #&gt; --------------------------------------------------------------------------- #&gt; time horizon sample size = 14, number of individuals = 560 #&gt; --------------------------------------------------------------------------- #&gt; Dependent variable: inva #&gt; --------------------------------------------------------------------------- #&gt; Explanatory variables in the linear part: #&gt; dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala debta cfa sales #&gt; --------------------------------------------------------------------------- #&gt; Explanatory variables in the non-linear part: #&gt; vala debta cfa sales #&gt; --------------------------------------------------------------------------- #&gt; Potential transition variable(s) to be tested: #&gt; vala #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the linearity (homogeneity) tests: #&gt; *************************************************************************** #&gt; Sequence of homogeneity tests for selecting number of switches &#39;m&#39;: #&gt; *************************************************************************** #&gt; ########################################################################### 它说使用了数据集“Hansen99”，因变量是“inva”，第4列到第20列的数据中的变量是线性部分的解释变量（尽管你可以写下它们的名称），非线性部分中的解释变量是“indep_k”中的四个，潜在的转换变量是“vala”（Tobin的Q）。 &nbsp; &nbsp; 以下代码执行线性测试 #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the linearity (homogeneity) tests: #&gt; --------------------------------------------------------------------------- #&gt; LM tests based on transition variable &#39;vala&#39; #&gt; m LM_X PV LM_F PV HAC_X PV HAC_F PV #&gt; 1 125.3 0 28.99 0 30.03 4.819e-06 6.952 1.396e-05 #&gt; *************************************************************************** #&gt; Sequence of homogeneity tests for selecting number of switches &#39;m&#39;: #&gt; --------------------------------------------------------------------------- #&gt; LM tests based on transition variable &#39;vala&#39; #&gt; m LM_X PV LM_F PV HAC_X PV HAC_F PV #&gt; 1 125.3 0 28.99 0 30.03 4.819e-06 6.952 1.396e-05 #&gt; *************************************************************************** #&gt; ########################################################################### 您可以看到函数“LinTest”获取PSTR对象“pstr”并在返回时覆盖它。这是我推荐的方式，因为处理包中PSTR对象的函数通过添加新的atrributes或成员来更新对象。但是，相同的函数将更改它添加的属性的值。您当然可以创建新的PSTR对象来获取返回值，以便保存模型的不同设置的结果。 &nbsp;可以通过运行以下代码来执行wild bootstrap和wild cluster bootstrap。&nbsp; &nbsp; 估计 当您确定要用于估计的转换变量时，在本例中为“inva”，您可以估计PSTR模型 print(pstr,&quot;estimates&quot;) 默认情况下，使用“optim”方法“L-BFGS-B”，但您可以通过执行更改方法进行估算 print(pstr,&quot;estimates&quot;) #&gt; ########################################################################### #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the PSTR estimation: #&gt; --------------------------------------------------------------------------- #&gt; Transition variable &#39;vala&#39; is used in the estimation. #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the linear part (first extreme regime) are #&gt; dt_75_0 dt_76_0 dt_77_0 dt_78_0 dt_79_0 dt_80_0 dt_81_0 #&gt; Est -0.002827 -0.007512 -0.005812 0.0003951 0.002464 0.006085 0.0004164 #&gt; s.e. 0.002431 0.002577 0.002649 0.0027950 0.002708 0.002910 0.0029220 #&gt; dt_82_0 dt_83_0 dt_84_0 dt_85_0 dt_86_0 dt_87_0 vala_0 #&gt; Est -0.007802 -0.014410 -0.0009146 0.003467 -0.001591 -0.008606 0.11500 #&gt; s.e. 0.002609 0.002701 0.0030910 0.003232 0.003202 0.003133 0.04073 #&gt; debta_0 cfa_0 sales_0 #&gt; Est -0.03392 0.10980 0.002978 #&gt; s.e. 0.03319 0.04458 0.008221 #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the non-linear part are #&gt; vala_1 debta_1 cfa_1 sales_1 #&gt; Est -0.10370 0.02892 -0.08801 0.005945 #&gt; s.e. 0.03981 0.04891 0.05672 0.012140 #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the second extreme regime are #&gt; vala_{0+1} debta_{0+1} cfa_{0+1} sales_{0+1} #&gt; Est 0.011300 -0.00500 0.02183 0.008923 #&gt; s.e. 0.001976 0.01739 0.01885 0.004957 #&gt; --------------------------------------------------------------------------- #&gt; Non-linear parameter estimates are #&gt; gamma c_1 #&gt; Est 0.6299 -0.0002008 #&gt; s.e. 0.1032 0.7252000 #&gt; --------------------------------------------------------------------------- #&gt; Estimated standard deviation of the residuals is 0.04301 #&gt; *************************************************************************** #&gt; ########################################################################### &nbsp; &nbsp;还实现了线性面板回归模型的估计。&nbsp; print(pstr0,&quot;estimates&quot;) #&gt; ########################################################################### #&gt; ## PSTR 1.2.4 (Orange Panel) #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; A linear panel regression with fixed effects is estimated. #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates are #&gt; dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 #&gt; Est -0.007759 -0.008248 -0.004296 0.002356 0.004370 0.008246 0.004164 #&gt; s.e. 0.002306 0.002544 0.002718 0.002820 0.002753 0.002959 0.002992 #&gt; dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala #&gt; Est -0.005294 -0.010040 0.006864 0.009740 0.007027 0.0004091 0.008334 #&gt; s.e. 0.002664 0.002678 0.003092 0.003207 0.003069 0.0030080 0.001259 #&gt; debta cfa sales #&gt; Est -0.016380 0.06506 0.007957 #&gt; s.e. 0.005725 0.01079 0.002412 #&gt; --------------------------------------------------------------------------- #&gt; Estimated standard deviation of the residuals is 0.04375 #&gt; *************************************************************************** #&gt; ########################################################################### 评估 可以基于估计的模型进行评估测试 &nbsp; 请注意，在“EvalTest”中，每次只有一个转换变量用于无剩余非线性测试。这与“LinTest”函数不同，后者可以采用多个转换变量。这就是为什么我将结果保存到新的PSTR对象“pstr1”而不是覆盖的原因。通过这样做，我可以在新对象中保存来自不同转换变量的更多测试结果。 iB = 5000 cpus = 50 ## wild bootstrap time-varyint evaluation test pstr = WCB_TVTest(use=pstr,iB=iB,parallel=T,cpus=cpus) ## wild bootstrap heterogeneity evaluation test pstr1 = WCB_HETest(use=pstr1,vq=pstr$mQ[,1],iB=iB,parallel=T,cpus=cpus) 请注意，评估函数不接受线性面板回归模型中返回的对象“pstr0”，因为评估测试是针对估计的PSTR模型设计的，而不是线性模型。 绘制 估算PSTR模型后，您可以通过运行绘制估计的过渡函数 &nbsp; &nbsp; 您还可以根据转换变量绘制系数曲线，标准误差和p值。 &nbsp; 绘图功能plot_response，描述了其中我称为响应，一些解释性变量和过渡可变在PSTR模型。 &nbsp; &nbsp;我们可以看到，如果没有非线性，对变量的响应是一条直线。如果变量和转换变量是不同的，我们可以绘制曲面，z轴为响应，x轴和y轴为两个变量。如果变量和转换变量相同，则变为曲线。X我Ťxitq我ŤqitX我Ťxitq我Ťqit 我们通过运行来制作图表 &nbsp; x轴上的数字看起来不太好，因为很难找到转折点的位置。 该ggplot2软件包允许我们手动绘制数字（PSTR包与一些预先包装的软件包很好地协作），甚至是x轴上的标签（以及更多）。 &nbsp; 现在我们非常清楚地看到，大约0.5的转折点将曲线切割成两种状态，并且两种状态的行为完全不同。该图表是关于托宾Q对预期投资的贡献滞后。低Q值公司（其潜力被金融市场评估为低）看起来不太愿意改变他们未来的投资计划，或者可能会改变。 &nbsp;&nbsp; &nbsp; &nbsp;" />
<link rel="canonical" href="https://uzzz.org/2019/06/18/795261.html" />
<meta property="og:url" content="https://uzzz.org/2019/06/18/795261.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-18T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"原文链接：http://tecdat.cn/?p=3765 &nbsp; 建模过程包括三个阶段：规范，估计和评估。该软件包提供的工具可帮助用户进行模型规范测试，进行PSTR模型评估以及进行模型评估。 在程序包中实现了集群依赖性和异方差性一致性测试。 还实现了wild bootstrap和cluster wild bootstrap测试。 并行计算（作为选项）在某些函数中实现，尤其是引导测试。因此，该程序包适合在超级计算服务器上运行多个核心的任务。 &nbsp;&nbsp; 数据 &nbsp;“Hansen99”的数据集来提供示例。&nbsp; 初始化 您可以通过执行创建PSTR类的新对象 #&gt; Summary of the model: #&gt; --------------------------------------------------------------------------- #&gt; time horizon sample size = 14, number of individuals = 560 #&gt; --------------------------------------------------------------------------- #&gt; Dependent variable: inva #&gt; --------------------------------------------------------------------------- #&gt; Explanatory variables in the linear part: #&gt; dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala debta cfa sales #&gt; --------------------------------------------------------------------------- #&gt; Explanatory variables in the non-linear part: #&gt; vala debta cfa sales #&gt; --------------------------------------------------------------------------- #&gt; Potential transition variable(s) to be tested: #&gt; vala #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the linearity (homogeneity) tests: #&gt; *************************************************************************** #&gt; Sequence of homogeneity tests for selecting number of switches &#39;m&#39;: #&gt; *************************************************************************** #&gt; ########################################################################### 它说使用了数据集“Hansen99”，因变量是“inva”，第4列到第20列的数据中的变量是线性部分的解释变量（尽管你可以写下它们的名称），非线性部分中的解释变量是“indep_k”中的四个，潜在的转换变量是“vala”（Tobin的Q）。 &nbsp; &nbsp; 以下代码执行线性测试 #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the linearity (homogeneity) tests: #&gt; --------------------------------------------------------------------------- #&gt; LM tests based on transition variable &#39;vala&#39; #&gt; m LM_X PV LM_F PV HAC_X PV HAC_F PV #&gt; 1 125.3 0 28.99 0 30.03 4.819e-06 6.952 1.396e-05 #&gt; *************************************************************************** #&gt; Sequence of homogeneity tests for selecting number of switches &#39;m&#39;: #&gt; --------------------------------------------------------------------------- #&gt; LM tests based on transition variable &#39;vala&#39; #&gt; m LM_X PV LM_F PV HAC_X PV HAC_F PV #&gt; 1 125.3 0 28.99 0 30.03 4.819e-06 6.952 1.396e-05 #&gt; *************************************************************************** #&gt; ########################################################################### 您可以看到函数“LinTest”获取PSTR对象“pstr”并在返回时覆盖它。这是我推荐的方式，因为处理包中PSTR对象的函数通过添加新的atrributes或成员来更新对象。但是，相同的函数将更改它添加的属性的值。您当然可以创建新的PSTR对象来获取返回值，以便保存模型的不同设置的结果。 &nbsp;可以通过运行以下代码来执行wild bootstrap和wild cluster bootstrap。&nbsp; &nbsp; 估计 当您确定要用于估计的转换变量时，在本例中为“inva”，您可以估计PSTR模型 print(pstr,&quot;estimates&quot;) 默认情况下，使用“optim”方法“L-BFGS-B”，但您可以通过执行更改方法进行估算 print(pstr,&quot;estimates&quot;) #&gt; ########################################################################### #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; Results of the PSTR estimation: #&gt; --------------------------------------------------------------------------- #&gt; Transition variable &#39;vala&#39; is used in the estimation. #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the linear part (first extreme regime) are #&gt; dt_75_0 dt_76_0 dt_77_0 dt_78_0 dt_79_0 dt_80_0 dt_81_0 #&gt; Est -0.002827 -0.007512 -0.005812 0.0003951 0.002464 0.006085 0.0004164 #&gt; s.e. 0.002431 0.002577 0.002649 0.0027950 0.002708 0.002910 0.0029220 #&gt; dt_82_0 dt_83_0 dt_84_0 dt_85_0 dt_86_0 dt_87_0 vala_0 #&gt; Est -0.007802 -0.014410 -0.0009146 0.003467 -0.001591 -0.008606 0.11500 #&gt; s.e. 0.002609 0.002701 0.0030910 0.003232 0.003202 0.003133 0.04073 #&gt; debta_0 cfa_0 sales_0 #&gt; Est -0.03392 0.10980 0.002978 #&gt; s.e. 0.03319 0.04458 0.008221 #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the non-linear part are #&gt; vala_1 debta_1 cfa_1 sales_1 #&gt; Est -0.10370 0.02892 -0.08801 0.005945 #&gt; s.e. 0.03981 0.04891 0.05672 0.012140 #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates in the second extreme regime are #&gt; vala_{0+1} debta_{0+1} cfa_{0+1} sales_{0+1} #&gt; Est 0.011300 -0.00500 0.02183 0.008923 #&gt; s.e. 0.001976 0.01739 0.01885 0.004957 #&gt; --------------------------------------------------------------------------- #&gt; Non-linear parameter estimates are #&gt; gamma c_1 #&gt; Est 0.6299 -0.0002008 #&gt; s.e. 0.1032 0.7252000 #&gt; --------------------------------------------------------------------------- #&gt; Estimated standard deviation of the residuals is 0.04301 #&gt; *************************************************************************** #&gt; ########################################################################### &nbsp; &nbsp;还实现了线性面板回归模型的估计。&nbsp; print(pstr0,&quot;estimates&quot;) #&gt; ########################################################################### #&gt; ## PSTR 1.2.4 (Orange Panel) #&gt; ########################################################################### #&gt; *************************************************************************** #&gt; A linear panel regression with fixed effects is estimated. #&gt; --------------------------------------------------------------------------- #&gt; Parameter estimates are #&gt; dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 #&gt; Est -0.007759 -0.008248 -0.004296 0.002356 0.004370 0.008246 0.004164 #&gt; s.e. 0.002306 0.002544 0.002718 0.002820 0.002753 0.002959 0.002992 #&gt; dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala #&gt; Est -0.005294 -0.010040 0.006864 0.009740 0.007027 0.0004091 0.008334 #&gt; s.e. 0.002664 0.002678 0.003092 0.003207 0.003069 0.0030080 0.001259 #&gt; debta cfa sales #&gt; Est -0.016380 0.06506 0.007957 #&gt; s.e. 0.005725 0.01079 0.002412 #&gt; --------------------------------------------------------------------------- #&gt; Estimated standard deviation of the residuals is 0.04375 #&gt; *************************************************************************** #&gt; ########################################################################### 评估 可以基于估计的模型进行评估测试 &nbsp; 请注意，在“EvalTest”中，每次只有一个转换变量用于无剩余非线性测试。这与“LinTest”函数不同，后者可以采用多个转换变量。这就是为什么我将结果保存到新的PSTR对象“pstr1”而不是覆盖的原因。通过这样做，我可以在新对象中保存来自不同转换变量的更多测试结果。 iB = 5000 cpus = 50 ## wild bootstrap time-varyint evaluation test pstr = WCB_TVTest(use=pstr,iB=iB,parallel=T,cpus=cpus) ## wild bootstrap heterogeneity evaluation test pstr1 = WCB_HETest(use=pstr1,vq=pstr$mQ[,1],iB=iB,parallel=T,cpus=cpus) 请注意，评估函数不接受线性面板回归模型中返回的对象“pstr0”，因为评估测试是针对估计的PSTR模型设计的，而不是线性模型。 绘制 估算PSTR模型后，您可以通过运行绘制估计的过渡函数 &nbsp; &nbsp; 您还可以根据转换变量绘制系数曲线，标准误差和p值。 &nbsp; 绘图功能plot_response，描述了其中我称为响应，一些解释性变量和过渡可变在PSTR模型。 &nbsp; &nbsp;我们可以看到，如果没有非线性，对变量的响应是一条直线。如果变量和转换变量是不同的，我们可以绘制曲面，z轴为响应，x轴和y轴为两个变量。如果变量和转换变量相同，则变为曲线。X我Ťxitq我ŤqitX我Ťxitq我Ťqit 我们通过运行来制作图表 &nbsp; x轴上的数字看起来不太好，因为很难找到转折点的位置。 该ggplot2软件包允许我们手动绘制数字（PSTR包与一些预先包装的软件包很好地协作），甚至是x轴上的标签（以及更多）。 &nbsp; 现在我们非常清楚地看到，大约0.5的转折点将曲线切割成两种状态，并且两种状态的行为完全不同。该图表是关于托宾Q对预期投资的贡献滞后。低Q值公司（其潜力被金融市场评估为低）看起来不太愿意改变他们未来的投资计划，或者可能会改变。 &nbsp;&nbsp; &nbsp; &nbsp;","@type":"BlogPosting","url":"https://uzzz.org/2019/06/18/795261.html","headline":"面板平滑转移回归(PSTR)分析案例实现","dateModified":"2019-06-18T00:00:00+08:00","datePublished":"2019-06-18T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/06/18/795261.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>面板平滑转移回归(PSTR)分析案例实现</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div class="htmledit_views" id="content_views"> 
  <h3>原文链接：<a href="http://tecdat.cn/?p=3765" rel="nofollow" data-token="59327d7a82952e87d86d847259c0fe37">http://tecdat.cn/?p=3765</a></h3> 
  <p>&nbsp;</p> 
  <p>建模过程包括三个阶段：规范，估计和评估。该软件包提供的工具可帮助用户进行模型规范测试，进行PSTR模型评估以及进行模型评估。</p> 
  <p>在程序包中实现了集群依赖性和异方差性一致性测试。</p> 
  <p>还实现了wild bootstrap和cluster wild bootstrap测试。</p> 
  <p>并行计算（作为选项）在某些函数中实现，尤其是引导测试。因此，该程序包适合在超级计算服务器上运行多个核心的任务。</p> 
  <h2>&nbsp;&nbsp;</h2> 
  <h3>数据</h3> 
  <p>&nbsp;“Hansen99”的数据集来提供示例。&nbsp;</p> 
  <h3>初始化</h3> 
  <p>您可以通过执行创建PSTR类的新对象</p> 
  <pre>
<code> 
<a id="cb7-4"></a> 
<a id="cb7-8"></a>#&gt; Summary of the model:
<a id="cb7-9"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb7-10"></a>#&gt;   time horizon sample size = 14,  number of individuals = 560
<a id="cb7-11"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb7-12"></a>#&gt; Dependent variable:  inva
<a id="cb7-13"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb7-14"></a>#&gt; Explanatory variables in the linear part:
<a id="cb7-15"></a>#&gt;   dt_75 dt_76 dt_77 dt_78 dt_79 dt_80 dt_81 dt_82 dt_83 dt_84 dt_85 dt_86 dt_87 vala debta cfa sales
<a id="cb7-16"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb7-17"></a>#&gt; Explanatory variables in the non-linear part:
<a id="cb7-18"></a>#&gt;   vala debta cfa sales
<a id="cb7-19"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb7-20"></a>#&gt; Potential transition variable(s) to be tested:
<a id="cb7-21"></a>#&gt;   vala
<a id="cb7-22"></a>#&gt; ###########################################################################
<a id="cb7-23"></a>#&gt; ***************************************************************************
<a id="cb7-24"></a>#&gt; Results of the linearity (homogeneity) tests:
<a id="cb7-25"></a>#&gt; ***************************************************************************
<a id="cb7-26"></a>#&gt; Sequence of homogeneity tests for selecting number of switches 'm':
<a id="cb7-27"></a>#&gt; ***************************************************************************
<a id="cb7-28"></a>#&gt; ###########################################################################</code></pre> 
  <p>它说使用了数据集“Hansen99”，因变量是“inva”，第4列到第20列的数据中的变量是线性部分的解释变量（尽管你可以写下它们的名称），非线性部分中的解释变量是“indep_k”中的四个，潜在的转换变量是“vala”（Tobin的Q）。</p> 
  <p>&nbsp;</p> 
  <h3>&nbsp;</h3> 
  <p>以下代码执行线性测试</p> 
  <pre>
<code> 
<a id="cb8-5"></a>#&gt; ###########################################################################
<a id="cb8-6"></a>#&gt; ***************************************************************************
<a id="cb8-7"></a>#&gt; Results of the linearity (homogeneity) tests:
<a id="cb8-8"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb8-9"></a>#&gt; LM tests based on transition variable 'vala'
<a id="cb8-10"></a>#&gt;   m  LM_X PV  LM_F PV HAC_X        PV HAC_F        PV
<a id="cb8-11"></a>#&gt;   1 125.3  0 28.99  0 30.03 4.819e-06 6.952 1.396e-05
<a id="cb8-12"></a>#&gt; ***************************************************************************
<a id="cb8-13"></a>#&gt; Sequence of homogeneity tests for selecting number of switches 'm':
<a id="cb8-14"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb8-15"></a>#&gt; LM tests based on transition variable 'vala'
<a id="cb8-16"></a>#&gt;   m  LM_X PV  LM_F PV HAC_X        PV HAC_F        PV
<a id="cb8-17"></a>#&gt;   1 125.3  0 28.99  0 30.03 4.819e-06 6.952 1.396e-05
<a id="cb8-18"></a>#&gt; ***************************************************************************
<a id="cb8-19"></a>#&gt; ###########################################################################</code></pre> 
  <p>您可以看到函数“LinTest”获取PSTR对象“pstr”并在返回时覆盖它。这是我推荐的方式，因为处理包中PSTR对象的函数通过添加新的atrributes或成员来更新对象。但是，相同的函数将更改它添加的属性的值。您当然可以创建新的PSTR对象来获取返回值，以便保存模型的不同设置的结果。</p> 
  <p>&nbsp;可以通过运行以下代码来执行wild bootstrap和wild cluster bootstrap。&nbsp;</p> 
  <p>&nbsp;</p> 
  <h3>估计</h3> 
  <p>当您确定要用于估计的转换变量时，在本例中为“inva”，您可以估计PSTR模型</p> 
  <pre>
<code> <a id="cb11-2"></a>print(pstr,"estimates")</code></pre> 
  <p>默认情况下，使用“optim”方法“L-BFGS-B”，但您可以通过执行更改方法进行估算</p> 
  <pre>
<code> <a id="cb12-2"></a>print(pstr,"estimates")
<a id="cb12-3"></a>#&gt; ###########################################################################
 <a id="cb12-5"></a>#&gt; ###########################################################################
<a id="cb12-6"></a>#&gt; ***************************************************************************
<a id="cb12-7"></a>#&gt; Results of the PSTR estimation:
<a id="cb12-8"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb12-9"></a>#&gt; Transition variable 'vala' is used in the estimation.
<a id="cb12-10"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb12-11"></a>#&gt; Parameter estimates in the linear part (first extreme regime) are
<a id="cb12-12"></a>#&gt;        dt_75_0   dt_76_0   dt_77_0   dt_78_0  dt_79_0  dt_80_0   dt_81_0
<a id="cb12-13"></a>#&gt; Est  -0.002827 -0.007512 -0.005812 0.0003951 0.002464 0.006085 0.0004164
<a id="cb12-14"></a>#&gt; s.e.  0.002431  0.002577  0.002649 0.0027950 0.002708 0.002910 0.0029220
<a id="cb12-15"></a>#&gt;        dt_82_0   dt_83_0    dt_84_0  dt_85_0   dt_86_0   dt_87_0  vala_0
<a id="cb12-16"></a>#&gt; Est  -0.007802 -0.014410 -0.0009146 0.003467 -0.001591 -0.008606 0.11500
<a id="cb12-17"></a>#&gt; s.e.  0.002609  0.002701  0.0030910 0.003232  0.003202  0.003133 0.04073
<a id="cb12-18"></a>#&gt;       debta_0   cfa_0  sales_0
<a id="cb12-19"></a>#&gt; Est  -0.03392 0.10980 0.002978
<a id="cb12-20"></a>#&gt; s.e.  0.03319 0.04458 0.008221
<a id="cb12-21"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb12-22"></a>#&gt; Parameter estimates in the non-linear part are
<a id="cb12-23"></a>#&gt;        vala_1 debta_1    cfa_1  sales_1
<a id="cb12-24"></a>#&gt; Est  -0.10370 0.02892 -0.08801 0.005945
<a id="cb12-25"></a>#&gt; s.e.  0.03981 0.04891  0.05672 0.012140
<a id="cb12-26"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb12-27"></a>#&gt; Parameter estimates in the second extreme regime are
<a id="cb12-28"></a>#&gt;      vala_{0+1} debta_{0+1} cfa_{0+1} sales_{0+1}
<a id="cb12-29"></a>#&gt; Est    0.011300    -0.00500   0.02183    0.008923
<a id="cb12-30"></a>#&gt; s.e.   0.001976     0.01739   0.01885    0.004957
<a id="cb12-31"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb12-32"></a>#&gt; Non-linear parameter estimates are
<a id="cb12-33"></a>#&gt;       gamma        c_1
<a id="cb12-34"></a>#&gt; Est  0.6299 -0.0002008
<a id="cb12-35"></a>#&gt; s.e. 0.1032  0.7252000
<a id="cb12-36"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb12-37"></a>#&gt; Estimated standard deviation of the residuals is 0.04301
<a id="cb12-38"></a>#&gt; ***************************************************************************
<a id="cb12-39"></a>#&gt; ###########################################################################</code></pre> 
  <p>&nbsp;</p> 
  <p>&nbsp;还实现了线性面板回归模型的估计。&nbsp;</p> 
  <pre>
<code> <a id="cb14-2"></a>print(pstr0,"estimates")
<a id="cb14-3"></a>#&gt; ###########################################################################
<a id="cb14-4"></a>#&gt; ## PSTR 1.2.4 (Orange Panel)
<a id="cb14-5"></a>#&gt; ###########################################################################
<a id="cb14-6"></a>#&gt; ***************************************************************************
<a id="cb14-7"></a>#&gt; A linear panel regression with fixed effects is estimated.
<a id="cb14-8"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb14-9"></a>#&gt; Parameter estimates are
<a id="cb14-10"></a>#&gt;          dt_75     dt_76     dt_77    dt_78    dt_79    dt_80    dt_81
<a id="cb14-11"></a>#&gt; Est  -0.007759 -0.008248 -0.004296 0.002356 0.004370 0.008246 0.004164
<a id="cb14-12"></a>#&gt; s.e.  0.002306  0.002544  0.002718 0.002820 0.002753 0.002959 0.002992
<a id="cb14-13"></a>#&gt;          dt_82     dt_83    dt_84    dt_85    dt_86     dt_87     vala
<a id="cb14-14"></a>#&gt; Est  -0.005294 -0.010040 0.006864 0.009740 0.007027 0.0004091 0.008334
<a id="cb14-15"></a>#&gt; s.e.  0.002664  0.002678 0.003092 0.003207 0.003069 0.0030080 0.001259
<a id="cb14-16"></a>#&gt;          debta     cfa    sales
<a id="cb14-17"></a>#&gt; Est  -0.016380 0.06506 0.007957
<a id="cb14-18"></a>#&gt; s.e.  0.005725 0.01079 0.002412
<a id="cb14-19"></a>#&gt; ---------------------------------------------------------------------------
<a id="cb14-20"></a>#&gt; Estimated standard deviation of the residuals is 0.04375
<a id="cb14-21"></a>#&gt; ***************************************************************************
<a id="cb14-22"></a>#&gt; ###########################################################################</code></pre> 
  <h3>评估</h3> 
  <p>可以基于估计的模型进行评估测试</p> 
  <p>&nbsp;</p> 
  <p>请注意，在“EvalTest”中，每次只有一个转换变量用于无剩余非线性测试。这与“LinTest”函数不同，后者可以采用多个转换变量。这就是为什么我将结果保存到新的PSTR对象“pstr1”而不是覆盖的原因。通过这样做，我可以在新对象中保存来自不同转换变量的更多测试结果。</p> 
  <pre>
<code><a id="cb16-1"></a>iB = 5000
<a id="cb16-2"></a>cpus = 50
<a id="cb16-3"></a>
<a id="cb16-4"></a>## wild bootstrap time-varyint evaluation test 
<a id="cb16-5"></a>pstr = WCB_TVTest(use=pstr,iB=iB,parallel=T,cpus=cpus)
<a id="cb16-6"></a>
<a id="cb16-7"></a>## wild bootstrap heterogeneity evaluation test
<a id="cb16-8"></a>pstr1 = WCB_HETest(use=pstr1,vq=pstr$mQ[,1],iB=iB,parallel=T,cpus=cpus)</code></pre> 
  <p>请注意，评估函数不接受线性面板回归模型中返回的对象“pstr0”，因为评估测试是针对估计的PSTR模型设计的，而不是线性模型。</p> 
  <h3>绘制</h3> 
  <p>估算PSTR模型后，您可以通过运行绘制估计的过渡函数</p> 
  <p>&nbsp;</p> 
  <p><img alt="" class="has" height="288" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190618181837765.png" width="288"></p> 
  <p>&nbsp;</p> 
  <p><img alt="" class="has" height="288" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190618181837868.png" width="288"></p> 
  <p>您还可以根据转换变量绘制系数曲线，标准误差和p值。</p> 
  <p>&nbsp;</p> 
  <p><img alt="" class="has" height="288" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190618181837946.png" width="288"></p> 
  <p>绘图功能<code>plot_response</code>，描述了其中我称为响应，一些解释性变量和过渡可变在PSTR模型。</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;我们可以看到，如果没有非线性，对变量的响应是一条直线。如果变量和转换变量是不同的，我们可以绘制曲面，z轴为响应，x轴和y轴为两个变量。如果变量和转换变量相同，则变为曲线。X我Ťxitq我ŤqitX我Ťxitq我Ťqit</p> 
  <p>我们通过运行来制作图表</p> 
  <p>&nbsp;</p> 
  <p><img alt="" class="has" height="288" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190618181837939.png" width="288"></p> 
  <p>x轴上的数字看起来不太好，因为很难找到转折点的位置。</p> 
  <p>该<code>ggplot2</code>软件包允许我们手动绘制数字（PSTR包与一些预先包装的软件包很好地协作），甚至是x轴上的标签（以及更多）。</p> 
  <p>&nbsp;</p> 
  <p><img alt="" class="has" height="288" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190618181837938.png" width="288"></p> 
  <p>现在我们非常清楚地看到，大约0.5的转折点将曲线切割成两种状态，并且两种状态的行为完全不同。该图表是关于托宾Q对预期投资的贡献滞后。低Q值公司（其潜力被金融市场评估为低）看起来不太愿意改变他们未来的投资计划，或者可能会改变。</p> 
  <p>&nbsp;&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
