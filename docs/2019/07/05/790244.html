<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 刚开始学习机器学习，学习的视频教程是coursera网站上吴恩达（Andrew Ng）教授的机器学习课程。 在此梳理并记录总结笔记，供学习交流，欢迎批评指正！ 文章目录 机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 怎么利用神经网络解决某个问题？（经验） 误差分析 学习曲线 类偏斜（skewed class）误差分析 代码 参考 怎么利用神经网络解决某个问题？（经验） 考虑一个简单的算法快速实现功能 误差分析（进而下一步完善改进算法） 可以通过控制变量，比如有无如下特征，看误差分析结果来判断等等 偏斜类问题误差分析 误差分析 误差分析用于评价假设的好坏，根据得到的结果改进算法 将数据分为训练集(training sets)，交叉验证集(cross validation sets)和测试集(testing sets )， 建议分配比例为60%，20%，20% 通过训练集训练得到参数 θ \theta θ或者说模型，训练集误差为对应代价函数的值 e r r o r _ t r a i n = J ( θ ) error\_train=J(\theta) error_train=J(θ) 将得到的参数对交叉验证集计算交叉验证误差， 即对应代价函数的值 e r r o r _ c v = J ( θ ) error\_cv=J(\theta) error_cv=J(θ) 将得到的参数对测试集计算推广误差，即对应代价函数的值 e r r o r _ t e s t = J ( θ ) error\_test=J(\theta) error_test=J(θ) 对应公式分别为： J t r a i n ( θ ) = 1 2 m ∑ i = 1 m ( h θ ( x i ) − y ( i ) ) 2 + λ 2 m ∑ i = 1 m θ j 2 J_{train}(\theta)=\frac{1}{2m}\sum_{i=1}^m(h_\theta(x^{{i}})-y^{(i)})^2+\frac{\lambda}{2m}\sum_{i=1}^m\theta_j^2 Jtrain​(θ)=2m1​∑i=1m​(hθ​(xi)−y(i))2+2mλ​∑i=1m​θj2​ J c v ( θ ) = 1 2 m c v ∑ i = 1 m c v ( h θ ( x c v i ) − y c v ( i ) ) 2 J_{cv}(\theta)=\frac{1}{2m_{cv}}\sum_{i=1}^{m_{cv}}(h_\theta(x_{cv}^{{i}})-y_{cv}^{(i)})^2 Jcv​(θ)=2mcv​1​∑i=1mcv​​(hθ​(xcvi​)−ycv(i)​)2 J t e s t ( θ ) = 1 2 m t e s t ∑ i = 1 m t e s t ( h θ ( x t e s t i ) − y t e s t ( i ) ) 2 J_{test}(\theta)=\frac{1}{2m_{test}}\sum_{i=1}^{m_{test}}(h_\theta(x_{test}^{{i}})-y_{test}^{(i)})^2 Jtest​(θ)=2mtest​1​∑i=1mtest​​(hθ​(xtesti​)−ytest(i)​)2 算法表现的不理想，一般有两种情况： 高偏差(high bias)和高方差(high variance)，分别对应了欠拟合和过拟合情况 用以上误差可以诊断到底是高偏差还是高方差，怎么改进 学习曲线 将训练集和交叉验证集得到的误差作为训练集样本数（m）的函数绘制成图 高偏差情况，提高样本数，帮助不大 高方差情况，提高样本数，有帮助 将训练集和交叉验证集得到的误差作为拟合的多项式最高次数（d）的函数绘制成图 拟合的多项式最高次数越小，对应欠拟合，高偏差 拟合的多项式最高次数越大，对应过拟合，高方差 训练集误差与交叉验证误差集接近，对应高偏差 训练集误差很小，交叉验证集误差远大于训练集误差，对应高方差 当交叉验证集误差最小时，是“just right”模型，为此，高偏差要提高d，高方差要降低d 将训练集和交叉验证集得到的误差作为正则化参数 λ \lambda λ的函数绘制成图 λ \lambda λ越小，对应过拟合，高方差 λ \lambda λ越大，对应欠拟合，高偏差 当交叉验证集误差最小时，是“just right”模型，高方差要提高 λ \lambda λ，高偏差要降低 λ \lambda λ 总结 解决高偏差问题 解决高方差问题 降低 λ \lambda λ 提高 λ \lambda λ 提高特征数 降低特征数 增加d 增加训练集样本数 类偏斜（skewed class）误差分析 当训练集某一类占的比例特别大时。 如，分类问题，恶性肿瘤还是良性。样本可能99%都为良性。 在这种情况下，讲所占比例较小的恶性肿瘤设置为y=1，良性为y=0 讲算法预测分为四种： 正确肯定（True positive)：预测为真，实际也为真 正确否定（True negative)：预测为假，实际也为假 错误肯定（False positive）: 预测为真，实际为假 不是恶性肿瘤，预测为恶性肿瘤 错误否定（False negative）: 预测为假，实际为真是恶性肿瘤，预测不是恶性肿瘤 查准率（Precision P）预测有恶性肿瘤的人中，真实有恶性肿瘤的人越多越好 P = T P T P + F P P=\frac{TP}{TP+FP} P=TP+FPTP​ 预测值positive全是预测有恶性肿瘤的 查全率（recall R）真实有恶性肿瘤的人，预测有恶性肿瘤的人越多越好 R = T P T P + T N R=\frac{TP}{TP+TN} R=TP+TNTP​ 实际值为positive全是真实有恶性肿瘤的 在此问题中，希望高查准率，可以使用h&gt;0.7,0.8而不是0.5 则y=1 希望高查全率，可以使用h&gt;0.3,则y=1 查准率与查全率的权衡，F1 score F 1 = 2 P R P + R F1=\frac{2PR}{P+R} F1=P+R2PR​ 代码 实现学习曲线, 展示函数 python import numpy as np import scipy.io as sio import scipy.optimize as opt import pandas as pd import matplotlib.pyplot as plt import seaborn as sns def load_data(): &quot;&quot;&quot;loading data&quot;&quot;&quot; d=sio.loadmat(&#39;ex5data1.mat&#39;) return map(np.ravel,[d[&#39;X&#39;],d[&#39;y&#39;],d[&#39;Xval&#39;],d[&#39;yval&#39;],d[&#39;Xtest&#39;],d[&#39;ytest&#39;]]) def cost(theta,X,y,l): &quot;&quot;&quot;compute cost function&quot;&quot;&quot; m=X.shape[0] theta_1=theta[1:] inner=X@theta-y print() cost=inner.T@inner/(2*m)+l/(2*m)*np.power(theta_1,2).sum() return cost def grad(theta,X,y,l): &quot;&quot;&quot;compute gradient of cost function&quot;&quot;&quot; m=X.shape[0] theta_1=theta.copy() theta_1[1]=0 grad=X.T@(X@theta-y)/m+l/m*theta_1 return grad def linear_regression_np(theta,X,y,l): &quot;&quot;&quot;minimize cost function&quot;&quot;&quot; res=opt.minimize(fun=cost,x0=theta,args=(X,y,l),method=&#39;TNC&#39;,jac=grad,options={&#39;disp&#39;:True}) return res def learningcurve(theta,X,y,Xval,yval,l): &quot;&quot;&quot;error_train/error_cv vesus m&quot;&quot;&quot; m=X.shape[0] error_train=[] error_cv=[] for i in range(1,m+1): res=linear_regression_np(theta,X[:i,:],y[:i],l).get(&#39;x&#39;) err_train=cost(res,X[:i,:],y[:i],0) err_cv=cost(res,Xval,yval,0) error_train.append(err_train) error_cv.append(err_cv) return error_train,error_cv def prepare_poly_data(x, power): &quot;&quot;&quot;poly degree &quot;&quot;&quot; df=poly_features(x,power) ndarr=normalize_feature(df) ndarr[:,0]=1 return ndarr def poly_features(x, power, as_ndarray=False): df=np.zeros((x.shape[0],power+1)) for i in range(1,power+1): df[:,i]=np.power(x,i); return df def normalize_feature(df): for i in range(1,df.shape[1]): df[:,i]=(df[:,i]-df[:,i].mean())/df[:,i].std() return df def learningcurve_lambda(theta,X,y,Xval,yval): &quot;&quot;&quot; err_train err_cv vesus lambda &quot;&quot;&quot; l_var=np.array([0,0.001,0.003,0.01,0.03,0.1,0.3,1,3,10]) error_train=[] error_cv=[] for i in range(l_var.shape[0]): res=linear_regression_np(theta,X,y,l_var[i]).get(&#39;x&#39;) err_train=cost(res,X,y,0) err_cv=cost(res,Xval,yval,0) error_train.append(err_train) error_cv.append(err_cv) return l_var,error_train,error_cv 参考 [1] 来自本课程课件和作业题，以及黄海广github上的中文笔记资料等" />
<meta property="og:description" content="机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 刚开始学习机器学习，学习的视频教程是coursera网站上吴恩达（Andrew Ng）教授的机器学习课程。 在此梳理并记录总结笔记，供学习交流，欢迎批评指正！ 文章目录 机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 怎么利用神经网络解决某个问题？（经验） 误差分析 学习曲线 类偏斜（skewed class）误差分析 代码 参考 怎么利用神经网络解决某个问题？（经验） 考虑一个简单的算法快速实现功能 误差分析（进而下一步完善改进算法） 可以通过控制变量，比如有无如下特征，看误差分析结果来判断等等 偏斜类问题误差分析 误差分析 误差分析用于评价假设的好坏，根据得到的结果改进算法 将数据分为训练集(training sets)，交叉验证集(cross validation sets)和测试集(testing sets )， 建议分配比例为60%，20%，20% 通过训练集训练得到参数 θ \theta θ或者说模型，训练集误差为对应代价函数的值 e r r o r _ t r a i n = J ( θ ) error\_train=J(\theta) error_train=J(θ) 将得到的参数对交叉验证集计算交叉验证误差， 即对应代价函数的值 e r r o r _ c v = J ( θ ) error\_cv=J(\theta) error_cv=J(θ) 将得到的参数对测试集计算推广误差，即对应代价函数的值 e r r o r _ t e s t = J ( θ ) error\_test=J(\theta) error_test=J(θ) 对应公式分别为： J t r a i n ( θ ) = 1 2 m ∑ i = 1 m ( h θ ( x i ) − y ( i ) ) 2 + λ 2 m ∑ i = 1 m θ j 2 J_{train}(\theta)=\frac{1}{2m}\sum_{i=1}^m(h_\theta(x^{{i}})-y^{(i)})^2+\frac{\lambda}{2m}\sum_{i=1}^m\theta_j^2 Jtrain​(θ)=2m1​∑i=1m​(hθ​(xi)−y(i))2+2mλ​∑i=1m​θj2​ J c v ( θ ) = 1 2 m c v ∑ i = 1 m c v ( h θ ( x c v i ) − y c v ( i ) ) 2 J_{cv}(\theta)=\frac{1}{2m_{cv}}\sum_{i=1}^{m_{cv}}(h_\theta(x_{cv}^{{i}})-y_{cv}^{(i)})^2 Jcv​(θ)=2mcv​1​∑i=1mcv​​(hθ​(xcvi​)−ycv(i)​)2 J t e s t ( θ ) = 1 2 m t e s t ∑ i = 1 m t e s t ( h θ ( x t e s t i ) − y t e s t ( i ) ) 2 J_{test}(\theta)=\frac{1}{2m_{test}}\sum_{i=1}^{m_{test}}(h_\theta(x_{test}^{{i}})-y_{test}^{(i)})^2 Jtest​(θ)=2mtest​1​∑i=1mtest​​(hθ​(xtesti​)−ytest(i)​)2 算法表现的不理想，一般有两种情况： 高偏差(high bias)和高方差(high variance)，分别对应了欠拟合和过拟合情况 用以上误差可以诊断到底是高偏差还是高方差，怎么改进 学习曲线 将训练集和交叉验证集得到的误差作为训练集样本数（m）的函数绘制成图 高偏差情况，提高样本数，帮助不大 高方差情况，提高样本数，有帮助 将训练集和交叉验证集得到的误差作为拟合的多项式最高次数（d）的函数绘制成图 拟合的多项式最高次数越小，对应欠拟合，高偏差 拟合的多项式最高次数越大，对应过拟合，高方差 训练集误差与交叉验证误差集接近，对应高偏差 训练集误差很小，交叉验证集误差远大于训练集误差，对应高方差 当交叉验证集误差最小时，是“just right”模型，为此，高偏差要提高d，高方差要降低d 将训练集和交叉验证集得到的误差作为正则化参数 λ \lambda λ的函数绘制成图 λ \lambda λ越小，对应过拟合，高方差 λ \lambda λ越大，对应欠拟合，高偏差 当交叉验证集误差最小时，是“just right”模型，高方差要提高 λ \lambda λ，高偏差要降低 λ \lambda λ 总结 解决高偏差问题 解决高方差问题 降低 λ \lambda λ 提高 λ \lambda λ 提高特征数 降低特征数 增加d 增加训练集样本数 类偏斜（skewed class）误差分析 当训练集某一类占的比例特别大时。 如，分类问题，恶性肿瘤还是良性。样本可能99%都为良性。 在这种情况下，讲所占比例较小的恶性肿瘤设置为y=1，良性为y=0 讲算法预测分为四种： 正确肯定（True positive)：预测为真，实际也为真 正确否定（True negative)：预测为假，实际也为假 错误肯定（False positive）: 预测为真，实际为假 不是恶性肿瘤，预测为恶性肿瘤 错误否定（False negative）: 预测为假，实际为真是恶性肿瘤，预测不是恶性肿瘤 查准率（Precision P）预测有恶性肿瘤的人中，真实有恶性肿瘤的人越多越好 P = T P T P + F P P=\frac{TP}{TP+FP} P=TP+FPTP​ 预测值positive全是预测有恶性肿瘤的 查全率（recall R）真实有恶性肿瘤的人，预测有恶性肿瘤的人越多越好 R = T P T P + T N R=\frac{TP}{TP+TN} R=TP+TNTP​ 实际值为positive全是真实有恶性肿瘤的 在此问题中，希望高查准率，可以使用h&gt;0.7,0.8而不是0.5 则y=1 希望高查全率，可以使用h&gt;0.3,则y=1 查准率与查全率的权衡，F1 score F 1 = 2 P R P + R F1=\frac{2PR}{P+R} F1=P+R2PR​ 代码 实现学习曲线, 展示函数 python import numpy as np import scipy.io as sio import scipy.optimize as opt import pandas as pd import matplotlib.pyplot as plt import seaborn as sns def load_data(): &quot;&quot;&quot;loading data&quot;&quot;&quot; d=sio.loadmat(&#39;ex5data1.mat&#39;) return map(np.ravel,[d[&#39;X&#39;],d[&#39;y&#39;],d[&#39;Xval&#39;],d[&#39;yval&#39;],d[&#39;Xtest&#39;],d[&#39;ytest&#39;]]) def cost(theta,X,y,l): &quot;&quot;&quot;compute cost function&quot;&quot;&quot; m=X.shape[0] theta_1=theta[1:] inner=X@theta-y print() cost=inner.T@inner/(2*m)+l/(2*m)*np.power(theta_1,2).sum() return cost def grad(theta,X,y,l): &quot;&quot;&quot;compute gradient of cost function&quot;&quot;&quot; m=X.shape[0] theta_1=theta.copy() theta_1[1]=0 grad=X.T@(X@theta-y)/m+l/m*theta_1 return grad def linear_regression_np(theta,X,y,l): &quot;&quot;&quot;minimize cost function&quot;&quot;&quot; res=opt.minimize(fun=cost,x0=theta,args=(X,y,l),method=&#39;TNC&#39;,jac=grad,options={&#39;disp&#39;:True}) return res def learningcurve(theta,X,y,Xval,yval,l): &quot;&quot;&quot;error_train/error_cv vesus m&quot;&quot;&quot; m=X.shape[0] error_train=[] error_cv=[] for i in range(1,m+1): res=linear_regression_np(theta,X[:i,:],y[:i],l).get(&#39;x&#39;) err_train=cost(res,X[:i,:],y[:i],0) err_cv=cost(res,Xval,yval,0) error_train.append(err_train) error_cv.append(err_cv) return error_train,error_cv def prepare_poly_data(x, power): &quot;&quot;&quot;poly degree &quot;&quot;&quot; df=poly_features(x,power) ndarr=normalize_feature(df) ndarr[:,0]=1 return ndarr def poly_features(x, power, as_ndarray=False): df=np.zeros((x.shape[0],power+1)) for i in range(1,power+1): df[:,i]=np.power(x,i); return df def normalize_feature(df): for i in range(1,df.shape[1]): df[:,i]=(df[:,i]-df[:,i].mean())/df[:,i].std() return df def learningcurve_lambda(theta,X,y,Xval,yval): &quot;&quot;&quot; err_train err_cv vesus lambda &quot;&quot;&quot; l_var=np.array([0,0.001,0.003,0.01,0.03,0.1,0.3,1,3,10]) error_train=[] error_cv=[] for i in range(l_var.shape[0]): res=linear_regression_np(theta,X,y,l_var[i]).get(&#39;x&#39;) err_train=cost(res,X,y,0) err_cv=cost(res,Xval,yval,0) error_train.append(err_train) error_cv.append(err_cv) return l_var,error_train,error_cv 参考 [1] 来自本课程课件和作业题，以及黄海广github上的中文笔记资料等" />
<link rel="canonical" href="https://uzzz.org/2019/07/05/790244.html" />
<meta property="og:url" content="https://uzzz.org/2019/07/05/790244.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-07-05T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 刚开始学习机器学习，学习的视频教程是coursera网站上吴恩达（Andrew Ng）教授的机器学习课程。 在此梳理并记录总结笔记，供学习交流，欢迎批评指正！ 文章目录 机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价 怎么利用神经网络解决某个问题？（经验） 误差分析 学习曲线 类偏斜（skewed class）误差分析 代码 参考 怎么利用神经网络解决某个问题？（经验） 考虑一个简单的算法快速实现功能 误差分析（进而下一步完善改进算法） 可以通过控制变量，比如有无如下特征，看误差分析结果来判断等等 偏斜类问题误差分析 误差分析 误差分析用于评价假设的好坏，根据得到的结果改进算法 将数据分为训练集(training sets)，交叉验证集(cross validation sets)和测试集(testing sets )， 建议分配比例为60%，20%，20% 通过训练集训练得到参数 θ \\theta θ或者说模型，训练集误差为对应代价函数的值 e r r o r _ t r a i n = J ( θ ) error\\_train=J(\\theta) error_train=J(θ) 将得到的参数对交叉验证集计算交叉验证误差， 即对应代价函数的值 e r r o r _ c v = J ( θ ) error\\_cv=J(\\theta) error_cv=J(θ) 将得到的参数对测试集计算推广误差，即对应代价函数的值 e r r o r _ t e s t = J ( θ ) error\\_test=J(\\theta) error_test=J(θ) 对应公式分别为： J t r a i n ( θ ) = 1 2 m ∑ i = 1 m ( h θ ( x i ) − y ( i ) ) 2 + λ 2 m ∑ i = 1 m θ j 2 J_{train}(\\theta)=\\frac{1}{2m}\\sum_{i=1}^m(h_\\theta(x^{{i}})-y^{(i)})^2+\\frac{\\lambda}{2m}\\sum_{i=1}^m\\theta_j^2 Jtrain​(θ)=2m1​∑i=1m​(hθ​(xi)−y(i))2+2mλ​∑i=1m​θj2​ J c v ( θ ) = 1 2 m c v ∑ i = 1 m c v ( h θ ( x c v i ) − y c v ( i ) ) 2 J_{cv}(\\theta)=\\frac{1}{2m_{cv}}\\sum_{i=1}^{m_{cv}}(h_\\theta(x_{cv}^{{i}})-y_{cv}^{(i)})^2 Jcv​(θ)=2mcv​1​∑i=1mcv​​(hθ​(xcvi​)−ycv(i)​)2 J t e s t ( θ ) = 1 2 m t e s t ∑ i = 1 m t e s t ( h θ ( x t e s t i ) − y t e s t ( i ) ) 2 J_{test}(\\theta)=\\frac{1}{2m_{test}}\\sum_{i=1}^{m_{test}}(h_\\theta(x_{test}^{{i}})-y_{test}^{(i)})^2 Jtest​(θ)=2mtest​1​∑i=1mtest​​(hθ​(xtesti​)−ytest(i)​)2 算法表现的不理想，一般有两种情况： 高偏差(high bias)和高方差(high variance)，分别对应了欠拟合和过拟合情况 用以上误差可以诊断到底是高偏差还是高方差，怎么改进 学习曲线 将训练集和交叉验证集得到的误差作为训练集样本数（m）的函数绘制成图 高偏差情况，提高样本数，帮助不大 高方差情况，提高样本数，有帮助 将训练集和交叉验证集得到的误差作为拟合的多项式最高次数（d）的函数绘制成图 拟合的多项式最高次数越小，对应欠拟合，高偏差 拟合的多项式最高次数越大，对应过拟合，高方差 训练集误差与交叉验证误差集接近，对应高偏差 训练集误差很小，交叉验证集误差远大于训练集误差，对应高方差 当交叉验证集误差最小时，是“just right”模型，为此，高偏差要提高d，高方差要降低d 将训练集和交叉验证集得到的误差作为正则化参数 λ \\lambda λ的函数绘制成图 λ \\lambda λ越小，对应过拟合，高方差 λ \\lambda λ越大，对应欠拟合，高偏差 当交叉验证集误差最小时，是“just right”模型，高方差要提高 λ \\lambda λ，高偏差要降低 λ \\lambda λ 总结 解决高偏差问题 解决高方差问题 降低 λ \\lambda λ 提高 λ \\lambda λ 提高特征数 降低特征数 增加d 增加训练集样本数 类偏斜（skewed class）误差分析 当训练集某一类占的比例特别大时。 如，分类问题，恶性肿瘤还是良性。样本可能99%都为良性。 在这种情况下，讲所占比例较小的恶性肿瘤设置为y=1，良性为y=0 讲算法预测分为四种： 正确肯定（True positive)：预测为真，实际也为真 正确否定（True negative)：预测为假，实际也为假 错误肯定（False positive）: 预测为真，实际为假 不是恶性肿瘤，预测为恶性肿瘤 错误否定（False negative）: 预测为假，实际为真是恶性肿瘤，预测不是恶性肿瘤 查准率（Precision P）预测有恶性肿瘤的人中，真实有恶性肿瘤的人越多越好 P = T P T P + F P P=\\frac{TP}{TP+FP} P=TP+FPTP​ 预测值positive全是预测有恶性肿瘤的 查全率（recall R）真实有恶性肿瘤的人，预测有恶性肿瘤的人越多越好 R = T P T P + T N R=\\frac{TP}{TP+TN} R=TP+TNTP​ 实际值为positive全是真实有恶性肿瘤的 在此问题中，希望高查准率，可以使用h&gt;0.7,0.8而不是0.5 则y=1 希望高查全率，可以使用h&gt;0.3,则y=1 查准率与查全率的权衡，F1 score F 1 = 2 P R P + R F1=\\frac{2PR}{P+R} F1=P+R2PR​ 代码 实现学习曲线, 展示函数 python import numpy as np import scipy.io as sio import scipy.optimize as opt import pandas as pd import matplotlib.pyplot as plt import seaborn as sns def load_data(): &quot;&quot;&quot;loading data&quot;&quot;&quot; d=sio.loadmat(&#39;ex5data1.mat&#39;) return map(np.ravel,[d[&#39;X&#39;],d[&#39;y&#39;],d[&#39;Xval&#39;],d[&#39;yval&#39;],d[&#39;Xtest&#39;],d[&#39;ytest&#39;]]) def cost(theta,X,y,l): &quot;&quot;&quot;compute cost function&quot;&quot;&quot; m=X.shape[0] theta_1=theta[1:] inner=X@theta-y print() cost=inner.T@inner/(2*m)+l/(2*m)*np.power(theta_1,2).sum() return cost def grad(theta,X,y,l): &quot;&quot;&quot;compute gradient of cost function&quot;&quot;&quot; m=X.shape[0] theta_1=theta.copy() theta_1[1]=0 grad=X.T@(X@theta-y)/m+l/m*theta_1 return grad def linear_regression_np(theta,X,y,l): &quot;&quot;&quot;minimize cost function&quot;&quot;&quot; res=opt.minimize(fun=cost,x0=theta,args=(X,y,l),method=&#39;TNC&#39;,jac=grad,options={&#39;disp&#39;:True}) return res def learningcurve(theta,X,y,Xval,yval,l): &quot;&quot;&quot;error_train/error_cv vesus m&quot;&quot;&quot; m=X.shape[0] error_train=[] error_cv=[] for i in range(1,m+1): res=linear_regression_np(theta,X[:i,:],y[:i],l).get(&#39;x&#39;) err_train=cost(res,X[:i,:],y[:i],0) err_cv=cost(res,Xval,yval,0) error_train.append(err_train) error_cv.append(err_cv) return error_train,error_cv def prepare_poly_data(x, power): &quot;&quot;&quot;poly degree &quot;&quot;&quot; df=poly_features(x,power) ndarr=normalize_feature(df) ndarr[:,0]=1 return ndarr def poly_features(x, power, as_ndarray=False): df=np.zeros((x.shape[0],power+1)) for i in range(1,power+1): df[:,i]=np.power(x,i); return df def normalize_feature(df): for i in range(1,df.shape[1]): df[:,i]=(df[:,i]-df[:,i].mean())/df[:,i].std() return df def learningcurve_lambda(theta,X,y,Xval,yval): &quot;&quot;&quot; err_train err_cv vesus lambda &quot;&quot;&quot; l_var=np.array([0,0.001,0.003,0.01,0.03,0.1,0.3,1,3,10]) error_train=[] error_cv=[] for i in range(l_var.shape[0]): res=linear_regression_np(theta,X,y,l_var[i]).get(&#39;x&#39;) err_train=cost(res,X,y,0) err_cv=cost(res,Xval,yval,0) error_train.append(err_train) error_cv.append(err_cv) return l_var,error_train,error_cv 参考 [1] 来自本课程课件和作业题，以及黄海广github上的中文笔记资料等","@type":"BlogPosting","url":"https://uzzz.org/2019/07/05/790244.html","headline":"机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价","dateModified":"2019-07-05T00:00:00+08:00","datePublished":"2019-07-05T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/07/05/790244.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix" data-track-view="{&quot;mod&quot;:&quot;popu_307&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/hyfariel/article/details/94736434,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_307&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/hyfariel/article/details/94736434&quot;}"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-cd6c485e8b.css"> 
 <div id="content_views" class="markdown_views prism-github-gist"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <h1><a id="_2014_43__0"></a>机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价</h1> 
  <p>刚开始学习机器学习，学习的视频教程是coursera网站上吴恩达（Andrew Ng）教授的机器学习课程。<br> 在此梳理并记录总结笔记，供学习交流，欢迎批评指正！<br> </p>
  <div class="toc">
   <h3>文章目录</h3>
   <ul>
    <li><a href="#_2014_43__0" rel="nofollow">机器学习 2014斯坦福大学课程: 4-3 神经网络设计及评价</a></li>
    <ul>
     <li><a href="#_5" rel="nofollow">怎么利用神经网络解决某个问题？（经验）</a></li>
     <li><a href="#_12" rel="nofollow">误差分析</a></li>
     <li><a href="#_30" rel="nofollow">学习曲线</a></li>
     <li><a href="#skewed_class_57" rel="nofollow">类偏斜（skewed class）误差分析</a></li>
     <li><a href="#_76" rel="nofollow">代码</a></li>
     <li><a href="#_150" rel="nofollow">参考</a></li>
    </ul>
   </ul>
  </div>
  <p></p> 
  <h2><a id="_5"></a>怎么利用神经网络解决某个问题？（经验）</h2> 
  <ol> 
   <li>考虑一个简单的算法快速实现功能</li> 
   <li>误差分析（进而下一步完善改进算法）</li> 
   <li>可以通过控制变量，比如有无如下特征，看误差分析结果来判断等等</li> 
   <li>偏斜类问题误差分析</li> 
  </ol> 
  <h2><a id="_12"></a>误差分析</h2> 
  <p><strong>误差分析用于评价假设的好坏，根据得到的结果改进算法</strong></p> 
  <ol> 
   <li> <p>将数据分为训练集(training sets)，交叉验证集(cross validation sets)和测试集(testing sets )，<br> 建议分配比例为60%，20%，20%</p> </li> 
   <li> <p>通过训练集训练得到参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            θ
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           \theta
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span>或者说模型，训练集误差为对应代价函数的值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            e
           </mi>
           <mi>
            r
           </mi>
           <mi>
            r
           </mi>
           <mi>
            o
           </mi>
           <mi>
            r
           </mi>
           <mi mathvariant="normal">
            _
           </mi>
           <mi>
            t
           </mi>
           <mi>
            r
           </mi>
           <mi>
            a
           </mi>
           <mi>
            i
           </mi>
           <mi>
            n
           </mi>
           <mo>
            =
           </mo>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           error\_train=J(\theta)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9695199999999999em; vertical-align: -0.31em;"></span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></p> </li> 
   <li> <p>将得到的参数对交叉验证集计算交叉验证误差， 即对应代价函数的值<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            e
           </mi>
           <mi>
            r
           </mi>
           <mi>
            r
           </mi>
           <mi>
            o
           </mi>
           <mi>
            r
           </mi>
           <mi mathvariant="normal">
            _
           </mi>
           <mi>
            c
           </mi>
           <mi>
            v
           </mi>
           <mo>
            =
           </mo>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           error\_cv=J(\theta)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.74056em; vertical-align: -0.31em;"></span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></p> </li> 
   <li> <p>将得到的参数对测试集计算推广误差，即对应代价函数的值<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            e
           </mi>
           <mi>
            r
           </mi>
           <mi>
            r
           </mi>
           <mi>
            o
           </mi>
           <mi>
            r
           </mi>
           <mi mathvariant="normal">
            _
           </mi>
           <mi>
            t
           </mi>
           <mi>
            e
           </mi>
           <mi>
            s
           </mi>
           <mi>
            t
           </mi>
           <mo>
            =
           </mo>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           error\_test=J(\theta)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9250799999999999em; vertical-align: -0.31em;"></span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></p> <p>对应公式分别为：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             J
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mi>
              r
             </mi>
             <mi>
              a
             </mi>
             <mi>
              i
             </mi>
             <mi>
              n
             </mi>
            </mrow>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mn>
             1
            </mn>
            <mrow>
             <mn>
              2
             </mn>
             <mi>
              m
             </mi>
            </mrow>
           </mfrac>
           <msubsup>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             m
            </mi>
           </msubsup>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             h
            </mi>
            <mi>
             θ
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <msup>
            <mi>
             y
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <msup>
            <mo>
             )
            </mo>
            <mn>
             2
            </mn>
           </msup>
           <mo>
            +
           </mo>
           <mfrac>
            <mi>
             λ
            </mi>
            <mrow>
             <mn>
              2
             </mn>
             <mi>
              m
             </mi>
            </mrow>
           </mfrac>
           <msubsup>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             m
            </mi>
           </msubsup>
           <msubsup>
            <mi>
             θ
            </mi>
            <mi>
             j
            </mi>
            <mn>
             2
            </mn>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           J_{train}(\theta)=\frac{1}{2m}\sum_{i=1}^m(h_\theta(x^{{i}})-y^{(i)})^2+\frac{\lambda}{2m}\sum_{i=1}^m\theta_j^2
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.31166399999999994em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.09618em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.190108em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.6550000000000002em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971000000000003em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.33610799999999996em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8879999999999999em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141079999999999em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1.27488em; vertical-align: -0.394772em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801079999999999em;"><span class="" style="top: -2.6550000000000002em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971000000000003em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8141079999999999em;"><span class="" style="top: -2.441336em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             J
            </mi>
            <mrow>
             <mi>
              c
             </mi>
             <mi>
              v
             </mi>
            </mrow>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mn>
             1
            </mn>
            <mrow>
             <mn>
              2
             </mn>
             <msub>
              <mi>
               m
              </mi>
              <mrow>
               <mi>
                c
               </mi>
               <mi>
                v
               </mi>
              </mrow>
             </msub>
            </mrow>
           </mfrac>
           <msubsup>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <msub>
             <mi>
              m
             </mi>
             <mrow>
              <mi>
               c
              </mi>
              <mi>
               v
              </mi>
             </mrow>
            </msub>
           </msubsup>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             h
            </mi>
            <mi>
             θ
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msubsup>
            <mi>
             x
            </mi>
            <mrow>
             <mi>
              c
             </mi>
             <mi>
              v
             </mi>
            </mrow>
            <mi>
             i
            </mi>
           </msubsup>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <msubsup>
            <mi>
             y
            </mi>
            <mrow>
             <mi>
              c
             </mi>
             <mi>
              v
             </mi>
            </mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
           <msup>
            <mo>
             )
            </mo>
            <mn>
             2
            </mn>
           </msup>
          </mrow>
          <annotation encoding="application/x-tex">
           J_{cv}(\theta)=\frac{1}{2m_{cv}}\sum_{i=1}^{m_{cv}}(h_\theta(x_{cv}^{{i}})-y_{cv}^{(i)})^2
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.09618em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.2902079999999998em; vertical-align: -0.44509999999999994em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.16454285714285719em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.44509999999999994em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.16454285714285719em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971000000000003em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.33610799999999996em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.4530000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1.2948em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.5834080000000004em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.11659199999999997em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141079999999999em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             J
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mi>
              e
             </mi>
             <mi>
              s
             </mi>
             <mi>
              t
             </mi>
            </mrow>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mn>
             1
            </mn>
            <mrow>
             <mn>
              2
             </mn>
             <msub>
              <mi>
               m
              </mi>
              <mrow>
               <mi>
                t
               </mi>
               <mi>
                e
               </mi>
               <mi>
                s
               </mi>
               <mi>
                t
               </mi>
              </mrow>
             </msub>
            </mrow>
           </mfrac>
           <msubsup>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <msub>
             <mi>
              m
             </mi>
             <mrow>
              <mi>
               t
              </mi>
              <mi>
               e
              </mi>
              <mi>
               s
              </mi>
              <mi>
               t
              </mi>
             </mrow>
            </msub>
           </msubsup>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             h
            </mi>
            <mi>
             θ
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msubsup>
            <mi>
             x
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mi>
              e
             </mi>
             <mi>
              s
             </mi>
             <mi>
              t
             </mi>
            </mrow>
            <mi>
             i
            </mi>
           </msubsup>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <msubsup>
            <mi>
             y
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mi>
              e
             </mi>
             <mi>
              s
             </mi>
             <mi>
              t
             </mi>
            </mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
           <msup>
            <mo>
             )
            </mo>
            <mn>
             2
            </mn>
           </msup>
          </mrow>
          <annotation encoding="application/x-tex">
           J_{test}(\theta)=\frac{1}{2m_{test}}\sum_{i=1}^{m_{test}}(h_\theta(x_{test}^{{i}})-y_{test}^{(i)})^2
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2805559999999999em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.09618em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.2902079999999998em; vertical-align: -0.44509999999999994em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.29634285714285713em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.44509999999999994em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.29634285714285713em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.07142857142857144em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971000000000003em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.33610799999999996em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.4530000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">t</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1.2948em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.454244em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">t</span></span></span></span><span class="" style="top: -3.2197999999999998em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24575599999999992em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141079999999999em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p> </li> 
  </ol> 
  <p>算法表现的不理想，一般有两种情况：<br> 高偏差(high bias)和高方差(high variance)，分别对应了欠拟合和过拟合情况<br> 用以上误差可以诊断到底是高偏差还是高方差，怎么改进</p> 
  <h2><a id="_30"></a>学习曲线</h2> 
  <ol> 
   <li>将训练集和交叉验证集得到的误差作为训练集样本数（m）的函数绘制成图<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705112149357.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705111459332.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70#pic_left" alt="在这里插入图片描述" width="400" height="300"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705111520901.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70#pic_left" alt="在这里插入图片描述" width="400" height="300"><br> 高偏差情况，提高样本数，帮助不大<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705111557622.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70#pic_left" alt="在这里插入图片描述" width="400" height="300"><br> 高方差情况，提高样本数，有帮助</li> 
   <li>将训练集和交叉验证集得到的误差作为拟合的多项式最高次数（d）的函数绘制成图<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705110652535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70#pic_left" alt="在这里插入图片描述" width="500" height="150"><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705105632718.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70#pic_left" alt="在这里插入图片描述" width="350" height="300"><br> 拟合的多项式最高次数越小，对应欠拟合，高偏差<br> 拟合的多项式最高次数越大，对应过拟合，高方差<br> 训练集误差与交叉验证误差集接近，对应高偏差<br> 训练集误差很小，交叉验证集误差远大于训练集误差，对应高方差<br> 当交叉验证集误差最小时，是“just right”模型，为此，高偏差要提高d，高方差要降低d</li> 
   <li>将训练集和交叉验证集得到的误差作为正则化参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>的函数绘制成图<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705111119749.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70#pic_left" alt="在这里插入图片描述" width="350" height="300"><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>越小，对应过拟合，高方差<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>越大，对应欠拟合，高偏差<br> 当交叉验证集误差最小时，是“just right”模型，高方差要提高<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>，高偏差要降低<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span></li> 
  </ol> 
  <p><code>总结</code></p> 
  <table> 
   <thead> 
    <tr> 
     <th>解决高偏差问题</th> 
     <th>解决高方差问题</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>降低<span class="katex--inline"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <mi>
             λ
            </mi>
           </mrow>
           <annotation encoding="application/x-tex">
            \lambda
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span></td> 
     <td>提高<span class="katex--inline"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <mi>
             λ
            </mi>
           </mrow>
           <annotation encoding="application/x-tex">
            \lambda
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span></td> 
    </tr> 
    <tr> 
     <td>提高特征数</td> 
     <td>降低特征数</td> 
    </tr> 
    <tr> 
     <td>增加d</td> 
     <td>增加训练集样本数</td> 
    </tr> 
   </tbody> 
  </table>
  <h2><a id="skewed_class_57"></a>类偏斜（skewed class）误差分析</h2> 
  <p>当训练集某一类占的比例特别大时。<br> 如，分类问题，恶性肿瘤还是良性。样本可能99%都为良性。<br> 在这种情况下，讲所占比例较小的恶性肿瘤设置为y=1，良性为y=0<br> 讲算法预测分为四种：</p> 
  <ol> 
   <li>正确肯定（True positive)：预测为真，实际也为真</li> 
   <li>正确否定（True negative)：预测为假，实际也为假</li> 
   <li>错误肯定（False positive）: 预测为真，实际为假 不是恶性肿瘤，预测为恶性肿瘤</li> 
   <li>错误否定（False negative）: 预测为假，实际为真是恶性肿瘤，预测不是恶性肿瘤<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190705114237749.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h5ZmFyaWVs,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 查准率（Precision P）预测有恶性肿瘤的人中，真实有恶性肿瘤的人越多越好<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             T
            </mi>
            <mi>
             P
            </mi>
           </mrow>
           <mrow>
            <mi>
             T
            </mi>
            <mi>
             P
            </mi>
            <mo>
             +
            </mo>
            <mi>
             F
            </mi>
            <mi>
             P
            </mi>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          P=\frac{TP}{TP+FP}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.275662em; vertical-align: -0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.872331em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mbin mtight">+</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">F</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.403331em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> 预测值positive全是预测有恶性肿瘤的<br> 查全率（recall R）真实有恶性肿瘤的人，预测有恶性肿瘤的人越多越好<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           R
          </mi>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             T
            </mi>
            <mi>
             P
            </mi>
           </mrow>
           <mrow>
            <mi>
             T
            </mi>
            <mi>
             P
            </mi>
            <mo>
             +
            </mo>
            <mi>
             T
            </mi>
            <mi>
             N
            </mi>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          R=\frac{TP}{TP+TN}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1.275662em; vertical-align: -0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.872331em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mbin mtight">+</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.403331em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> 实际值为positive全是真实有恶性肿瘤的</li> 
  </ol> 
  <p>在此问题中，希望高查准率，可以使用h&gt;0.7,0.8而不是0.5 则y=1<br> 希望高查全率，可以使用h&gt;0.3,则y=1<br> 查准率与查全率的权衡，F1 score<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           F
          </mi>
          <mn>
           1
          </mn>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mn>
             2
            </mn>
            <mi>
             P
            </mi>
            <mi>
             R
            </mi>
           </mrow>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             +
            </mo>
            <mi>
             R
            </mi>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          F1=\frac{2PR}{P+R}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 2.1296600000000003em; vertical-align: -0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mord mathit" style="margin-right: 0.00773em;">R</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mord mathit" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693300000000001em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
  <h2><a id="_76"></a>代码</h2> 
  <p>实现学习曲线, 展示函数<br> python</p> 
  <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>io <span class="token keyword">as</span> sio
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">as</span> opt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""loading data"""</span>
    d<span class="token operator">=</span>sio<span class="token punctuation">.</span>loadmat<span class="token punctuation">(</span><span class="token string">'ex5data1.mat'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>ravel<span class="token punctuation">,</span><span class="token punctuation">[</span>d<span class="token punctuation">[</span><span class="token string">'X'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span><span class="token string">'Xval'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span><span class="token string">'yval'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span><span class="token string">'Xtest'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span><span class="token string">'ytest'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cost</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""compute cost function"""</span>
    m<span class="token operator">=</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    theta_1<span class="token operator">=</span>theta<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    inner<span class="token operator">=</span>X@theta<span class="token operator">-</span>y
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    cost<span class="token operator">=</span>inner<span class="token punctuation">.</span>T@inner<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>m<span class="token punctuation">)</span><span class="token operator">+</span>l<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>m<span class="token punctuation">)</span><span class="token operator">*</span>np<span class="token punctuation">.</span>power<span class="token punctuation">(</span>theta_1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> cost
<span class="token keyword">def</span> <span class="token function">grad</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""compute gradient of cost function"""</span>
    m<span class="token operator">=</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    theta_1<span class="token operator">=</span>theta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    theta_1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>
    grad<span class="token operator">=</span>X<span class="token punctuation">.</span>T@<span class="token punctuation">(</span>X@theta<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">/</span>m<span class="token operator">+</span>l<span class="token operator">/</span>m<span class="token operator">*</span>theta_1
    <span class="token keyword">return</span> grad
<span class="token keyword">def</span> <span class="token function">linear_regression_np</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""minimize cost function"""</span>
    res<span class="token operator">=</span>opt<span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>fun<span class="token operator">=</span>cost<span class="token punctuation">,</span>x0<span class="token operator">=</span>theta<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">'TNC'</span><span class="token punctuation">,</span>jac<span class="token operator">=</span>grad<span class="token punctuation">,</span>options<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'disp'</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res
<span class="token keyword">def</span> <span class="token function">learningcurve</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>Xval<span class="token punctuation">,</span>yval<span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""error_train/error_cv vesus m"""</span>
    m<span class="token operator">=</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    error_train<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    error_cv<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
           res<span class="token operator">=</span>linear_regression_np<span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
        err_train<span class="token operator">=</span>cost<span class="token punctuation">(</span>res<span class="token punctuation">,</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        err_cv<span class="token operator">=</span>cost<span class="token punctuation">(</span>res<span class="token punctuation">,</span>Xval<span class="token punctuation">,</span>yval<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        error_train<span class="token punctuation">.</span>append<span class="token punctuation">(</span>err_train<span class="token punctuation">)</span>
        error_cv<span class="token punctuation">.</span>append<span class="token punctuation">(</span>err_cv<span class="token punctuation">)</span>
    <span class="token keyword">return</span> error_train<span class="token punctuation">,</span>error_cv
<span class="token keyword">def</span> <span class="token function">prepare_poly_data</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> power<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""poly degree """</span>
    df<span class="token operator">=</span>poly_features<span class="token punctuation">(</span>x<span class="token punctuation">,</span>power<span class="token punctuation">)</span>
    ndarr<span class="token operator">=</span>normalize_feature<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
    ndarr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">return</span> ndarr
<span class="token keyword">def</span> <span class="token function">poly_features</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> power<span class="token punctuation">,</span> as_ndarray<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    df<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>power<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>power<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token operator">=</span>np<span class="token punctuation">.</span>power<span class="token punctuation">(</span>x<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> df
<span class="token keyword">def</span> <span class="token function">normalize_feature</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token operator">-</span>df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> df
<span class="token keyword">def</span> <span class="token function">learningcurve_lambda</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>Xval<span class="token punctuation">,</span>yval<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" err_train err_cv vesus lambda """</span>
    l_var<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">,</span><span class="token number">0.003</span><span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">,</span><span class="token number">0.03</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    error_train<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    error_cv<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l_var<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        res<span class="token operator">=</span>linear_regression_np<span class="token punctuation">(</span>theta<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>l_var<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
        err_train<span class="token operator">=</span>cost<span class="token punctuation">(</span>res<span class="token punctuation">,</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        err_cv<span class="token operator">=</span>cost<span class="token punctuation">(</span>res<span class="token punctuation">,</span>Xval<span class="token punctuation">,</span>yval<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        error_train<span class="token punctuation">.</span>append<span class="token punctuation">(</span>err_train<span class="token punctuation">)</span>
        error_cv<span class="token punctuation">.</span>append<span class="token punctuation">(</span>err_cv<span class="token punctuation">)</span>
    <span class="token keyword">return</span> l_var<span class="token punctuation">,</span>error_train<span class="token punctuation">,</span>error_cv
</code></pre> 
  <h2><a id="_150"></a>参考</h2> 
  <p>[1] 来自本课程课件和作业题，以及黄海广github上的中文笔记资料等</p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
