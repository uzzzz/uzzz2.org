<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>李宏毅 机器学习笔记-02 Regression | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="李宏毅 机器学习笔记-02 Regression" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Regression 回归 能够用线较为精确地描述数据之间的关系。这样当出现新的数据的时候，就能够预测出一个简单的值。回归中最常见的就是房价的问题。收集到的房屋面积和房价的数据，如下图所示： 在这种情况下，就可以利用回归模型构造出一条线来近似地描述房价与房屋面积之间的关系，从而就可以根据房屋面积推测出房价（这里也可以有多个标签，例如房间的个数，卧室的面积等）。 回归算法的输出是一个数值（标量）。例如我们想预测股市，输入到函数的就是过去的股市信息，得到预测值；无人驾驶系统我们是把车的各个传感器接收的信号作为输入，模型计算出方向盘的角度；在推荐系统中，输入的是消费者和某种商品，得到的是消费者购买的可能性，这样就可以挑选可能性高的几种商品进行推荐。 风靡全球的AR手游Pokemon Go想必大家都不陌生，回归算法的实例一就是根据神奇宝贝现有的参数，计算神奇宝贝升级后的CP值，让我们一起来看吧： 所以我们就是要找到一个function: input： x c p x_{cp} xcp​ - CP值， x s x_{s} xs​ - 神奇宝贝种类， x h p x_{hp} xhp​ - HP， x w x_{w} xw​ - Weight， x h x_{h} xh​ - Height，我们把这些的称为Feature output： y y y - 进化后的CP值。 这里的参数下标代表他的component（成分），上标代表object的编号。 在Introduction中，我们说过，做machine learning就是三个步骤： 找一个model（function set） 拿一个function看evaluate好坏 找到最好的function Step1:模型Model 模型指的是一组函数的集合(function set)，其中函数的输入是宝可梦的特征 x x x（各个参数），输出是宝可梦进化后的CP值( y y y)。 我们采用最简单的模型（线性模型），并且假设因变量只有一个，即宝可梦进化前的cp值，则表达式为 y = b + w ⋅ x c p y = b + w ⋅ x_{cp} y=b+w⋅xcp​。其中 w w w和 b b b均有无穷多种选择，所以函数空间中函数的取值（二元组）也为无穷多个。但是某些取值显然是不合理的，例如图中的 f 3 f_{3} f3​就是和进化前的 x c p x_{cp} xcp​成反比的。 对单变量模型进行泛化，生成多变量线性模型，表达式为 y = b + ∑ w i x i y = b + ∑ w_{i}x_{i} y=b+∑wi​xi​。其中 x i x_{i} xi​表示的是每个特征的取值， w i w_{i} wi​表示的是每个特征对应的权重， b b b表示的是偏置(bias)。 Step2:函数的评估标准 由于函数空间中函数数量众多，如果没有一个评估标准，我们则无法选择到最优函数。 这里的模型评估标准的作用对象是训练数据。即在函数空间中选择某一个函数，然后使用评估标准函数对预测后的结果进行评估，从而得到函数的优劣。 这里我们选取十对正确的数据，绘制在坐标系上。 y ^ \hat{y} y^​就是我们验证过的神奇宝贝进化后的CP，之后我们引出Loss fuction这个概念： 在机器学习中，评估标准的专业术语称为损失函数（Loss Function）或者目标函数。在线性回归中，使用的是平方误差或者均方误差来作为损失函数。 L ( f ) = L ( w , b ) = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) 2 L(f) = L(w,b) = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))^2 L(f)=L(w,b)=n=1∑10​(y^​n−(b+w⋅xcpn​))2 其中 y ^ \hat{y} y^​表示的是真实值，后者表示的是预测值。公式是对每个样本的误差求平方和。 拓展阅读：线性回归损失函数为什么要用平方形式 下图中使用等高线图表示出哪些函数区域的效果较好（上边误差较小），哪些函数区域的效果较差（下边误差较大）。 Step3:最优函数 从理论上来说，如果存在评估标准和函数空间，就可以使用穷举法选择出最优函数。但实际上来说，这是不可取的（宇宙毁灭之时也可能计算不完）。所以我们需要在有限时间内（而且不能太慢），求出最优函数。 我们把问题进行转化，把求最优函数问题转化为最优化问题。 求最优化问题有两种思路：一种是解析解，一种是使用梯度下降（迭代法）。课程只介绍了梯度下降法。 为什么能够使用梯度下降法？本质上是从微分的定义出发的。 Δ y = f ′ ( x 0 ) ⋅ Δ x \Delta{y} = f^\prime(x_0)\cdot\Delta x Δy=f′(x0​)⋅Δx Δ y = f ( x + x 0 ) − f ( x ) \Delta{y} = f(x + x_0) - f(x) Δy=f(x+x0​)−f(x) 如果导数为正、而且 Δ x \Delta x Δx为正，则 y y y就会增加。而我们要使 y y y减小，所以使得 y = y − f ′ ( x 0 ) ⋅ Δ x y = y - f^\prime(x_0)\cdot\Delta x y=y−f′(x0​)⋅Δx 注意上述公式是在 Δ x \Delta x Δx极其小的情况下才满足。在机器学习中，我们将 Δ x \Delta x Δx称作为学习率，一般取0.01或者0.001。 Gradient Descent 梯度下降 这里引入梯度下降的概念，他的作用就是快速帮我们找到Loss最小的点。 通俗的理解就是坐滑梯，在滑梯上坐下，自然就滑到底了。 数学理解就是，求微分。如果微分是负的那么就是左边高右边底，我们需要增大 w w w，就向右下降，我们现在来看具体一次下降多少： 现在我们位于 w 0 w^0 w0点，向下滑动的距离就是 学 习 率 η ⋅ w 0 点 的 微 分 学习率\eta \cdot w^0点的微分 学习率η⋅w0点的微分。由于微分是负的所以要减去这个负值来增大 w w w，反之亦然。 图中展示的是两次下降过程， w 0 w^0 w0到 w 1 w^1 w1， w 1 w^1 w1到 w 2 w^2 w2。上边我们提到通常学习率使我们设置的，例如0.001。微分的结果是跟曲线倾斜度相关的，越陡峭，微分越大，一次下降的越多，越平缓，微分越小，一次下降的越少。 w T w^T wT是Local minima局部最小，后面的是global minima全局最小。线性回归是一个凸函数，所以不用考虑局部最小，结果一定是线性最小。 我们知道，线性回归有两个参数， w w w和 b b b。那么两个参数是如何同时更新的呢？ 原来就是对function求偏微分，这样就可以分别更新两个参数了。如下图所示: 我们把单个参数推广到多个参数中。其中 ∇ L \nabla L ∇L指代的是梯度函数。 下图为梯度下降的直观图。 我们可以通过图像更好的理解下降的过程，我们可以看到，经过两次下降，Loss已经达到了很低的位置。 梯度下降存在的问题 1.局部最优化点。2.鞍点。 在这两种类型的点中，导数为0，则无法继续进行迭代，停留在当前点中。 线性回归的对应的偏微分： L ( w , b ) = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) 2 L(w,b) = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))^2 L(w,b)=n=1∑10​(y^​n−(b+w⋅xcpn​))2 ∂ L ∂ w = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) ( − x c p n ) \frac{\partial L}{\partial w} = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))(- x_{cp}^n) ∂w∂L​=n=1∑10​(y^​n−(b+w⋅xcpn​))(−xcpn​) ∂ L ∂ b = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) ( − 1 ) \frac{\partial L}{\partial b} = \sum_{n=1}^{10} (\hat{y}^n - (b+w\cdot x_{cp}^n))(- 1) ∂b∂L​=n=1∑10​(y^​n−(b+w⋅xcpn​))(−1) 我们真正关心的是，model在测试集（新data）上的表现 相比在训练集的 L o s s = 31.9 Loss = 31.9 Loss=31.9，测试上 L o s s = 35 Loss = 35 Loss=35 是否存在更好的函数，使得训练数据和测试数据的评估误差都变小呢？根据泰勒公式，任何形式的函数都可以近似表示为若干个多项式函数之和。而我们现在使用的是线性函数，尝试使用多项式函数降低数据误差。 二次函数 三次函数 四次函数 五次函数 到目前为止，我们尝试了五个model，由折线图我们可以看出，在训练集上error rate是一直在减小的。高幂的function space是包含低幂的（即最高次幂项常数为0），所以如果梯度下降能帮我们找到best function的话，model越复杂，包含越多的function，理论上就可以找出一个function在训练集上的error rate越来越低。 但是在测试集上，越复杂的model不一定能得到更好的结果，这就是Overfitting（过拟合），如model 4和5。暂时我们选择model 3作为我们的function set。 单个特征到多个特征 之前的模型只考虑了宝可梦进化前的cp值。现在我们添加第二个特征，如宝可梦的种类。 如果我们为每个种类做if，那么对应的是这些function set。我们如何把这几个if改写成一个Liner function：这里我们使用开关函数，将他们串联在一起，起到if的作用。若种类对应则 δ \delta δ为1反之为0。这样波波鸟就得到 y = b 1 + w 1 ⋅ x c p y = b_1 + w_1\cdot x_{cp} y=b1​+w1​⋅xcp​ 蓝色框框里就是feature。 按照惯例看一下在training set和test set上的average error。可以看出即使是线性模型，训练和测试误差都很小。 课程开始的时候我们就说过，可以考虑将这神奇宝贝拥有的feature都加进去。在下图中可以看到，这么复杂的model很容易什么？Overfitting。 在我们无法简化feature的情况下，我们选择重新设计Loss function。 正则化 正则化的公式如下所示，需要注意的是正则化项不包括偏置项。因为偏执性不会改变曲线的平滑程度。 正则化公式中的 λ \lambda λ取值越大，会使得函数越平滑。这是由于 λ \lambda λ的值越大，在尽量使损失函数变小的前提下，就会使得 w w w越小， w w w越小就会使得函数越平滑。 一个平滑的函数对noise不那么敏感，但是太平滑也不行，会在test set得到糟糕的结果。 λ本质上表示的是惩罚项，惩罚项过大可能就会影响学习的效果，因为惩罚项过大，就会导致参数空间变的比较小，所以最终结果一般，如下图所示： 推荐学习：奔腾老师的博客" />
<meta property="og:description" content="Regression 回归 能够用线较为精确地描述数据之间的关系。这样当出现新的数据的时候，就能够预测出一个简单的值。回归中最常见的就是房价的问题。收集到的房屋面积和房价的数据，如下图所示： 在这种情况下，就可以利用回归模型构造出一条线来近似地描述房价与房屋面积之间的关系，从而就可以根据房屋面积推测出房价（这里也可以有多个标签，例如房间的个数，卧室的面积等）。 回归算法的输出是一个数值（标量）。例如我们想预测股市，输入到函数的就是过去的股市信息，得到预测值；无人驾驶系统我们是把车的各个传感器接收的信号作为输入，模型计算出方向盘的角度；在推荐系统中，输入的是消费者和某种商品，得到的是消费者购买的可能性，这样就可以挑选可能性高的几种商品进行推荐。 风靡全球的AR手游Pokemon Go想必大家都不陌生，回归算法的实例一就是根据神奇宝贝现有的参数，计算神奇宝贝升级后的CP值，让我们一起来看吧： 所以我们就是要找到一个function: input： x c p x_{cp} xcp​ - CP值， x s x_{s} xs​ - 神奇宝贝种类， x h p x_{hp} xhp​ - HP， x w x_{w} xw​ - Weight， x h x_{h} xh​ - Height，我们把这些的称为Feature output： y y y - 进化后的CP值。 这里的参数下标代表他的component（成分），上标代表object的编号。 在Introduction中，我们说过，做machine learning就是三个步骤： 找一个model（function set） 拿一个function看evaluate好坏 找到最好的function Step1:模型Model 模型指的是一组函数的集合(function set)，其中函数的输入是宝可梦的特征 x x x（各个参数），输出是宝可梦进化后的CP值( y y y)。 我们采用最简单的模型（线性模型），并且假设因变量只有一个，即宝可梦进化前的cp值，则表达式为 y = b + w ⋅ x c p y = b + w ⋅ x_{cp} y=b+w⋅xcp​。其中 w w w和 b b b均有无穷多种选择，所以函数空间中函数的取值（二元组）也为无穷多个。但是某些取值显然是不合理的，例如图中的 f 3 f_{3} f3​就是和进化前的 x c p x_{cp} xcp​成反比的。 对单变量模型进行泛化，生成多变量线性模型，表达式为 y = b + ∑ w i x i y = b + ∑ w_{i}x_{i} y=b+∑wi​xi​。其中 x i x_{i} xi​表示的是每个特征的取值， w i w_{i} wi​表示的是每个特征对应的权重， b b b表示的是偏置(bias)。 Step2:函数的评估标准 由于函数空间中函数数量众多，如果没有一个评估标准，我们则无法选择到最优函数。 这里的模型评估标准的作用对象是训练数据。即在函数空间中选择某一个函数，然后使用评估标准函数对预测后的结果进行评估，从而得到函数的优劣。 这里我们选取十对正确的数据，绘制在坐标系上。 y ^ \hat{y} y^​就是我们验证过的神奇宝贝进化后的CP，之后我们引出Loss fuction这个概念： 在机器学习中，评估标准的专业术语称为损失函数（Loss Function）或者目标函数。在线性回归中，使用的是平方误差或者均方误差来作为损失函数。 L ( f ) = L ( w , b ) = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) 2 L(f) = L(w,b) = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))^2 L(f)=L(w,b)=n=1∑10​(y^​n−(b+w⋅xcpn​))2 其中 y ^ \hat{y} y^​表示的是真实值，后者表示的是预测值。公式是对每个样本的误差求平方和。 拓展阅读：线性回归损失函数为什么要用平方形式 下图中使用等高线图表示出哪些函数区域的效果较好（上边误差较小），哪些函数区域的效果较差（下边误差较大）。 Step3:最优函数 从理论上来说，如果存在评估标准和函数空间，就可以使用穷举法选择出最优函数。但实际上来说，这是不可取的（宇宙毁灭之时也可能计算不完）。所以我们需要在有限时间内（而且不能太慢），求出最优函数。 我们把问题进行转化，把求最优函数问题转化为最优化问题。 求最优化问题有两种思路：一种是解析解，一种是使用梯度下降（迭代法）。课程只介绍了梯度下降法。 为什么能够使用梯度下降法？本质上是从微分的定义出发的。 Δ y = f ′ ( x 0 ) ⋅ Δ x \Delta{y} = f^\prime(x_0)\cdot\Delta x Δy=f′(x0​)⋅Δx Δ y = f ( x + x 0 ) − f ( x ) \Delta{y} = f(x + x_0) - f(x) Δy=f(x+x0​)−f(x) 如果导数为正、而且 Δ x \Delta x Δx为正，则 y y y就会增加。而我们要使 y y y减小，所以使得 y = y − f ′ ( x 0 ) ⋅ Δ x y = y - f^\prime(x_0)\cdot\Delta x y=y−f′(x0​)⋅Δx 注意上述公式是在 Δ x \Delta x Δx极其小的情况下才满足。在机器学习中，我们将 Δ x \Delta x Δx称作为学习率，一般取0.01或者0.001。 Gradient Descent 梯度下降 这里引入梯度下降的概念，他的作用就是快速帮我们找到Loss最小的点。 通俗的理解就是坐滑梯，在滑梯上坐下，自然就滑到底了。 数学理解就是，求微分。如果微分是负的那么就是左边高右边底，我们需要增大 w w w，就向右下降，我们现在来看具体一次下降多少： 现在我们位于 w 0 w^0 w0点，向下滑动的距离就是 学 习 率 η ⋅ w 0 点 的 微 分 学习率\eta \cdot w^0点的微分 学习率η⋅w0点的微分。由于微分是负的所以要减去这个负值来增大 w w w，反之亦然。 图中展示的是两次下降过程， w 0 w^0 w0到 w 1 w^1 w1， w 1 w^1 w1到 w 2 w^2 w2。上边我们提到通常学习率使我们设置的，例如0.001。微分的结果是跟曲线倾斜度相关的，越陡峭，微分越大，一次下降的越多，越平缓，微分越小，一次下降的越少。 w T w^T wT是Local minima局部最小，后面的是global minima全局最小。线性回归是一个凸函数，所以不用考虑局部最小，结果一定是线性最小。 我们知道，线性回归有两个参数， w w w和 b b b。那么两个参数是如何同时更新的呢？ 原来就是对function求偏微分，这样就可以分别更新两个参数了。如下图所示: 我们把单个参数推广到多个参数中。其中 ∇ L \nabla L ∇L指代的是梯度函数。 下图为梯度下降的直观图。 我们可以通过图像更好的理解下降的过程，我们可以看到，经过两次下降，Loss已经达到了很低的位置。 梯度下降存在的问题 1.局部最优化点。2.鞍点。 在这两种类型的点中，导数为0，则无法继续进行迭代，停留在当前点中。 线性回归的对应的偏微分： L ( w , b ) = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) 2 L(w,b) = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))^2 L(w,b)=n=1∑10​(y^​n−(b+w⋅xcpn​))2 ∂ L ∂ w = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) ( − x c p n ) \frac{\partial L}{\partial w} = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))(- x_{cp}^n) ∂w∂L​=n=1∑10​(y^​n−(b+w⋅xcpn​))(−xcpn​) ∂ L ∂ b = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) ( − 1 ) \frac{\partial L}{\partial b} = \sum_{n=1}^{10} (\hat{y}^n - (b+w\cdot x_{cp}^n))(- 1) ∂b∂L​=n=1∑10​(y^​n−(b+w⋅xcpn​))(−1) 我们真正关心的是，model在测试集（新data）上的表现 相比在训练集的 L o s s = 31.9 Loss = 31.9 Loss=31.9，测试上 L o s s = 35 Loss = 35 Loss=35 是否存在更好的函数，使得训练数据和测试数据的评估误差都变小呢？根据泰勒公式，任何形式的函数都可以近似表示为若干个多项式函数之和。而我们现在使用的是线性函数，尝试使用多项式函数降低数据误差。 二次函数 三次函数 四次函数 五次函数 到目前为止，我们尝试了五个model，由折线图我们可以看出，在训练集上error rate是一直在减小的。高幂的function space是包含低幂的（即最高次幂项常数为0），所以如果梯度下降能帮我们找到best function的话，model越复杂，包含越多的function，理论上就可以找出一个function在训练集上的error rate越来越低。 但是在测试集上，越复杂的model不一定能得到更好的结果，这就是Overfitting（过拟合），如model 4和5。暂时我们选择model 3作为我们的function set。 单个特征到多个特征 之前的模型只考虑了宝可梦进化前的cp值。现在我们添加第二个特征，如宝可梦的种类。 如果我们为每个种类做if，那么对应的是这些function set。我们如何把这几个if改写成一个Liner function：这里我们使用开关函数，将他们串联在一起，起到if的作用。若种类对应则 δ \delta δ为1反之为0。这样波波鸟就得到 y = b 1 + w 1 ⋅ x c p y = b_1 + w_1\cdot x_{cp} y=b1​+w1​⋅xcp​ 蓝色框框里就是feature。 按照惯例看一下在training set和test set上的average error。可以看出即使是线性模型，训练和测试误差都很小。 课程开始的时候我们就说过，可以考虑将这神奇宝贝拥有的feature都加进去。在下图中可以看到，这么复杂的model很容易什么？Overfitting。 在我们无法简化feature的情况下，我们选择重新设计Loss function。 正则化 正则化的公式如下所示，需要注意的是正则化项不包括偏置项。因为偏执性不会改变曲线的平滑程度。 正则化公式中的 λ \lambda λ取值越大，会使得函数越平滑。这是由于 λ \lambda λ的值越大，在尽量使损失函数变小的前提下，就会使得 w w w越小， w w w越小就会使得函数越平滑。 一个平滑的函数对noise不那么敏感，但是太平滑也不行，会在test set得到糟糕的结果。 λ本质上表示的是惩罚项，惩罚项过大可能就会影响学习的效果，因为惩罚项过大，就会导致参数空间变的比较小，所以最终结果一般，如下图所示： 推荐学习：奔腾老师的博客" />
<link rel="canonical" href="https://uzzz.org/2019/07/23/795625.html" />
<meta property="og:url" content="https://uzzz.org/2019/07/23/795625.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-07-23T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"Regression 回归 能够用线较为精确地描述数据之间的关系。这样当出现新的数据的时候，就能够预测出一个简单的值。回归中最常见的就是房价的问题。收集到的房屋面积和房价的数据，如下图所示： 在这种情况下，就可以利用回归模型构造出一条线来近似地描述房价与房屋面积之间的关系，从而就可以根据房屋面积推测出房价（这里也可以有多个标签，例如房间的个数，卧室的面积等）。 回归算法的输出是一个数值（标量）。例如我们想预测股市，输入到函数的就是过去的股市信息，得到预测值；无人驾驶系统我们是把车的各个传感器接收的信号作为输入，模型计算出方向盘的角度；在推荐系统中，输入的是消费者和某种商品，得到的是消费者购买的可能性，这样就可以挑选可能性高的几种商品进行推荐。 风靡全球的AR手游Pokemon Go想必大家都不陌生，回归算法的实例一就是根据神奇宝贝现有的参数，计算神奇宝贝升级后的CP值，让我们一起来看吧： 所以我们就是要找到一个function: input： x c p x_{cp} xcp​ - CP值， x s x_{s} xs​ - 神奇宝贝种类， x h p x_{hp} xhp​ - HP， x w x_{w} xw​ - Weight， x h x_{h} xh​ - Height，我们把这些的称为Feature output： y y y - 进化后的CP值。 这里的参数下标代表他的component（成分），上标代表object的编号。 在Introduction中，我们说过，做machine learning就是三个步骤： 找一个model（function set） 拿一个function看evaluate好坏 找到最好的function Step1:模型Model 模型指的是一组函数的集合(function set)，其中函数的输入是宝可梦的特征 x x x（各个参数），输出是宝可梦进化后的CP值( y y y)。 我们采用最简单的模型（线性模型），并且假设因变量只有一个，即宝可梦进化前的cp值，则表达式为 y = b + w ⋅ x c p y = b + w ⋅ x_{cp} y=b+w⋅xcp​。其中 w w w和 b b b均有无穷多种选择，所以函数空间中函数的取值（二元组）也为无穷多个。但是某些取值显然是不合理的，例如图中的 f 3 f_{3} f3​就是和进化前的 x c p x_{cp} xcp​成反比的。 对单变量模型进行泛化，生成多变量线性模型，表达式为 y = b + ∑ w i x i y = b + ∑ w_{i}x_{i} y=b+∑wi​xi​。其中 x i x_{i} xi​表示的是每个特征的取值， w i w_{i} wi​表示的是每个特征对应的权重， b b b表示的是偏置(bias)。 Step2:函数的评估标准 由于函数空间中函数数量众多，如果没有一个评估标准，我们则无法选择到最优函数。 这里的模型评估标准的作用对象是训练数据。即在函数空间中选择某一个函数，然后使用评估标准函数对预测后的结果进行评估，从而得到函数的优劣。 这里我们选取十对正确的数据，绘制在坐标系上。 y ^ \\hat{y} y^​就是我们验证过的神奇宝贝进化后的CP，之后我们引出Loss fuction这个概念： 在机器学习中，评估标准的专业术语称为损失函数（Loss Function）或者目标函数。在线性回归中，使用的是平方误差或者均方误差来作为损失函数。 L ( f ) = L ( w , b ) = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) 2 L(f) = L(w,b) = \\sum_{n=1}^{10}(\\hat{y}^n - (b+w\\cdot x_{cp}^n))^2 L(f)=L(w,b)=n=1∑10​(y^​n−(b+w⋅xcpn​))2 其中 y ^ \\hat{y} y^​表示的是真实值，后者表示的是预测值。公式是对每个样本的误差求平方和。 拓展阅读：线性回归损失函数为什么要用平方形式 下图中使用等高线图表示出哪些函数区域的效果较好（上边误差较小），哪些函数区域的效果较差（下边误差较大）。 Step3:最优函数 从理论上来说，如果存在评估标准和函数空间，就可以使用穷举法选择出最优函数。但实际上来说，这是不可取的（宇宙毁灭之时也可能计算不完）。所以我们需要在有限时间内（而且不能太慢），求出最优函数。 我们把问题进行转化，把求最优函数问题转化为最优化问题。 求最优化问题有两种思路：一种是解析解，一种是使用梯度下降（迭代法）。课程只介绍了梯度下降法。 为什么能够使用梯度下降法？本质上是从微分的定义出发的。 Δ y = f ′ ( x 0 ) ⋅ Δ x \\Delta{y} = f^\\prime(x_0)\\cdot\\Delta x Δy=f′(x0​)⋅Δx Δ y = f ( x + x 0 ) − f ( x ) \\Delta{y} = f(x + x_0) - f(x) Δy=f(x+x0​)−f(x) 如果导数为正、而且 Δ x \\Delta x Δx为正，则 y y y就会增加。而我们要使 y y y减小，所以使得 y = y − f ′ ( x 0 ) ⋅ Δ x y = y - f^\\prime(x_0)\\cdot\\Delta x y=y−f′(x0​)⋅Δx 注意上述公式是在 Δ x \\Delta x Δx极其小的情况下才满足。在机器学习中，我们将 Δ x \\Delta x Δx称作为学习率，一般取0.01或者0.001。 Gradient Descent 梯度下降 这里引入梯度下降的概念，他的作用就是快速帮我们找到Loss最小的点。 通俗的理解就是坐滑梯，在滑梯上坐下，自然就滑到底了。 数学理解就是，求微分。如果微分是负的那么就是左边高右边底，我们需要增大 w w w，就向右下降，我们现在来看具体一次下降多少： 现在我们位于 w 0 w^0 w0点，向下滑动的距离就是 学 习 率 η ⋅ w 0 点 的 微 分 学习率\\eta \\cdot w^0点的微分 学习率η⋅w0点的微分。由于微分是负的所以要减去这个负值来增大 w w w，反之亦然。 图中展示的是两次下降过程， w 0 w^0 w0到 w 1 w^1 w1， w 1 w^1 w1到 w 2 w^2 w2。上边我们提到通常学习率使我们设置的，例如0.001。微分的结果是跟曲线倾斜度相关的，越陡峭，微分越大，一次下降的越多，越平缓，微分越小，一次下降的越少。 w T w^T wT是Local minima局部最小，后面的是global minima全局最小。线性回归是一个凸函数，所以不用考虑局部最小，结果一定是线性最小。 我们知道，线性回归有两个参数， w w w和 b b b。那么两个参数是如何同时更新的呢？ 原来就是对function求偏微分，这样就可以分别更新两个参数了。如下图所示: 我们把单个参数推广到多个参数中。其中 ∇ L \\nabla L ∇L指代的是梯度函数。 下图为梯度下降的直观图。 我们可以通过图像更好的理解下降的过程，我们可以看到，经过两次下降，Loss已经达到了很低的位置。 梯度下降存在的问题 1.局部最优化点。2.鞍点。 在这两种类型的点中，导数为0，则无法继续进行迭代，停留在当前点中。 线性回归的对应的偏微分： L ( w , b ) = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) 2 L(w,b) = \\sum_{n=1}^{10}(\\hat{y}^n - (b+w\\cdot x_{cp}^n))^2 L(w,b)=n=1∑10​(y^​n−(b+w⋅xcpn​))2 ∂ L ∂ w = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) ( − x c p n ) \\frac{\\partial L}{\\partial w} = \\sum_{n=1}^{10}(\\hat{y}^n - (b+w\\cdot x_{cp}^n))(- x_{cp}^n) ∂w∂L​=n=1∑10​(y^​n−(b+w⋅xcpn​))(−xcpn​) ∂ L ∂ b = ∑ n = 1 10 ( y ^ n − ( b + w ⋅ x c p n ) ) ( − 1 ) \\frac{\\partial L}{\\partial b} = \\sum_{n=1}^{10} (\\hat{y}^n - (b+w\\cdot x_{cp}^n))(- 1) ∂b∂L​=n=1∑10​(y^​n−(b+w⋅xcpn​))(−1) 我们真正关心的是，model在测试集（新data）上的表现 相比在训练集的 L o s s = 31.9 Loss = 31.9 Loss=31.9，测试上 L o s s = 35 Loss = 35 Loss=35 是否存在更好的函数，使得训练数据和测试数据的评估误差都变小呢？根据泰勒公式，任何形式的函数都可以近似表示为若干个多项式函数之和。而我们现在使用的是线性函数，尝试使用多项式函数降低数据误差。 二次函数 三次函数 四次函数 五次函数 到目前为止，我们尝试了五个model，由折线图我们可以看出，在训练集上error rate是一直在减小的。高幂的function space是包含低幂的（即最高次幂项常数为0），所以如果梯度下降能帮我们找到best function的话，model越复杂，包含越多的function，理论上就可以找出一个function在训练集上的error rate越来越低。 但是在测试集上，越复杂的model不一定能得到更好的结果，这就是Overfitting（过拟合），如model 4和5。暂时我们选择model 3作为我们的function set。 单个特征到多个特征 之前的模型只考虑了宝可梦进化前的cp值。现在我们添加第二个特征，如宝可梦的种类。 如果我们为每个种类做if，那么对应的是这些function set。我们如何把这几个if改写成一个Liner function：这里我们使用开关函数，将他们串联在一起，起到if的作用。若种类对应则 δ \\delta δ为1反之为0。这样波波鸟就得到 y = b 1 + w 1 ⋅ x c p y = b_1 + w_1\\cdot x_{cp} y=b1​+w1​⋅xcp​ 蓝色框框里就是feature。 按照惯例看一下在training set和test set上的average error。可以看出即使是线性模型，训练和测试误差都很小。 课程开始的时候我们就说过，可以考虑将这神奇宝贝拥有的feature都加进去。在下图中可以看到，这么复杂的model很容易什么？Overfitting。 在我们无法简化feature的情况下，我们选择重新设计Loss function。 正则化 正则化的公式如下所示，需要注意的是正则化项不包括偏置项。因为偏执性不会改变曲线的平滑程度。 正则化公式中的 λ \\lambda λ取值越大，会使得函数越平滑。这是由于 λ \\lambda λ的值越大，在尽量使损失函数变小的前提下，就会使得 w w w越小， w w w越小就会使得函数越平滑。 一个平滑的函数对noise不那么敏感，但是太平滑也不行，会在test set得到糟糕的结果。 λ本质上表示的是惩罚项，惩罚项过大可能就会影响学习的效果，因为惩罚项过大，就会导致参数空间变的比较小，所以最终结果一般，如下图所示： 推荐学习：奔腾老师的博客","@type":"BlogPosting","url":"https://uzzz.org/2019/07/23/795625.html","headline":"李宏毅 机器学习笔记-02 Regression","dateModified":"2019-07-23T00:00:00+08:00","datePublished":"2019-07-23T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/07/23/795625.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>李宏毅 机器学习笔记-02 Regression</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <h2><a id="Regression__0"></a>Regression 回归</h2> 
  <p>能够用线较为精确地描述数据之间的关系。这样当出现新的数据的时候，就能够预测出一个简单的值。回归中最常见的就是房价的问题。收集到的房屋面积和房价的数据，如下图所示：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722175015233.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 在这种情况下，就可以利用回归模型构造出一条线来近似地描述房价与房屋面积之间的关系，从而就可以根据房屋面积推测出房价（这里也可以有多个标签，例如房间的个数，卧室的面积等）。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722175638963.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 回归算法的输出是一个数值（标量）。例如我们想预测股市，输入到函数的就是过去的股市信息，得到预测值；无人驾驶系统我们是把车的各个传感器接收的信号作为输入，模型计算出方向盘的角度；在推荐系统中，输入的是消费者和某种商品，得到的是消费者购买的可能性，这样就可以挑选可能性高的几种商品进行推荐。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722180304285.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 风靡全球的AR手游<strong>Pokemon Go</strong>想必大家都不陌生，回归算法的实例一就是根据神奇宝贝现有的参数，计算神奇宝贝升级后的CP值，让我们一起来看吧：</p> 
  <p>所以我们就是要找到一个<strong>function</strong>:</p> 
  <ul> 
   <li><strong>input</strong>：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          x_{cp}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> - CP值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            s
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          x_{s}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> - 神奇宝贝种类，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             h
            </mi>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          x_{hp}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> - HP，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            w
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          x_{w}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> - Weight，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            h
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          x_{h}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> - Height，我们把这些的称为<strong>Feature</strong></li> 
   <li><strong>output</strong>：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           y
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          y
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span> - 进化后的CP值。</li> 
  </ul> 
  <p>这里的参数<strong>下标</strong>代表他的component（成分），<strong>上标</strong>代表object的编号。</p> 
  <p><strong>在Introduction中</strong>，我们说过，做<strong>machine learning</strong>就是三个步骤：</p> 
  <ol> 
   <li>找一个model（function set）</li> 
   <li>拿一个function看evaluate好坏</li> 
   <li>找到最好的function</li> 
  </ol> 
  <h2><a id="Step1Model_23"></a>Step1:模型Model</h2> 
  <p>模型指的是一组函数的集合(function set)，其中函数的输入是宝可梦的特征<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>（各个参数），输出是宝可梦进化后的CP值(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>)。<br> 我们采用最简单的模型（线性模型），并且假设因变量只有一个，即宝可梦进化前的cp值，则表达式为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
         <mo>
          =
         </mo>
         <mi>
          b
         </mi>
         <mo>
          +
         </mo>
         <mi>
          w
         </mi>
         <mo>
          ⋅
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         y = b + w ⋅ x_{cp}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>均有无穷多种选择，所以函数空间中函数的取值（二元组）也为无穷多个。但是某些取值显然是不合理的，例如图中的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mn>
           3
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         f_{3}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>就是和进化前的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{cp}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>成反比的。<br> 对单变量模型进行泛化，生成多变量线性模型，表达式为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
         <mo>
          =
         </mo>
         <mi>
          b
         </mi>
         <mo>
          +
         </mo>
         <mo>
          ∑
         </mo>
         <msub>
          <mi>
           w
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         y = b + ∑ w_{i}x_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.00001em; vertical-align: -0.25001em;"></span><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示的是每个特征的取值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示的是每个特征对应的权重，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>表示的是偏置(bias)。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722203510874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="Step2_28"></a>Step2:函数的评估标准</h2> 
  <p>由于函数空间中函数数量众多，如果没有一个评估标准，我们则无法选择到最优函数。<br> 这里的模型评估标准的作用对象是训练数据。即在函数空间中选择某一个函数，然后使用评估标准函数对预测后的结果进行评估，从而得到函数的优劣。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722203811183.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 这里我们选取十对正确的数据，绘制在坐标系上。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi>
           y
          </mi>
          <mo>
           ^
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{y}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span>就是我们验证过的神奇宝贝进化后的CP，之后我们引出Loss fuction这个概念：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722204136751.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 在机器学习中，评估标准的专业术语称为损失函数（Loss Function）或者目标函数。在线性回归中，使用的是平方误差或者均方误差来作为损失函数。<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <mi>
           f
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <mi>
           w
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           b
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            10
           </mn>
          </munderover>
          <mo>
           (
          </mo>
          <msup>
           <mover accent="true">
            <mi>
             y
            </mi>
            <mo>
             ^
            </mo>
           </mover>
           <mi>
            n
           </mi>
          </msup>
          <mo>
           −
          </mo>
          <mo>
           (
          </mo>
          <mi>
           b
          </mi>
          <mo>
           +
          </mo>
          <mi>
           w
          </mi>
          <mo>
           ⋅
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             p
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
          <msup>
           <mo>
            )
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          L(f) = L(w,b) = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))^2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.06823em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.24722em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi>
           y
          </mi>
          <mo>
           ^
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \hat{y}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span>表示的是真实值，后者表示的是预测值。公式是对每个样本的误差求平方和。</p> 
  <blockquote> 
   <p>拓展阅读：<a href="https://blog.csdn.net/saltriver/article/details/57544704" rel="nofollow" data-token="b3cbb9e4413019917763437e53353405">线性回归损失函数为什么要用平方形式</a></p> 
  </blockquote> 
  <p>下图中使用等高线图表示出哪些函数区域的效果较好（上边误差较小），哪些函数区域的效果较差（下边误差较大）。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723113307808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="Step3_41"></a>Step3:最优函数</h2> 
  <p>从理论上来说，如果存在评估标准和函数空间，就可以使用穷举法选择出最优函数。但实际上来说，这是不可取的（宇宙毁灭之时也可能计算不完）。所以我们需要在有限时间内（而且不能太慢），求出最优函数。</p> 
  <p>我们把问题进行转化，把求最优函数问题转化为最优化问题。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722204527305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 求最优化问题有两种思路：一种是解析解，一种是使用梯度下降（迭代法）。课程只介绍了梯度下降法。</p> 
  <p>为什么能够使用梯度下降法？本质上是从微分的定义出发的。<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="normal">
           Δ
          </mi>
          <mi>
           y
          </mi>
          <mo>
           =
          </mo>
          <msup>
           <mi>
            f
           </mi>
           <mo mathvariant="normal">
            ′
           </mo>
          </msup>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           ⋅
          </mo>
          <mi mathvariant="normal">
           Δ
          </mi>
          <mi>
           x
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \Delta{y} = f^\prime(x_0)\cdot\Delta x
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathit">x</span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="normal">
           Δ
          </mi>
          <mi>
           y
          </mi>
          <mo>
           =
          </mo>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           +
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \Delta{y} = f(x + x_0) - f(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></span><br> 如果导数为正、而且<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \Delta x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathit">x</span></span></span></span></span>为正，则<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>就会增加。而我们要使<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>减小，所以使得<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           y
          </mi>
          <mo>
           =
          </mo>
          <mi>
           y
          </mi>
          <mo>
           −
          </mo>
          <msup>
           <mi>
            f
           </mi>
           <mo mathvariant="normal">
            ′
           </mo>
          </msup>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           ⋅
          </mo>
          <mi mathvariant="normal">
           Δ
          </mi>
          <mi>
           x
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          y = y - f^\prime(x_0)\cdot\Delta x
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathit">x</span></span></span></span></span></span><br> 注意上述公式是在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \Delta x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathit">x</span></span></span></span></span>极其小的情况下才满足。在机器学习中，我们将<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \Delta x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathit">x</span></span></span></span></span>称作为学习率，一般取0.01或者0.001。</p> 
  <h2><a id="Gradient_Descent__52"></a>Gradient Descent 梯度下降</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722204804482.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 这里引入梯度下降的概念，他的作用就是快速帮我们找到Loss最小的点。<br> 通俗的理解就是坐滑梯，在滑梯上坐下，自然就滑到底了。<br> 数学理解就是，求微分。如果微分是负的那么就是<strong>左边高右边底</strong>，我们需要增大<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>，就向右下降，我们现在来看具体一次下降多少：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722205150610.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 现在我们位于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mn>
           0
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>点，向下滑动的距离就是<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          学
         </mi>
         <mi mathvariant="normal">
          习
         </mi>
         <mi mathvariant="normal">
          率
         </mi>
         <mi>
          η
         </mi>
         <mo>
          ⋅
         </mo>
         <msup>
          <mi>
           w
          </mi>
          <mn>
           0
          </mn>
         </msup>
         <mi mathvariant="normal">
          点
         </mi>
         <mi mathvariant="normal">
          的
         </mi>
         <mi mathvariant="normal">
          微
         </mi>
         <mi mathvariant="normal">
          分
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         学习率\eta \cdot w^0点的微分
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63889em; vertical-align: -0.19444em;"></span><span class="mord cjk_fallback">学</span><span class="mord cjk_fallback">习</span><span class="mord cjk_fallback">率</span><span class="mord mathit" style="margin-right: 0.03588em;">η</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">点</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">微</span><span class="mord cjk_fallback">分</span></span></span></span></span>。由于<strong>微分是负</strong>的所以要<strong>减去</strong>这个负值来增大<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>，反之亦然。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722205544638.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 图中展示的是两次下降过程，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mn>
           0
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mn>
           2
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>。上边我们提到通常学习率使我们设置的，例如0.001。微分的结果是跟曲线倾斜度相关的，越陡峭，微分越大，一次下降的越多，越平缓，微分越小，一次下降的越少。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mi>
           T
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         w^T
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>是Local minima<strong>局部最小</strong>，后面的是global minima<strong>全局最小</strong>。线性回归是一个<strong>凸函数</strong>，所以不用考虑局部最小，结果一定是线性最小。</p> 
  <p>我们知道，线性回归有两个参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>。那么两个参数是如何同时更新的呢？<br> 原来就是对function求偏微分，这样就可以分别更新两个参数了。如下图所示:<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722205948145.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 我们把单个参数推广到多个参数中。其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∇
         </mi>
         <mi>
          L
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \nabla L
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">∇</span><span class="mord mathit">L</span></span></span></span></span>指代的是梯度函数。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723115404324.png" alt="在这里插入图片描述"><br> 下图为梯度下降的直观图。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190722210322420.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 我们可以通过图像更好的理解下降的过程，我们可以看到，经过两次下降，Loss已经达到了很低的位置。</p> 
  <h2><a id="_72"></a>梯度下降存在的问题</h2> 
  <p>1.局部最优化点。2.鞍点。<br> 在这两种类型的点中，导数为0，则无法继续进行迭代，停留在当前点中。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723115718611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 线性回归的对应的偏微分：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <mi>
           w
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           b
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            10
           </mn>
          </munderover>
          <mo>
           (
          </mo>
          <msup>
           <mover accent="true">
            <mi>
             y
            </mi>
            <mo>
             ^
            </mo>
           </mover>
           <mi>
            n
           </mi>
          </msup>
          <mo>
           −
          </mo>
          <mo>
           (
          </mo>
          <mi>
           b
          </mi>
          <mo>
           +
          </mo>
          <mi>
           w
          </mi>
          <mo>
           ⋅
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             p
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
          <msup>
           <mo>
            )
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          L(w,b) = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))^2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.06823em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.24722em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             L
            </mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             w
            </mi>
           </mrow>
          </mfrac>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            10
           </mn>
          </munderover>
          <mo>
           (
          </mo>
          <msup>
           <mover accent="true">
            <mi>
             y
            </mi>
            <mo>
             ^
            </mo>
           </mover>
           <mi>
            n
           </mi>
          </msup>
          <mo>
           −
          </mo>
          <mo>
           (
          </mo>
          <mi>
           b
          </mi>
          <mo>
           +
          </mo>
          <mi>
           w
          </mi>
          <mo>
           ⋅
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             p
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
          <mo>
           (
          </mo>
          <mo>
           −
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             p
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \frac{\partial L}{\partial w} = \sum_{n=1}^{10}(\hat{y}^n - (b+w\cdot x_{cp}^n))(- x_{cp}^n)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.06823em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.13311em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             L
            </mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             b
            </mi>
           </mrow>
          </mfrac>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            10
           </mn>
          </munderover>
          <mo>
           (
          </mo>
          <msup>
           <mover accent="true">
            <mi>
             y
            </mi>
            <mo>
             ^
            </mo>
           </mover>
           <mi>
            n
           </mi>
          </msup>
          <mo>
           −
          </mo>
          <mo>
           (
          </mo>
          <mi>
           b
          </mi>
          <mo>
           +
          </mo>
          <mi>
           w
          </mi>
          <mo>
           ⋅
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             p
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
          <mo>
           (
          </mo>
          <mo>
           −
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \frac{\partial L}{\partial b} = \sum_{n=1}^{10} (\hat{y}^n - (b+w\cdot x_{cp}^n))(- 1)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">b</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.06823em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.13311em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></span><br> 我们真正关心的是，model在测试集（新data）上的表现<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723150129611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 相比在训练集的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          L
         </mi>
         <mi>
          o
         </mi>
         <mi>
          s
         </mi>
         <mi>
          s
         </mi>
         <mo>
          =
         </mo>
         <mn>
          31.9
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         Loss = 31.9
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">.</span><span class="mord">9</span></span></span></span></span>，测试上<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          L
         </mi>
         <mi>
          o
         </mi>
         <mi>
          s
         </mi>
         <mi>
          s
         </mi>
         <mo>
          =
         </mo>
         <mn>
          35
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         Loss = 35
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span><span class="mord">5</span></span></span></span></span></p> 
  <p>是否存在更好的函数，使得训练数据和测试数据的评估误差都变小呢？根据泰勒公式，任何形式的函数都可以近似表示为若干个多项式函数之和。而我们现在使用的是线性函数，尝试使用多项式函数降低数据误差。</p> 
  <h4><a id="_86"></a>二次函数</h4> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723150340967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h4><a id="_88"></a>三次函数</h4> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723150427201.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h4><a id="httpsimgblogcsdnimgcn2019072315053488pngxossprocessimagewatermarktype_ZmFuZ3poZW5naGVpdGkshadow_10text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQsize_16color_FFFFFFt_70_90"></a>四次函数<img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019072315053488.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></h4> 
  <h4><a id="_91"></a>五次函数</h4> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723150622971.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 到目前为止，我们尝试了五个model，由折线图我们可以看出，在训练集上error rate是一直在减小的。高幂的function space是包含低幂的（即最高次幂项常数为0），所以如果梯度下降能帮我们找到best function的话，model越复杂，包含越多的function，理论上就可以找出一个function在训练集上的error rate越来越低。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723150752288.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723152106465.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 但是在测试集上，越复杂的model不一定能得到更好的结果，这就是<strong>Overfitting（过拟合）</strong>，如model 4和5。暂时我们选择model 3作为我们的function set。</p> 
  <h2><a id="_97"></a>单个特征到多个特征</h2> 
  <p>之前的模型只考虑了宝可梦进化前的cp值。现在我们添加第二个特征，如宝可梦的种类。<img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723152335974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723152710868.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 如果我们为每个种类做if，那么对应的是这些function set。我们如何把这几个if改写成一个Liner function：这里我们使用开关函数，将他们串联在一起，起到if的作用。若种类对应则<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          δ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \delta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03785em;">δ</span></span></span></span></span>为1反之为0。这样波波鸟就得到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           w
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          ⋅
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         y = b_1 + w_1\cdot x_{cp}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.59445em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
  <p>蓝色框框里就是feature。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723153045948.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 按照惯例看一下在training set和test set上的average error。可以看出即使是线性模型，训练和测试误差都很小。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019072315350071.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019072315363270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 课程开始的时候我们就说过，可以考虑将这神奇宝贝拥有的feature都加进去。在下图中可以看到，这么复杂的model很容易什么？Overfitting。<img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723153825588.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在"><br> 在我们无法简化feature的情况下，我们选择重新设计Loss function。</p> 
  <h2><a id="_110"></a>正则化</h2> 
  <p>正则化的公式如下所示，需要注意的是正则化项不包括偏置项。因为偏执性不会改变曲线的平滑程度。</p> 
  <p>正则化公式中的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>取值越大，会使得函数越平滑。这是由于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>的值越大，在尽量使损失函数变小的前提下，就会使得<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>越小，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>越小就会使得函数越平滑。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723154612117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 一个平滑的函数对noise不那么敏感，但是太平滑也不行，会在test set得到糟糕的结果。</p> 
  <p>λ本质上表示的是惩罚项，惩罚项过大可能就会影响学习的效果，因为惩罚项过大，就会导致参数空间变的比较小，所以最终结果一般，如下图所示：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190723155228366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUzODg4OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <blockquote> 
   <p>推荐学习：<a href="https://me.csdn.net/herosunly" rel="nofollow" data-token="2b7dcfbb8d8dee273c5a16baaf6f87ad">奔腾老师的博客</a></p> 
  </blockquote> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
