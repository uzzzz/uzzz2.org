<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>运维老司机带你学Zabbix，小白速收！ | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="运维老司机带你学Zabbix，小白速收！" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="原文链接： http://bmxxbiao.mikecrm.com/A5ojTQE zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案，在企业中有非常全面的应用，本文是Linux运维老司机撰写，一站式帮你解决zabbix的难题。 第1章 zabbix监控 1.1 为什么要监控 在需要的时刻，提前提醒我们服务器出问题了 当出问题之后，可以找到问题的根源 网站/服务器 的可用性 1.1.1 网站可用性 在软件系统的高可靠性（也称为可用性，英文描述为HA，High Available）里有个衡量其可靠性的标准——X个9，这个X是代表数字3~5。X个9表示在软件系统1年时间的使用过程中，系统可以正常使用时间与总时间（1年）之比，我们通过下面的计算来感受下X个9在不同级别的可靠性差异。 1个9：(1-90%)*365=36.5天，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是36.5天 2个9：(1-99%)*365=3.65天 ， 表示该软件系统在连续运行1年时间里最多可能的业务中断时间是3.65天 3个9：(1-99.9%)*365*24=8.76小时，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是8.76小时。 4个9：(1-99.99%)*365*24=0.876小时=52.6分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是52.6分钟。 5个9：(1-99.999%)*365*24*60=5.26分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是5.26分钟。 6个9：(1-99.9999%)*365*24*60*60=31秒， 示该软件系统在连续运行1年时间里最多可能的业务中断时间是31秒 1.2 监控什么东西 监控一切需要监控的东西，只要能够想到，能够用命令实现的都能用来监控 1.2.1 监控范畴 1.3 怎么来监控 1.3.1 远程管理服务器 如果想远程管理服务器就有远程管理卡，比如Dell idRAC，HP ILO，IBM IMM 1.3.2 监控硬件 查看硬件的温度/风扇转速，电脑有鲁大师，服务器就有ipmitool。 使用ipmitool实现对服务器的命令行远程管理 1.3.3 查看cpu相关 lscpu、uptime、top、htop vmstat mpstat &nbsp;&nbsp; 其中htop需要安装，安装依赖与epel源。 1.3.4 内存够不够可以用 free 1.3.5 磁盘剩多少写的快不快可以用 df、dd、iotop 1.3.6 监控网络 iftop nethogs 1.4 监控工具总览 mrtg 流量监控出图 nagios 监控 cacti&nbsp; 流量监控出图 zabbix&nbsp;监控+出图 1.5 zabbix介绍 Zabbix 是由 Alexei Vladishev 开发的一种网络监视、管理系统，基于 Server-Client 架构。可用于监视各种网络服务、服务器和网络机器等状态。 使用各种 Database-end 如 MySQL, PostgreSQL, SQLite, Oracle 或 IBM DB2 储存资料。Server 端基于 C语言、Web 管理端 frontend 则是基于 PHP 所制作的。Zabbix 可以使用多种方式监视。可以只使用 Simple Check 不需要安装 Client 端，亦可基于 SMTP 或 HTTP ... 各种协定做死活监视。 在客户端如 UNIX, Windows 中安装 Zabbix Agent 之后，可监视 CPU Load、网络使用状况、硬盘容量等各种状态。而就算没有安装 Agent 在监视对象中，Zabbix 也可以经由 SNMP、TCP、ICMP、利用 IPMI、SSH、telnet 对目标进行监视。 另外，Zabbix 包含 XMPP 等各种 Item 警示功能。 1.5.1 zabbix的组成&nbsp; zabbix官网: https://www.zabbix.com zabbix 主要由2部分构成 zabbix server和 zabbix agent zabbix proxy是用来管理其他的agent，作为代理 1.5.2 zabbix监控范畴 ²&nbsp; 硬件监控 ：Zabbix IPMI Interface ²&nbsp; 系统监控 ：Zabbix Agent Interface ²&nbsp; Java 监控：ZabbixJMX Interface ²&nbsp; 网络设备监抟：Zabbix SNMP Interface ²&nbsp; 应用服务监控：Zabbix Agent UserParameter ²&nbsp; MySQL 数据库监控：percona-monitoring-pldlgins ²&nbsp; URL监控：Zabbix Web监控 第2章 安装zabbix 2.1 环境检查 2.2 安装zabbix过程 2.2.1 安装方式选择 编译安装 （服务较多，环境复杂） yum安装（干净环境） 2.2.2 服务端快速安装脚本 2.2.3 客户端快速部署脚本 2.3 检测连通性 2.3.1 服务端安装zabbix-get检测工具 yum install zabbix-get 2.3.2 在服务端进行测试 第3章 web界面操作 3.1 zabbix的web安装 3.1.1 使用浏览器访问 http://10.0.0.61/zabbix/setup.php &nbsp;&nbsp; 在检测信息时，可查看具体的报错信息进行不同的解决 &nbsp;&nbsp; 选择mysql数据库，输入密码即可 &nbsp;&nbsp; host与port不需要修改，name自定义 &nbsp;确认信息,正确点击下一步&nbsp; &nbsp;&nbsp; &nbsp;安装完成、点击finsh &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 进入登陆界面&nbsp; 账号Admin密码zabbix&nbsp;&nbsp;&nbsp;注意A大写 3.2 添加监控信息 3.2.1 修改监控管理机zabbix server 配置 &gt;&gt; 主机 &nbsp; 主机名称： 要与主机名相同，这是zabbix server程序用的 可见名称： 显示在zabbix网页上的，给我们看的 &nbsp; &nbsp;&nbsp; 修改后，要将下面的已启用要勾上 &nbsp;&nbsp; 添加完成就有了管理机的监控主机 3.2.2 添加新的主机 配置 &gt;&gt; 主机 &gt;&gt; 创建主机 &nbsp; 注意勾选以启用 &nbsp;&nbsp; 然后添加模板，选择linux OS ，先点小添加，再点大添加。 &nbsp;&nbsp; 添加完成，将会又两条监控主机信息 3.2.3 查看监控内容 检测中 &nbsp;&gt;&gt; 最新数据 &nbsp;&nbsp; 在最新数据中需要筛选，&nbsp; &nbsp;&nbsp; 输入ip或者名字都能够搜索出来 &nbsp; 在下面就会列出所有的监控项 3.2.4 查看图像 检测中 &gt;&gt; 图形 &nbsp;&nbsp; 选择正确的主机。选择要查看的图形即可出图 第4章 自定义监控与监控报警 4.1 自定义监控 4.1.1 说明 zabbix自带模板Template OS Linux (Template App Zabbix Agent)提供CPU、内存、磁盘、网卡等常规监控，只要新加主机关联此模板，就可自动添加这些监控项。 需求：服务器登陆人数不能超过三人，超过三人报警 4.1.2 预备知识 4.2 实现自定义监控 4.2.1 自定义语法 4.2.2 agent注册 4.2.3 在server端注册(web操作) ①&nbsp;&nbsp;&nbsp;创建模板 配置 &gt;&gt;&nbsp;模板 &gt;&gt;&nbsp;创建模板 点击添加，即可创建出来模板 &nbsp;&nbsp; 查看创建出来的模板。↑ ②&nbsp;&nbsp;&nbsp;创建应用集 应用集类似(目录/文件夹)，其作用是给监控项分类。 点击&nbsp;应用集 &gt;&gt;&nbsp;创建应用集 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 自定义应用集的名称，然后点击添加 ③&nbsp;&nbsp;&nbsp;创建监控项 监控项 &gt;&gt;&nbsp;创建监控项 键值&nbsp;-- key,即前面出创建的login-user。 &nbsp;&nbsp; 注意：创建监控项的时候，注意选择上应用集，即之前创建的安全。 ④&nbsp;&nbsp;&nbsp;创建触发器 触发器的作用：当监控项获取到的值达到一定条件时就触发报警 (根据需求创建) 触发器 &gt;&gt;&nbsp;创建触发器 创建触发器，自定义名称，该名称是报警时显示的名称。 &nbsp;&nbsp; 表达式，点击右边的添加，选择表达式。&nbsp; &nbsp;&nbsp; 严重性自定义。 &nbsp;&nbsp;&nbsp;表达式的定义&nbsp;↓&nbsp;，选择之前创建的监控项， 最新的T值为当前获取到的值。 &nbsp;&nbsp; 添加完成，能够在触发器中看到添加的情况 ⑤&nbsp;&nbsp;&nbsp;创建图形 以图形的方式展示出来监控信息 图形 &gt;&gt;&nbsp;创建图形 名称自定义，关联上监控项。 ⑥&nbsp;&nbsp;&nbsp;主机关联模板 配置 &gt;&gt;&nbsp;主机 &nbsp;&nbsp; 一个主机可以关联多个模板 4.2.4 查看监控的图形&nbsp; 4.3 监控报警 4.3.1 第三方报警平台 http://www.onealert.com &nbsp;&nbsp; 　 通过 OneAlert 提供的通知分派与排班策略，以及全方位的短信、微信、QQ、电话提醒服务，您可以在最合适的时间，将最重要的信息推送给最合适的人员。 4.3.2 onealert配置 添加应用，注意添加的是zabbix&nbsp; &nbsp;&nbsp; 实现微信报警需要关注微信公众号即可。&nbsp; 4.3.3 安装 onealert Agent 4.3.1 如何删除onealert Agent ①&nbsp; 删除报警媒介类型中的脚本&nbsp; ②&nbsp; 删除创建的用户 ③&nbsp; 删除用户群组 ④&nbsp; 删除创建的动作&nbsp; 4.3.2 触发器响应，发送报警信息&nbsp; &nbsp;&nbsp; 在微信和邮件中，均能收到报警信息。 &nbsp;&nbsp;&nbsp;注意：当状态改变的时候才会发邮件 &nbsp;&nbsp;&nbsp;　　&nbsp;好--&gt;坏 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;坏--&gt;好 4.4 监控可视化 4.4.1 聚合图形 最新数据 &gt;&gt;&nbsp;图形 &nbsp;&nbsp; 自定义名称 &nbsp;&nbsp; 点击聚合图形的名称，进行更改，添加要显示的图形即可。 4.4.2 幻灯片 添加幻灯片 监测中 &gt;&gt;&nbsp;复合图形 &gt;&gt;&nbsp;幻灯片演示 &nbsp;&nbsp; 创建幻灯片，名称自定，选择要显示的 &nbsp;&nbsp; 幻灯片根据设定的时间自动播放 4.5 模板的共享 4.5.1 主机共享 在主机页打开，全选后点击导出 &nbsp; &nbsp; 导入 4.5.2 模板共享 https://github.com/zhangyao8/zabbix-community-repos 第5章 监控全网服务器 5.1 需求说明 实际需求： 公司已经有了100台服务器，现在需要使用zabbix全部监控起来。 5.2 规划方案 常规监控：cpu，内存，磁盘，网卡&nbsp; 问题：怎样快速添加100台机器 &nbsp;&nbsp; 　　方法1：使用克隆的方式 &nbsp;　　&nbsp; 方法2：自动注册和自动发现 &nbsp;　　&nbsp; 方法3：调用zabbix api接口&nbsp; curl 、python &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;　　 &nbsp;开发自己的运维平台兼容zabbix的通道 服务监控，url监控等特殊监控：自定义监控 5.2.1 api接口使用（curl） 5.3 具体实施规划 5.3.1 硬件、系统、网络监控 所有集群节点（所有虚拟机）都监控上 交换机，路由器监控（简单方法：换成端口对应服务器网卡流量监控；标准方法：监控交换机的网卡） snmp监控 5.3.2 应用服务监控 1. 监控备份服务器，简单方法是监控rsync端口，如果有其他更佳方案可以说明； 2. 监控NFS服务器，使用监控NFS进程来判断NFS服务器正常，如果有其他更佳方案可以说明； 3. 监控MySQL服务器，简单方法监控mysql的3306端口，或者使用zabbix提供的Mysql模板，如果有其他更佳方案可以说明； 4. 监控2台web服务器，简单方法监控80端口，如果有其他更佳方案可以说明； 5. 监控URL地址来更精确的监控我们的网站运行正常； 6. 监控反向代理服务器，PPTP服务器等你在期中架构部署的服务。 7. 监控Nginx的7种连接状态。 5.3.3 监控服务通用方法 1. 监控端口 netstat ss lsof&nbsp; ==》 wc -l 2. 监控进程 ps -ef|grep 进程|wc -l&nbsp; 试运行一下 3. 模拟客户端的使用方式监控服务端 &nbsp;&nbsp;　　 &nbsp;&nbsp; web&nbsp; ==》 curl &nbsp;&nbsp; &nbsp;&nbsp;　　 mysql ==》 select insert &nbsp;&nbsp; 　　&nbsp;&nbsp; memcache ==》 set再get 5.4 实施全网监控 安装客户端脚本，for centos6 5.4.1 使用自动发现规则 添加自动发现规则 &nbsp;创建发现动作 查看自动发现的机器。&nbsp; 5.4.2 监控备份服务器 利用系统自带键值进行监控net.tcp.listen[port]&nbsp;创建新的模板&nbsp; 在服务端进行测试 将模板添加到主机&nbsp; 5.4.3 监控NFS服务器 创建nfs监控模板 使用&nbsp;proc.num[&lt;name&gt;,&lt;user&gt;,&lt;state&gt;,&lt;cmdline&gt;]&nbsp; 键值，检测nfs进程的数量 &nbsp;在服务端进行测试 将模板绑定到主机&nbsp; 5.4.4 监控MySQL服务器 将自带的mysqlkey值加上mysql的账户密码，否则不能获取到数据。&nbsp; 使用系统自带模板 &nbsp;net.tcp.port[&lt;ip&gt;,port] 利用自带的监控端口键值进行监控&nbsp; 添加新的mysql监控项端口&nbsp; 将模板关联到主机&nbsp; 5.4.5 监控web服务器 创建监控模板 监控 nginx服务与 80 端口 将模板关联到主机&nbsp; 5.4.6 监控URL地址 创建监测页面 创建web监测模板 &nbsp;&nbsp;&nbsp;创建应用集&nbsp; &nbsp;&nbsp;&nbsp;创建Web场景&nbsp; &nbsp;&nbsp;&nbsp;创建图形 将模板关联到主机&nbsp; 监测结果&nbsp; 5.4.7 监控反向代理服务器 创建自定义key 在服务端测试 [root@m01 ~]# zabbix_get -s 172.16.1.5 &nbsp;-p 10050 -k &quot;keep-ip&quot;1[root@m01 ~]# zabbix_get -s 172.16.1.6 &nbsp;-p 10050 -k &quot;keep-ip&quot;0 在web界面添加模板 &nbsp;将模板关联到主机&nbsp; 5.4.8 监控Nginx的7种连接状态 [root@web01 ~]# for ip in 7 8 9 ;do curl 172.16.1.$ip/status ;doneActive connections: 1server accepts handled requests 73 73 69Reading: 0 Writing: 1 Waiting: 0 Active connections: 1server accepts handled requests 134 134 127Reading: 0 Writing: 1 Waiting: 0 Active connections: 1server accepts handled requests 7 7 7Reading: 0 Writing: 1 Waiting: 0 在nginx服务器上添加key cat &gt;/etc/zabbix/zabbix_agentd.d/userparameter_nginx_status.conf &lt;&lt;&#39;EOF&#39;UserParameter=nginx_active,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;/Active/ {print $NF}&#39;UserParameter=nginx_accepts,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $1}&#39;UserParameter=nginx_handled,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $2}&#39;UserParameter=nginx_requests,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $3}&#39;UserParameter=nginx_reading,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $2}&#39;UserParameter=nginx_writing,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $4}&#39;UserParameter=nginx_waiting,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $6}&#39;EOF 服务端测试 在zabbix-web上添加 监控项 添加图形 将模板关联到主机&nbsp; 查看添加的图形 第6章 自动发现与自动注册 6.1 自动注册与自动注册 6.1.1 简介 自动发现： zabbix Server主动发现所有客户端，然后将客户端登记自己的小本本上，缺点zabbix server压力山大（网段大，客户端多），时间消耗多. 自动注册： zabbix agent主动到zabbix Server上报到，登记；缺点agent有可能找不到Server（配置出错） 6.1.2 两种模式 &nbsp; &nbsp; &nbsp;注意：&nbsp;两种模式都是在agent上进行配置 &nbsp; &nbsp; &nbsp;zabbix&nbsp;的使用要在hosts文件中预先做好主机名的解析 6.2 自动发现--被动模式 第一个里程碑：完成之前的安装 &nbsp; 在ip范围内输入ip，注意格式； &nbsp; &nbsp;延迟在实际的生产环境中要大一些，实验环境可以小一些 &nbsp;&nbsp;&nbsp;创建发现动作 ①&nbsp; 配置动作 ②&nbsp; 在条件中添加条件，让添加更准确 ③&nbsp; 在操作中添加 a)&nbsp; 添加主机与启用主机 &nbsp;&nbsp;　　&nbsp; 然后等待者客户端自动上门就好😏 6.3 自动注册--主动模式 第一个里程碑：zabbix Server安装完毕 （完成） &nbsp;&nbsp; 第二个里程碑：zabbix agent安装完毕，需要额外增加的配置 &nbsp;&nbsp;&nbsp; 源文件与修改后对比 &nbsp; &nbsp;第三个里程碑：在web见面上进行配置 创建动作，添加名称即可&nbsp; 条件中也无需修改&nbsp; &nbsp;&nbsp;&nbsp; 在动作中添加动作 （添加主机、添加到主机群组、链接到模板） &nbsp;&nbsp;&nbsp; 添加完动作后，等待就行了 &nbsp;&nbsp;&nbsp; 注意：重启客户端可以加速发现。但是在生产环境中勿用。 第7章 分布式监控与SNMP监控 7.1 分布式监控 7.1.1 作用 &nbsp; 　　分担压力，减轻负载 &nbsp; 　　多机房监控 zabbix Server&nbsp; ===》&nbsp; zabbix agent （只能同一个局域网监控） 分担压力，降低负载 多机房监控 7.1.2 环境说明 7.1.3 配置zabbix proxy 第一个里程碑：配置zabbix yum源，并安装proxy &nbsp;&nbsp;&nbsp;第二个里程碑：安装数据库 &nbsp;&nbsp;&nbsp; zabbix&nbsp; proxy也需要数据库，这个数据库不是用于存储监控数据的 只是用于存储配置信息 &nbsp;&nbsp; #安装数据库 &nbsp;&nbsp; #建立数据库 &nbsp;&nbsp; #导入数据文件 &nbsp;&nbsp; #配置zabbix proxy 连接数据库 sed -i.ori&nbsp; &#39;162a DBPassword=zabbix&#39; /etc/zabbix/zabbix_proxy.conf sed -i&nbsp; &#39;s#Server=127.0.0.1#Server=172.16.1.61#&#39; /etc/zabbix/zabbix_proxy.conf sed -i&nbsp; &#39;s#Hostname=Zabbix proxy#Hostname=cache01#&#39; /etc/zabbix/zabbix_proxy.conf# Hostname 作为后面添加的代理程序名称，要保持一致 &nbsp;&nbsp; #启动 &nbsp;&nbsp; #检查端口 [root@cache01 ~]# netstat -lntup |grep zabbixtcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10050 &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10051 &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy&nbsp; tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10050 &nbsp; &nbsp; &nbsp; :::* &nbsp; &nbsp; &nbsp;LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10051 &nbsp;:::* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy &nbsp;&nbsp;&nbsp;第三个里程碑：修改agent配置指向 proxy [root@cache01 ~] # grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.61ServerActive=172.16.1.61[root@cache01 ~] # sed -i &#39;s#172.16.1.61#172.16.1.21#g&#39; /etc/zabbix/zabbix_agentd.conf[root@cache01 ~] # grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.21ServerActive=172.16.1.21[root@cache01 ~] # systemctl restart zabbix-agent.service &nbsp;&nbsp;&nbsp;第四个里程碑：web界面添加代理 &nbsp;&nbsp;&nbsp; 管理 &gt;&gt; agent代理程序 &gt;&gt; 创建代理 &nbsp;&nbsp; 代理程序名称要填写主机名 &nbsp;&nbsp; 稍等片刻就能在程序中出现代理 &nbsp;&nbsp; 在主机中能发现主机代理 7.2 SNMP监控 7.2.1 使用范围 无法安装agent&nbsp; 很多前辈的监控软件都可以监控各种设备&nbsp; 都是通过snmp监控 snmp simple network manager protocol 简单网络管理协议 简单网络管理协议（SNMP），由一组网络管理的标准组成，包含一个应用层协议（application layer protocol）、数据库模型（database schema）和一组资源对象。该协议能够支持网络管理系统，用以监测连接到网络上的设备是否有任何引起管理上关注的情况。 7.2.2 安装snmp程序 7.2.3 配置snmp程序 7.2.4 测试snmp 说明： # snmpwalk 类似 zabbix_get # -v 2c&nbsp; 指定使用snmp协议的版本&nbsp; snmp分为v1 v2 v3 # -c public&nbsp; 指定暗号 # sysname&nbsp; 类似zabbix的key 7.2.5 在web界面进行配置 添加新的主机，注意使用snmp接口 选择模板，注意使用SNMP的模板 &nbsp;&nbsp;&nbsp; 添加完成就能够在主机中看到snmp监控对的主机 7.2.6 附录 作者：惨绿少年 文章链接：https://www.cnblogs.com/clsn/p/7885990.html PS:记得查收小编送你的免费大礼包呦~ 福利 | 一万多套PPT模板等你免费来拿！无条件领取！ 免费送 | 1000多套简历模板免费拿，附赠简历制作教程！ 免费领 | 《Shell脚本 100例》电子书免费拿，运维必备干货~ ▼▼点击【阅读原文】，22大互联网热门课程任选免费学" />
<meta property="og:description" content="原文链接： http://bmxxbiao.mikecrm.com/A5ojTQE zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案，在企业中有非常全面的应用，本文是Linux运维老司机撰写，一站式帮你解决zabbix的难题。 第1章 zabbix监控 1.1 为什么要监控 在需要的时刻，提前提醒我们服务器出问题了 当出问题之后，可以找到问题的根源 网站/服务器 的可用性 1.1.1 网站可用性 在软件系统的高可靠性（也称为可用性，英文描述为HA，High Available）里有个衡量其可靠性的标准——X个9，这个X是代表数字3~5。X个9表示在软件系统1年时间的使用过程中，系统可以正常使用时间与总时间（1年）之比，我们通过下面的计算来感受下X个9在不同级别的可靠性差异。 1个9：(1-90%)*365=36.5天，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是36.5天 2个9：(1-99%)*365=3.65天 ， 表示该软件系统在连续运行1年时间里最多可能的业务中断时间是3.65天 3个9：(1-99.9%)*365*24=8.76小时，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是8.76小时。 4个9：(1-99.99%)*365*24=0.876小时=52.6分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是52.6分钟。 5个9：(1-99.999%)*365*24*60=5.26分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是5.26分钟。 6个9：(1-99.9999%)*365*24*60*60=31秒， 示该软件系统在连续运行1年时间里最多可能的业务中断时间是31秒 1.2 监控什么东西 监控一切需要监控的东西，只要能够想到，能够用命令实现的都能用来监控 1.2.1 监控范畴 1.3 怎么来监控 1.3.1 远程管理服务器 如果想远程管理服务器就有远程管理卡，比如Dell idRAC，HP ILO，IBM IMM 1.3.2 监控硬件 查看硬件的温度/风扇转速，电脑有鲁大师，服务器就有ipmitool。 使用ipmitool实现对服务器的命令行远程管理 1.3.3 查看cpu相关 lscpu、uptime、top、htop vmstat mpstat &nbsp;&nbsp; 其中htop需要安装，安装依赖与epel源。 1.3.4 内存够不够可以用 free 1.3.5 磁盘剩多少写的快不快可以用 df、dd、iotop 1.3.6 监控网络 iftop nethogs 1.4 监控工具总览 mrtg 流量监控出图 nagios 监控 cacti&nbsp; 流量监控出图 zabbix&nbsp;监控+出图 1.5 zabbix介绍 Zabbix 是由 Alexei Vladishev 开发的一种网络监视、管理系统，基于 Server-Client 架构。可用于监视各种网络服务、服务器和网络机器等状态。 使用各种 Database-end 如 MySQL, PostgreSQL, SQLite, Oracle 或 IBM DB2 储存资料。Server 端基于 C语言、Web 管理端 frontend 则是基于 PHP 所制作的。Zabbix 可以使用多种方式监视。可以只使用 Simple Check 不需要安装 Client 端，亦可基于 SMTP 或 HTTP ... 各种协定做死活监视。 在客户端如 UNIX, Windows 中安装 Zabbix Agent 之后，可监视 CPU Load、网络使用状况、硬盘容量等各种状态。而就算没有安装 Agent 在监视对象中，Zabbix 也可以经由 SNMP、TCP、ICMP、利用 IPMI、SSH、telnet 对目标进行监视。 另外，Zabbix 包含 XMPP 等各种 Item 警示功能。 1.5.1 zabbix的组成&nbsp; zabbix官网: https://www.zabbix.com zabbix 主要由2部分构成 zabbix server和 zabbix agent zabbix proxy是用来管理其他的agent，作为代理 1.5.2 zabbix监控范畴 ²&nbsp; 硬件监控 ：Zabbix IPMI Interface ²&nbsp; 系统监控 ：Zabbix Agent Interface ²&nbsp; Java 监控：ZabbixJMX Interface ²&nbsp; 网络设备监抟：Zabbix SNMP Interface ²&nbsp; 应用服务监控：Zabbix Agent UserParameter ²&nbsp; MySQL 数据库监控：percona-monitoring-pldlgins ²&nbsp; URL监控：Zabbix Web监控 第2章 安装zabbix 2.1 环境检查 2.2 安装zabbix过程 2.2.1 安装方式选择 编译安装 （服务较多，环境复杂） yum安装（干净环境） 2.2.2 服务端快速安装脚本 2.2.3 客户端快速部署脚本 2.3 检测连通性 2.3.1 服务端安装zabbix-get检测工具 yum install zabbix-get 2.3.2 在服务端进行测试 第3章 web界面操作 3.1 zabbix的web安装 3.1.1 使用浏览器访问 http://10.0.0.61/zabbix/setup.php &nbsp;&nbsp; 在检测信息时，可查看具体的报错信息进行不同的解决 &nbsp;&nbsp; 选择mysql数据库，输入密码即可 &nbsp;&nbsp; host与port不需要修改，name自定义 &nbsp;确认信息,正确点击下一步&nbsp; &nbsp;&nbsp; &nbsp;安装完成、点击finsh &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 进入登陆界面&nbsp; 账号Admin密码zabbix&nbsp;&nbsp;&nbsp;注意A大写 3.2 添加监控信息 3.2.1 修改监控管理机zabbix server 配置 &gt;&gt; 主机 &nbsp; 主机名称： 要与主机名相同，这是zabbix server程序用的 可见名称： 显示在zabbix网页上的，给我们看的 &nbsp; &nbsp;&nbsp; 修改后，要将下面的已启用要勾上 &nbsp;&nbsp; 添加完成就有了管理机的监控主机 3.2.2 添加新的主机 配置 &gt;&gt; 主机 &gt;&gt; 创建主机 &nbsp; 注意勾选以启用 &nbsp;&nbsp; 然后添加模板，选择linux OS ，先点小添加，再点大添加。 &nbsp;&nbsp; 添加完成，将会又两条监控主机信息 3.2.3 查看监控内容 检测中 &nbsp;&gt;&gt; 最新数据 &nbsp;&nbsp; 在最新数据中需要筛选，&nbsp; &nbsp;&nbsp; 输入ip或者名字都能够搜索出来 &nbsp; 在下面就会列出所有的监控项 3.2.4 查看图像 检测中 &gt;&gt; 图形 &nbsp;&nbsp; 选择正确的主机。选择要查看的图形即可出图 第4章 自定义监控与监控报警 4.1 自定义监控 4.1.1 说明 zabbix自带模板Template OS Linux (Template App Zabbix Agent)提供CPU、内存、磁盘、网卡等常规监控，只要新加主机关联此模板，就可自动添加这些监控项。 需求：服务器登陆人数不能超过三人，超过三人报警 4.1.2 预备知识 4.2 实现自定义监控 4.2.1 自定义语法 4.2.2 agent注册 4.2.3 在server端注册(web操作) ①&nbsp;&nbsp;&nbsp;创建模板 配置 &gt;&gt;&nbsp;模板 &gt;&gt;&nbsp;创建模板 点击添加，即可创建出来模板 &nbsp;&nbsp; 查看创建出来的模板。↑ ②&nbsp;&nbsp;&nbsp;创建应用集 应用集类似(目录/文件夹)，其作用是给监控项分类。 点击&nbsp;应用集 &gt;&gt;&nbsp;创建应用集 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 自定义应用集的名称，然后点击添加 ③&nbsp;&nbsp;&nbsp;创建监控项 监控项 &gt;&gt;&nbsp;创建监控项 键值&nbsp;-- key,即前面出创建的login-user。 &nbsp;&nbsp; 注意：创建监控项的时候，注意选择上应用集，即之前创建的安全。 ④&nbsp;&nbsp;&nbsp;创建触发器 触发器的作用：当监控项获取到的值达到一定条件时就触发报警 (根据需求创建) 触发器 &gt;&gt;&nbsp;创建触发器 创建触发器，自定义名称，该名称是报警时显示的名称。 &nbsp;&nbsp; 表达式，点击右边的添加，选择表达式。&nbsp; &nbsp;&nbsp; 严重性自定义。 &nbsp;&nbsp;&nbsp;表达式的定义&nbsp;↓&nbsp;，选择之前创建的监控项， 最新的T值为当前获取到的值。 &nbsp;&nbsp; 添加完成，能够在触发器中看到添加的情况 ⑤&nbsp;&nbsp;&nbsp;创建图形 以图形的方式展示出来监控信息 图形 &gt;&gt;&nbsp;创建图形 名称自定义，关联上监控项。 ⑥&nbsp;&nbsp;&nbsp;主机关联模板 配置 &gt;&gt;&nbsp;主机 &nbsp;&nbsp; 一个主机可以关联多个模板 4.2.4 查看监控的图形&nbsp; 4.3 监控报警 4.3.1 第三方报警平台 http://www.onealert.com &nbsp;&nbsp; 　 通过 OneAlert 提供的通知分派与排班策略，以及全方位的短信、微信、QQ、电话提醒服务，您可以在最合适的时间，将最重要的信息推送给最合适的人员。 4.3.2 onealert配置 添加应用，注意添加的是zabbix&nbsp; &nbsp;&nbsp; 实现微信报警需要关注微信公众号即可。&nbsp; 4.3.3 安装 onealert Agent 4.3.1 如何删除onealert Agent ①&nbsp; 删除报警媒介类型中的脚本&nbsp; ②&nbsp; 删除创建的用户 ③&nbsp; 删除用户群组 ④&nbsp; 删除创建的动作&nbsp; 4.3.2 触发器响应，发送报警信息&nbsp; &nbsp;&nbsp; 在微信和邮件中，均能收到报警信息。 &nbsp;&nbsp;&nbsp;注意：当状态改变的时候才会发邮件 &nbsp;&nbsp;&nbsp;　　&nbsp;好--&gt;坏 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;坏--&gt;好 4.4 监控可视化 4.4.1 聚合图形 最新数据 &gt;&gt;&nbsp;图形 &nbsp;&nbsp; 自定义名称 &nbsp;&nbsp; 点击聚合图形的名称，进行更改，添加要显示的图形即可。 4.4.2 幻灯片 添加幻灯片 监测中 &gt;&gt;&nbsp;复合图形 &gt;&gt;&nbsp;幻灯片演示 &nbsp;&nbsp; 创建幻灯片，名称自定，选择要显示的 &nbsp;&nbsp; 幻灯片根据设定的时间自动播放 4.5 模板的共享 4.5.1 主机共享 在主机页打开，全选后点击导出 &nbsp; &nbsp; 导入 4.5.2 模板共享 https://github.com/zhangyao8/zabbix-community-repos 第5章 监控全网服务器 5.1 需求说明 实际需求： 公司已经有了100台服务器，现在需要使用zabbix全部监控起来。 5.2 规划方案 常规监控：cpu，内存，磁盘，网卡&nbsp; 问题：怎样快速添加100台机器 &nbsp;&nbsp; 　　方法1：使用克隆的方式 &nbsp;　　&nbsp; 方法2：自动注册和自动发现 &nbsp;　　&nbsp; 方法3：调用zabbix api接口&nbsp; curl 、python &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;　　 &nbsp;开发自己的运维平台兼容zabbix的通道 服务监控，url监控等特殊监控：自定义监控 5.2.1 api接口使用（curl） 5.3 具体实施规划 5.3.1 硬件、系统、网络监控 所有集群节点（所有虚拟机）都监控上 交换机，路由器监控（简单方法：换成端口对应服务器网卡流量监控；标准方法：监控交换机的网卡） snmp监控 5.3.2 应用服务监控 1. 监控备份服务器，简单方法是监控rsync端口，如果有其他更佳方案可以说明； 2. 监控NFS服务器，使用监控NFS进程来判断NFS服务器正常，如果有其他更佳方案可以说明； 3. 监控MySQL服务器，简单方法监控mysql的3306端口，或者使用zabbix提供的Mysql模板，如果有其他更佳方案可以说明； 4. 监控2台web服务器，简单方法监控80端口，如果有其他更佳方案可以说明； 5. 监控URL地址来更精确的监控我们的网站运行正常； 6. 监控反向代理服务器，PPTP服务器等你在期中架构部署的服务。 7. 监控Nginx的7种连接状态。 5.3.3 监控服务通用方法 1. 监控端口 netstat ss lsof&nbsp; ==》 wc -l 2. 监控进程 ps -ef|grep 进程|wc -l&nbsp; 试运行一下 3. 模拟客户端的使用方式监控服务端 &nbsp;&nbsp;　　 &nbsp;&nbsp; web&nbsp; ==》 curl &nbsp;&nbsp; &nbsp;&nbsp;　　 mysql ==》 select insert &nbsp;&nbsp; 　　&nbsp;&nbsp; memcache ==》 set再get 5.4 实施全网监控 安装客户端脚本，for centos6 5.4.1 使用自动发现规则 添加自动发现规则 &nbsp;创建发现动作 查看自动发现的机器。&nbsp; 5.4.2 监控备份服务器 利用系统自带键值进行监控net.tcp.listen[port]&nbsp;创建新的模板&nbsp; 在服务端进行测试 将模板添加到主机&nbsp; 5.4.3 监控NFS服务器 创建nfs监控模板 使用&nbsp;proc.num[&lt;name&gt;,&lt;user&gt;,&lt;state&gt;,&lt;cmdline&gt;]&nbsp; 键值，检测nfs进程的数量 &nbsp;在服务端进行测试 将模板绑定到主机&nbsp; 5.4.4 监控MySQL服务器 将自带的mysqlkey值加上mysql的账户密码，否则不能获取到数据。&nbsp; 使用系统自带模板 &nbsp;net.tcp.port[&lt;ip&gt;,port] 利用自带的监控端口键值进行监控&nbsp; 添加新的mysql监控项端口&nbsp; 将模板关联到主机&nbsp; 5.4.5 监控web服务器 创建监控模板 监控 nginx服务与 80 端口 将模板关联到主机&nbsp; 5.4.6 监控URL地址 创建监测页面 创建web监测模板 &nbsp;&nbsp;&nbsp;创建应用集&nbsp; &nbsp;&nbsp;&nbsp;创建Web场景&nbsp; &nbsp;&nbsp;&nbsp;创建图形 将模板关联到主机&nbsp; 监测结果&nbsp; 5.4.7 监控反向代理服务器 创建自定义key 在服务端测试 [root@m01 ~]# zabbix_get -s 172.16.1.5 &nbsp;-p 10050 -k &quot;keep-ip&quot;1[root@m01 ~]# zabbix_get -s 172.16.1.6 &nbsp;-p 10050 -k &quot;keep-ip&quot;0 在web界面添加模板 &nbsp;将模板关联到主机&nbsp; 5.4.8 监控Nginx的7种连接状态 [root@web01 ~]# for ip in 7 8 9 ;do curl 172.16.1.$ip/status ;doneActive connections: 1server accepts handled requests 73 73 69Reading: 0 Writing: 1 Waiting: 0 Active connections: 1server accepts handled requests 134 134 127Reading: 0 Writing: 1 Waiting: 0 Active connections: 1server accepts handled requests 7 7 7Reading: 0 Writing: 1 Waiting: 0 在nginx服务器上添加key cat &gt;/etc/zabbix/zabbix_agentd.d/userparameter_nginx_status.conf &lt;&lt;&#39;EOF&#39;UserParameter=nginx_active,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;/Active/ {print $NF}&#39;UserParameter=nginx_accepts,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $1}&#39;UserParameter=nginx_handled,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $2}&#39;UserParameter=nginx_requests,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $3}&#39;UserParameter=nginx_reading,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $2}&#39;UserParameter=nginx_writing,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $4}&#39;UserParameter=nginx_waiting,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $6}&#39;EOF 服务端测试 在zabbix-web上添加 监控项 添加图形 将模板关联到主机&nbsp; 查看添加的图形 第6章 自动发现与自动注册 6.1 自动注册与自动注册 6.1.1 简介 自动发现： zabbix Server主动发现所有客户端，然后将客户端登记自己的小本本上，缺点zabbix server压力山大（网段大，客户端多），时间消耗多. 自动注册： zabbix agent主动到zabbix Server上报到，登记；缺点agent有可能找不到Server（配置出错） 6.1.2 两种模式 &nbsp; &nbsp; &nbsp;注意：&nbsp;两种模式都是在agent上进行配置 &nbsp; &nbsp; &nbsp;zabbix&nbsp;的使用要在hosts文件中预先做好主机名的解析 6.2 自动发现--被动模式 第一个里程碑：完成之前的安装 &nbsp; 在ip范围内输入ip，注意格式； &nbsp; &nbsp;延迟在实际的生产环境中要大一些，实验环境可以小一些 &nbsp;&nbsp;&nbsp;创建发现动作 ①&nbsp; 配置动作 ②&nbsp; 在条件中添加条件，让添加更准确 ③&nbsp; 在操作中添加 a)&nbsp; 添加主机与启用主机 &nbsp;&nbsp;　　&nbsp; 然后等待者客户端自动上门就好😏 6.3 自动注册--主动模式 第一个里程碑：zabbix Server安装完毕 （完成） &nbsp;&nbsp; 第二个里程碑：zabbix agent安装完毕，需要额外增加的配置 &nbsp;&nbsp;&nbsp; 源文件与修改后对比 &nbsp; &nbsp;第三个里程碑：在web见面上进行配置 创建动作，添加名称即可&nbsp; 条件中也无需修改&nbsp; &nbsp;&nbsp;&nbsp; 在动作中添加动作 （添加主机、添加到主机群组、链接到模板） &nbsp;&nbsp;&nbsp; 添加完动作后，等待就行了 &nbsp;&nbsp;&nbsp; 注意：重启客户端可以加速发现。但是在生产环境中勿用。 第7章 分布式监控与SNMP监控 7.1 分布式监控 7.1.1 作用 &nbsp; 　　分担压力，减轻负载 &nbsp; 　　多机房监控 zabbix Server&nbsp; ===》&nbsp; zabbix agent （只能同一个局域网监控） 分担压力，降低负载 多机房监控 7.1.2 环境说明 7.1.3 配置zabbix proxy 第一个里程碑：配置zabbix yum源，并安装proxy &nbsp;&nbsp;&nbsp;第二个里程碑：安装数据库 &nbsp;&nbsp;&nbsp; zabbix&nbsp; proxy也需要数据库，这个数据库不是用于存储监控数据的 只是用于存储配置信息 &nbsp;&nbsp; #安装数据库 &nbsp;&nbsp; #建立数据库 &nbsp;&nbsp; #导入数据文件 &nbsp;&nbsp; #配置zabbix proxy 连接数据库 sed -i.ori&nbsp; &#39;162a DBPassword=zabbix&#39; /etc/zabbix/zabbix_proxy.conf sed -i&nbsp; &#39;s#Server=127.0.0.1#Server=172.16.1.61#&#39; /etc/zabbix/zabbix_proxy.conf sed -i&nbsp; &#39;s#Hostname=Zabbix proxy#Hostname=cache01#&#39; /etc/zabbix/zabbix_proxy.conf# Hostname 作为后面添加的代理程序名称，要保持一致 &nbsp;&nbsp; #启动 &nbsp;&nbsp; #检查端口 [root@cache01 ~]# netstat -lntup |grep zabbixtcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10050 &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10051 &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy&nbsp; tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10050 &nbsp; &nbsp; &nbsp; :::* &nbsp; &nbsp; &nbsp;LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10051 &nbsp;:::* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy &nbsp;&nbsp;&nbsp;第三个里程碑：修改agent配置指向 proxy [root@cache01 ~] # grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.61ServerActive=172.16.1.61[root@cache01 ~] # sed -i &#39;s#172.16.1.61#172.16.1.21#g&#39; /etc/zabbix/zabbix_agentd.conf[root@cache01 ~] # grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.21ServerActive=172.16.1.21[root@cache01 ~] # systemctl restart zabbix-agent.service &nbsp;&nbsp;&nbsp;第四个里程碑：web界面添加代理 &nbsp;&nbsp;&nbsp; 管理 &gt;&gt; agent代理程序 &gt;&gt; 创建代理 &nbsp;&nbsp; 代理程序名称要填写主机名 &nbsp;&nbsp; 稍等片刻就能在程序中出现代理 &nbsp;&nbsp; 在主机中能发现主机代理 7.2 SNMP监控 7.2.1 使用范围 无法安装agent&nbsp; 很多前辈的监控软件都可以监控各种设备&nbsp; 都是通过snmp监控 snmp simple network manager protocol 简单网络管理协议 简单网络管理协议（SNMP），由一组网络管理的标准组成，包含一个应用层协议（application layer protocol）、数据库模型（database schema）和一组资源对象。该协议能够支持网络管理系统，用以监测连接到网络上的设备是否有任何引起管理上关注的情况。 7.2.2 安装snmp程序 7.2.3 配置snmp程序 7.2.4 测试snmp 说明： # snmpwalk 类似 zabbix_get # -v 2c&nbsp; 指定使用snmp协议的版本&nbsp; snmp分为v1 v2 v3 # -c public&nbsp; 指定暗号 # sysname&nbsp; 类似zabbix的key 7.2.5 在web界面进行配置 添加新的主机，注意使用snmp接口 选择模板，注意使用SNMP的模板 &nbsp;&nbsp;&nbsp; 添加完成就能够在主机中看到snmp监控对的主机 7.2.6 附录 作者：惨绿少年 文章链接：https://www.cnblogs.com/clsn/p/7885990.html PS:记得查收小编送你的免费大礼包呦~ 福利 | 一万多套PPT模板等你免费来拿！无条件领取！ 免费送 | 1000多套简历模板免费拿，附赠简历制作教程！ 免费领 | 《Shell脚本 100例》电子书免费拿，运维必备干货~ ▼▼点击【阅读原文】，22大互联网热门课程任选免费学" />
<link rel="canonical" href="https://uzzz.org/2019/08/02/793502.html" />
<meta property="og:url" content="https://uzzz.org/2019/08/02/793502.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-02T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"原文链接： http://bmxxbiao.mikecrm.com/A5ojTQE zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案，在企业中有非常全面的应用，本文是Linux运维老司机撰写，一站式帮你解决zabbix的难题。 第1章 zabbix监控 1.1 为什么要监控 在需要的时刻，提前提醒我们服务器出问题了 当出问题之后，可以找到问题的根源 网站/服务器 的可用性 1.1.1 网站可用性 在软件系统的高可靠性（也称为可用性，英文描述为HA，High Available）里有个衡量其可靠性的标准——X个9，这个X是代表数字3~5。X个9表示在软件系统1年时间的使用过程中，系统可以正常使用时间与总时间（1年）之比，我们通过下面的计算来感受下X个9在不同级别的可靠性差异。 1个9：(1-90%)*365=36.5天，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是36.5天 2个9：(1-99%)*365=3.65天 ， 表示该软件系统在连续运行1年时间里最多可能的业务中断时间是3.65天 3个9：(1-99.9%)*365*24=8.76小时，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是8.76小时。 4个9：(1-99.99%)*365*24=0.876小时=52.6分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是52.6分钟。 5个9：(1-99.999%)*365*24*60=5.26分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是5.26分钟。 6个9：(1-99.9999%)*365*24*60*60=31秒， 示该软件系统在连续运行1年时间里最多可能的业务中断时间是31秒 1.2 监控什么东西 监控一切需要监控的东西，只要能够想到，能够用命令实现的都能用来监控 1.2.1 监控范畴 1.3 怎么来监控 1.3.1 远程管理服务器 如果想远程管理服务器就有远程管理卡，比如Dell idRAC，HP ILO，IBM IMM 1.3.2 监控硬件 查看硬件的温度/风扇转速，电脑有鲁大师，服务器就有ipmitool。 使用ipmitool实现对服务器的命令行远程管理 1.3.3 查看cpu相关 lscpu、uptime、top、htop vmstat mpstat &nbsp;&nbsp; 其中htop需要安装，安装依赖与epel源。 1.3.4 内存够不够可以用 free 1.3.5 磁盘剩多少写的快不快可以用 df、dd、iotop 1.3.6 监控网络 iftop nethogs 1.4 监控工具总览 mrtg 流量监控出图 nagios 监控 cacti&nbsp; 流量监控出图 zabbix&nbsp;监控+出图 1.5 zabbix介绍 Zabbix 是由 Alexei Vladishev 开发的一种网络监视、管理系统，基于 Server-Client 架构。可用于监视各种网络服务、服务器和网络机器等状态。 使用各种 Database-end 如 MySQL, PostgreSQL, SQLite, Oracle 或 IBM DB2 储存资料。Server 端基于 C语言、Web 管理端 frontend 则是基于 PHP 所制作的。Zabbix 可以使用多种方式监视。可以只使用 Simple Check 不需要安装 Client 端，亦可基于 SMTP 或 HTTP ... 各种协定做死活监视。 在客户端如 UNIX, Windows 中安装 Zabbix Agent 之后，可监视 CPU Load、网络使用状况、硬盘容量等各种状态。而就算没有安装 Agent 在监视对象中，Zabbix 也可以经由 SNMP、TCP、ICMP、利用 IPMI、SSH、telnet 对目标进行监视。 另外，Zabbix 包含 XMPP 等各种 Item 警示功能。 1.5.1 zabbix的组成&nbsp; zabbix官网: https://www.zabbix.com zabbix 主要由2部分构成 zabbix server和 zabbix agent zabbix proxy是用来管理其他的agent，作为代理 1.5.2 zabbix监控范畴 ²&nbsp; 硬件监控 ：Zabbix IPMI Interface ²&nbsp; 系统监控 ：Zabbix Agent Interface ²&nbsp; Java 监控：ZabbixJMX Interface ²&nbsp; 网络设备监抟：Zabbix SNMP Interface ²&nbsp; 应用服务监控：Zabbix Agent UserParameter ²&nbsp; MySQL 数据库监控：percona-monitoring-pldlgins ²&nbsp; URL监控：Zabbix Web监控 第2章 安装zabbix 2.1 环境检查 2.2 安装zabbix过程 2.2.1 安装方式选择 编译安装 （服务较多，环境复杂） yum安装（干净环境） 2.2.2 服务端快速安装脚本 2.2.3 客户端快速部署脚本 2.3 检测连通性 2.3.1 服务端安装zabbix-get检测工具 yum install zabbix-get 2.3.2 在服务端进行测试 第3章 web界面操作 3.1 zabbix的web安装 3.1.1 使用浏览器访问 http://10.0.0.61/zabbix/setup.php &nbsp;&nbsp; 在检测信息时，可查看具体的报错信息进行不同的解决 &nbsp;&nbsp; 选择mysql数据库，输入密码即可 &nbsp;&nbsp; host与port不需要修改，name自定义 &nbsp;确认信息,正确点击下一步&nbsp; &nbsp;&nbsp; &nbsp;安装完成、点击finsh &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 进入登陆界面&nbsp; 账号Admin密码zabbix&nbsp;&nbsp;&nbsp;注意A大写 3.2 添加监控信息 3.2.1 修改监控管理机zabbix server 配置 &gt;&gt; 主机 &nbsp; 主机名称： 要与主机名相同，这是zabbix server程序用的 可见名称： 显示在zabbix网页上的，给我们看的 &nbsp; &nbsp;&nbsp; 修改后，要将下面的已启用要勾上 &nbsp;&nbsp; 添加完成就有了管理机的监控主机 3.2.2 添加新的主机 配置 &gt;&gt; 主机 &gt;&gt; 创建主机 &nbsp; 注意勾选以启用 &nbsp;&nbsp; 然后添加模板，选择linux OS ，先点小添加，再点大添加。 &nbsp;&nbsp; 添加完成，将会又两条监控主机信息 3.2.3 查看监控内容 检测中 &nbsp;&gt;&gt; 最新数据 &nbsp;&nbsp; 在最新数据中需要筛选，&nbsp; &nbsp;&nbsp; 输入ip或者名字都能够搜索出来 &nbsp; 在下面就会列出所有的监控项 3.2.4 查看图像 检测中 &gt;&gt; 图形 &nbsp;&nbsp; 选择正确的主机。选择要查看的图形即可出图 第4章 自定义监控与监控报警 4.1 自定义监控 4.1.1 说明 zabbix自带模板Template OS Linux (Template App Zabbix Agent)提供CPU、内存、磁盘、网卡等常规监控，只要新加主机关联此模板，就可自动添加这些监控项。 需求：服务器登陆人数不能超过三人，超过三人报警 4.1.2 预备知识 4.2 实现自定义监控 4.2.1 自定义语法 4.2.2 agent注册 4.2.3 在server端注册(web操作) ①&nbsp;&nbsp;&nbsp;创建模板 配置 &gt;&gt;&nbsp;模板 &gt;&gt;&nbsp;创建模板 点击添加，即可创建出来模板 &nbsp;&nbsp; 查看创建出来的模板。↑ ②&nbsp;&nbsp;&nbsp;创建应用集 应用集类似(目录/文件夹)，其作用是给监控项分类。 点击&nbsp;应用集 &gt;&gt;&nbsp;创建应用集 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 自定义应用集的名称，然后点击添加 ③&nbsp;&nbsp;&nbsp;创建监控项 监控项 &gt;&gt;&nbsp;创建监控项 键值&nbsp;-- key,即前面出创建的login-user。 &nbsp;&nbsp; 注意：创建监控项的时候，注意选择上应用集，即之前创建的安全。 ④&nbsp;&nbsp;&nbsp;创建触发器 触发器的作用：当监控项获取到的值达到一定条件时就触发报警 (根据需求创建) 触发器 &gt;&gt;&nbsp;创建触发器 创建触发器，自定义名称，该名称是报警时显示的名称。 &nbsp;&nbsp; 表达式，点击右边的添加，选择表达式。&nbsp; &nbsp;&nbsp; 严重性自定义。 &nbsp;&nbsp;&nbsp;表达式的定义&nbsp;↓&nbsp;，选择之前创建的监控项， 最新的T值为当前获取到的值。 &nbsp;&nbsp; 添加完成，能够在触发器中看到添加的情况 ⑤&nbsp;&nbsp;&nbsp;创建图形 以图形的方式展示出来监控信息 图形 &gt;&gt;&nbsp;创建图形 名称自定义，关联上监控项。 ⑥&nbsp;&nbsp;&nbsp;主机关联模板 配置 &gt;&gt;&nbsp;主机 &nbsp;&nbsp; 一个主机可以关联多个模板 4.2.4 查看监控的图形&nbsp; 4.3 监控报警 4.3.1 第三方报警平台 http://www.onealert.com &nbsp;&nbsp; 　 通过 OneAlert 提供的通知分派与排班策略，以及全方位的短信、微信、QQ、电话提醒服务，您可以在最合适的时间，将最重要的信息推送给最合适的人员。 4.3.2 onealert配置 添加应用，注意添加的是zabbix&nbsp; &nbsp;&nbsp; 实现微信报警需要关注微信公众号即可。&nbsp; 4.3.3 安装 onealert Agent 4.3.1 如何删除onealert Agent ①&nbsp; 删除报警媒介类型中的脚本&nbsp; ②&nbsp; 删除创建的用户 ③&nbsp; 删除用户群组 ④&nbsp; 删除创建的动作&nbsp; 4.3.2 触发器响应，发送报警信息&nbsp; &nbsp;&nbsp; 在微信和邮件中，均能收到报警信息。 &nbsp;&nbsp;&nbsp;注意：当状态改变的时候才会发邮件 &nbsp;&nbsp;&nbsp;　　&nbsp;好--&gt;坏 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;坏--&gt;好 4.4 监控可视化 4.4.1 聚合图形 最新数据 &gt;&gt;&nbsp;图形 &nbsp;&nbsp; 自定义名称 &nbsp;&nbsp; 点击聚合图形的名称，进行更改，添加要显示的图形即可。 4.4.2 幻灯片 添加幻灯片 监测中 &gt;&gt;&nbsp;复合图形 &gt;&gt;&nbsp;幻灯片演示 &nbsp;&nbsp; 创建幻灯片，名称自定，选择要显示的 &nbsp;&nbsp; 幻灯片根据设定的时间自动播放 4.5 模板的共享 4.5.1 主机共享 在主机页打开，全选后点击导出 &nbsp; &nbsp; 导入 4.5.2 模板共享 https://github.com/zhangyao8/zabbix-community-repos 第5章 监控全网服务器 5.1 需求说明 实际需求： 公司已经有了100台服务器，现在需要使用zabbix全部监控起来。 5.2 规划方案 常规监控：cpu，内存，磁盘，网卡&nbsp; 问题：怎样快速添加100台机器 &nbsp;&nbsp; 　　方法1：使用克隆的方式 &nbsp;　　&nbsp; 方法2：自动注册和自动发现 &nbsp;　　&nbsp; 方法3：调用zabbix api接口&nbsp; curl 、python &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;　　 &nbsp;开发自己的运维平台兼容zabbix的通道 服务监控，url监控等特殊监控：自定义监控 5.2.1 api接口使用（curl） 5.3 具体实施规划 5.3.1 硬件、系统、网络监控 所有集群节点（所有虚拟机）都监控上 交换机，路由器监控（简单方法：换成端口对应服务器网卡流量监控；标准方法：监控交换机的网卡） snmp监控 5.3.2 应用服务监控 1. 监控备份服务器，简单方法是监控rsync端口，如果有其他更佳方案可以说明； 2. 监控NFS服务器，使用监控NFS进程来判断NFS服务器正常，如果有其他更佳方案可以说明； 3. 监控MySQL服务器，简单方法监控mysql的3306端口，或者使用zabbix提供的Mysql模板，如果有其他更佳方案可以说明； 4. 监控2台web服务器，简单方法监控80端口，如果有其他更佳方案可以说明； 5. 监控URL地址来更精确的监控我们的网站运行正常； 6. 监控反向代理服务器，PPTP服务器等你在期中架构部署的服务。 7. 监控Nginx的7种连接状态。 5.3.3 监控服务通用方法 1. 监控端口 netstat ss lsof&nbsp; ==》 wc -l 2. 监控进程 ps -ef|grep 进程|wc -l&nbsp; 试运行一下 3. 模拟客户端的使用方式监控服务端 &nbsp;&nbsp;　　 &nbsp;&nbsp; web&nbsp; ==》 curl &nbsp;&nbsp; &nbsp;&nbsp;　　 mysql ==》 select insert &nbsp;&nbsp; 　　&nbsp;&nbsp; memcache ==》 set再get 5.4 实施全网监控 安装客户端脚本，for centos6 5.4.1 使用自动发现规则 添加自动发现规则 &nbsp;创建发现动作 查看自动发现的机器。&nbsp; 5.4.2 监控备份服务器 利用系统自带键值进行监控net.tcp.listen[port]&nbsp;创建新的模板&nbsp; 在服务端进行测试 将模板添加到主机&nbsp; 5.4.3 监控NFS服务器 创建nfs监控模板 使用&nbsp;proc.num[&lt;name&gt;,&lt;user&gt;,&lt;state&gt;,&lt;cmdline&gt;]&nbsp; 键值，检测nfs进程的数量 &nbsp;在服务端进行测试 将模板绑定到主机&nbsp; 5.4.4 监控MySQL服务器 将自带的mysqlkey值加上mysql的账户密码，否则不能获取到数据。&nbsp; 使用系统自带模板 &nbsp;net.tcp.port[&lt;ip&gt;,port] 利用自带的监控端口键值进行监控&nbsp; 添加新的mysql监控项端口&nbsp; 将模板关联到主机&nbsp; 5.4.5 监控web服务器 创建监控模板 监控 nginx服务与 80 端口 将模板关联到主机&nbsp; 5.4.6 监控URL地址 创建监测页面 创建web监测模板 &nbsp;&nbsp;&nbsp;创建应用集&nbsp; &nbsp;&nbsp;&nbsp;创建Web场景&nbsp; &nbsp;&nbsp;&nbsp;创建图形 将模板关联到主机&nbsp; 监测结果&nbsp; 5.4.7 监控反向代理服务器 创建自定义key 在服务端测试 [root@m01 ~]# zabbix_get -s 172.16.1.5 &nbsp;-p 10050 -k &quot;keep-ip&quot;1[root@m01 ~]# zabbix_get -s 172.16.1.6 &nbsp;-p 10050 -k &quot;keep-ip&quot;0 在web界面添加模板 &nbsp;将模板关联到主机&nbsp; 5.4.8 监控Nginx的7种连接状态 [root@web01 ~]# for ip in 7 8 9 ;do curl 172.16.1.$ip/status ;doneActive connections: 1server accepts handled requests 73 73 69Reading: 0 Writing: 1 Waiting: 0 Active connections: 1server accepts handled requests 134 134 127Reading: 0 Writing: 1 Waiting: 0 Active connections: 1server accepts handled requests 7 7 7Reading: 0 Writing: 1 Waiting: 0 在nginx服务器上添加key cat &gt;/etc/zabbix/zabbix_agentd.d/userparameter_nginx_status.conf &lt;&lt;&#39;EOF&#39;UserParameter=nginx_active,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;/Active/ {print $NF}&#39;UserParameter=nginx_accepts,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $1}&#39;UserParameter=nginx_handled,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $2}&#39;UserParameter=nginx_requests,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==3 {print $3}&#39;UserParameter=nginx_reading,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $2}&#39;UserParameter=nginx_writing,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $4}&#39;UserParameter=nginx_waiting,curl -s &nbsp;127.0.0.1/status|awk&nbsp; &#39;NR==4 {print $6}&#39;EOF 服务端测试 在zabbix-web上添加 监控项 添加图形 将模板关联到主机&nbsp; 查看添加的图形 第6章 自动发现与自动注册 6.1 自动注册与自动注册 6.1.1 简介 自动发现： zabbix Server主动发现所有客户端，然后将客户端登记自己的小本本上，缺点zabbix server压力山大（网段大，客户端多），时间消耗多. 自动注册： zabbix agent主动到zabbix Server上报到，登记；缺点agent有可能找不到Server（配置出错） 6.1.2 两种模式 &nbsp; &nbsp; &nbsp;注意：&nbsp;两种模式都是在agent上进行配置 &nbsp; &nbsp; &nbsp;zabbix&nbsp;的使用要在hosts文件中预先做好主机名的解析 6.2 自动发现--被动模式 第一个里程碑：完成之前的安装 &nbsp; 在ip范围内输入ip，注意格式； &nbsp; &nbsp;延迟在实际的生产环境中要大一些，实验环境可以小一些 &nbsp;&nbsp;&nbsp;创建发现动作 ①&nbsp; 配置动作 ②&nbsp; 在条件中添加条件，让添加更准确 ③&nbsp; 在操作中添加 a)&nbsp; 添加主机与启用主机 &nbsp;&nbsp;　　&nbsp; 然后等待者客户端自动上门就好😏 6.3 自动注册--主动模式 第一个里程碑：zabbix Server安装完毕 （完成） &nbsp;&nbsp; 第二个里程碑：zabbix agent安装完毕，需要额外增加的配置 &nbsp;&nbsp;&nbsp; 源文件与修改后对比 &nbsp; &nbsp;第三个里程碑：在web见面上进行配置 创建动作，添加名称即可&nbsp; 条件中也无需修改&nbsp; &nbsp;&nbsp;&nbsp; 在动作中添加动作 （添加主机、添加到主机群组、链接到模板） &nbsp;&nbsp;&nbsp; 添加完动作后，等待就行了 &nbsp;&nbsp;&nbsp; 注意：重启客户端可以加速发现。但是在生产环境中勿用。 第7章 分布式监控与SNMP监控 7.1 分布式监控 7.1.1 作用 &nbsp; 　　分担压力，减轻负载 &nbsp; 　　多机房监控 zabbix Server&nbsp; ===》&nbsp; zabbix agent （只能同一个局域网监控） 分担压力，降低负载 多机房监控 7.1.2 环境说明 7.1.3 配置zabbix proxy 第一个里程碑：配置zabbix yum源，并安装proxy &nbsp;&nbsp;&nbsp;第二个里程碑：安装数据库 &nbsp;&nbsp;&nbsp; zabbix&nbsp; proxy也需要数据库，这个数据库不是用于存储监控数据的 只是用于存储配置信息 &nbsp;&nbsp; #安装数据库 &nbsp;&nbsp; #建立数据库 &nbsp;&nbsp; #导入数据文件 &nbsp;&nbsp; #配置zabbix proxy 连接数据库 sed -i.ori&nbsp; &#39;162a DBPassword=zabbix&#39; /etc/zabbix/zabbix_proxy.conf sed -i&nbsp; &#39;s#Server=127.0.0.1#Server=172.16.1.61#&#39; /etc/zabbix/zabbix_proxy.conf sed -i&nbsp; &#39;s#Hostname=Zabbix proxy#Hostname=cache01#&#39; /etc/zabbix/zabbix_proxy.conf# Hostname 作为后面添加的代理程序名称，要保持一致 &nbsp;&nbsp; #启动 &nbsp;&nbsp; #检查端口 [root@cache01 ~]# netstat -lntup |grep zabbixtcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10050 &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10051 &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy&nbsp; tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10050 &nbsp; &nbsp; &nbsp; :::* &nbsp; &nbsp; &nbsp;LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10051 &nbsp;:::* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy &nbsp;&nbsp;&nbsp;第三个里程碑：修改agent配置指向 proxy [root@cache01 ~] # grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.61ServerActive=172.16.1.61[root@cache01 ~] # sed -i &#39;s#172.16.1.61#172.16.1.21#g&#39; /etc/zabbix/zabbix_agentd.conf[root@cache01 ~] # grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.21ServerActive=172.16.1.21[root@cache01 ~] # systemctl restart zabbix-agent.service &nbsp;&nbsp;&nbsp;第四个里程碑：web界面添加代理 &nbsp;&nbsp;&nbsp; 管理 &gt;&gt; agent代理程序 &gt;&gt; 创建代理 &nbsp;&nbsp; 代理程序名称要填写主机名 &nbsp;&nbsp; 稍等片刻就能在程序中出现代理 &nbsp;&nbsp; 在主机中能发现主机代理 7.2 SNMP监控 7.2.1 使用范围 无法安装agent&nbsp; 很多前辈的监控软件都可以监控各种设备&nbsp; 都是通过snmp监控 snmp simple network manager protocol 简单网络管理协议 简单网络管理协议（SNMP），由一组网络管理的标准组成，包含一个应用层协议（application layer protocol）、数据库模型（database schema）和一组资源对象。该协议能够支持网络管理系统，用以监测连接到网络上的设备是否有任何引起管理上关注的情况。 7.2.2 安装snmp程序 7.2.3 配置snmp程序 7.2.4 测试snmp 说明： # snmpwalk 类似 zabbix_get # -v 2c&nbsp; 指定使用snmp协议的版本&nbsp; snmp分为v1 v2 v3 # -c public&nbsp; 指定暗号 # sysname&nbsp; 类似zabbix的key 7.2.5 在web界面进行配置 添加新的主机，注意使用snmp接口 选择模板，注意使用SNMP的模板 &nbsp;&nbsp;&nbsp; 添加完成就能够在主机中看到snmp监控对的主机 7.2.6 附录 作者：惨绿少年 文章链接：https://www.cnblogs.com/clsn/p/7885990.html PS:记得查收小编送你的免费大礼包呦~ 福利 | 一万多套PPT模板等你免费来拿！无条件领取！ 免费送 | 1000多套简历模板免费拿，附赠简历制作教程！ 免费领 | 《Shell脚本 100例》电子书免费拿，运维必备干货~ ▼▼点击【阅读原文】，22大互联网热门课程任选免费学","@type":"BlogPosting","url":"https://uzzz.org/2019/08/02/793502.html","headline":"运维老司机带你学Zabbix，小白速收！","dateModified":"2019-08-02T00:00:00+08:00","datePublished":"2019-08-02T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/08/02/793502.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>运维老司机带你学Zabbix，小白速收！</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix"> 
 <div class="article-source-link">
   原文链接：
  <a href="http://bmxxbiao.mikecrm.com/A5ojTQE" target="_blank">http://bmxxbiao.mikecrm.com/A5ojTQE</a> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="rich_media_content" id="js_content"> 
   <p><img class="__bg_gif" style="font-family:'微软雅黑';font-size:14px;color:rgb(62,62,62);text-indent:32px;line-height:25.6px;text-align:center;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/z9433rAGTDdibEpOicqr1cEjnWvByDZtfE3AhEu0ibp03MmDS8Gvibwf4AdPibqMae1HrYm3GBCEn7vX2Avp8Qetr4A/640?" alt="640?"><span style="font-size:15px;"></span><br></p>
   <p><br></p>
   <p><span style="font-size:15px;">zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案，在企业中有非常全面的应用，本文是Linux运维老司机撰写，一站式帮你解决zabbix的难题。</span></p>
   <p><br></p>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第1章 zabbix监控</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <p><br></p>
   <p><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">1.1 为什么要监控</span></strong></span><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">在需要的时刻，提前提醒我们服务器出问题了</span></p>
   <p><span style="font-size:15px;">当出问题之后，可以找到问题的根源</span></p>
   <p><span style="font-size:15px;">网站/服务器 的可用性</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">1.1.1 网站可用性</span></strong></h3>
   <p><span style="font-size:15px;">在软件系统的高可靠性（也称为可用性，英文描述为HA，High Available）里有个衡量其可靠性的标准——X个9，这个X是代表数字3~5。X个9表示在软件系统1年时间的使用过程中，系统可以正常使用时间与总时间（1年）之比，我们通过下面的计算来感受下X个9在不同级别的可靠性差异。</span></p>
   <p><br></p>
   <p><span style="font-size:15px;">1个9：(1-90%)*365=36.5天，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是36.5天</span></p>
   <p><span style="font-size:15px;">2个9：(1-99%)*365=3.65天 ， 表示该软件系统在连续运行1年时间里最多可能的业务中断时间是3.65天</span></p>
   <p><span style="font-size:15px;">3个9：(1-99.9%)*365*24=8.76小时，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是8.76小时。</span></p>
   <p><span style="font-size:15px;">4个9：(1-99.99%)*365*24=0.876小时=52.6分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是52.6分钟。</span></p>
   <p><span style="font-size:15px;">5个9：(1-99.999%)*365*24*60=5.26分钟，表示该软件系统在连续运行1年时间里最多可能的业务中断时间是5.26分钟。</span></p>
   <p><span style="font-size:15px;">6个9：(1-99.9999%)*365*24*60*60=31秒， 示该软件系统在连续运行1年时间里最多可能的业务中断时间是31秒</span></p>
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">1.2 监控什么东西</span></strong></span></h2>
   <p><span style="font-size:15px;">监控一切需要监控的东西，只要能够想到，能够用命令实现的都能用来监控</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">1.2.1 监控范畴</span></strong></h3>
   <p><img style="font-size:0px;width:506px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8tV1XqOH0HsYQTkdCrjibicDYics86qI6dHvwibqyDCVYCXxUicDibMT0d6vg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">1.3 怎么来监控</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">1.3.1 远程管理服务器</span></strong></h3>
   <p><span style="font-size:15px;">如果想远程管理服务器就有远程管理卡，比如Dell idRAC，HP ILO，IBM IMM</span></p>
   <p><br></p>
   <h3><strong><span style="font-size:15px;">1.3.2 监控硬件</span></strong></h3>
   <p><span style="font-size:15px;">查看硬件的温度/风扇转速，电脑有鲁大师，服务器就有ipmitool。</span></p>
   <p><span style="font-size:15px;">使用ipmitool实现对服务器的命令行远程管理</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8LFfP59o8Ke6ay6ib1QbFNSrMwaiaiayMQYzTJ7NWicBGRadNGJPsWWPs0Q/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">1.3.3 查看cpu相关</span></strong></h3>
   <p><span style="font-size:15px;">lscpu、uptime、top、htop vmstat mpstat</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 其中htop需要安装，安装依赖与epel源。</span></p>
   <p><img style="width:528px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8VjnyiaaTybBvdaywx83ibZS7ibu4BicbcxzLlfibZA6GaOoaB9hMXFwZ6FQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">1.3.4 内存够不够可以用</span></strong></h3>
   <p><span style="font-size:15px;">free</span></p>
   <p><img style="width:529px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8p1pgmm9BhzZUOsQvuYo2S7IOb5N2Zic55p5vqyicvAUvHekMFoA8se3g/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h3><span style="font-size:15px;"><br></span></h3>
   <h3><strong><span style="font-size:15px;">1.3.5 磁盘剩多少写的快不快可以用</span></strong></h3>
   <p><span style="font-size:15px;">df、dd、iotop</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8DAYr9n6sGYFJ6SEaaibcbIeLwxAK8gpn9xotenbX5VOeJXl9DRoibpQg/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">1.3.6 监控网络</span></strong></h3>
   <p><span style="font-size:15px;">iftop nethogs</span></p>
   <p><img style="width:540px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8kANW9FZ2PbSHC4nv9v1aJaQAeoWriauNwIEJrzQQ7wS1K1u7U454L8Q/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h2><br></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">1.4 监控工具总览</span></strong></span></h2>
   <p><span style="font-size:15px;">mrtg 流量监控出图</span></p>
   <p><span style="font-size:15px;">nagios 监控</span></p>
   <p><span style="font-size:15px;">cacti&nbsp; 流量监控出图</span></p>
   <p><span style="font-size:15px;">zabbix&nbsp;监控+出图</span></p>
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">1.5 zabbix介绍</span></strong></span></h2>
   <p><span style="font-size:15px;">Zabbix 是由 Alexei Vladishev 开发的一种网络监视、管理系统，基于 Server-Client 架构。可用于监视各种网络服务、服务器和网络机器等状态。</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">使用各种 Database-end 如 MySQL, PostgreSQL, SQLite, Oracle 或 IBM DB2 储存资料。Server 端基于 C语言、Web 管理端 frontend 则是基于 PHP 所制作的。Zabbix 可以使用多种方式监视。可以只使用 Simple Check 不需要安装 Client 端，亦可基于 SMTP 或 HTTP ... 各种协定做死活监视。</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">在客户端如 UNIX, Windows 中安装 Zabbix Agent 之后，可监视 CPU Load、网络使用状况、硬盘容量等各种状态。而就算没有安装 Agent 在监视对象中，Zabbix 也可以经由 SNMP、TCP、ICMP、利用 IPMI、SSH、telnet 对目标进行监视。</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">另外，Zabbix 包含 XMPP 等各种 Item 警示功能。</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <h3><strong><span style="font-size:15px;">1.5.1 zabbix的组成&nbsp;</span></strong></h3>
   <p><img style="border-width:0px;width:479px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8avVSjQ50bhznKl491qLd5va1duxVYD8ibEd5PXejKKssb8x13LTmjtA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">zabbix官网: https://www.zabbix.com</span></p>
   <p><span style="font-size:15px;">zabbix 主要由2部分构成 zabbix server和 zabbix agent</span></p>
   <p><span style="font-size:15px;">zabbix proxy是用来管理其他的agent，作为代理</span></p>
   <h3><span style="font-size:15px;"><br></span></h3>
   <h3><strong><span style="font-size:15px;">1.5.2 zabbix监控范畴</span></strong></h3>
   <p><span style="font-size:15px;">²&nbsp; 硬件监控 ：Zabbix IPMI Interface</span></p>
   <p><span style="font-size:15px;">²&nbsp; 系统监控 ：Zabbix Agent Interface</span></p>
   <p><span style="font-size:15px;">²&nbsp; Java 监控：ZabbixJMX Interface</span></p>
   <p><span style="font-size:15px;">²&nbsp; 网络设备监抟：Zabbix SNMP Interface</span></p>
   <p><span style="font-size:15px;">²&nbsp; 应用服务监控：Zabbix Agent UserParameter</span></p>
   <p><span style="font-size:15px;">²&nbsp; MySQL 数据库监控：percona-monitoring-pldlgins</span></p>
   <p><span style="font-size:15px;">²&nbsp; URL监控：Zabbix Web监控</span></p>
   <p><br></p>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第2章 安装zabbix</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <br>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">2.1 环境检查</span></strong></span></h2>
   <p><img style="width:494px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8NqDge8EMjH0bzv8CfxmsIrDvgUnDaThMeslDicIEHtuRFSJmGIVwvvQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">2.2 安装zabbix过程</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">2.2.1 安装方式选择</span></strong></h3>
   <p><span style="font-size:15px;">编译安装 （服务较多，环境复杂）</span></p>
   <p><span style="font-size:15px;">yum安装（干净环境）</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">2.2.2 服务端快速安装脚本</span></strong></h3>
   <p><img style="width:500px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF85HkYhpo1nW5MkUYekqicYbTNIr6camaEWANypkYqiaCnJIEZd4X3kuHg/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <p><img style="width:507px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ibYs8tKJTyThHicQmHUXCCjNSaKBSUyhBUgdvWUwQoWflKXfIwSeicTZg/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">2.2.3 客户端快速部署脚本</span></strong></h3>
   <p><img style="width:516px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8Dx149EBtaODwZuOYT8JuIThQAxXSp9lLGKOAq6e1ia5MIkpCNRoSYdg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">2.3 检测连通性</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">2.3.1 服务端安装zabbix-get检测工具</span></strong></h3>
   <h3><span style="font-size:15px;">yum install zabbix-get</span></h3>
   <h3><span style="font-size:15px;"><br></span></h3>
   <h3><strong><span style="font-size:15px;">2.3.2 在服务端进行测试</span></strong></h3>
   <p><img style="width:506px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8oznDyJ89DsG1CNZks9UiaDIOoxPHjtTkKNtmsCVo9Yy4hqfXxycFZAg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><br></p>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第3章 web界面操作</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">3.1 zabbix的web安装</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">3.1.1 使用浏览器访问</span></strong></h3>
   <p><span style="font-size:15px;">http://10.0.0.61/zabbix/setup.php</span></p>
   <p><img style="border-width:0px;width:453px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF81MM9fdAA2kxO4xx6y5UWn6T2SPAU4ec9CLEY3d9jCgRyicDJ2QdP45Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 在检测信息时，可查看具体的报错信息进行不同的解决</span></p>
   <p><img style="border-width:0px;width:450px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8xZttUIU8PRfrbO1ydeSrOKibGzbl3Jqxtu8lO0q4O4IWiaibuKefpbTYw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 选择mysql数据库，输入密码即可</span></p>
   <p><img style="border-width:0px;width:441px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF87OIHgCqNjFlVwQzvCZKA19YYWUIpUEia2c8Nsnc0JCclAxCHcialW8wg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; host与port不需要修改，name自定义</span></p>
   <p><img style="border-width:0px;width:439px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF85p5leg9HsyK7LnhetjUibIs9jADrAFMh6r6hIsFv43Evz9dk5975ojg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;确认信息,正确点击下一步&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8az7u9H7VnFtEQuWVu7YpGEr0bcdeyFQhaVwpR66pHSAeDLlm9bc71g/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;</span></p>
   <p><span style="font-size:15px;">&nbsp;安装完成、点击finsh</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8r6iauicbswsNOKxth0OgfsnbDtl5KGSBMqUibus7O7ianAOh06dfMeDVvw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 进入登陆界面&nbsp; 账号Admin密码zabbix&nbsp;&nbsp;&nbsp;注意A大写</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8E6lkvdQfF2XborFiau6vKR4RMumQFIdv3we4ibcnsiac4cK9v1OIhT6OQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">3.2 添加监控信息</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">3.2.1 修改监控管理机zabbix server</span></strong></h3>
   <p><span style="font-size:15px;">配置 &gt;&gt; 主机</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8A3H8ibFIPkRMAev6rluGcGbfx8oO232Tia2cerVhxR25Zt4K7iaiaaNJUQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><span style="font-size:15px;">主机名称： 要与主机名相同，这是zabbix server程序用的</span></p>
   <p><span style="font-size:15px;">可见名称： 显示在zabbix网页上的，给我们看的</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8O6u4h6eRkRQmmECfBElnBg1dZSwjXZkto5PfaVB8ERT8U5OFpGxJag/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 修改后，要将下面的已启用要勾上</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8C31UEnk9jXncB46LTt3wdhbPDgcCTv8YiaP5GcicyOICDfDicaaI6F8qQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 添加完成就有了管理机的监控主机</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8l0TQ8ESjO3xjrlrEBHhHEXqftibuxpIqggFZ9WWrxDlDlcv423icsuhQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">3.2.2 添加新的主机</span></strong></h3>
   <p><span style="font-size:15px;">配置 &gt;&gt; 主机 &gt;&gt; 创建主机</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8EWibTQbvLIXkEo502uTnlauMF2djcSnqlskiaj37CL5Eqdib63au1hic4Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><span style="font-size:15px;">注意勾选以启用</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8jMLNqcpoibJAIg3wCK4xFkW1Aboyk93we2pibtk8Fsicxw4Az0KydVycA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 然后添加模板，选择linux OS ，先点小添加，再点大添加。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8hrHNG4rR9TsXmZbvelCmYb2QBwRMHBmzeaW8gMCibsWn008RE3WOrZg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 添加完成，将会又两条监控主机信息</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF84wx4rIdeibLSmRntJno2j6Zo2UIh799Gw3YgIc8FbUaOX6Cp1sIuagw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">3.2.3 查看监控内容</span></strong></h3>
   <p><span style="font-size:15px;">检测中 &nbsp;&gt;&gt; 最新数据</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 在最新数据中需要筛选，&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8unopSpBt729G2zAsdibQofhFCPqicrialra8zpq4S2ClsrXPMgnW5hNXw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 输入ip或者名字都能够搜索出来</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8X92tyMjpqBp2LUF6POJ2dvgj07bqK3zmPF5KPrF07a2UXMeI9lDHicg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><span style="font-size:15px;">在下面就会列出所有的监控项</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8MmlZLGjCaXRwN2trwx25lwia1TuZV7VN3I2wrnVDagNtM0ojC79dknQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">3.2.4 查看图像</span></strong></h3>
   <p><span style="font-size:15px;">检测中 &gt;&gt; 图形</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 选择正确的主机。选择要查看的图形即可出图</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8k6ynTOEicwRUtgBGmb5W1YTAic5fEaecbibj1g0HheVmTIgv5j868rffQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><br></p>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第4章 自定义监控与监控报警</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <br>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">4.1 自定义监控</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">4.1.1 说明</span></strong></h3>
   <p><span style="font-size:15px;">zabbix自带模板Template OS Linux (Template App Zabbix Agent)提供CPU、内存、磁盘、网卡等常规监控，只要新加主机关联此模板，就可自动添加这些监控项。</span></p>
   <p><span style="font-size:15px;">需求：服务器登陆人数不能超过三人，超过三人报警</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.1.2 预备知识</span></strong></h3>
   <p><img style="width:503px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ibfSQibpiapPicfcia5PxXzcyXajAFOm6IA12kGCYVDkwZ7vmjKxN0MZfpA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">4.2 实现自定义监控</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">4.2.1 自定义语法</span></strong></h3>
   <p><img style="width:499px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8bXW8yyLDZIHzgv2ghqChibsl2lTj0GgTLCPcc6bDl2XcyOLcels2oiaA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.2.2 agent注册</span></strong></h3>
   <p><img style="width:502px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8rAX01Xx3ibXwFoCiboR5AV3KR21UtzQEYko7qhUhoqxcCic6UErxicnI6Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.2.3 在server端注册(web操作)</span></strong></h3>
   <p><span style="font-size:15px;">①&nbsp;&nbsp;&nbsp;创建模板</span></p>
   <p><span style="font-size:15px;">配置 &gt;&gt;&nbsp;模板 &gt;&gt;&nbsp;创建模板</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8NeagZRnydb0FGAclqOAia9ES6II3xgDRchxMWctvnOfFCD674x023gA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">点击添加，即可创建出来模板</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8qGMZMtQEbhzLsslhqSZMvKxh96wEYEV6ckwOjtwLibQoyzibfGeSMccQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 查看创建出来的模板。↑</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">②&nbsp;&nbsp;&nbsp;创建应用集</span></p>
   <p><span style="font-size:15px;">应用集类似(目录/文件夹)，其作用是给监控项分类。</span></p>
   <p><span style="font-size:15px;">点击&nbsp;应用集 &gt;&gt;&nbsp;创建应用集</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8de03co9WpjnOQHc9t1lvsoWTF8sDXNziaybjPgDuTtXhZ3XtGDOVphA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 自定义应用集的名称，然后点击添加</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">③&nbsp;&nbsp;&nbsp;创建监控项</span></p>
   <p><span style="font-size:15px;">监控项 &gt;&gt;&nbsp;创建监控项</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF88a2Q1m4aE6c3SoBE1oLL6ASHnYzbIGibyaPgHBFJmwzy4vMKrUxmI6Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">键值&nbsp;-- key,即前面出创建的login-user。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8QMw7icY40gJEmj03CcFxOunmCcuhm4kfW8fsGL6mFuVekP80l41a7mA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 注意：创建监控项的时候，注意选择上应用集，即之前创建的安全。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF84RVWL1dIM263C9w2lfkibWcsj4iaXWYibyibW3DvOVvianfZIFAzURSUu6w/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">④&nbsp;&nbsp;&nbsp;创建触发器</span></p>
   <p><span style="font-size:15px;">触发器的作用：当监控项获取到的值达到一定条件时就触发报警</span></p>
   <p><span style="font-size:15px;">(根据需求创建)</span></p>
   <p><span style="font-size:15px;">触发器 &gt;&gt;&nbsp;创建触发器</span></p>
   <p><span style="font-size:15px;">创建触发器，自定义名称，该名称是报警时显示的名称。</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 表达式，点击右边的添加，选择表达式。&nbsp;</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 严重性自定义。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8va707Ys6IibRDWqsK1eHXiaPUyvibUAGQw1zW4puFe5mKVgAo1nE65WXg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;表达式的定义&nbsp;↓&nbsp;，选择之前创建的监控项，</span></p>
   <p><span style="font-size:15px;">最新的T值为当前获取到的值。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8gEngVc1ju9E8bHHVTLyD2QU2ia8M1Plue7nIGBdTXibnEIEt8Oau1wTw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 添加完成，能够在触发器中看到添加的情况</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8iatZMuI0diaTic2kU2RFPHoWS0ibW9jWQ0Xkd5eib6wf0HKQk9PyrY2N0QA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">⑤&nbsp;&nbsp;&nbsp;创建图形</span></p>
   <p><span style="font-size:15px;">以图形的方式展示出来监控信息</span></p>
   <p><span style="font-size:15px;">图形 &gt;&gt;&nbsp;创建图形</span></p>
   <p><span style="font-size:15px;">名称自定义，关联上监控项。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8W9fWxa8mLn15OGk2sIv8bUBDSI44y4lGoZy2FtoVSniaXaZprfkk1eQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">⑥&nbsp;&nbsp;&nbsp;主机关联模板</span></p>
   <p><span style="font-size:15px;">配置 &gt;&gt;&nbsp;主机</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 一个主机可以关联多个模板</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF81Krj6qYInBOOicDhWR8Kv5JUFsmsyDgf2g5BBsiaxFBJnOqoIZ6ee4fA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.2.4 查看监控的图形</span></strong>&nbsp;</h3>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8dT2mqm178hU6icQAeJjN8bkdJOMMTnzs63thwMU0fIkt8cpSe8remaQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">4.3 监控报</span></strong><strong><span style="font-size:15px;">警</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">4.3.1 第三方报警平台</span></strong></h3>
   <p><span style="font-size:15px;">http://www.onealert.com</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 　 通过 OneAlert 提供的通知分派与排班策略，以及全方位的短信、微信、QQ、电话提醒服务，您可以在最合适的时间，将最重要的信息推送给最合适的人员。</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.3.2 onealert配置</span></strong></h3>
   <p><span style="font-size:15px;">添加应用，注意添加的是zabbix&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF84HZzpuLS6A5GMJX7A9aDGfAd8sEW8Q0QyMDx88BsFibIWnziczqoFd2g/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 实现微信报警需要关注微信公众号即可。&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF80v57nT6PN7vyEr1Hr8ystjpic8KV2vaWGCibWIXHRtaU95AbuMh3PpBA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><span style="font-size:15px;"><br></span></h3>
   <h3><strong><span style="font-size:15px;">4.3.3 安装 onealert Agent</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8XA6yyiaKUSMibLCvJdrMcDkWvRYSHdcjpnHsSNib1w101GQlevRFFFqpw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8tVAxUjefLY0rPayUia5ibvt4eE8MHaAp3OQ70UXSTC2drt3BFYkot30A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.3.1 如何删除onealert Agent</span></strong></h3>
   <p><span style="font-size:15px;">①&nbsp; 删除报警媒介类型中的脚本&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8d7fahozXKQ7uWGJWHzhPAH2Glibue5yUdwhrL460zbRxxdEicqgb5rYg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">②&nbsp; 删除创建的用户</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF84tEialev5oV7icm1qsFamHmKT1FjypbPrQaSpyUImD5gib7fVwerhQnUg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">③&nbsp; 删除用户群组</span></p>
   <p><img style="border-width:0px;width:560px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8Tlr0ZiayP31EE4ROuwpz0FNH53Dm3e9FZCcGuEVoLg3JBWJY7JdYKcg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">④&nbsp; 删除创建的动作&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8Oiat2FoHSwsWb7aq5EObib3bVUnKjLKHY85ibW3Bia2TNoeqG7PfPbjGtg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.3.2 触发器响应，发送报警信息</span></strong>&nbsp;</h3>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8r2BGqGNpPZ7sSEI3ic1zJh0VlOYJCJZK4yaoo0oeVAlQLHJ8gZjvamA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 在微信和邮件中，均能收到报警信息。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8bFLdhIWicCYMiaXXrJIwfrAX5ibrpFcezNSQsFme8Fsy8PWAB7zNdUZxw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;注意：当状态改变的时候才会发邮件</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;　　&nbsp;好--&gt;坏</span></p>
   <p><span style="font-size:15px;">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;坏--&gt;好</span></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">4.4 监控可视化</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">4.4.1 聚合图形</span></strong></h3>
   <p><span style="font-size:15px;">最新数据 &gt;&gt;&nbsp;图形</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8b3xiaH94egPta4zy8EMzvxiaQ8Y5j7PqyoqXx2so3NIkQJjMjnqtzLIA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 自定义名称</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8SxaAryKu3LlT2aXheYYwN6KoxJBM0p6GD6kLZOr9BU1NMTCKrUb29g/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 点击聚合图形的名称，进行更改，添加要显示的图形即可。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8VK9qLpvFsXnAFXkeyUokSAiaKJhHPhYYDPGUd3XvsscpmaxEYvw6Q6Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.4.2 幻灯片</span></strong></h3>
   <p><span style="font-size:15px;">添加幻灯片</span></p>
   <p><span style="font-size:15px;">监测中 &gt;&gt;&nbsp;复合图形 &gt;&gt;&nbsp;幻灯片演示</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8XQ8sxF3pEut6Sc8O9piakI8z2icad4wbtpiaX1vr05HdFiaASJ2zaicuxFw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 创建幻灯片，名称自定，选择要显示的</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF87oEvy10mN2YB5VjaZXiaHdmkm3TMoDLH5EOLyswndbHwYA1EyulUrWA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 幻灯片根据设定的时间自动播放</span></p>
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">4.5 模板的共享</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">4.5.1 主机共享</span></strong></h3>
   <p><span style="font-size:15px;">在主机页打开，全选后点击导出</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8jKJyqElvBvia5Oam3bVyBB0XneolDg3QC6Mr7ria4FpeMjKDFknXPUWw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><span style="font-size:15px;">&nbsp; 导入</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF89LiaQlvkE6EttibQNhmcYCwTAOm2vH3YWibR4LpVdbtsnRgawficJjcVnw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">4.5.2 模板共享</span></strong></h3>
   <p><span style="font-size:15px;">https://github.com/zhangyao8/zabbix-community-repos</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8wAOsv8C5hPwZib5RDmJUH32t9yAZsicRKuxgZsWDwp3HurL0EfTCSdqg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h1><br></h1>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第5章 监控全网服务器</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <br>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">5.1 需求说明</span></strong></span></h2>
   <p><span style="font-size:15px;">实际需求：</span></p>
   <p><span style="font-size:15px;">公司已经有了100台服务器，现在需要使用zabbix全部监控起来。</span></p>
   <h2><br></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">5.2 规划方案</span></strong></span></h2>
   <p><span style="font-size:15px;">常规监控：cpu，内存，磁盘，网卡&nbsp; 问题：怎样快速添加100台机器</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 　　方法1：使用克隆的方式</span></p>
   <p><span style="font-size:15px;">&nbsp;　　&nbsp; 方法2：自动注册和自动发现</span></p>
   <p><span style="font-size:15px;">&nbsp;　　&nbsp; 方法3：调用zabbix api接口&nbsp; curl 、python</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;　　 &nbsp;开发自己的运维平台兼容zabbix的通道</span></p>
   <p><span style="font-size:15px;">服务监控，url监控等特殊监控：自定义监控</span></p>
   <h3><strong><span style="font-size:15px;">5.2.1 api接口使用（curl）</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8iakV4nLMoiaUibdcsHLibHFLHAv0Vf5XLibdibtESASia9qTjaFhtVhfoDs9Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">5.3 具体实施规划</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">5.3.1 硬件、系统、网络</span></strong><strong><span style="font-size:15px;">监控</span></strong></h3>
   <p><span style="font-size:15px;">所有集群节点（所有虚拟机）都监控上</span></p>
   <p><span style="font-size:15px;">交换机，路由器监控（简单方法：换成端口对应服务器网卡流量监控；标准方法：监控交换机的网卡）</span></p>
   <p><span style="font-size:15px;">snmp监控</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.3.2 应用服务监控</span></strong></h3>
   <p><span style="font-size:15px;">1. 监控备份服务器，简单方法是监控rsync端口，如果有其他更佳方案可以说明；</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4zqcicELbLy3XibuiahnK2YXZ1sSjzTxzEd8B1UmtddMib1tOjEfB2Np4icw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">2. 监控NFS服务器，使用监控NFS进程来判断NFS服务器正常，如果有其他更佳方案可以说明；</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4HQ3KcgnEsGOYWsfibVKDjcftPfPxHdytib0PMgXh8ib9sAmibYmX7liao6Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">3. 监控MySQL服务器，简单方法监控mysql的3306端口，或者使用zabbix提供的Mysql模板，如果有其他更佳方案可以说明；</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4RVibtHSth4FWGzeLibnF8bgVhDePdhUAATV9DJSC17eIgoJXiaiaj6P0uQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">4. 监控2台web服务器，简单方法监控80端口，如果有其他更佳方案可以说明；</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4klW0ViaicUWSib3tT4NokMaEicMRvWJYOytiaPCuicJq3nk0hGT9jz2pNuCQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">5. 监控URL地址来更精确的监控我们的网站运行正常；</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4vv1RPvrhe2RyMUwLEhpINtibdbklM1f2P3ZsEiaqTnnX9sauIoDEcNGQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">6. 监控反向代理服务器，PPTP服务器等你在期中架构部署的服务。</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4zS0bym6VicVh5EgdEoL2icRkVHq56ClgCQnXJJloaoPqdcBCibdvCUJHA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">7. 监控Nginx的7种连接状态。</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4QbLTrdEaqTFEgGIAFchgTPwpMdxJmot42V9WibfvtY1pqiaonH3aNHJQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <h3><strong><span style="font-size:15px;">5.3.3 监控服务通用方法</span></strong></h3>
   <p><span style="font-size:15px;">1. 监控端口 netstat ss lsof&nbsp; ==》 wc -l</span></p>
   <p><span style="font-size:15px;">2. 监控进程 ps -ef|grep 进程|wc -l&nbsp; 试运行一下</span></p>
   <p><span style="font-size:15px;">3. 模拟客户端的使用方式监控服务端</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;　　 &nbsp;&nbsp; web&nbsp; ==》 curl</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; &nbsp;&nbsp;　　 mysql ==》 select insert</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 　　&nbsp;&nbsp; memcache ==》 set再get</span></p>
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">5.4 实施全网监控</span></strong></span></h2>
   <p><span style="font-size:15px;">安装客户端脚本，for centos6</span></p>
   <p><img style="width:500px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8pVNjKlu0oKu6XfrNKia00s8AiaibLDHWZhS6esS9r4n8DDicIJLUBjENAQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><strong><span style="font-size:15px;"><br></span></strong></p>
   <p><strong><span style="font-size:15px;">5.4.1 使用自动发现规则</span></strong><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">添加自动发现规则</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8qDcfYlucMMNGYSlmYYYvgUJNCTnat6M1iaJN3FDX18eicHNV9xTf6QxA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;创建发现动作</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ibA5gyNk6NVxyM4xLpNrlVMxOgrJgM7TsjJwVeEpcJXZ1WD5uMibSyVw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">查看自动发现的机器。&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF886cFtCCEkerbfqEtLGAlh5p8s1jLds6uFFf35mgl9ibJB7Wex7e6rBw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.2 监控备份服务器</span></strong></h3>
   <p><span style="font-size:15px;">利用系统自带键值进行监控net.tcp.listen[port]&nbsp;创建新的模板&nbsp;</span></p>
   <p><img style="border-width:0px;width:538px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8wsVAgnokwojVFdkCibviaYLGt5ZKLtSSVpR2YfXWMAsFYAjCaGyZODLg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">在服务端进行测试</span></p>
   <p><img style="width:533px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8fWJwdd1mXpibeQgKkyVDjNdvthXfp9SzMwMichl5hq2SficUILgJXZ7Sw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">将模板添加到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8VysWfRVzEvsWyGUUjGsfPHLK8gqicx2hXIDLBR642JA4yC2dymCIkmQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.3 监控NFS服务器</span></strong></h3>
   <p><span style="font-size:15px;">创建nfs监控模板</span></p>
   <p><span style="font-size:15px;">使用&nbsp;proc.num[&lt;name&gt;,&lt;user&gt;,&lt;state&gt;,&lt;cmdline&gt;]&nbsp; 键值，检测nfs进程的数量</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF88WIMuq9cSekaTLN0aO9YldibTxx057piaJsMhupXd6JBh7whQic0Kn3hQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;在服务端进行测试</span></p>
   <p><img style="width:533px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8QlrUYBE310Wld4uIVslf2sHibq2YNfflicuq7qJBuUhbMzFibBYL7e6SA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">将模板绑定到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8t1mW3uCGLpapUp78VsIOed1dr0jSkYbRObkXGicsOcZWmnrCg3NK49A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.4 监控MySQL服</span></strong><strong><span style="font-size:15px;">务器</span></strong></h3>
   <p><span style="font-size:15px;">将自带的mysqlkey值加上mysql的账户密码，否则不能获取到数据。&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8GVR7Se0heS4luN1G3Z1T1Fkmt4vAI76cKYFia62ILbmg8VDtCicvTfOA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">使用系统自带模板 &nbsp;net.tcp.port[&lt;ip&gt;,port] 利用自带的监控端口键值进行监控&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8uTFJh2mCFKKBEX2K27UBXLHRMEictdtRvY5CadAiaiaeIlw8hyJqm3EwQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">添加新的mysql监控项端口&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8iajM0rLic4199VC5h3s415qs8OM4gJj3LUDiagv53NubicpBSWChOUvumg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img style="font-family:monospace;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm48lklicsibcL86vuFjLs6IwkKGt7lVouKT6ZfJMpXVvtI6zmkST95vJPg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">将模板关联到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8Abibno88zpuwuuz3htnp362OVVP7JccC5asFz4ChjRJuwQUoYfRXXMw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.5 监控web服务器</span></strong></h3>
   <p><span style="font-size:15px;">创建监控模板 监控 nginx服务与 80 端口</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4PdXzgYMicUX12OficYYptacEAmBh2sZnG1Vl1WNl9jAwdz3o30Bzb6BA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF84rWXHpXA84VTV8OanScNo7kbhnDjRiciaxnD6I7Bt4yewASVDmSP4OhQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4wD0NgVtoyyyiaBfMarL7CnBfQLvK5T0SY6dajNy2bSicVVRo1ibQqHJiaw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">将模板关联到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8jy59FWSt5SvbbFsp7vxobKviahnBg4rY2zAl6pic5KLGSKlyxJemPa9A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.6 监控URL地址</span></strong></h3>
   <p><span style="font-size:15px;">创建监测页面</span></p>
   <p><span style="font-size:15px;"></span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4x0qGicGdrwTlg96S2iaqufCuM30kmhYuD0EgS2iaEJGxlslcc7KhP9PBg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">创建web监测模板</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;创建应用集&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8DWPPLRY9gia9kLQaahmflGNw2LNCYn4DZvWnZRKIzLI8kaVjgRSPmmQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;创建Web场景&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF89a2ZB8rGquqE8unlUPqcmhytuE2v0ny58ULFYVkKoykudDh1c1eWmQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;创建图形</span></p>
   <p><img style="border-width:0px;width:548px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8e6KmTQHCuXmBHICIRbI4zXV2KHVBibLGjEePIYDD2WXKY6evAzqSXBA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">将模板关联到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8hoha51QNnUqGaia2DPficicn9QXB6aOmeL50Zfan6b1ibv0AdZ6RyxHVYw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">监测结果&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8JePwAic6uib6wfpnHJOMqq5Exzk2YiaiambAJUiaM9rAkWmlpCpEQI0U8lA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.7 监控反向代理服务器</span></strong></h3>
   <p><span style="font-size:15px;">创建自定义key</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4aG5C3cn3FV3GtYNJv29jWXApnkFrtR67VticLMmvxUu1K76lABmGJ0w/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">在服务端测试</span></p>
   <blockquote>
    <p><span style="font-size:13px;color:rgb(136,136,136);">[root@m01 ~]# zabbix_get -s 172.16.1.5 &nbsp;-p 10050 -k "keep-ip"1[root@m01 ~]# zabbix_get -s 172.16.1.6 &nbsp;-p 10050 -k "keep-ip"0</span></p>
   </blockquote>
   <p><span style="font-size:15px;">在web界面添加模板</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8gn4YK2ZCkaUADToSJrhj6GAnYnWIRYC62JSLlibKQHoRdyzpwKdEicgg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;将模板关联到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8TM3V2bWIgLjdmgv99MvVwyhI6pOZcTsj7t4m6vQTpYyfOIVVeWP61A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">5.4.8 监控Nginx的7种连接状态</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4zSfLtwZzSsu7tmSiagpkNf8FD5X7WsicwPXaJOaDZsakY0aKp7zqZ72g/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <blockquote>
    <p><span style="font-size:13px;color:rgb(136,136,136);">[root@web01 ~]# for ip in 7 8 9 ;do curl 172.16.1.$ip/status ;doneActive connections: 1server accepts handled requests 73 73 69Reading: 0 Writing: 1 Waiting: 0</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">Active connections: 1server accepts handled requests 134 134 127Reading: 0 Writing: 1 Waiting: 0</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">Active connections: 1server accepts handled requests 7 7 7Reading: 0 Writing: 1 Waiting: 0</span></p>
   </blockquote>
   <p><span style="font-size:15px;"></span></p>
   <p><span style="font-size:15px;">在nginx服务器上添加key</span></p>
   <blockquote>
    <p><span style="font-size:13px;color:rgb(136,136,136);">cat &gt;/etc/zabbix/zabbix_agentd.d/userparameter_nginx_status.conf &lt;&lt;'EOF'UserParameter=nginx_active,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'/Active/ {print $NF}'UserParameter=nginx_accepts,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'NR==3 {print $1}'UserParameter=nginx_handled,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'NR==3 {print $2}'UserParameter=nginx_requests,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'NR==3 {print $3}'UserParameter=nginx_reading,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'NR==4 {print $2}'UserParameter=nginx_writing,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'NR==4 {print $4}'UserParameter=nginx_waiting,curl -s &nbsp;127.0.0.1/status|awk&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'NR==4 {print $6}'EOF</span></p>
   </blockquote>
   <p><br></p>
   <p><span style="font-size:15px;">服务端测试</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4L9a2pibGJHlPloSI5pkIBJnQPyicc1XwPse7jxxevJeRicSpybyrwTxnQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">在zabbix-web上添加</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF83zibjMmsn4rndnRViarznZXC9L1bEUAWsFV2PncyzU7WICDhc2q4jUlQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">监控项</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ViaxQGN11UHvXXLEQzx1XCOuiaFkKLetelGATA9dtBDk6O6psrnKPpRQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">添加图形</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF88evEjEs14yZFicl8TfWqehwjxBOMXkjs8pG2SgF4weoRJO6LvbdZ5Zw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">将模板关联到主机&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8sCmeiay84iapOMf3GRu8WibBR9ZxsGyOWNic5sd5tyAy0pvtribnTDwgiaTw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">查看添加的图形</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8nnv2hyXFHULjlOpjPxD3Bg8WASQDu1w7EvoXJ1IGxzXRPcNGVS6KiaQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img style="border-width:0px;width:557px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8R2X2y5oVX2f3YicKGHlMI3icvwBibfXA1LLuwBAKWJlMI109dQ9K1E1icg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><br></p>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第6章 自动发现与自动注册</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">6.1 自动注册与自动注册</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">6.1.1 简介</span></strong></h3>
   <p><span style="font-size:15px;">自动发现：</span></p>
   <p><span style="font-size:15px;">zabbix Server主动发现所有客户端，然后将客户端登记自己的小本本上，缺点zabbix server压力山大（网段大，客户端多），时间消耗多.</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">自动注册：</span></p>
   <p><span style="font-size:15px;">zabbix agent主动到zabbix Server上报到，登记；缺点agent有可能找不到Server（配置出错）</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <h3><strong><span style="font-size:15px;">6.1.2 两种模式</span></strong></h3>
   <p><strong><span style="font-size:15px;"></span></strong></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm48avKbiaiaKrPWfibMeeGYKo01Up9N1XD0oSgjgceqDuTb2LM5gO72YeicA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp; &nbsp; &nbsp;注意：&nbsp;两种模式都是在agent上进行配置</span></p>
   <p><span style="font-size:15px;">&nbsp; &nbsp; &nbsp;zabbix&nbsp;的使用要在hosts文件中预先做好主机名的解析</span></p>
   <h2><br></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">6.2 自动发现--被动模式</span></strong></span></h2>
   <p><span style="font-size:15px;">第一个里程碑：完成之前的安装</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4YT0QtGouZwXeeSiaQF0q40QTnvzeFzZLnKCm3eDoFuVhvwr2HYt7Wag/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ldyxvs8duMJCfc9rXZgu2Aicu05r8KHv98XRFXlibd7j12ckOicnRo93g/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><br></p>
   <p><span style="font-size:15px;">在ip范围内输入ip，注意格式；</span></p>
   <p><span style="font-size:15px;">&nbsp; &nbsp;延迟在实际的生产环境中要大一些，实验环境可以小一些</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8vmMe3Lr18MiaBlLy5jXFWX8TFrgn2ibHmFyzqM76cficXr0hxCSP36gLA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"><br></span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;创建发现动作</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4lTV7D8jD0jjy4BMCx2cQUQjXFrBSYWq4YouibLpHxJzP7Na40b64gwQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8pDNDnsnyG5QUdH2jDHqfNgb9USKiaCv0snIm803naDW2yw0aNtBBnww/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">①&nbsp; 配置动作</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF81V9pbF9icOqGXklwyrhgHxle8lj0thR3lQklM8renZAZEwRXicuEa7MQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">②&nbsp; 在条件中添加条件，让添加更准确</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8EOJomZU26iaBLXHSu2xMLukwbuZwKYNlY4oNGxSqjEU8MvxhaKWlHXg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">③&nbsp; 在操作中添加</span></p>
   <p><span style="font-size:15px;">a)&nbsp; 添加主机与启用主机</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8Hx1fKQHaSulE7Gv50xnWvTCCMcTWWicRTAKxqzictzTQVlibxswuD2QNw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;　　&nbsp; 然后等待者客户端自动上门就好😏</span></p>
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">6.3 自动注册--主动模式</span></strong></span></h2>
   <p><span style="font-size:15px;">第一个里程碑：zabbix Server安装完毕 （完成）</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4AgRqHjLdsUCMLbicGHZtzdbMZ9JKsmRSX1EUZibW8Uz9ib2QIpRpmdDzg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 第二个里程碑：zabbix agent安装完毕，需要额外增加的配置</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4Z3FARVYhFF81oTs2S4tGcHeic2VSphkS5KBichJM1QibRuIe83oFbzlBw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; 源文件与修改后对比</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8lKw30vSFe5qbo1L89klT7GQREWVM2vde07vNrpVxmWuLosQxDSnlUw/640?wx_fmt=png" alt="640?wx_fmt=png"><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8uMIoMso8eoQv9MJnqxanOFngfrv5C2rfbucPNr1zia2puALP6j2ETHw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp; &nbsp;第三个里程碑：在web见面上进行配置</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm40LP3DbjrSTUJpffy7Jeh9IxXZutDDzT4dpBCEnzP6IN1xCaOnYPC3g/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8TOncsgEIb2G7M3ZziciadRVcUSw7B0f0xBXrlPibGiba6SPib9U1Dia6E7Lw/640?wx_fmt=png" alt="640?wx_fmt=png"><span style="font-size:15px;">创建动作，添加名称即可&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF88JvEId66AmiawYuXfK94PFEMz6pTkKHtHia87zOBzlfrfWvzZ6SwtSkQ/640?wx_fmt=png" alt="640?wx_fmt=png"><span style="font-size:15px;">条件中也无需修改&nbsp;</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ibFuwBe4WVN7gb5J3Rq8hnzg4mzX8FCM6SMvzKQFmWoTAz8OFPBLsibw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; 在动作中添加动作</span></p>
   <p><span style="font-size:15px;">（添加主机、添加到主机群组、链接到模板）</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8iaRibPibI3DMuJv0LKjc9HwvnFk4RXD8YNAenSHgeZFva1Td1VEn15Yfg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; 添加完动作后，等待就行了</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; 注意：重启客户端可以加速发现。但是在生产环境中勿用。</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF81HRtFQQHEVaw34u3E3icN0V5RMBDzicC5yEWbkZ8FgQWw1eEwu1uP2Ww/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><br></p>
   <p><strong><span style="font-size:15px;color:rgb(216,40,33);">第7章 分布式监控与SNMP监控</span></strong></p>
   <img class="wx-img" style="width:518px;vertical-align:top;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmLA3dzelziaLvzUHDNVicuufA26DB8wPjydKMs2icFgHw9NicdVSHwIyf1JJMT9aPvTBK8Xq1xTJ4Xafg/640?wx_fmt=png" alt="640?wx_fmt=png">
   <p><br></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">7.1 分布式监控</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">7.1.1 作用</span></strong></h3>
   <p><span style="font-size:15px;">&nbsp; 　　分担压力，减轻负载</span></p>
   <p><span style="font-size:15px;">&nbsp; 　　多机房监控</span></p>
   <p><span style="font-size:15px;">zabbix Server&nbsp; ===》&nbsp; zabbix agent （只能同一个局域网监控）</span></p>
   <p><span style="font-size:15px;">分担压力，降低负载</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4pvL8picKYwMT1nSuibVuKVS8jp0ibl6qVP4sdxGXvTbL6Ic1gFnAEFzSw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">多机房监控</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4sW4po8jdrWl1EDPiaCWVFIauF9RiczhGsJdXC3Yx293H2UamHyE1GiabQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <h3><strong><span style="font-size:15px;">7.1.2 环境说明</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4Awmu4bxjNPkiaHDE86Gu380ccqzMpibblWNweoXlGhPwkUqB2DryBv7Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"></span></strong><br></h3>
   <h3><strong><span style="font-size:15px;">7.1.3 配置zabbix proxy</span></strong></h3>
   <p><span style="font-size:15px;">第一个里程碑：配置zabbix yum源，并安装proxy</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4FApbuauLgCTMpajQ3k8lQlKEG8CCfY17Zb9l14oibicyFOxfDA4ADe8A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;第二个里程碑：安装数据库</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; zabbix&nbsp; proxy也需要数据库，这个数据库不是用于存储监控数据的 只是用于存储配置信息</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; #安装数据库</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4AHWYydGJicuVTSz3vrCrHzfPYgyacJkm6icNY8lM3QUMibSArsqWpR2Gg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; #建立数据库</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4PDOiayQqc2pEjLXjHHwqFl9Ln7XHH0qLsDr6WjGeMRvuu9vmXoCpETw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; #导入数据文件</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4mjxwq8xUUtGXpU9uT9ib6EsWjiabrsS3yekAMxUR4labDlqyYraVTM7w/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; #配置zabbix proxy 连接数据库</span></p>
   <blockquote>
    <p><span style="font-size:13px;color:rgb(136,136,136);">sed -i.ori&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'162a DBPassword=zabbix' /etc/zabbix/zabbix_proxy.conf</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">sed -i&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'s#Server=127.0.0.1#Server=172.16.1.61#' /etc/zabbix/zabbix_proxy.conf</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">sed -i&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">'s#Hostname=Zabbix proxy#Hostname=cache01#' /etc/zabbix/zabbix_proxy.conf# Hostname 作为后面添加的代理程序名称，要保持一致</span></p>
   </blockquote>
   <p><span style="font-size:15px;">&nbsp;&nbsp; #启动</span></p>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4kqUaDNK54QPeCbYj7pwUltbia2EZibXjRteianJKxSfqTpOS6iaxeRD4aQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;"></span><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; #检查端口</span></p>
   <blockquote>
    <p><span style="font-size:13px;color:rgb(136,136,136);">[root@cache01 ~]# netstat -lntup |grep zabbixtcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10050 &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:10051 &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy&nbsp;</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10050 &nbsp; &nbsp; &nbsp; :::* &nbsp; &nbsp; &nbsp;LISTEN &nbsp; &nbsp; &nbsp;105762/zabbix_agent</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);">tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 :::10051 &nbsp;:::* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;85273/zabbix_proxy</span></p>
   </blockquote>
   <p><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;第三个里程碑：修改agent配置指向 proxy</span></p>
   <blockquote>
    <p><span style="font-size:13px;color:rgb(136,136,136);">[root@cache01 ~]</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);"># grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.61ServerActive=172.16.1.61[root@cache01 ~]</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);"># sed -i 's#172.16.1.61#172.16.1.21#g' /etc/zabbix/zabbix_agentd.conf[root@cache01 ~]</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);"># grep ^Server /etc/zabbix/zabbix_agentd.confServer=172.16.1.21ServerActive=172.16.1.21[root@cache01 ~]</span></p>
    <p><span style="font-size:13px;color:rgb(136,136,136);"># systemctl restart zabbix-agent.service</span></p>
   </blockquote>
   <p><br></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp;第四个里程碑：web界面添加代理</span></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; 管理 &gt;&gt; agent代理程序 &gt;&gt; 创建代理</span></p>
   <p><br></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8MlQzD3CMRib9ibdt6NP7DLYBXG3yiaiaON9M9RwcXxT0qd07FYfTv35jpA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 代理程序名称要填写主机名</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8doVFtLSoyY02c01CXXFUfwujqyB74fsSKoub06KDwQUUoIe4kvuiaLA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 稍等片刻就能在程序中出现代理</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8ZEIiaR8Sjjh0NHlDUgAaHPYMialR5EYB2kyye4BydqEXcpIIxNS1lTxQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp; 在主机中能发现主机代理</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8rgsE23Kg2hQb0MxT7ia9ZrPQTOGibzXjcUPqAS5sfRmH2X9v7kAtBbPg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;"><br></span></strong></span></h2>
   <h2><span style="color:rgb(0,122,170);"><strong><span style="font-size:15px;">7.2 SNMP监控</span></strong></span></h2>
   <h3><strong><span style="font-size:15px;">7.2.1 使用范围</span></strong></h3>
   <p><span style="font-size:15px;">无法安装agent&nbsp; 很多前辈的监控软件都可以监控各种设备&nbsp; 都是通过snmp监控</span></p>
   <p><span style="font-size:15px;">snmp simple network manager protocol 简单网络管理协议</span></p>
   <p><span style="font-size:15px;">简单网络管理协议（SNMP），由一组网络管理的标准组成，包含一个应用层协议（application layer protocol）、数据库模型（database schema）和一组资源对象。该协议能够支持网络管理系统，用以监测连接到网络上的设备是否有任何引起管理上关注的情况。</span></p>
   <p><span style="font-size:15px;"><br></span></p>
   <h3><strong><span style="font-size:15px;">7.2.2 安装snmp程序</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4IMVm1PJrRkkw13YdNPUQqbS2DAdU57fjOib4lbF7aFgAQkJQkeeuTcQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"></span></strong><br></h3>
   <h3><strong><span style="font-size:15px;">7.2.3 配置snmp程序</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4IQrbR2RsSWRfz88H0KkmYqibZnpXIuW0TNtuNic9RibkYzQo6Gj7y0Hlg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;"></span></strong><br></h3>
   <h3><span style="font-size:15px;">7.2.4 测试snmp</span></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4fianmn1RxcicqOrnauBk8mKtOhCBuhSt4v1rtVVFLjpoMB7Ysk8OF2icg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><span style="font-size:15px;"></span><br></h3>
   <p><span style="font-size:15px;">说明：</span></p>
   <p><span style="font-size:15px;"># snmpwalk 类似 zabbix_get</span></p>
   <p><span style="font-size:15px;"># -v 2c&nbsp; 指定使用snmp协议的版本&nbsp; snmp分为v1 v2 v3</span></p>
   <p><span style="font-size:15px;"># -c public&nbsp; 指定暗号</span></p>
   <p><span style="font-size:15px;"># sysname&nbsp; 类似zabbix的key</span></p>
   <h3><strong><span style="font-size:15px;"><br></span></strong></h3>
   <h3><strong><span style="font-size:15px;">7.2.5 在web界面进行配置</span></strong></h3>
   <p><span style="font-size:15px;">添加新的主机，注意使用snmp接口</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF81u3xicodNibedpjSybyM63A7X8dHz3S1Mkyk9PnjlOJH0Syz528u2Mhg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">选择模板，注意使用SNMP的模板</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8x4dMKtljRVXaetMOCjDibPhzM9unX7cRprGgg4FKIg1V3BzuKrTWt7w/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:15px;">&nbsp;&nbsp;&nbsp; 添加完成就能够在主机中看到snmp监控对的主机</span></p>
   <p><img style="border-width:0px;font-size:0px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/IP70Vic417DPsBxRuwZ4SO53BBZTia6hF8GVuugbJywkv5pvK2a4xhZoUNNvHM9A504YzzwleAUWicO1UG7yCXmiag/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <h3><strong><span style="font-size:15px;">7.2.6 附录</span></strong></h3>
   <p><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/kFKyFMaQc89OVTQibl6tbYWKCZ2soWPm4AfESPOAwRZowNcq2Jgk3tazBnPCQjskRPSG6RL5qqWMbN34PeRrIhQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><span style="font-size:10px;color:rgb(136,136,136);">作者：惨绿少年</span></p>
   <p><span style="font-size:10px;color:rgb(136,136,136);">文章链接：https://www.cnblogs.com/clsn/p/7885990.html</span></p>
   <p style="letter-spacing:.544px;"><img style="margin-left:auto;border-style:none;letter-spacing:.544px;color:rgb(0,0,0);font-family:'Helvitica Neue', Helvitica, Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'Arial Regular', sans-serif;font-size:14px;clear:both;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/iacaGZAx79h9cqLY9dqJKILgsSmfztzBRg2c8Yf6icGHJfznyg95Fia7xsM6h3puLxILhtucN4aBslBIyKo15dzVQ/640?wx_fmt=other" alt="640?wx_fmt=other"></p>
   <p style="font-size:16px;letter-spacing:.408px;color:rgb(62,62,62);line-height:25.6px;"><span style="font-weight:bolder;font-family:'微软雅黑';font-size:12px;line-height:normal;">PS:记得查收小编送你的免费大礼包呦~</span></p>
   <p style="font-size:16px;letter-spacing:.408px;color:rgb(62,62,62);line-height:25.6px;"><span style="text-decoration:underline;font-weight:bolder;line-height:25.6px;"><span style="line-height:25.6px;font-size:12px;">福利 | 一万多套PPT模板等你免费来拿！无条件领取！</span></span></p>
   <p style="font-size:16px;letter-spacing:.408px;color:rgb(62,62,62);line-height:25.6px;"><span style="text-decoration:underline;font-weight:bolder;font-family:'微软雅黑';font-size:12px;line-height:normal;">免费送 | 1000多套简历模板免费拿，附赠简历制作教程！</span></p>
   <p style="font-size:16px;letter-spacing:.408px;color:rgb(62,62,62);line-height:25.6px;"><span style="font-weight:bolder;text-decoration:underline;font-size:12px;">免费领 | 《Shell脚本 100例》电子书免费拿，运维必备干货~</span></p>
   <p><br></p>
   <img class="__bg_gif" width="318" style="border-style:none;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/iacaGZAx79hiczej8HKykKxsn27998Fg01heLiaLibZiabshJz2NIGnaX2GH816nzqiayzk4bt4icIiaia5QduVYPhuvkCw/640?" alt="640?">
   <img border="0" height="120" title="Linux云计算数据自学.jpg" width="120" style="border-style:none;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/iacaGZAx79hiczej8HKykKxsn27998Fg01yXtMoFjgep0mgulibA1VeMo6m6rGMZ9CWS4UiaaRwtUmeoPLbo4HDenw/640?" alt="640?">
   <p><br></p>
   <p style="font-size:16px;letter-spacing:.408px;"><span style="font-family:'微软雅黑';font-size:12px;line-height:22.4px;">▼▼点击【</span><span style="font-weight:bolder;font-family:'微软雅黑';line-height:22.4px;font-size:12px;color:rgb(255,0,0);">阅读原文</span><span style="font-family:'微软雅黑';font-size:12px;line-height:22.4px;">】，22大互联网热门课程任选免费学</span></p> 
  </div> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
