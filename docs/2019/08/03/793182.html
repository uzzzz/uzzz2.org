<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>k8s核心组件—-kubectl常用命令总结 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="k8s核心组件—-kubectl常用命令总结" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="文章目录 一、k8s集群搭建 二、kubectl简介 三、命令行自动补全配置 四、kubectl常用命令总结 1、kubectl version 2、kubectl run 2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器 3、kubectl create 3.1、创建dashboard通过yaml文件 3.2、kubectl create namespace：创建namespace 3.3、kubectl create secret：创建secret 3.3.1、创建一个TLS Secret 3.3.2、创建一个generic Secret 3.4、kubectl create configmap：创建configmap 3.5、kubectl create serviceaccount：创建serviceaccount 4、kubectl get 4.1、kubectl get nodes 4.1.1、获取节点信息 4.1.2、获取节点详细信息 4.1.3、获取节点标签 4.1.4、给节点打标签 4.2、kubectl get pods 4.2.1、获取指定namespace的Pod信息（不加-n默认获取default） 4.2.2、获取所有namespace的Pod信息 4.2.3、获取Pod的详细信息 4.2.4、获取Pod的labels 4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白 4.2.6、获取含有指定标签key的pod 4.2.7、获取含有指定标签key=value的pod 4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合） 4.2.7、获取podIP 4.2.8、导出指定pod的yaml配置 4.3、kubectl get namespaces：获取namespace信息 4.3.1、获取所有namespace信息 4.3.2、获取指定namespace信息 4.3.3、获取指定namespace的yaml格式信息 4.3.4、获取指定namespace的json格式信息 4.4、kubectl get rs：获取ReplicaSet控制器信息 4.5、kubectl get deploy &amp;&amp; kubectl get deployment 4.5.1、获取Deployment控制器信息 4.5.2、与ReplicaSet的联系。`rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf` 4.5.3、滚动更新 4.6、kubectl get svc：获取service信息 4.6.1、获取默认命名空间的service 4.6.2、获取指定命名空间的service 4.7、kubectl get secrets：获取secrets信息 4.8、kubectl get pv：获取pv信息 4.9、kubectl get pvc：获取pvc信息 4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息 4.11、kubectl get sts：获取statefulSet控制器信息 4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息 5、kubectl label 5.1、给一个pod打一个没有存在的标签key=value， 5.2、给一个pod已经存在的标签重新赋值 5.3、通过key删除标签 6、kubectl describe 6.1、查看某个pod的详细信息 6.2、查看创建的serviceaccount的详细信息 7、kubectl delete 7.1、删除pods资源 7.2、删除service 7.3、删除namespace 7.4、删除Secret 7.5、删除configmap 8、kubectl edit 8.1、修改ReplicaSet控制器的yaml清单内容 9、kubectl exec 9.1、进入pod内的容器 9.2、进入pod内指定容器 10、kubectl logs 10.1、查看pod内的容器日志 10.2、查看pod内指定容器的日志 11、kubectl explain 11.1、查看pod资源清单字段 11.2、查看pod资源清单理metadata字段下的字段（以此类推） 11.3、查看ReplicaSet资源清单字段 12、kubectl rollout 12.1、查看deployment滚动更新历史版本 12.2、更新一个pod后暂停更新 12.3、解除暂停状态，继续更新 12.4、回滚到指定版本 12.5、监控deployment更新状态 13、kubectl scale 13.1、扩容和缩容 14、kubectl patch 14.1、修改deployment副本数 14.2、修改deployment滚动更新策略 15、kubectl set 15.1、kubectl set image 15.1.1、修改deployment的镜像版本 15.1.2、修改daemonset的镜像版本 16、kubectl config 16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件 kubectl cluster-info：查看集群信息 kubectl api-versions：查询 Kubernetes API 支持的 API 版本 kubectl api-resources：查看k8s支持的资源类型 查看指定群组支持的资源类型 一、k8s集群搭建 可以参考我的另一篇文章搭建一个集群进行演练：k8s核心组件----kubeadm初始化集群（v1.14.2） 二、kubectl简介 kubectl 是 Kubernetes 的命令行工具（CLI），是 Kubernetes 用户和管理员必备的管理工具。 kubectl 提供了大量的子命令，方便管理 Kubernetes 集群中的各种功能。以下是查看子命令的帮助命令： kubectl -h：查看子命令列表 kubectl options：查看全局选项 kubectl --help：查看子命令的帮助 kubectl [command] [PARAMS] -o=：设置输出格式（如 json、yaml、jsonpath 等） kubectl explain [RESOURCE]：查看资源的定义 三、命令行自动补全配置 为了方便练习k8s常用命令使用，配置命令行自动补全 Centos yum install -y bash-completion source /usr/share/bash-completion/bash_completion source &lt;(kubectl completion bash) echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc Ubuntu curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.2/bin/linux/amd64/kubectl chmod +x kubectl mv kubectl /usr/local/bin/ sudo mv kubectl /usr/local/bin/ source &lt;(kubectl completion bash) echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc 四、kubectl常用命令总结 1、kubectl version 输出 client 和 server 的版本信息 [root@master ~]# kubectl version Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.2&quot;, GitCommit:&quot;66049e3b21efe110454d67df4fa62b08ea79a19b&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-05-16T16:23:09Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.2&quot;, GitCommit:&quot;66049e3b21efe110454d67df4fa62b08ea79a19b&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-05-16T16:14:56Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} 2、kubectl run 用法：kubectl run NAME --image=image [--env=&quot;key=value&quot;] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [--command] -- [COMMAND] [args...] [options] 2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器 [root@master ~]# kubectl run nginx --image=nginx --replicas=2 --port=80 kubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead. deployment.apps/nginx created 3、kubectl create 用法：kubectl create -f FILENAME [options]，创建资源 3.1、创建dashboard通过yaml文件 可以参考我的另一篇文章：k8s UI组件----Kubernetes Dashboard [root@master yaml]# kubectl create -f kubernetes-dashboard.yaml secret/kubernetes-dashboard-certs created serviceaccount/kubernetes-dashboard created role.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created deployment.apps/kubernetes-dashboard created service/kubernetes-dashboard created 3.2、kubectl create namespace：创建namespace 用法：kubectl create namespace NAME [–dry-run] [options] [root@master ~]# kubectl create namespace cyf namespace/cyf created 3.3、kubectl create secret：创建secret 用法：kubectl create secret [flags] [options] 3.3.1、创建一个TLS Secret [root@master ingress]# kubectl create secret tls tomcat-ingress-sercret --cert=tls.crt --key=tls.key secret/tomcat-ingress-sercret created [root@master ingress]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 5d14h tomcat-ingress-sercret kubernetes.io/tls 2 11s [root@master ingress]# kubectl describe secrets tomcat-ingress-sercret Name: tomcat-ingress-sercret Namespace: default Labels: &lt;none&gt; Annotations: &lt;none&gt; Type: kubernetes.io/tls Data ==== tls.crt: 1294 bytes tls.key: 1675 bytes 3.3.2、创建一个generic Secret [root@master configmap]# kubectl create secret generic mysql-root-password --from-literal=password=Myp@ss123 secret/mysql-root-password created [root@master configmap]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 9d mysql-root-password Opaque 1 10s #Opaque：模糊类型 tomcat-ingress-secret kubernetes.io/tls 2 4d7h 3.4、kubectl create configmap：创建configmap 用法：kubectl create configmap NAME [--from-file=[key=]source] [--from-literal=key1=value1] [--dry-run] [options] [root@master ~]# kubectl create configmap nginx-config --from-literal=nginx_port=80 --from-literal=server_name=myapp.cyf.com configmap/nginx-config created 3.5、kubectl create serviceaccount：创建serviceaccount [root@master yaml]# kubectl create serviceaccount admin serviceaccount/admin created [root@master ~]# kubectl create serviceaccount mysa -o yaml --dry-run apiVersion: v1 kind: ServiceAccount metadata: creationTimestamp: null name: mysa 4、kubectl get 用法：kubectl get [(-o|--output=)json|yaml|wide|custom-columns=...|custom-columns-file=...|go-template=...|go-template-file=...|jsonpath=...|jsonpath-file=...] (TYPE[.VERSION][.GROUP] [NAME | -l label] | TYPE[.VERSION][.GROUP]/NAME ...) [flags] [options] 4.1、kubectl get nodes 4.1.1、获取节点信息 [root@master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSION master Ready master 16h v1.14.2 node1 Ready worker 16h v1.14.2 4.1.2、获取节点详细信息 [root@master ~]# kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME master Ready master 16h v1.14.2 192.168.10.48 &lt;none&gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://19.3.1 node1 Ready worker 16h v1.14.2 192.168.10.148 &lt;none&gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://19.3.1 4.1.3、获取节点标签 [root@master ~]# kubectl get nodes --show-labels NAME STATUS ROLES AGE VERSION LABELS master Ready master 2d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=master,kubernetes.io/os=linux,node-role.kubernetes.io/master= node1 Ready worker 2d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=node1,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker 4.1.4、给节点打标签 [root@master ~]# kubectl label nodes node1 disktype=ssd node/node1 labeled 4.2、kubectl get pods 4.2.1、获取指定namespace的Pod信息（不加-n默认获取default） [root@master ~]# kubectl get pods -n default NAME READY STATUS RESTARTS AGE nginx-755464dd6c-b56mr 1/1 Running 0 52s nginx-755464dd6c-ggwzv 1/1 Running 0 52s 4.2.2、获取所有namespace的Pod信息 [root@master ~]# kubectl get pods --all-namespaces [root@master ~]# kubectl get pods -A NAMESPACE NAME READY STATUS RESTARTS AGE default nginx-755464dd6c-b56mr 1/1 Running 0 3m12s default nginx-755464dd6c-ggwzv 1/1 Running 0 3m12s kube-system coredns-fb8b8dccf-b9cwb 1/1 Running 1 17h kube-system coredns-fb8b8dccf-qcdv2 1/1 Running 1 17h kube-system etcd-master 1/1 Running 1 17h kube-system kube-apiserver-master 1/1 Running 1 17h kube-system kube-controller-manager-master 1/1 Running 1 17h kube-system kube-flannel-ds-amd64-4kn7q 1/1 Running 1 17h kube-system kube-flannel-ds-amd64-xpd8f 1/1 Running 1 17h kube-system kube-proxy-htdpc 1/1 Running 1 17h kube-system kube-proxy-q49ff 1/1 Running 1 17h kube-system kube-scheduler-master 1/1 Running 1 17h kube-system kubernetes-dashboard-6c98b7f57c-q6zp7 1/1 Running 1 16h 4.2.3、获取Pod的详细信息 [root@master ~]# kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES nginx-755464dd6c-b56mr 1/1 Running 0 5m31s 10.244.1.11 node1 &lt;none&gt; &lt;none&gt; nginx-755464dd6c-ggwzv 1/1 Running 0 5m31s 10.244.1.10 node1 &lt;none&gt; &lt;none&gt; [root@master ~]# kubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES default nginx-755464dd6c-b56mr 1/1 Running 0 6m4s 10.244.1.11 node1 &lt;none&gt; &lt;none&gt; default nginx-755464dd6c-ggwzv 1/1 Running 0 6m4s 10.244.1.10 node1 &lt;none&gt; &lt;none&gt; kube-system coredns-fb8b8dccf-b9cwb 1/1 Running 1 17h 10.244.1.9 node1 &lt;none&gt; &lt;none&gt; kube-system coredns-fb8b8dccf-qcdv2 1/1 Running 1 17h 10.244.1.8 node1 &lt;none&gt; &lt;none&gt; ...... 4.2.4、获取Pod的labels [root@master ~]# kubectl get pods --show-labels NAME READY STATUS RESTARTS AGE LABELS nginx-755464dd6c-b56mr 1/1 Running 0 27h pod-template-hash=755464dd6c,run=nginx nginx-755464dd6c-ggwzv 1/1 Running 0 27h pod-template-hash=755464dd6c,run=nginx pod-demo 2/2 Running 0 58s apps=myapp,tier=frontend 4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白 [root@master yaml]# kubectl get pods -L apps,run NAME READY STATUS RESTARTS AGE APPS RUN nginx-755464dd6c-b56mr 1/1 Running 0 27h nginx nginx-755464dd6c-ggwzv 1/1 Running 0 27h nginx pod-demo 2/2 Running 0 15m myapp 4.2.6、获取含有指定标签key的pod [root@master yaml]# kubectl get pods -l apps --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 112s apps=myapp,tier=frontend 4.2.7、获取含有指定标签key=value的pod 等值关系：=和!= [root@master yaml]# kubectl get pods -l release=stable --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 39m apps=myapp,release=stable,tier=frontend 4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合） 集合关系： key in （value1，value2...） key notin （value1，value2...） key !key [root@master yaml]# kubectl get pods -l &quot;release in (canary,beta,alpha)&quot; NAME READY STATUS RESTARTS AGE nginx-755464dd6c-ggwzv 1/1 Running 0 28h [root@master yaml]# kubectl get pods -l &quot;release notin (canary,beta,alpha)&quot; NAME READY STATUS RESTARTS AGE nginx-755464dd6c-b56mr 1/1 Running 0 28h pod-demo 2/2 Running 0 53m 4.2.7、获取podIP kubectl get pod pod-name -o jsonpath=’{.status.podIP}’ [root@master ~]# kubectl get pods nginx-755464dd6c-b56mr -o jsonpath=&#39;{.status.podIP}&#39; 10.244.1.11 4.2.8、导出指定pod的yaml配置 [root@master yaml]# kubectl get pods myapp-deploy-74fb9bdf9b-2rt79 -o yaml --export Flag --export has been deprecated, This flag is deprecated and will be removed in future. apiVersion: v1 kind: Pod metadata: creationTimestamp: null generateName: myapp-deploy-74fb9bdf9b- labels: app: myapp pod-template-hash: 74fb9bdf9b release: canary ownerReferences: ..... 4.3、kubectl get namespaces：获取namespace信息 4.3.1、获取所有namespace信息 [root@master ~]# kubectl get ns NAME STATUS AGE default Active 18h kube-node-lease Active 18h kube-public Active 18h kube-system Active 18h [root@master ~]# kubectl get namespaces NAME STATUS AGE default Active 18h kube-node-lease Active 18h kube-public Active 18h kube-system Active 18h 4.3.2、获取指定namespace信息 [root@master ~]# kubectl get namespaces kube-system NAME STATUS AGE kube-system Active 18h 4.3.3、获取指定namespace的yaml格式信息 [root@master ~]# kubectl get namespaces kube-system -o yaml apiVersion: v1 kind: Namespace metadata: creationTimestamp: &quot;2019-07-29T09:28:58Z&quot; name: kube-system resourceVersion: &quot;10&quot; selfLink: /api/v1/namespaces/kube-system uid: 4ad779da-b1e3-11e9-ac67-0800273a2eb7 spec: finalizers: - kubernetes status: phase: Active 4.3.4、获取指定namespace的json格式信息 [root@master ~]# kubectl get namespaces kube-system -o json { &quot;apiVersion&quot;: &quot;v1&quot;, &quot;kind&quot;: &quot;Namespace&quot;, &quot;metadata&quot;: { &quot;creationTimestamp&quot;: &quot;2019-07-29T09:28:58Z&quot;, &quot;name&quot;: &quot;kube-system&quot;, &quot;resourceVersion&quot;: &quot;10&quot;, &quot;selfLink&quot;: &quot;/api/v1/namespaces/kube-system&quot;, &quot;uid&quot;: &quot;4ad779da-b1e3-11e9-ac67-0800273a2eb7&quot; }, &quot;spec&quot;: { &quot;finalizers&quot;: [ &quot;kubernetes&quot; ] }, &quot;status&quot;: { &quot;phase&quot;: &quot;Active&quot; } } 4.4、kubectl get rs：获取ReplicaSet控制器信息 [root@master yaml]# kubectl get rs NAME DESIRED CURRENT READY AGE myapp 2 2 2 24s 4.5、kubectl get deploy &amp;&amp; kubectl get deployment 4.5.1、获取Deployment控制器信息 [root@master yaml]# kubectl get deploy NAME READY UP-TO-DATE AVAILABLE AGE myapp-deploy 2/2 2 2 22s nginx 1/1 1 1 19h [root@master yaml]# kubectl get deployments NAME READY UP-TO-DATE AVAILABLE AGE myapp-deploy 2/2 2 2 22s nginx 1/1 1 1 19h 4.5.2、与ReplicaSet的联系。rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf [root@master yaml]# kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deploy-74fb9bdf9b 2 2 2 48s nginx-755464dd6c 1 1 1 19h [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-deploy-74fb9bdf9b-rd4nf 1/1 Running 0 7m42s myapp-deploy-74fb9bdf9b-slfst 1/1 Running 0 7m42s nginx-755464dd6c-2pgbs 1/1 Running 0 19h 4.5.3、滚动更新 修改版本号后的滚动更新过程 [root@master yaml]# kubectl get pods -w NAME READY STATUS RESTARTS AGE myapp-deploy-74fb9bdf9b-rd4nf 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-slfst 1/1 Running 0 33h nginx-755464dd6c-2pgbs 1/1 Running 0 2d4h myapp-deploy-74fb9bdf9b-lqm77 0/1 Pending 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Pending 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 ContainerCreating 0 33h myapp-deploy-74fb9bdf9b-lqm77 1/1 Running 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 Pending 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 Pending 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 ContainerCreating 0 33h myapp-deploy-66cfdc5675-g8dgm 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-lqm77 1/1 Terminating 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 Pending 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 Pending 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 ContainerCreating 0 33h myapp-deploy-66cfdc5675-c7fxx 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 1/1 Terminating 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 Pending 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 Pending 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 ContainerCreating 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-66cfdc5675-xj5qq 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-slfst 1/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h 查看滚动更新后历史版本和现在运行版本 [root@master yaml]# kubectl get rs -o wide NAME DESIRED CURRENT READY AGE CONTAINERS IMAGES SELECTOR myapp-deploy-66cfdc5675 3 3 3 100s myapp ikubernetes/myapp:v2 app=myapp,pod-template-hash=66cfdc5675,release=canary myapp-deploy-74fb9bdf9b 0 0 0 16m myapp ikubernetes/myapp:v1 app=myapp,pod-template-hash=74fb9bdf9b,release=canary 4.6、kubectl get svc：获取service信息 4.6.1、获取默认命名空间的service [root@master yaml]# kubectl get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.96.0.1 &lt;none&gt; 443/TCP 3d5h 4.6.2、获取指定命名空间的service [root@master ingress-nginx]# kubectl get svc -n ingress-nginx NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE default-http-backend ClusterIP 10.109.114.81 &lt;none&gt; 80/TCP 45m ingress-nginx NodePort 10.106.125.159 &lt;none&gt; 80:30080/TCP,443:30443/TCP 73s 4.7、kubectl get secrets：获取secrets信息 [root@master ingress]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 5d14h tomcat-ingress-sercret kubernetes.io/tls 2 11s 4.8、kubectl get pv：获取pv信息 [root@master volumes]# kubectl get pv NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE pv001 1Gi RWO,RWX Retain Available 10s pv002 1Gi RWX Retain Available 10s pv003 1Gi RWO,RWX Retain Available 10s pv004 1Gi RWO,RWX Retain Available 10s pv005 1Gi RWO,RWX Retain Available 10s 4.9、kubectl get pvc：获取pvc信息 [root@master volumes]# kubectl get pvc NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE mypvc Bound pv002 1Gi RWX 43s 4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息 [root@master ~]# kubectl get cm NAME DATA AGE nginx-config 2 4m11s 4.11、kubectl get sts：获取statefulSet控制器信息 [root@master yaml]# kubectl get sts NAME READY AGE myapp 3/3 30s 4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息 [root@master yaml]# kubectl get serviceaccounts &amp;&amp; kubectl get sa NAME SECRETS AGE admin 1 3m49s default 1 10d NAME SECRETS AGE admin 1 3m50s default 1 10d 5、kubectl label 用法：kubectl label [--overwrite] (-f FILENAME | TYPE NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--resource-version=version]，资源标签设定 5.1、给一个pod打一个没有存在的标签key=value， [root@master yaml]# kubectl label pods pod-demo release=canary pod/pod-demo labeled [root@master yaml]# kubectl get pods pod-demo --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 33m apps=myapp,release=canary,tier=frontend 5.2、给一个pod已经存在的标签重新赋值 [root@master yaml]# kubectl label pods pod-demo release=stable error: &#39;release&#39; already has a value (canary), and --overwrite is false [root@master yaml]# kubectl label pods pod-demo release=stable --overwrite pod/pod-demo labeled 5.3、通过key删除标签 [root@master ~]# kubectl get nodes --show-labels NAME STATUS ROLES AGE VERSION LABELS master Ready master 8d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=master,kubernetes.io/os=linux,node-role.kubernetes.io/master= node1 Ready worker 8d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,disktype=ssd,hostname=node1,kubernetes.io/arch=amd64,kubernetes.io/hostname=node1,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker node2 Ready worker 5d6h v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,hostname=node2,kubernetes.io/arch=amd64,kubernetes.io/hostname=node2,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker [root@master ~]# kubectl label nodes node1 disktype- node/node1 labeled 6、kubectl describe 用法：kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | -l label] | TYPE/NAME) [options]，显示资源的详细描述 6.1、查看某个pod的详细信息 [root@master yaml]# kubectl describe pods pod-demo Name: pod-demo Namespace: default Priority: 0 PriorityClassName: &lt;none&gt; Node: node1/192.168.10.148 Start Time: Tue, 30 Jul 2019 18:17:38 +0800 Labels: apps=myapp tier=frontend Annotations: &lt;none&gt; Status: Running IP: 10.244.1.14 6.2、查看创建的serviceaccount的详细信息 [root@master yaml]# kubectl describe sa admin Name: admin Namespace: default Labels: &lt;none&gt; Annotations: &lt;none&gt; Image pull secrets: &lt;none&gt; #设置镜像拉取的镜像仓库，用sa替代imagePullSecrets Mountable secrets: admin-token-f6h28 Tokens: admin-token-f6h28 Events: &lt;none&gt; 7、kubectl delete 用法：kubectl delete ([-f FILENAME] | [-k DIRECTORY] | TYPE [(NAME | -l label | --all)]) [options]，删除资源 7.1、删除pods资源 [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-l9pbb 1/1 Running 0 7m1s myapp-nlw6m 1/1 Running 0 10m myapp-ppktd 1/1 Running 0 10m myapp-wmbnc 1/1 Running 0 28m myapp-wpfpn 1/1 Running 0 10m [root@master yaml]# kubectl delete pods myapp-l9pbb pod &quot;myapp-l9pbb&quot; deleted [root@master yaml]# 7.2、删除service [root@master yaml]# kubectl delete svc redis service &quot;redis&quot; deleted 7.3、删除namespace [root@master ~]# kubectl delete ns cyf namespace &quot;cyf&quot; deleted 7.4、删除Secret [root@master ingress]# kubectl delete secrets tomcat-ingress-sercret secret &quot;tomcat-ingress-sercret&quot; deleted 7.5、删除configmap [root@master configmap]# kubectl delete configmaps nginx configmap &quot;nginx&quot; deleted 8、kubectl edit 用法：kubectl edit (RESOURCE/NAME | -f FILENAME) [options]，编辑资源清单 8.1、修改ReplicaSet控制器的yaml清单内容 注意：修改容器版本，不会自动更新（手动删除pod后自动更新：灰度发布） [root@master yaml]# kubectl edit rs myapp replicaset.extensions/myapp edited 9、kubectl exec 用法：kubectl exec POD [-c CONTAINER] -- COMMAND [args...] [options]，类似docker exec，进入容器 9.1、进入pod内的容器 [root@master yaml]# kubectl exec -it myapp-lmj45 -- /bin/sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # exit [root@master yaml]# kubectl exec -it myapp-lmj45 sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # 9.2、进入pod内指定容器 用法：kubectl exec -it pod-name -c container-name -- /bin/sh [root@master yaml]# kubectl exec -it myapp-lmj45 -c myapp-container sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # exit [root@master yaml]# kubectl exec -it myapp-lmj45 -c myapp-container -- /bin/sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # 10、kubectl logs 用法：kubectl logs [-f] [-p] (POD | TYPE/NAME) [-c CONTAINER] [options]，类似于docker logs，查看容器日志 10.1、查看pod内的容器日志 [root@master yaml]# kubectl logs myapp-lmj45 --tail 300 -f 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:44 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.2、查看pod内指定容器的日志 [root@master yaml]# kubectl logs myapp-lmj45 -c myapp-container --tail 300 -f 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:44 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 11、kubectl explain 用法：kubectl explain RESOURCE [options]，显示各种资源清单的字段解释 11.1、查看pod资源清单字段 [root@master ~]# kubectl explain pod KIND: Pod VERSION: v1 DESCRIPTION: Pod is a collection of containers that can run on a host. This resource is created by clients and scheduled onto hosts. FIELDS: apiVersion &lt;string&gt; ..... 11.2、查看pod资源清单理metadata字段下的字段（以此类推） [root@master ~]# kubectl explain pod.metadata KIND: Pod VERSION: v1 RESOURCE: metadata &lt;Object&gt; DESCRIPTION: Standard object&#39;s metadata. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata ObjectMeta is metadata that all persisted resources must have, which includes all objects users must create. FIELDS: annotations &lt;map[string]string&gt; ..... 11.3、查看ReplicaSet资源清单字段 [root@master yaml]# kubectl explain rs KIND: ReplicaSet VERSION: extensions/v1beta1 DESCRIPTION: DEPRECATED - This group version of ReplicaSet is deprecated by apps/v1beta2/ReplicaSet. See the release notes for more information. ReplicaSet ensures that a specified number of pod replicas are running at any given time. FIELDS: apiVersion &lt;string&gt; APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: ..... 12、kubectl rollout 用法：kubectl rollout SUBCOMMAND [options]，滚动更新 类型： deployments daemonsets statefulsets 12.1、查看deployment滚动更新历史版本 [root@master yaml]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 1 &lt;none&gt; 2 &lt;none&gt; 12.2、更新一个pod后暂停更新 [root@master yaml]# kubectl rollout pause deployment myapp-deploy deployment.extensions/myapp-deploy paused [root@master ~]# kubectl get pods -l app=myapp -w NAME READY STATUS RESTARTS AGE myapp-deploy-66cfdc5675-cnm4m 1/1 Running 0 12s myapp-deploy-66cfdc5675-jzghg 1/1 Running 0 12s myapp-deploy-66cfdc5675-zkc94 1/1 Running 0 12s myapp-deploy-668ff4dc58-fq6hp 0/1 Pending 0 0s myapp-deploy-668ff4dc58-fq6hp 0/1 Pending 0 0s myapp-deploy-668ff4dc58-fq6hp 0/1 ContainerCreating 0 0s myapp-deploy-668ff4dc58-fq6hp 1/1 Running 0 9s 12.3、解除暂停状态，继续更新 [root@master yaml]# kubectl rollout resume deployment myapp-deploy deployment.extensions/myapp-deploy resumed [root@master yaml]# kubectl rollout status deployment myapp-deploy deployment &quot;myapp-deploy&quot; successfully rolled out 12.4、回滚到指定版本 [root@master ~]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 1 &lt;none&gt; 2 &lt;none&gt; 3 &lt;none&gt; [root@master yaml]# kubectl rollout undo deployment myapp-deploy --to-revision=1 deployment.extensions/myapp-deploy rolled back [root@master yaml]# kubectl get rs -o wide NAME DESIRED CURRENT READY AGE CONTAINERS IMAGES SELECTOR myapp-deploy-668ff4dc58 0 0 0 4m myapp ikubernetes/myapp:v3 app=myapp,pod-template-hash=668ff4dc58,release=canary myapp-deploy-66cfdc5675 0 0 0 4m23s myapp ikubernetes/myapp:v2 app=myapp,pod-template-hash=66cfdc5675,release=canary myapp-deploy-74fb9bdf9b 5 5 5 5m8s myapp ikubernetes/myapp:v1 app=myapp,pod-template-hash=74fb9bdf9b,release=canary [root@master ~]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 2 &lt;none&gt; 3 &lt;none&gt; 4 &lt;none&gt; 12.5、监控deployment更新状态 [root@master yaml]# kubectl rollout status deployment myapp-deploy Waiting for deployment &quot;myapp-deploy&quot; rollout to finish: 1 out of 3 new replicas have been updated... 13、kubectl scale Deployment, ReplicaSet, Replication Controller, or StatefulSet，pod副本的扩容和缩容 用法：kubectl scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME) 13.1、扩容和缩容 [root@master yaml]# kubectl scale sts myapp --replicas=2 statefulset.apps/myapp scaled [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-0 1/1 Running 0 14m myapp-1 1/1 Running 0 14m 14、kubectl patch 用法：kubectl patch (-f FILENAME | TYPE NAME) -p PATCH [options] 14.1、修改deployment副本数 [root@master yaml]# kubectl patch deployment myapp-deploy -p &#39;{&quot;spec&quot;:{&quot;replicas&quot;:5}}&#39; deployment.extensions/myapp-deploy patched 14.2、修改deployment滚动更新策略 [root@master yaml]# kubectl patch deployment myapp-deploy -p &#39;{&quot;spec&quot;:{&quot;strategy&quot;:{&quot;rollingUpdate&quot;:{&quot;maxSurge&quot;:1,&quot;maxUnavailable&quot;:0}}}}&#39; deployment.extensions/myapp-deploy patched [root@master yaml]# kubectl describe deployments myapp-deploy Name: myapp-deploy Namespace: default CreationTimestamp: Fri, 02 Aug 2019 01:33:47 +0800 Labels: app=myapp release=canary Annotations: deployment.kubernetes.io/revision: 2 kubectl.kubernetes.io/last-applied-configuration: {&quot;apiVersion&quot;:&quot;apps/v1&quot;,&quot;kind&quot;:&quot;Deployment&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;myapp-deploy&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;replicas&quot;:3... Selector: app=myapp,release=canary Replicas: 5 desired | 5 updated | 5 total | 5 available | 0 unavailable StrategyType: RollingUpdate MinReadySeconds: 0 RollingUpdateStrategy: 0 max unavailable, 1 max surge #已经修改 ..... 15、kubectl set 用法：kubectl set SUBCOMMAND [options] 15.1、kubectl set image 用法：kubectl set image (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N [options] 15.1.1、修改deployment的镜像版本 [root@master yaml]# kubectl set image deployment myapp-deploy myapp=ikubernetes/myapp:v3 deployment.extensions/myapp-deploy image updated 15.1.2、修改daemonset的镜像版本 [root@master yaml]# kubectl set image daemonsets filebeat-ds filebeat=ikubernetes/filebeat:5.6.6-alpine daemonset.extensions/filebeat-ds image updated 16、kubectl config 用法：kubectl config SUBCOMMAND [options] 16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件 [root@master yaml]# kubectl config view apiVersion: v1 clusters: - cluster: certificate-authority-data: DATA+OMITTED server: https://192.168.10.48:6443 name: kubernetes contexts: - context: cluster: kubernetes user: kubernetes-admin name: kubernetes-admin@kubernetes current-context: kubernetes-admin@kubernetes kind: Config preferences: {} users: - name: kubernetes-admin user: client-certificate-data: REDACTED client-key-data: REDACTED kubectl cluster-info：查看集群信息 [root@master ~]# kubectl cluster-info Kubernetes master is running at https://192.168.10.48:6443 KubeDNS is running at https://192.168.10.48:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;. kubectl api-versions：查询 Kubernetes API 支持的 API 版本 [root@master ~]# kubectl api-versions admissionregistration.k8s.io/v1beta1 apiextensions.k8s.io/v1beta1 apiregistration.k8s.io/v1 apiregistration.k8s.io/v1beta1 apps/v1 apps/v1beta1 apps/v1beta2 ..... kubectl api-resources：查看k8s支持的资源类型 [root@master ~]# kubectl api-resources NAME SHORTNAMES APIGROUP NAMESPACED KIND bindings true Binding componentstatuses cs false ComponentStatus configmaps cm true ConfigMap endpoints ep true Endpoints events ev true Event limitranges limits true LimitRange namespaces ns false Namespace nodes no false Node 查看指定群组支持的资源类型 [root@master ~]# kubectl api-resources --api-group=storage.k8s.io NAME SHORTNAMES APIGROUP NAMESPACED KIND csidrivers storage.k8s.io false CSIDriver csinodes storage.k8s.io false CSINode storageclasses sc storage.k8s.io false StorageClass volumeattachments storage.k8s.io false VolumeAttachment" />
<meta property="og:description" content="文章目录 一、k8s集群搭建 二、kubectl简介 三、命令行自动补全配置 四、kubectl常用命令总结 1、kubectl version 2、kubectl run 2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器 3、kubectl create 3.1、创建dashboard通过yaml文件 3.2、kubectl create namespace：创建namespace 3.3、kubectl create secret：创建secret 3.3.1、创建一个TLS Secret 3.3.2、创建一个generic Secret 3.4、kubectl create configmap：创建configmap 3.5、kubectl create serviceaccount：创建serviceaccount 4、kubectl get 4.1、kubectl get nodes 4.1.1、获取节点信息 4.1.2、获取节点详细信息 4.1.3、获取节点标签 4.1.4、给节点打标签 4.2、kubectl get pods 4.2.1、获取指定namespace的Pod信息（不加-n默认获取default） 4.2.2、获取所有namespace的Pod信息 4.2.3、获取Pod的详细信息 4.2.4、获取Pod的labels 4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白 4.2.6、获取含有指定标签key的pod 4.2.7、获取含有指定标签key=value的pod 4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合） 4.2.7、获取podIP 4.2.8、导出指定pod的yaml配置 4.3、kubectl get namespaces：获取namespace信息 4.3.1、获取所有namespace信息 4.3.2、获取指定namespace信息 4.3.3、获取指定namespace的yaml格式信息 4.3.4、获取指定namespace的json格式信息 4.4、kubectl get rs：获取ReplicaSet控制器信息 4.5、kubectl get deploy &amp;&amp; kubectl get deployment 4.5.1、获取Deployment控制器信息 4.5.2、与ReplicaSet的联系。`rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf` 4.5.3、滚动更新 4.6、kubectl get svc：获取service信息 4.6.1、获取默认命名空间的service 4.6.2、获取指定命名空间的service 4.7、kubectl get secrets：获取secrets信息 4.8、kubectl get pv：获取pv信息 4.9、kubectl get pvc：获取pvc信息 4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息 4.11、kubectl get sts：获取statefulSet控制器信息 4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息 5、kubectl label 5.1、给一个pod打一个没有存在的标签key=value， 5.2、给一个pod已经存在的标签重新赋值 5.3、通过key删除标签 6、kubectl describe 6.1、查看某个pod的详细信息 6.2、查看创建的serviceaccount的详细信息 7、kubectl delete 7.1、删除pods资源 7.2、删除service 7.3、删除namespace 7.4、删除Secret 7.5、删除configmap 8、kubectl edit 8.1、修改ReplicaSet控制器的yaml清单内容 9、kubectl exec 9.1、进入pod内的容器 9.2、进入pod内指定容器 10、kubectl logs 10.1、查看pod内的容器日志 10.2、查看pod内指定容器的日志 11、kubectl explain 11.1、查看pod资源清单字段 11.2、查看pod资源清单理metadata字段下的字段（以此类推） 11.3、查看ReplicaSet资源清单字段 12、kubectl rollout 12.1、查看deployment滚动更新历史版本 12.2、更新一个pod后暂停更新 12.3、解除暂停状态，继续更新 12.4、回滚到指定版本 12.5、监控deployment更新状态 13、kubectl scale 13.1、扩容和缩容 14、kubectl patch 14.1、修改deployment副本数 14.2、修改deployment滚动更新策略 15、kubectl set 15.1、kubectl set image 15.1.1、修改deployment的镜像版本 15.1.2、修改daemonset的镜像版本 16、kubectl config 16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件 kubectl cluster-info：查看集群信息 kubectl api-versions：查询 Kubernetes API 支持的 API 版本 kubectl api-resources：查看k8s支持的资源类型 查看指定群组支持的资源类型 一、k8s集群搭建 可以参考我的另一篇文章搭建一个集群进行演练：k8s核心组件----kubeadm初始化集群（v1.14.2） 二、kubectl简介 kubectl 是 Kubernetes 的命令行工具（CLI），是 Kubernetes 用户和管理员必备的管理工具。 kubectl 提供了大量的子命令，方便管理 Kubernetes 集群中的各种功能。以下是查看子命令的帮助命令： kubectl -h：查看子命令列表 kubectl options：查看全局选项 kubectl --help：查看子命令的帮助 kubectl [command] [PARAMS] -o=：设置输出格式（如 json、yaml、jsonpath 等） kubectl explain [RESOURCE]：查看资源的定义 三、命令行自动补全配置 为了方便练习k8s常用命令使用，配置命令行自动补全 Centos yum install -y bash-completion source /usr/share/bash-completion/bash_completion source &lt;(kubectl completion bash) echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc Ubuntu curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.2/bin/linux/amd64/kubectl chmod +x kubectl mv kubectl /usr/local/bin/ sudo mv kubectl /usr/local/bin/ source &lt;(kubectl completion bash) echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc 四、kubectl常用命令总结 1、kubectl version 输出 client 和 server 的版本信息 [root@master ~]# kubectl version Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.2&quot;, GitCommit:&quot;66049e3b21efe110454d67df4fa62b08ea79a19b&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-05-16T16:23:09Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.2&quot;, GitCommit:&quot;66049e3b21efe110454d67df4fa62b08ea79a19b&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-05-16T16:14:56Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} 2、kubectl run 用法：kubectl run NAME --image=image [--env=&quot;key=value&quot;] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [--command] -- [COMMAND] [args...] [options] 2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器 [root@master ~]# kubectl run nginx --image=nginx --replicas=2 --port=80 kubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead. deployment.apps/nginx created 3、kubectl create 用法：kubectl create -f FILENAME [options]，创建资源 3.1、创建dashboard通过yaml文件 可以参考我的另一篇文章：k8s UI组件----Kubernetes Dashboard [root@master yaml]# kubectl create -f kubernetes-dashboard.yaml secret/kubernetes-dashboard-certs created serviceaccount/kubernetes-dashboard created role.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created deployment.apps/kubernetes-dashboard created service/kubernetes-dashboard created 3.2、kubectl create namespace：创建namespace 用法：kubectl create namespace NAME [–dry-run] [options] [root@master ~]# kubectl create namespace cyf namespace/cyf created 3.3、kubectl create secret：创建secret 用法：kubectl create secret [flags] [options] 3.3.1、创建一个TLS Secret [root@master ingress]# kubectl create secret tls tomcat-ingress-sercret --cert=tls.crt --key=tls.key secret/tomcat-ingress-sercret created [root@master ingress]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 5d14h tomcat-ingress-sercret kubernetes.io/tls 2 11s [root@master ingress]# kubectl describe secrets tomcat-ingress-sercret Name: tomcat-ingress-sercret Namespace: default Labels: &lt;none&gt; Annotations: &lt;none&gt; Type: kubernetes.io/tls Data ==== tls.crt: 1294 bytes tls.key: 1675 bytes 3.3.2、创建一个generic Secret [root@master configmap]# kubectl create secret generic mysql-root-password --from-literal=password=Myp@ss123 secret/mysql-root-password created [root@master configmap]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 9d mysql-root-password Opaque 1 10s #Opaque：模糊类型 tomcat-ingress-secret kubernetes.io/tls 2 4d7h 3.4、kubectl create configmap：创建configmap 用法：kubectl create configmap NAME [--from-file=[key=]source] [--from-literal=key1=value1] [--dry-run] [options] [root@master ~]# kubectl create configmap nginx-config --from-literal=nginx_port=80 --from-literal=server_name=myapp.cyf.com configmap/nginx-config created 3.5、kubectl create serviceaccount：创建serviceaccount [root@master yaml]# kubectl create serviceaccount admin serviceaccount/admin created [root@master ~]# kubectl create serviceaccount mysa -o yaml --dry-run apiVersion: v1 kind: ServiceAccount metadata: creationTimestamp: null name: mysa 4、kubectl get 用法：kubectl get [(-o|--output=)json|yaml|wide|custom-columns=...|custom-columns-file=...|go-template=...|go-template-file=...|jsonpath=...|jsonpath-file=...] (TYPE[.VERSION][.GROUP] [NAME | -l label] | TYPE[.VERSION][.GROUP]/NAME ...) [flags] [options] 4.1、kubectl get nodes 4.1.1、获取节点信息 [root@master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSION master Ready master 16h v1.14.2 node1 Ready worker 16h v1.14.2 4.1.2、获取节点详细信息 [root@master ~]# kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME master Ready master 16h v1.14.2 192.168.10.48 &lt;none&gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://19.3.1 node1 Ready worker 16h v1.14.2 192.168.10.148 &lt;none&gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://19.3.1 4.1.3、获取节点标签 [root@master ~]# kubectl get nodes --show-labels NAME STATUS ROLES AGE VERSION LABELS master Ready master 2d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=master,kubernetes.io/os=linux,node-role.kubernetes.io/master= node1 Ready worker 2d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=node1,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker 4.1.4、给节点打标签 [root@master ~]# kubectl label nodes node1 disktype=ssd node/node1 labeled 4.2、kubectl get pods 4.2.1、获取指定namespace的Pod信息（不加-n默认获取default） [root@master ~]# kubectl get pods -n default NAME READY STATUS RESTARTS AGE nginx-755464dd6c-b56mr 1/1 Running 0 52s nginx-755464dd6c-ggwzv 1/1 Running 0 52s 4.2.2、获取所有namespace的Pod信息 [root@master ~]# kubectl get pods --all-namespaces [root@master ~]# kubectl get pods -A NAMESPACE NAME READY STATUS RESTARTS AGE default nginx-755464dd6c-b56mr 1/1 Running 0 3m12s default nginx-755464dd6c-ggwzv 1/1 Running 0 3m12s kube-system coredns-fb8b8dccf-b9cwb 1/1 Running 1 17h kube-system coredns-fb8b8dccf-qcdv2 1/1 Running 1 17h kube-system etcd-master 1/1 Running 1 17h kube-system kube-apiserver-master 1/1 Running 1 17h kube-system kube-controller-manager-master 1/1 Running 1 17h kube-system kube-flannel-ds-amd64-4kn7q 1/1 Running 1 17h kube-system kube-flannel-ds-amd64-xpd8f 1/1 Running 1 17h kube-system kube-proxy-htdpc 1/1 Running 1 17h kube-system kube-proxy-q49ff 1/1 Running 1 17h kube-system kube-scheduler-master 1/1 Running 1 17h kube-system kubernetes-dashboard-6c98b7f57c-q6zp7 1/1 Running 1 16h 4.2.3、获取Pod的详细信息 [root@master ~]# kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES nginx-755464dd6c-b56mr 1/1 Running 0 5m31s 10.244.1.11 node1 &lt;none&gt; &lt;none&gt; nginx-755464dd6c-ggwzv 1/1 Running 0 5m31s 10.244.1.10 node1 &lt;none&gt; &lt;none&gt; [root@master ~]# kubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES default nginx-755464dd6c-b56mr 1/1 Running 0 6m4s 10.244.1.11 node1 &lt;none&gt; &lt;none&gt; default nginx-755464dd6c-ggwzv 1/1 Running 0 6m4s 10.244.1.10 node1 &lt;none&gt; &lt;none&gt; kube-system coredns-fb8b8dccf-b9cwb 1/1 Running 1 17h 10.244.1.9 node1 &lt;none&gt; &lt;none&gt; kube-system coredns-fb8b8dccf-qcdv2 1/1 Running 1 17h 10.244.1.8 node1 &lt;none&gt; &lt;none&gt; ...... 4.2.4、获取Pod的labels [root@master ~]# kubectl get pods --show-labels NAME READY STATUS RESTARTS AGE LABELS nginx-755464dd6c-b56mr 1/1 Running 0 27h pod-template-hash=755464dd6c,run=nginx nginx-755464dd6c-ggwzv 1/1 Running 0 27h pod-template-hash=755464dd6c,run=nginx pod-demo 2/2 Running 0 58s apps=myapp,tier=frontend 4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白 [root@master yaml]# kubectl get pods -L apps,run NAME READY STATUS RESTARTS AGE APPS RUN nginx-755464dd6c-b56mr 1/1 Running 0 27h nginx nginx-755464dd6c-ggwzv 1/1 Running 0 27h nginx pod-demo 2/2 Running 0 15m myapp 4.2.6、获取含有指定标签key的pod [root@master yaml]# kubectl get pods -l apps --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 112s apps=myapp,tier=frontend 4.2.7、获取含有指定标签key=value的pod 等值关系：=和!= [root@master yaml]# kubectl get pods -l release=stable --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 39m apps=myapp,release=stable,tier=frontend 4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合） 集合关系： key in （value1，value2...） key notin （value1，value2...） key !key [root@master yaml]# kubectl get pods -l &quot;release in (canary,beta,alpha)&quot; NAME READY STATUS RESTARTS AGE nginx-755464dd6c-ggwzv 1/1 Running 0 28h [root@master yaml]# kubectl get pods -l &quot;release notin (canary,beta,alpha)&quot; NAME READY STATUS RESTARTS AGE nginx-755464dd6c-b56mr 1/1 Running 0 28h pod-demo 2/2 Running 0 53m 4.2.7、获取podIP kubectl get pod pod-name -o jsonpath=’{.status.podIP}’ [root@master ~]# kubectl get pods nginx-755464dd6c-b56mr -o jsonpath=&#39;{.status.podIP}&#39; 10.244.1.11 4.2.8、导出指定pod的yaml配置 [root@master yaml]# kubectl get pods myapp-deploy-74fb9bdf9b-2rt79 -o yaml --export Flag --export has been deprecated, This flag is deprecated and will be removed in future. apiVersion: v1 kind: Pod metadata: creationTimestamp: null generateName: myapp-deploy-74fb9bdf9b- labels: app: myapp pod-template-hash: 74fb9bdf9b release: canary ownerReferences: ..... 4.3、kubectl get namespaces：获取namespace信息 4.3.1、获取所有namespace信息 [root@master ~]# kubectl get ns NAME STATUS AGE default Active 18h kube-node-lease Active 18h kube-public Active 18h kube-system Active 18h [root@master ~]# kubectl get namespaces NAME STATUS AGE default Active 18h kube-node-lease Active 18h kube-public Active 18h kube-system Active 18h 4.3.2、获取指定namespace信息 [root@master ~]# kubectl get namespaces kube-system NAME STATUS AGE kube-system Active 18h 4.3.3、获取指定namespace的yaml格式信息 [root@master ~]# kubectl get namespaces kube-system -o yaml apiVersion: v1 kind: Namespace metadata: creationTimestamp: &quot;2019-07-29T09:28:58Z&quot; name: kube-system resourceVersion: &quot;10&quot; selfLink: /api/v1/namespaces/kube-system uid: 4ad779da-b1e3-11e9-ac67-0800273a2eb7 spec: finalizers: - kubernetes status: phase: Active 4.3.4、获取指定namespace的json格式信息 [root@master ~]# kubectl get namespaces kube-system -o json { &quot;apiVersion&quot;: &quot;v1&quot;, &quot;kind&quot;: &quot;Namespace&quot;, &quot;metadata&quot;: { &quot;creationTimestamp&quot;: &quot;2019-07-29T09:28:58Z&quot;, &quot;name&quot;: &quot;kube-system&quot;, &quot;resourceVersion&quot;: &quot;10&quot;, &quot;selfLink&quot;: &quot;/api/v1/namespaces/kube-system&quot;, &quot;uid&quot;: &quot;4ad779da-b1e3-11e9-ac67-0800273a2eb7&quot; }, &quot;spec&quot;: { &quot;finalizers&quot;: [ &quot;kubernetes&quot; ] }, &quot;status&quot;: { &quot;phase&quot;: &quot;Active&quot; } } 4.4、kubectl get rs：获取ReplicaSet控制器信息 [root@master yaml]# kubectl get rs NAME DESIRED CURRENT READY AGE myapp 2 2 2 24s 4.5、kubectl get deploy &amp;&amp; kubectl get deployment 4.5.1、获取Deployment控制器信息 [root@master yaml]# kubectl get deploy NAME READY UP-TO-DATE AVAILABLE AGE myapp-deploy 2/2 2 2 22s nginx 1/1 1 1 19h [root@master yaml]# kubectl get deployments NAME READY UP-TO-DATE AVAILABLE AGE myapp-deploy 2/2 2 2 22s nginx 1/1 1 1 19h 4.5.2、与ReplicaSet的联系。rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf [root@master yaml]# kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deploy-74fb9bdf9b 2 2 2 48s nginx-755464dd6c 1 1 1 19h [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-deploy-74fb9bdf9b-rd4nf 1/1 Running 0 7m42s myapp-deploy-74fb9bdf9b-slfst 1/1 Running 0 7m42s nginx-755464dd6c-2pgbs 1/1 Running 0 19h 4.5.3、滚动更新 修改版本号后的滚动更新过程 [root@master yaml]# kubectl get pods -w NAME READY STATUS RESTARTS AGE myapp-deploy-74fb9bdf9b-rd4nf 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-slfst 1/1 Running 0 33h nginx-755464dd6c-2pgbs 1/1 Running 0 2d4h myapp-deploy-74fb9bdf9b-lqm77 0/1 Pending 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Pending 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 ContainerCreating 0 33h myapp-deploy-74fb9bdf9b-lqm77 1/1 Running 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 Pending 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 Pending 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 ContainerCreating 0 33h myapp-deploy-66cfdc5675-g8dgm 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-lqm77 1/1 Terminating 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 Pending 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 Pending 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 ContainerCreating 0 33h myapp-deploy-66cfdc5675-c7fxx 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 1/1 Terminating 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 Pending 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 Pending 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 ContainerCreating 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-66cfdc5675-xj5qq 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-slfst 1/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h 查看滚动更新后历史版本和现在运行版本 [root@master yaml]# kubectl get rs -o wide NAME DESIRED CURRENT READY AGE CONTAINERS IMAGES SELECTOR myapp-deploy-66cfdc5675 3 3 3 100s myapp ikubernetes/myapp:v2 app=myapp,pod-template-hash=66cfdc5675,release=canary myapp-deploy-74fb9bdf9b 0 0 0 16m myapp ikubernetes/myapp:v1 app=myapp,pod-template-hash=74fb9bdf9b,release=canary 4.6、kubectl get svc：获取service信息 4.6.1、获取默认命名空间的service [root@master yaml]# kubectl get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.96.0.1 &lt;none&gt; 443/TCP 3d5h 4.6.2、获取指定命名空间的service [root@master ingress-nginx]# kubectl get svc -n ingress-nginx NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE default-http-backend ClusterIP 10.109.114.81 &lt;none&gt; 80/TCP 45m ingress-nginx NodePort 10.106.125.159 &lt;none&gt; 80:30080/TCP,443:30443/TCP 73s 4.7、kubectl get secrets：获取secrets信息 [root@master ingress]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 5d14h tomcat-ingress-sercret kubernetes.io/tls 2 11s 4.8、kubectl get pv：获取pv信息 [root@master volumes]# kubectl get pv NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE pv001 1Gi RWO,RWX Retain Available 10s pv002 1Gi RWX Retain Available 10s pv003 1Gi RWO,RWX Retain Available 10s pv004 1Gi RWO,RWX Retain Available 10s pv005 1Gi RWO,RWX Retain Available 10s 4.9、kubectl get pvc：获取pvc信息 [root@master volumes]# kubectl get pvc NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE mypvc Bound pv002 1Gi RWX 43s 4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息 [root@master ~]# kubectl get cm NAME DATA AGE nginx-config 2 4m11s 4.11、kubectl get sts：获取statefulSet控制器信息 [root@master yaml]# kubectl get sts NAME READY AGE myapp 3/3 30s 4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息 [root@master yaml]# kubectl get serviceaccounts &amp;&amp; kubectl get sa NAME SECRETS AGE admin 1 3m49s default 1 10d NAME SECRETS AGE admin 1 3m50s default 1 10d 5、kubectl label 用法：kubectl label [--overwrite] (-f FILENAME | TYPE NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--resource-version=version]，资源标签设定 5.1、给一个pod打一个没有存在的标签key=value， [root@master yaml]# kubectl label pods pod-demo release=canary pod/pod-demo labeled [root@master yaml]# kubectl get pods pod-demo --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 33m apps=myapp,release=canary,tier=frontend 5.2、给一个pod已经存在的标签重新赋值 [root@master yaml]# kubectl label pods pod-demo release=stable error: &#39;release&#39; already has a value (canary), and --overwrite is false [root@master yaml]# kubectl label pods pod-demo release=stable --overwrite pod/pod-demo labeled 5.3、通过key删除标签 [root@master ~]# kubectl get nodes --show-labels NAME STATUS ROLES AGE VERSION LABELS master Ready master 8d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=master,kubernetes.io/os=linux,node-role.kubernetes.io/master= node1 Ready worker 8d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,disktype=ssd,hostname=node1,kubernetes.io/arch=amd64,kubernetes.io/hostname=node1,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker node2 Ready worker 5d6h v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,hostname=node2,kubernetes.io/arch=amd64,kubernetes.io/hostname=node2,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker [root@master ~]# kubectl label nodes node1 disktype- node/node1 labeled 6、kubectl describe 用法：kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | -l label] | TYPE/NAME) [options]，显示资源的详细描述 6.1、查看某个pod的详细信息 [root@master yaml]# kubectl describe pods pod-demo Name: pod-demo Namespace: default Priority: 0 PriorityClassName: &lt;none&gt; Node: node1/192.168.10.148 Start Time: Tue, 30 Jul 2019 18:17:38 +0800 Labels: apps=myapp tier=frontend Annotations: &lt;none&gt; Status: Running IP: 10.244.1.14 6.2、查看创建的serviceaccount的详细信息 [root@master yaml]# kubectl describe sa admin Name: admin Namespace: default Labels: &lt;none&gt; Annotations: &lt;none&gt; Image pull secrets: &lt;none&gt; #设置镜像拉取的镜像仓库，用sa替代imagePullSecrets Mountable secrets: admin-token-f6h28 Tokens: admin-token-f6h28 Events: &lt;none&gt; 7、kubectl delete 用法：kubectl delete ([-f FILENAME] | [-k DIRECTORY] | TYPE [(NAME | -l label | --all)]) [options]，删除资源 7.1、删除pods资源 [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-l9pbb 1/1 Running 0 7m1s myapp-nlw6m 1/1 Running 0 10m myapp-ppktd 1/1 Running 0 10m myapp-wmbnc 1/1 Running 0 28m myapp-wpfpn 1/1 Running 0 10m [root@master yaml]# kubectl delete pods myapp-l9pbb pod &quot;myapp-l9pbb&quot; deleted [root@master yaml]# 7.2、删除service [root@master yaml]# kubectl delete svc redis service &quot;redis&quot; deleted 7.3、删除namespace [root@master ~]# kubectl delete ns cyf namespace &quot;cyf&quot; deleted 7.4、删除Secret [root@master ingress]# kubectl delete secrets tomcat-ingress-sercret secret &quot;tomcat-ingress-sercret&quot; deleted 7.5、删除configmap [root@master configmap]# kubectl delete configmaps nginx configmap &quot;nginx&quot; deleted 8、kubectl edit 用法：kubectl edit (RESOURCE/NAME | -f FILENAME) [options]，编辑资源清单 8.1、修改ReplicaSet控制器的yaml清单内容 注意：修改容器版本，不会自动更新（手动删除pod后自动更新：灰度发布） [root@master yaml]# kubectl edit rs myapp replicaset.extensions/myapp edited 9、kubectl exec 用法：kubectl exec POD [-c CONTAINER] -- COMMAND [args...] [options]，类似docker exec，进入容器 9.1、进入pod内的容器 [root@master yaml]# kubectl exec -it myapp-lmj45 -- /bin/sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # exit [root@master yaml]# kubectl exec -it myapp-lmj45 sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # 9.2、进入pod内指定容器 用法：kubectl exec -it pod-name -c container-name -- /bin/sh [root@master yaml]# kubectl exec -it myapp-lmj45 -c myapp-container sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # exit [root@master yaml]# kubectl exec -it myapp-lmj45 -c myapp-container -- /bin/sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # 10、kubectl logs 用法：kubectl logs [-f] [-p] (POD | TYPE/NAME) [-c CONTAINER] [options]，类似于docker logs，查看容器日志 10.1、查看pod内的容器日志 [root@master yaml]# kubectl logs myapp-lmj45 --tail 300 -f 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:44 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.2、查看pod内指定容器的日志 [root@master yaml]# kubectl logs myapp-lmj45 -c myapp-container --tail 300 -f 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:44 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 11、kubectl explain 用法：kubectl explain RESOURCE [options]，显示各种资源清单的字段解释 11.1、查看pod资源清单字段 [root@master ~]# kubectl explain pod KIND: Pod VERSION: v1 DESCRIPTION: Pod is a collection of containers that can run on a host. This resource is created by clients and scheduled onto hosts. FIELDS: apiVersion &lt;string&gt; ..... 11.2、查看pod资源清单理metadata字段下的字段（以此类推） [root@master ~]# kubectl explain pod.metadata KIND: Pod VERSION: v1 RESOURCE: metadata &lt;Object&gt; DESCRIPTION: Standard object&#39;s metadata. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata ObjectMeta is metadata that all persisted resources must have, which includes all objects users must create. FIELDS: annotations &lt;map[string]string&gt; ..... 11.3、查看ReplicaSet资源清单字段 [root@master yaml]# kubectl explain rs KIND: ReplicaSet VERSION: extensions/v1beta1 DESCRIPTION: DEPRECATED - This group version of ReplicaSet is deprecated by apps/v1beta2/ReplicaSet. See the release notes for more information. ReplicaSet ensures that a specified number of pod replicas are running at any given time. FIELDS: apiVersion &lt;string&gt; APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: ..... 12、kubectl rollout 用法：kubectl rollout SUBCOMMAND [options]，滚动更新 类型： deployments daemonsets statefulsets 12.1、查看deployment滚动更新历史版本 [root@master yaml]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 1 &lt;none&gt; 2 &lt;none&gt; 12.2、更新一个pod后暂停更新 [root@master yaml]# kubectl rollout pause deployment myapp-deploy deployment.extensions/myapp-deploy paused [root@master ~]# kubectl get pods -l app=myapp -w NAME READY STATUS RESTARTS AGE myapp-deploy-66cfdc5675-cnm4m 1/1 Running 0 12s myapp-deploy-66cfdc5675-jzghg 1/1 Running 0 12s myapp-deploy-66cfdc5675-zkc94 1/1 Running 0 12s myapp-deploy-668ff4dc58-fq6hp 0/1 Pending 0 0s myapp-deploy-668ff4dc58-fq6hp 0/1 Pending 0 0s myapp-deploy-668ff4dc58-fq6hp 0/1 ContainerCreating 0 0s myapp-deploy-668ff4dc58-fq6hp 1/1 Running 0 9s 12.3、解除暂停状态，继续更新 [root@master yaml]# kubectl rollout resume deployment myapp-deploy deployment.extensions/myapp-deploy resumed [root@master yaml]# kubectl rollout status deployment myapp-deploy deployment &quot;myapp-deploy&quot; successfully rolled out 12.4、回滚到指定版本 [root@master ~]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 1 &lt;none&gt; 2 &lt;none&gt; 3 &lt;none&gt; [root@master yaml]# kubectl rollout undo deployment myapp-deploy --to-revision=1 deployment.extensions/myapp-deploy rolled back [root@master yaml]# kubectl get rs -o wide NAME DESIRED CURRENT READY AGE CONTAINERS IMAGES SELECTOR myapp-deploy-668ff4dc58 0 0 0 4m myapp ikubernetes/myapp:v3 app=myapp,pod-template-hash=668ff4dc58,release=canary myapp-deploy-66cfdc5675 0 0 0 4m23s myapp ikubernetes/myapp:v2 app=myapp,pod-template-hash=66cfdc5675,release=canary myapp-deploy-74fb9bdf9b 5 5 5 5m8s myapp ikubernetes/myapp:v1 app=myapp,pod-template-hash=74fb9bdf9b,release=canary [root@master ~]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 2 &lt;none&gt; 3 &lt;none&gt; 4 &lt;none&gt; 12.5、监控deployment更新状态 [root@master yaml]# kubectl rollout status deployment myapp-deploy Waiting for deployment &quot;myapp-deploy&quot; rollout to finish: 1 out of 3 new replicas have been updated... 13、kubectl scale Deployment, ReplicaSet, Replication Controller, or StatefulSet，pod副本的扩容和缩容 用法：kubectl scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME) 13.1、扩容和缩容 [root@master yaml]# kubectl scale sts myapp --replicas=2 statefulset.apps/myapp scaled [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-0 1/1 Running 0 14m myapp-1 1/1 Running 0 14m 14、kubectl patch 用法：kubectl patch (-f FILENAME | TYPE NAME) -p PATCH [options] 14.1、修改deployment副本数 [root@master yaml]# kubectl patch deployment myapp-deploy -p &#39;{&quot;spec&quot;:{&quot;replicas&quot;:5}}&#39; deployment.extensions/myapp-deploy patched 14.2、修改deployment滚动更新策略 [root@master yaml]# kubectl patch deployment myapp-deploy -p &#39;{&quot;spec&quot;:{&quot;strategy&quot;:{&quot;rollingUpdate&quot;:{&quot;maxSurge&quot;:1,&quot;maxUnavailable&quot;:0}}}}&#39; deployment.extensions/myapp-deploy patched [root@master yaml]# kubectl describe deployments myapp-deploy Name: myapp-deploy Namespace: default CreationTimestamp: Fri, 02 Aug 2019 01:33:47 +0800 Labels: app=myapp release=canary Annotations: deployment.kubernetes.io/revision: 2 kubectl.kubernetes.io/last-applied-configuration: {&quot;apiVersion&quot;:&quot;apps/v1&quot;,&quot;kind&quot;:&quot;Deployment&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;myapp-deploy&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;replicas&quot;:3... Selector: app=myapp,release=canary Replicas: 5 desired | 5 updated | 5 total | 5 available | 0 unavailable StrategyType: RollingUpdate MinReadySeconds: 0 RollingUpdateStrategy: 0 max unavailable, 1 max surge #已经修改 ..... 15、kubectl set 用法：kubectl set SUBCOMMAND [options] 15.1、kubectl set image 用法：kubectl set image (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N [options] 15.1.1、修改deployment的镜像版本 [root@master yaml]# kubectl set image deployment myapp-deploy myapp=ikubernetes/myapp:v3 deployment.extensions/myapp-deploy image updated 15.1.2、修改daemonset的镜像版本 [root@master yaml]# kubectl set image daemonsets filebeat-ds filebeat=ikubernetes/filebeat:5.6.6-alpine daemonset.extensions/filebeat-ds image updated 16、kubectl config 用法：kubectl config SUBCOMMAND [options] 16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件 [root@master yaml]# kubectl config view apiVersion: v1 clusters: - cluster: certificate-authority-data: DATA+OMITTED server: https://192.168.10.48:6443 name: kubernetes contexts: - context: cluster: kubernetes user: kubernetes-admin name: kubernetes-admin@kubernetes current-context: kubernetes-admin@kubernetes kind: Config preferences: {} users: - name: kubernetes-admin user: client-certificate-data: REDACTED client-key-data: REDACTED kubectl cluster-info：查看集群信息 [root@master ~]# kubectl cluster-info Kubernetes master is running at https://192.168.10.48:6443 KubeDNS is running at https://192.168.10.48:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;. kubectl api-versions：查询 Kubernetes API 支持的 API 版本 [root@master ~]# kubectl api-versions admissionregistration.k8s.io/v1beta1 apiextensions.k8s.io/v1beta1 apiregistration.k8s.io/v1 apiregistration.k8s.io/v1beta1 apps/v1 apps/v1beta1 apps/v1beta2 ..... kubectl api-resources：查看k8s支持的资源类型 [root@master ~]# kubectl api-resources NAME SHORTNAMES APIGROUP NAMESPACED KIND bindings true Binding componentstatuses cs false ComponentStatus configmaps cm true ConfigMap endpoints ep true Endpoints events ev true Event limitranges limits true LimitRange namespaces ns false Namespace nodes no false Node 查看指定群组支持的资源类型 [root@master ~]# kubectl api-resources --api-group=storage.k8s.io NAME SHORTNAMES APIGROUP NAMESPACED KIND csidrivers storage.k8s.io false CSIDriver csinodes storage.k8s.io false CSINode storageclasses sc storage.k8s.io false StorageClass volumeattachments storage.k8s.io false VolumeAttachment" />
<link rel="canonical" href="https://uzzz.org/2019/08/03/793182.html" />
<meta property="og:url" content="https://uzzz.org/2019/08/03/793182.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-03T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"文章目录 一、k8s集群搭建 二、kubectl简介 三、命令行自动补全配置 四、kubectl常用命令总结 1、kubectl version 2、kubectl run 2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器 3、kubectl create 3.1、创建dashboard通过yaml文件 3.2、kubectl create namespace：创建namespace 3.3、kubectl create secret：创建secret 3.3.1、创建一个TLS Secret 3.3.2、创建一个generic Secret 3.4、kubectl create configmap：创建configmap 3.5、kubectl create serviceaccount：创建serviceaccount 4、kubectl get 4.1、kubectl get nodes 4.1.1、获取节点信息 4.1.2、获取节点详细信息 4.1.3、获取节点标签 4.1.4、给节点打标签 4.2、kubectl get pods 4.2.1、获取指定namespace的Pod信息（不加-n默认获取default） 4.2.2、获取所有namespace的Pod信息 4.2.3、获取Pod的详细信息 4.2.4、获取Pod的labels 4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白 4.2.6、获取含有指定标签key的pod 4.2.7、获取含有指定标签key=value的pod 4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合） 4.2.7、获取podIP 4.2.8、导出指定pod的yaml配置 4.3、kubectl get namespaces：获取namespace信息 4.3.1、获取所有namespace信息 4.3.2、获取指定namespace信息 4.3.3、获取指定namespace的yaml格式信息 4.3.4、获取指定namespace的json格式信息 4.4、kubectl get rs：获取ReplicaSet控制器信息 4.5、kubectl get deploy &amp;&amp; kubectl get deployment 4.5.1、获取Deployment控制器信息 4.5.2、与ReplicaSet的联系。`rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf` 4.5.3、滚动更新 4.6、kubectl get svc：获取service信息 4.6.1、获取默认命名空间的service 4.6.2、获取指定命名空间的service 4.7、kubectl get secrets：获取secrets信息 4.8、kubectl get pv：获取pv信息 4.9、kubectl get pvc：获取pvc信息 4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息 4.11、kubectl get sts：获取statefulSet控制器信息 4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息 5、kubectl label 5.1、给一个pod打一个没有存在的标签key=value， 5.2、给一个pod已经存在的标签重新赋值 5.3、通过key删除标签 6、kubectl describe 6.1、查看某个pod的详细信息 6.2、查看创建的serviceaccount的详细信息 7、kubectl delete 7.1、删除pods资源 7.2、删除service 7.3、删除namespace 7.4、删除Secret 7.5、删除configmap 8、kubectl edit 8.1、修改ReplicaSet控制器的yaml清单内容 9、kubectl exec 9.1、进入pod内的容器 9.2、进入pod内指定容器 10、kubectl logs 10.1、查看pod内的容器日志 10.2、查看pod内指定容器的日志 11、kubectl explain 11.1、查看pod资源清单字段 11.2、查看pod资源清单理metadata字段下的字段（以此类推） 11.3、查看ReplicaSet资源清单字段 12、kubectl rollout 12.1、查看deployment滚动更新历史版本 12.2、更新一个pod后暂停更新 12.3、解除暂停状态，继续更新 12.4、回滚到指定版本 12.5、监控deployment更新状态 13、kubectl scale 13.1、扩容和缩容 14、kubectl patch 14.1、修改deployment副本数 14.2、修改deployment滚动更新策略 15、kubectl set 15.1、kubectl set image 15.1.1、修改deployment的镜像版本 15.1.2、修改daemonset的镜像版本 16、kubectl config 16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件 kubectl cluster-info：查看集群信息 kubectl api-versions：查询 Kubernetes API 支持的 API 版本 kubectl api-resources：查看k8s支持的资源类型 查看指定群组支持的资源类型 一、k8s集群搭建 可以参考我的另一篇文章搭建一个集群进行演练：k8s核心组件----kubeadm初始化集群（v1.14.2） 二、kubectl简介 kubectl 是 Kubernetes 的命令行工具（CLI），是 Kubernetes 用户和管理员必备的管理工具。 kubectl 提供了大量的子命令，方便管理 Kubernetes 集群中的各种功能。以下是查看子命令的帮助命令： kubectl -h：查看子命令列表 kubectl options：查看全局选项 kubectl --help：查看子命令的帮助 kubectl [command] [PARAMS] -o=：设置输出格式（如 json、yaml、jsonpath 等） kubectl explain [RESOURCE]：查看资源的定义 三、命令行自动补全配置 为了方便练习k8s常用命令使用，配置命令行自动补全 Centos yum install -y bash-completion source /usr/share/bash-completion/bash_completion source &lt;(kubectl completion bash) echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc Ubuntu curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.2/bin/linux/amd64/kubectl chmod +x kubectl mv kubectl /usr/local/bin/ sudo mv kubectl /usr/local/bin/ source &lt;(kubectl completion bash) echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc 四、kubectl常用命令总结 1、kubectl version 输出 client 和 server 的版本信息 [root@master ~]# kubectl version Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.2&quot;, GitCommit:&quot;66049e3b21efe110454d67df4fa62b08ea79a19b&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-05-16T16:23:09Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.2&quot;, GitCommit:&quot;66049e3b21efe110454d67df4fa62b08ea79a19b&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-05-16T16:14:56Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} 2、kubectl run 用法：kubectl run NAME --image=image [--env=&quot;key=value&quot;] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [--command] -- [COMMAND] [args...] [options] 2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器 [root@master ~]# kubectl run nginx --image=nginx --replicas=2 --port=80 kubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead. deployment.apps/nginx created 3、kubectl create 用法：kubectl create -f FILENAME [options]，创建资源 3.1、创建dashboard通过yaml文件 可以参考我的另一篇文章：k8s UI组件----Kubernetes Dashboard [root@master yaml]# kubectl create -f kubernetes-dashboard.yaml secret/kubernetes-dashboard-certs created serviceaccount/kubernetes-dashboard created role.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created deployment.apps/kubernetes-dashboard created service/kubernetes-dashboard created 3.2、kubectl create namespace：创建namespace 用法：kubectl create namespace NAME [–dry-run] [options] [root@master ~]# kubectl create namespace cyf namespace/cyf created 3.3、kubectl create secret：创建secret 用法：kubectl create secret [flags] [options] 3.3.1、创建一个TLS Secret [root@master ingress]# kubectl create secret tls tomcat-ingress-sercret --cert=tls.crt --key=tls.key secret/tomcat-ingress-sercret created [root@master ingress]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 5d14h tomcat-ingress-sercret kubernetes.io/tls 2 11s [root@master ingress]# kubectl describe secrets tomcat-ingress-sercret Name: tomcat-ingress-sercret Namespace: default Labels: &lt;none&gt; Annotations: &lt;none&gt; Type: kubernetes.io/tls Data ==== tls.crt: 1294 bytes tls.key: 1675 bytes 3.3.2、创建一个generic Secret [root@master configmap]# kubectl create secret generic mysql-root-password --from-literal=password=Myp@ss123 secret/mysql-root-password created [root@master configmap]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 9d mysql-root-password Opaque 1 10s #Opaque：模糊类型 tomcat-ingress-secret kubernetes.io/tls 2 4d7h 3.4、kubectl create configmap：创建configmap 用法：kubectl create configmap NAME [--from-file=[key=]source] [--from-literal=key1=value1] [--dry-run] [options] [root@master ~]# kubectl create configmap nginx-config --from-literal=nginx_port=80 --from-literal=server_name=myapp.cyf.com configmap/nginx-config created 3.5、kubectl create serviceaccount：创建serviceaccount [root@master yaml]# kubectl create serviceaccount admin serviceaccount/admin created [root@master ~]# kubectl create serviceaccount mysa -o yaml --dry-run apiVersion: v1 kind: ServiceAccount metadata: creationTimestamp: null name: mysa 4、kubectl get 用法：kubectl get [(-o|--output=)json|yaml|wide|custom-columns=...|custom-columns-file=...|go-template=...|go-template-file=...|jsonpath=...|jsonpath-file=...] (TYPE[.VERSION][.GROUP] [NAME | -l label] | TYPE[.VERSION][.GROUP]/NAME ...) [flags] [options] 4.1、kubectl get nodes 4.1.1、获取节点信息 [root@master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSION master Ready master 16h v1.14.2 node1 Ready worker 16h v1.14.2 4.1.2、获取节点详细信息 [root@master ~]# kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME master Ready master 16h v1.14.2 192.168.10.48 &lt;none&gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://19.3.1 node1 Ready worker 16h v1.14.2 192.168.10.148 &lt;none&gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://19.3.1 4.1.3、获取节点标签 [root@master ~]# kubectl get nodes --show-labels NAME STATUS ROLES AGE VERSION LABELS master Ready master 2d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=master,kubernetes.io/os=linux,node-role.kubernetes.io/master= node1 Ready worker 2d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=node1,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker 4.1.4、给节点打标签 [root@master ~]# kubectl label nodes node1 disktype=ssd node/node1 labeled 4.2、kubectl get pods 4.2.1、获取指定namespace的Pod信息（不加-n默认获取default） [root@master ~]# kubectl get pods -n default NAME READY STATUS RESTARTS AGE nginx-755464dd6c-b56mr 1/1 Running 0 52s nginx-755464dd6c-ggwzv 1/1 Running 0 52s 4.2.2、获取所有namespace的Pod信息 [root@master ~]# kubectl get pods --all-namespaces [root@master ~]# kubectl get pods -A NAMESPACE NAME READY STATUS RESTARTS AGE default nginx-755464dd6c-b56mr 1/1 Running 0 3m12s default nginx-755464dd6c-ggwzv 1/1 Running 0 3m12s kube-system coredns-fb8b8dccf-b9cwb 1/1 Running 1 17h kube-system coredns-fb8b8dccf-qcdv2 1/1 Running 1 17h kube-system etcd-master 1/1 Running 1 17h kube-system kube-apiserver-master 1/1 Running 1 17h kube-system kube-controller-manager-master 1/1 Running 1 17h kube-system kube-flannel-ds-amd64-4kn7q 1/1 Running 1 17h kube-system kube-flannel-ds-amd64-xpd8f 1/1 Running 1 17h kube-system kube-proxy-htdpc 1/1 Running 1 17h kube-system kube-proxy-q49ff 1/1 Running 1 17h kube-system kube-scheduler-master 1/1 Running 1 17h kube-system kubernetes-dashboard-6c98b7f57c-q6zp7 1/1 Running 1 16h 4.2.3、获取Pod的详细信息 [root@master ~]# kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES nginx-755464dd6c-b56mr 1/1 Running 0 5m31s 10.244.1.11 node1 &lt;none&gt; &lt;none&gt; nginx-755464dd6c-ggwzv 1/1 Running 0 5m31s 10.244.1.10 node1 &lt;none&gt; &lt;none&gt; [root@master ~]# kubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES default nginx-755464dd6c-b56mr 1/1 Running 0 6m4s 10.244.1.11 node1 &lt;none&gt; &lt;none&gt; default nginx-755464dd6c-ggwzv 1/1 Running 0 6m4s 10.244.1.10 node1 &lt;none&gt; &lt;none&gt; kube-system coredns-fb8b8dccf-b9cwb 1/1 Running 1 17h 10.244.1.9 node1 &lt;none&gt; &lt;none&gt; kube-system coredns-fb8b8dccf-qcdv2 1/1 Running 1 17h 10.244.1.8 node1 &lt;none&gt; &lt;none&gt; ...... 4.2.4、获取Pod的labels [root@master ~]# kubectl get pods --show-labels NAME READY STATUS RESTARTS AGE LABELS nginx-755464dd6c-b56mr 1/1 Running 0 27h pod-template-hash=755464dd6c,run=nginx nginx-755464dd6c-ggwzv 1/1 Running 0 27h pod-template-hash=755464dd6c,run=nginx pod-demo 2/2 Running 0 58s apps=myapp,tier=frontend 4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白 [root@master yaml]# kubectl get pods -L apps,run NAME READY STATUS RESTARTS AGE APPS RUN nginx-755464dd6c-b56mr 1/1 Running 0 27h nginx nginx-755464dd6c-ggwzv 1/1 Running 0 27h nginx pod-demo 2/2 Running 0 15m myapp 4.2.6、获取含有指定标签key的pod [root@master yaml]# kubectl get pods -l apps --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 112s apps=myapp,tier=frontend 4.2.7、获取含有指定标签key=value的pod 等值关系：=和!= [root@master yaml]# kubectl get pods -l release=stable --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 39m apps=myapp,release=stable,tier=frontend 4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合） 集合关系： key in （value1，value2...） key notin （value1，value2...） key !key [root@master yaml]# kubectl get pods -l &quot;release in (canary,beta,alpha)&quot; NAME READY STATUS RESTARTS AGE nginx-755464dd6c-ggwzv 1/1 Running 0 28h [root@master yaml]# kubectl get pods -l &quot;release notin (canary,beta,alpha)&quot; NAME READY STATUS RESTARTS AGE nginx-755464dd6c-b56mr 1/1 Running 0 28h pod-demo 2/2 Running 0 53m 4.2.7、获取podIP kubectl get pod pod-name -o jsonpath=’{.status.podIP}’ [root@master ~]# kubectl get pods nginx-755464dd6c-b56mr -o jsonpath=&#39;{.status.podIP}&#39; 10.244.1.11 4.2.8、导出指定pod的yaml配置 [root@master yaml]# kubectl get pods myapp-deploy-74fb9bdf9b-2rt79 -o yaml --export Flag --export has been deprecated, This flag is deprecated and will be removed in future. apiVersion: v1 kind: Pod metadata: creationTimestamp: null generateName: myapp-deploy-74fb9bdf9b- labels: app: myapp pod-template-hash: 74fb9bdf9b release: canary ownerReferences: ..... 4.3、kubectl get namespaces：获取namespace信息 4.3.1、获取所有namespace信息 [root@master ~]# kubectl get ns NAME STATUS AGE default Active 18h kube-node-lease Active 18h kube-public Active 18h kube-system Active 18h [root@master ~]# kubectl get namespaces NAME STATUS AGE default Active 18h kube-node-lease Active 18h kube-public Active 18h kube-system Active 18h 4.3.2、获取指定namespace信息 [root@master ~]# kubectl get namespaces kube-system NAME STATUS AGE kube-system Active 18h 4.3.3、获取指定namespace的yaml格式信息 [root@master ~]# kubectl get namespaces kube-system -o yaml apiVersion: v1 kind: Namespace metadata: creationTimestamp: &quot;2019-07-29T09:28:58Z&quot; name: kube-system resourceVersion: &quot;10&quot; selfLink: /api/v1/namespaces/kube-system uid: 4ad779da-b1e3-11e9-ac67-0800273a2eb7 spec: finalizers: - kubernetes status: phase: Active 4.3.4、获取指定namespace的json格式信息 [root@master ~]# kubectl get namespaces kube-system -o json { &quot;apiVersion&quot;: &quot;v1&quot;, &quot;kind&quot;: &quot;Namespace&quot;, &quot;metadata&quot;: { &quot;creationTimestamp&quot;: &quot;2019-07-29T09:28:58Z&quot;, &quot;name&quot;: &quot;kube-system&quot;, &quot;resourceVersion&quot;: &quot;10&quot;, &quot;selfLink&quot;: &quot;/api/v1/namespaces/kube-system&quot;, &quot;uid&quot;: &quot;4ad779da-b1e3-11e9-ac67-0800273a2eb7&quot; }, &quot;spec&quot;: { &quot;finalizers&quot;: [ &quot;kubernetes&quot; ] }, &quot;status&quot;: { &quot;phase&quot;: &quot;Active&quot; } } 4.4、kubectl get rs：获取ReplicaSet控制器信息 [root@master yaml]# kubectl get rs NAME DESIRED CURRENT READY AGE myapp 2 2 2 24s 4.5、kubectl get deploy &amp;&amp; kubectl get deployment 4.5.1、获取Deployment控制器信息 [root@master yaml]# kubectl get deploy NAME READY UP-TO-DATE AVAILABLE AGE myapp-deploy 2/2 2 2 22s nginx 1/1 1 1 19h [root@master yaml]# kubectl get deployments NAME READY UP-TO-DATE AVAILABLE AGE myapp-deploy 2/2 2 2 22s nginx 1/1 1 1 19h 4.5.2、与ReplicaSet的联系。rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf [root@master yaml]# kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deploy-74fb9bdf9b 2 2 2 48s nginx-755464dd6c 1 1 1 19h [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-deploy-74fb9bdf9b-rd4nf 1/1 Running 0 7m42s myapp-deploy-74fb9bdf9b-slfst 1/1 Running 0 7m42s nginx-755464dd6c-2pgbs 1/1 Running 0 19h 4.5.3、滚动更新 修改版本号后的滚动更新过程 [root@master yaml]# kubectl get pods -w NAME READY STATUS RESTARTS AGE myapp-deploy-74fb9bdf9b-rd4nf 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-slfst 1/1 Running 0 33h nginx-755464dd6c-2pgbs 1/1 Running 0 2d4h myapp-deploy-74fb9bdf9b-lqm77 0/1 Pending 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Pending 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 ContainerCreating 0 33h myapp-deploy-74fb9bdf9b-lqm77 1/1 Running 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 Pending 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 Pending 0 33h myapp-deploy-66cfdc5675-g8dgm 0/1 ContainerCreating 0 33h myapp-deploy-66cfdc5675-g8dgm 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-lqm77 1/1 Terminating 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 Pending 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 Pending 0 33h myapp-deploy-66cfdc5675-c7fxx 0/1 ContainerCreating 0 33h myapp-deploy-66cfdc5675-c7fxx 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 1/1 Terminating 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 Pending 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 Pending 0 33h myapp-deploy-66cfdc5675-xj5qq 0/1 ContainerCreating 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-lqm77 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-66cfdc5675-xj5qq 1/1 Running 0 33h myapp-deploy-74fb9bdf9b-slfst 1/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-rd4nf 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h myapp-deploy-74fb9bdf9b-slfst 0/1 Terminating 0 33h 查看滚动更新后历史版本和现在运行版本 [root@master yaml]# kubectl get rs -o wide NAME DESIRED CURRENT READY AGE CONTAINERS IMAGES SELECTOR myapp-deploy-66cfdc5675 3 3 3 100s myapp ikubernetes/myapp:v2 app=myapp,pod-template-hash=66cfdc5675,release=canary myapp-deploy-74fb9bdf9b 0 0 0 16m myapp ikubernetes/myapp:v1 app=myapp,pod-template-hash=74fb9bdf9b,release=canary 4.6、kubectl get svc：获取service信息 4.6.1、获取默认命名空间的service [root@master yaml]# kubectl get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.96.0.1 &lt;none&gt; 443/TCP 3d5h 4.6.2、获取指定命名空间的service [root@master ingress-nginx]# kubectl get svc -n ingress-nginx NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE default-http-backend ClusterIP 10.109.114.81 &lt;none&gt; 80/TCP 45m ingress-nginx NodePort 10.106.125.159 &lt;none&gt; 80:30080/TCP,443:30443/TCP 73s 4.7、kubectl get secrets：获取secrets信息 [root@master ingress]# kubectl get secrets NAME TYPE DATA AGE default-token-g5zk6 kubernetes.io/service-account-token 3 5d14h tomcat-ingress-sercret kubernetes.io/tls 2 11s 4.8、kubectl get pv：获取pv信息 [root@master volumes]# kubectl get pv NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE pv001 1Gi RWO,RWX Retain Available 10s pv002 1Gi RWX Retain Available 10s pv003 1Gi RWO,RWX Retain Available 10s pv004 1Gi RWO,RWX Retain Available 10s pv005 1Gi RWO,RWX Retain Available 10s 4.9、kubectl get pvc：获取pvc信息 [root@master volumes]# kubectl get pvc NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE mypvc Bound pv002 1Gi RWX 43s 4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息 [root@master ~]# kubectl get cm NAME DATA AGE nginx-config 2 4m11s 4.11、kubectl get sts：获取statefulSet控制器信息 [root@master yaml]# kubectl get sts NAME READY AGE myapp 3/3 30s 4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息 [root@master yaml]# kubectl get serviceaccounts &amp;&amp; kubectl get sa NAME SECRETS AGE admin 1 3m49s default 1 10d NAME SECRETS AGE admin 1 3m50s default 1 10d 5、kubectl label 用法：kubectl label [--overwrite] (-f FILENAME | TYPE NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--resource-version=version]，资源标签设定 5.1、给一个pod打一个没有存在的标签key=value， [root@master yaml]# kubectl label pods pod-demo release=canary pod/pod-demo labeled [root@master yaml]# kubectl get pods pod-demo --show-labels NAME READY STATUS RESTARTS AGE LABELS pod-demo 2/2 Running 0 33m apps=myapp,release=canary,tier=frontend 5.2、给一个pod已经存在的标签重新赋值 [root@master yaml]# kubectl label pods pod-demo release=stable error: &#39;release&#39; already has a value (canary), and --overwrite is false [root@master yaml]# kubectl label pods pod-demo release=stable --overwrite pod/pod-demo labeled 5.3、通过key删除标签 [root@master ~]# kubectl get nodes --show-labels NAME STATUS ROLES AGE VERSION LABELS master Ready master 8d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=master,kubernetes.io/os=linux,node-role.kubernetes.io/master= node1 Ready worker 8d v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,disktype=ssd,hostname=node1,kubernetes.io/arch=amd64,kubernetes.io/hostname=node1,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker node2 Ready worker 5d6h v1.14.2 beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,hostname=node2,kubernetes.io/arch=amd64,kubernetes.io/hostname=node2,kubernetes.io/os=linux,node-role.kubernetes.io/worker=worker [root@master ~]# kubectl label nodes node1 disktype- node/node1 labeled 6、kubectl describe 用法：kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | -l label] | TYPE/NAME) [options]，显示资源的详细描述 6.1、查看某个pod的详细信息 [root@master yaml]# kubectl describe pods pod-demo Name: pod-demo Namespace: default Priority: 0 PriorityClassName: &lt;none&gt; Node: node1/192.168.10.148 Start Time: Tue, 30 Jul 2019 18:17:38 +0800 Labels: apps=myapp tier=frontend Annotations: &lt;none&gt; Status: Running IP: 10.244.1.14 6.2、查看创建的serviceaccount的详细信息 [root@master yaml]# kubectl describe sa admin Name: admin Namespace: default Labels: &lt;none&gt; Annotations: &lt;none&gt; Image pull secrets: &lt;none&gt; #设置镜像拉取的镜像仓库，用sa替代imagePullSecrets Mountable secrets: admin-token-f6h28 Tokens: admin-token-f6h28 Events: &lt;none&gt; 7、kubectl delete 用法：kubectl delete ([-f FILENAME] | [-k DIRECTORY] | TYPE [(NAME | -l label | --all)]) [options]，删除资源 7.1、删除pods资源 [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-l9pbb 1/1 Running 0 7m1s myapp-nlw6m 1/1 Running 0 10m myapp-ppktd 1/1 Running 0 10m myapp-wmbnc 1/1 Running 0 28m myapp-wpfpn 1/1 Running 0 10m [root@master yaml]# kubectl delete pods myapp-l9pbb pod &quot;myapp-l9pbb&quot; deleted [root@master yaml]# 7.2、删除service [root@master yaml]# kubectl delete svc redis service &quot;redis&quot; deleted 7.3、删除namespace [root@master ~]# kubectl delete ns cyf namespace &quot;cyf&quot; deleted 7.4、删除Secret [root@master ingress]# kubectl delete secrets tomcat-ingress-sercret secret &quot;tomcat-ingress-sercret&quot; deleted 7.5、删除configmap [root@master configmap]# kubectl delete configmaps nginx configmap &quot;nginx&quot; deleted 8、kubectl edit 用法：kubectl edit (RESOURCE/NAME | -f FILENAME) [options]，编辑资源清单 8.1、修改ReplicaSet控制器的yaml清单内容 注意：修改容器版本，不会自动更新（手动删除pod后自动更新：灰度发布） [root@master yaml]# kubectl edit rs myapp replicaset.extensions/myapp edited 9、kubectl exec 用法：kubectl exec POD [-c CONTAINER] -- COMMAND [args...] [options]，类似docker exec，进入容器 9.1、进入pod内的容器 [root@master yaml]# kubectl exec -it myapp-lmj45 -- /bin/sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # exit [root@master yaml]# kubectl exec -it myapp-lmj45 sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # 9.2、进入pod内指定容器 用法：kubectl exec -it pod-name -c container-name -- /bin/sh [root@master yaml]# kubectl exec -it myapp-lmj45 -c myapp-container sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # exit [root@master yaml]# kubectl exec -it myapp-lmj45 -c myapp-container -- /bin/sh / # ls bin dev etc home lib media mnt proc root run sbin srv sys tmp usr var / # 10、kubectl logs 用法：kubectl logs [-f] [-p] (POD | TYPE/NAME) [-c CONTAINER] [options]，类似于docker logs，查看容器日志 10.1、查看pod内的容器日志 [root@master yaml]# kubectl logs myapp-lmj45 --tail 300 -f 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:44 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.2、查看pod内指定容器的日志 [root@master yaml]# kubectl logs myapp-lmj45 -c myapp-container --tail 300 -f 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:42 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:43 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 10.244.0.0 - - [31/Jul/2019:22:06:44 +0000] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;curl/7.29.0&quot; &quot;-&quot; 11、kubectl explain 用法：kubectl explain RESOURCE [options]，显示各种资源清单的字段解释 11.1、查看pod资源清单字段 [root@master ~]# kubectl explain pod KIND: Pod VERSION: v1 DESCRIPTION: Pod is a collection of containers that can run on a host. This resource is created by clients and scheduled onto hosts. FIELDS: apiVersion &lt;string&gt; ..... 11.2、查看pod资源清单理metadata字段下的字段（以此类推） [root@master ~]# kubectl explain pod.metadata KIND: Pod VERSION: v1 RESOURCE: metadata &lt;Object&gt; DESCRIPTION: Standard object&#39;s metadata. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata ObjectMeta is metadata that all persisted resources must have, which includes all objects users must create. FIELDS: annotations &lt;map[string]string&gt; ..... 11.3、查看ReplicaSet资源清单字段 [root@master yaml]# kubectl explain rs KIND: ReplicaSet VERSION: extensions/v1beta1 DESCRIPTION: DEPRECATED - This group version of ReplicaSet is deprecated by apps/v1beta2/ReplicaSet. See the release notes for more information. ReplicaSet ensures that a specified number of pod replicas are running at any given time. FIELDS: apiVersion &lt;string&gt; APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: ..... 12、kubectl rollout 用法：kubectl rollout SUBCOMMAND [options]，滚动更新 类型： deployments daemonsets statefulsets 12.1、查看deployment滚动更新历史版本 [root@master yaml]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 1 &lt;none&gt; 2 &lt;none&gt; 12.2、更新一个pod后暂停更新 [root@master yaml]# kubectl rollout pause deployment myapp-deploy deployment.extensions/myapp-deploy paused [root@master ~]# kubectl get pods -l app=myapp -w NAME READY STATUS RESTARTS AGE myapp-deploy-66cfdc5675-cnm4m 1/1 Running 0 12s myapp-deploy-66cfdc5675-jzghg 1/1 Running 0 12s myapp-deploy-66cfdc5675-zkc94 1/1 Running 0 12s myapp-deploy-668ff4dc58-fq6hp 0/1 Pending 0 0s myapp-deploy-668ff4dc58-fq6hp 0/1 Pending 0 0s myapp-deploy-668ff4dc58-fq6hp 0/1 ContainerCreating 0 0s myapp-deploy-668ff4dc58-fq6hp 1/1 Running 0 9s 12.3、解除暂停状态，继续更新 [root@master yaml]# kubectl rollout resume deployment myapp-deploy deployment.extensions/myapp-deploy resumed [root@master yaml]# kubectl rollout status deployment myapp-deploy deployment &quot;myapp-deploy&quot; successfully rolled out 12.4、回滚到指定版本 [root@master ~]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 1 &lt;none&gt; 2 &lt;none&gt; 3 &lt;none&gt; [root@master yaml]# kubectl rollout undo deployment myapp-deploy --to-revision=1 deployment.extensions/myapp-deploy rolled back [root@master yaml]# kubectl get rs -o wide NAME DESIRED CURRENT READY AGE CONTAINERS IMAGES SELECTOR myapp-deploy-668ff4dc58 0 0 0 4m myapp ikubernetes/myapp:v3 app=myapp,pod-template-hash=668ff4dc58,release=canary myapp-deploy-66cfdc5675 0 0 0 4m23s myapp ikubernetes/myapp:v2 app=myapp,pod-template-hash=66cfdc5675,release=canary myapp-deploy-74fb9bdf9b 5 5 5 5m8s myapp ikubernetes/myapp:v1 app=myapp,pod-template-hash=74fb9bdf9b,release=canary [root@master ~]# kubectl rollout history deployment myapp-deploy deployment.extensions/myapp-deploy REVISION CHANGE-CAUSE 2 &lt;none&gt; 3 &lt;none&gt; 4 &lt;none&gt; 12.5、监控deployment更新状态 [root@master yaml]# kubectl rollout status deployment myapp-deploy Waiting for deployment &quot;myapp-deploy&quot; rollout to finish: 1 out of 3 new replicas have been updated... 13、kubectl scale Deployment, ReplicaSet, Replication Controller, or StatefulSet，pod副本的扩容和缩容 用法：kubectl scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME) 13.1、扩容和缩容 [root@master yaml]# kubectl scale sts myapp --replicas=2 statefulset.apps/myapp scaled [root@master yaml]# kubectl get pods NAME READY STATUS RESTARTS AGE myapp-0 1/1 Running 0 14m myapp-1 1/1 Running 0 14m 14、kubectl patch 用法：kubectl patch (-f FILENAME | TYPE NAME) -p PATCH [options] 14.1、修改deployment副本数 [root@master yaml]# kubectl patch deployment myapp-deploy -p &#39;{&quot;spec&quot;:{&quot;replicas&quot;:5}}&#39; deployment.extensions/myapp-deploy patched 14.2、修改deployment滚动更新策略 [root@master yaml]# kubectl patch deployment myapp-deploy -p &#39;{&quot;spec&quot;:{&quot;strategy&quot;:{&quot;rollingUpdate&quot;:{&quot;maxSurge&quot;:1,&quot;maxUnavailable&quot;:0}}}}&#39; deployment.extensions/myapp-deploy patched [root@master yaml]# kubectl describe deployments myapp-deploy Name: myapp-deploy Namespace: default CreationTimestamp: Fri, 02 Aug 2019 01:33:47 +0800 Labels: app=myapp release=canary Annotations: deployment.kubernetes.io/revision: 2 kubectl.kubernetes.io/last-applied-configuration: {&quot;apiVersion&quot;:&quot;apps/v1&quot;,&quot;kind&quot;:&quot;Deployment&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;myapp-deploy&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;replicas&quot;:3... Selector: app=myapp,release=canary Replicas: 5 desired | 5 updated | 5 total | 5 available | 0 unavailable StrategyType: RollingUpdate MinReadySeconds: 0 RollingUpdateStrategy: 0 max unavailable, 1 max surge #已经修改 ..... 15、kubectl set 用法：kubectl set SUBCOMMAND [options] 15.1、kubectl set image 用法：kubectl set image (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N [options] 15.1.1、修改deployment的镜像版本 [root@master yaml]# kubectl set image deployment myapp-deploy myapp=ikubernetes/myapp:v3 deployment.extensions/myapp-deploy image updated 15.1.2、修改daemonset的镜像版本 [root@master yaml]# kubectl set image daemonsets filebeat-ds filebeat=ikubernetes/filebeat:5.6.6-alpine daemonset.extensions/filebeat-ds image updated 16、kubectl config 用法：kubectl config SUBCOMMAND [options] 16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件 [root@master yaml]# kubectl config view apiVersion: v1 clusters: - cluster: certificate-authority-data: DATA+OMITTED server: https://192.168.10.48:6443 name: kubernetes contexts: - context: cluster: kubernetes user: kubernetes-admin name: kubernetes-admin@kubernetes current-context: kubernetes-admin@kubernetes kind: Config preferences: {} users: - name: kubernetes-admin user: client-certificate-data: REDACTED client-key-data: REDACTED kubectl cluster-info：查看集群信息 [root@master ~]# kubectl cluster-info Kubernetes master is running at https://192.168.10.48:6443 KubeDNS is running at https://192.168.10.48:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;. kubectl api-versions：查询 Kubernetes API 支持的 API 版本 [root@master ~]# kubectl api-versions admissionregistration.k8s.io/v1beta1 apiextensions.k8s.io/v1beta1 apiregistration.k8s.io/v1 apiregistration.k8s.io/v1beta1 apps/v1 apps/v1beta1 apps/v1beta2 ..... kubectl api-resources：查看k8s支持的资源类型 [root@master ~]# kubectl api-resources NAME SHORTNAMES APIGROUP NAMESPACED KIND bindings true Binding componentstatuses cs false ComponentStatus configmaps cm true ConfigMap endpoints ep true Endpoints events ev true Event limitranges limits true LimitRange namespaces ns false Namespace nodes no false Node 查看指定群组支持的资源类型 [root@master ~]# kubectl api-resources --api-group=storage.k8s.io NAME SHORTNAMES APIGROUP NAMESPACED KIND csidrivers storage.k8s.io false CSIDriver csinodes storage.k8s.io false CSINode storageclasses sc storage.k8s.io false StorageClass volumeattachments storage.k8s.io false VolumeAttachment","@type":"BlogPosting","url":"https://uzzz.org/2019/08/03/793182.html","headline":"k8s核心组件—-kubectl常用命令总结","dateModified":"2019-08-03T00:00:00+08:00","datePublished":"2019-08-03T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/08/03/793182.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>k8s核心组件----kubectl常用命令总结</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div id="content_views" class="markdown_views prism-tomorrow-night"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <p></p>
  <div class="toc">
   <h3>文章目录</h3>
   <ul>
    <li><a href="#k8s_1" rel="nofollow" data-token="9d1f5e37809eb473cfb96285bf66e733">一、k8s集群搭建</a></li>
    <li><a href="#kubectl_3" rel="nofollow" data-token="7e9db3416091688627d4a75815febe01">二、kubectl简介</a></li>
    <li><a href="#_12" rel="nofollow" data-token="5621298fdcf14e28350536b4423448b7">三、命令行自动补全配置</a></li>
    <li><a href="#kubectl_29" rel="nofollow" data-token="2f10cfb2fa194b67273ecfdbad27b711">四、kubectl常用命令总结</a></li>
    <ul>
     <li><a href="#1kubectl_version_30" rel="nofollow" data-token="2ef14ddbf061cefd19121b2a2eba3e80">1、kubectl version</a></li>
     <li><a href="#2kubectl_run_37" rel="nofollow" data-token="e54c2bb855a5537c906c68ce2b204165">2、kubectl run</a></li>
     <ul>
      <li><a href="#21nginx280nginx_40" rel="nofollow" data-token="23c0dbdb19cfd8e052823a8cd92d2375">2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器</a></li>
     </ul>
     <li><a href="#3kubectl_create_46" rel="nofollow" data-token="748dcfd0baaa50d456394225786a394d">3、kubectl create</a></li>
     <ul>
      <li><a href="#31dashboardyaml_48" rel="nofollow" data-token="89e9409b1db40f8adcffe0dfcd400908">3.1、创建dashboard通过yaml文件</a></li>
      <li><a href="#32kubectl_create_namespacenamespace_59" rel="nofollow" data-token="2c4ec6e4209a578341d0a9f7663c2dc4">3.2、kubectl create namespace：创建namespace</a></li>
      <li><a href="#33kubectl_create_secretsecret_65" rel="nofollow" data-token="1727656564a6e5210b0cdb4fdb39ceba">3.3、kubectl create secret：创建secret</a></li>
      <ul>
       <li><a href="#331TLS_Secret_67" rel="nofollow" data-token="fd536a14ec5b55311e562c7f0b23126a">3.3.1、创建一个TLS Secret</a></li>
       <li><a href="#332generic_Secret_88" rel="nofollow" data-token="6ac4a9c058c85049022056189a4bd3b9">3.3.2、创建一个generic Secret</a></li>
      </ul>
      <li><a href="#34kubectl_create_configmapconfigmap_98" rel="nofollow" data-token="4e08bd34dd206eda803e2770cb349044">3.4、kubectl create configmap：创建configmap</a></li>
      <li><a href="#35kubectl_create_serviceaccountserviceaccount_104" rel="nofollow" data-token="fcd0c60d50945c7b26b3729fe899c664">3.5、kubectl create serviceaccount：创建serviceaccount</a></li>
     </ul>
     <li><a href="#4kubectl_get_115" rel="nofollow" data-token="95a359483cb8aa9c997560cb587994b8">4、kubectl get</a></li>
     <ul>
      <li><a href="#41kubectl_get_nodes_118" rel="nofollow" data-token="88fe9015b0fdf4352bad5c4cb48f8f2b">4.1、kubectl get nodes</a></li>
      <ul>
       <li><a href="#411_119" rel="nofollow" data-token="d9f1ca074a6be4f997dd17fd1d286c5b">4.1.1、获取节点信息</a></li>
       <li><a href="#412_126" rel="nofollow" data-token="f1375905b44b367c98434a11b5ef3db0">4.1.2、获取节点详细信息</a></li>
       <li><a href="#413_133" rel="nofollow" data-token="cf87e7f87db7db0e4e5157822f71a063">4.1.3、获取节点标签</a></li>
       <li><a href="#414_140" rel="nofollow" data-token="6fa34a8e7069f956ff1b244698c977c0">4.1.4、给节点打标签</a></li>
      </ul>
      <li><a href="#42kubectl_get_pods_145" rel="nofollow" data-token="b0025c9eca7c9c72bbbfb2bc288c3e46">4.2、kubectl get pods</a></li>
      <ul>
       <li><a href="#421namespacePodndefault_146" rel="nofollow" data-token="1562273f9c41218a143e7ec32107fde8">4.2.1、获取指定namespace的Pod信息（不加-n默认获取default）</a></li>
       <li><a href="#422namespacePod_153" rel="nofollow" data-token="659e007774a0e5250f790e4edc37a38b">4.2.2、获取所有namespace的Pod信息</a></li>
       <li><a href="#423Pod_172" rel="nofollow" data-token="3ade49e5ef00361aa88a391348d04634">4.2.3、获取Pod的详细信息</a></li>
       <li><a href="#424Podlabels_186" rel="nofollow" data-token="7eaaaea6f9cb8a0c06c28e567983b9e9">4.2.4、获取Pod的labels</a></li>
       <li><a href="#425podkeyvalue_195" rel="nofollow" data-token="13803430ef00d23f29b1d22ebfc72672">4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白</a></li>
       <li><a href="#426keypod_203" rel="nofollow" data-token="b3c09a4d4faeb5d4410b08e0820a6409">4.2.6、获取含有指定标签key的pod</a></li>
       <li><a href="#427keyvaluepod_209" rel="nofollow" data-token="b9353ca0b6ddf73577afb26ce1b86b12">4.2.7、获取含有指定标签key=value的pod</a></li>
       <li><a href="#428keyvaluepodinnotin_216" rel="nofollow" data-token="6f9163bf569519b7d5657ebc159dabf7">4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合）</a></li>
       <li><a href="#427podIP_231" rel="nofollow" data-token="988f0b4b27d4b87214336d31be4f5cd0">4.2.7、获取podIP</a></li>
       <li><a href="#428podyaml_237" rel="nofollow" data-token="5d5e40a05fabb19a7798efd09020abcb">4.2.8、导出指定pod的yaml配置</a></li>
      </ul>
      <li><a href="#43kubectl_get_namespacesnamespace_253" rel="nofollow" data-token="a1b77c3aaca11656ebf0fa3f27c5ec4e">4.3、kubectl get namespaces：获取namespace信息</a></li>
      <ul>
       <li><a href="#431namespace_254" rel="nofollow" data-token="b03557f3eee73dd28b4782f8190dcda4">4.3.1、获取所有namespace信息</a></li>
       <li><a href="#432namespace_269" rel="nofollow" data-token="e0fe20ea22d2bc360723f6d06f4f014e">4.3.2、获取指定namespace信息</a></li>
       <li><a href="#433namespaceyaml_275" rel="nofollow" data-token="c8379b726286d9564a22b03bce2883b6">4.3.3、获取指定namespace的yaml格式信息</a></li>
       <li><a href="#434namespacejson_292" rel="nofollow" data-token="a9cb7955ef3ae6f45930fe4099b85d70">4.3.4、获取指定namespace的json格式信息</a></li>
      </ul>
      <li><a href="#44kubectl_get_rsReplicaSet_315" rel="nofollow" data-token="915d7dbc81a4ebe41b39ecc378d9e63e">4.4、kubectl get rs：获取ReplicaSet控制器信息</a></li>
      <li><a href="#45kubectl_get_deploy__kubectl_get_deployment_321" rel="nofollow" data-token="122fe8f4727776e5f5fc2e91eadcd64f">4.5、kubectl get deploy &amp;&amp; kubectl get deployment</a></li>
      <ul>
       <li><a href="#451Deployment_322" rel="nofollow" data-token="b9e22f6acad01d9d03f7bf118402247d">4.5.1、获取Deployment控制器信息</a></li>
       <li><a href="#452ReplicaSetrsmyappdeploy74fb9bdf9bdeploymyappdeploypodmyappdeploy74fb9bdf9brd4nf_333" rel="nofollow" data-token="bc195fda021366bd1705e7afca8bb0a5">4.5.2、与ReplicaSet的联系。`rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf`</a></li>
       <li><a href="#453_345" rel="nofollow" data-token="77651c65c78baba59961870ca3dde1a6">4.5.3、滚动更新</a></li>
      </ul>
      <li><a href="#46kubectl_get_svcservice_390" rel="nofollow" data-token="827552922bada87b54bac538076eef06">4.6、kubectl get svc：获取service信息</a></li>
      <ul>
       <li><a href="#461service_391" rel="nofollow" data-token="b7b46d479d3be67b69907056768a928a">4.6.1、获取默认命名空间的service</a></li>
       <li><a href="#462service_397" rel="nofollow" data-token="5c0bfca9197c6400110cce4660aee48a">4.6.2、获取指定命名空间的service</a></li>
      </ul>
      <li><a href="#47kubectl_get_secretssecrets_404" rel="nofollow" data-token="25cab57fc4b4cf6479166d8d84a43461">4.7、kubectl get secrets：获取secrets信息</a></li>
      <li><a href="#48kubectl_get_pvpv_411" rel="nofollow" data-token="a639c23959828374135351222be9a8b4">4.8、kubectl get pv：获取pv信息</a></li>
      <li><a href="#49kubectl_get_pvcpvc_421" rel="nofollow" data-token="81a23e37485fc0a12ed1a95dda4995f9">4.9、kubectl get pvc：获取pvc信息</a></li>
      <li><a href="#410kubectl_get_configmap__kubectl_get_cmconfigMap_427" rel="nofollow" data-token="3239e14af4778bef66d0a126c1dba5e1">4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息</a></li>
      <li><a href="#411kubectl_get_stsstatefulSet_433" rel="nofollow" data-token="cc8d8d8fd5a7bac7186117907acf5852">4.11、kubectl get sts：获取statefulSet控制器信息</a></li>
      <li><a href="#412kubectl_get_serviceaccounts__kubectl_get_saserviceaccount_439" rel="nofollow" data-token="3a8e61009f221c6b87706f0c65343311">4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息</a></li>
     </ul>
     <li><a href="#5kubectl_label_449" rel="nofollow" data-token="540ece261b2f3ade69afc4037980aa0d">5、kubectl label</a></li>
     <ul>
      <li><a href="#51podkeyvalue_451" rel="nofollow" data-token="3a6e8775e93cc45815015914fd8eb82f">5.1、给一个pod打一个没有存在的标签key=value，</a></li>
      <li><a href="#52pod_459" rel="nofollow" data-token="9bd43dd840552f1644be5f2f121dc050">5.2、给一个pod已经存在的标签重新赋值</a></li>
      <li><a href="#53key_466" rel="nofollow" data-token="14a7ec4d55496e085a63ff823c75bfa2">5.3、通过key删除标签</a></li>
     </ul>
     <li><a href="#6kubectl_describe_476" rel="nofollow" data-token="f591bedcb66d800ece7087960658dc93">6、kubectl describe</a></li>
     <ul>
      <li><a href="#61pod_478" rel="nofollow" data-token="c51c2563f3810e6e594cf3eb6265e4f4">6.1、查看某个pod的详细信息</a></li>
      <li><a href="#62serviceaccount_493" rel="nofollow" data-token="81b8f4dcaaf8500a2227864414120245">6.2、查看创建的serviceaccount的详细信息</a></li>
     </ul>
     <li><a href="#7kubectl_delete_505" rel="nofollow" data-token="365deb490eb5961cf1a06c4bc9eb46a9">7、kubectl delete</a></li>
     <ul>
      <li><a href="#71pods_507" rel="nofollow" data-token="557ed6e4653599b362230090b771492b">7.1、删除pods资源</a></li>
      <li><a href="#72service_520" rel="nofollow" data-token="22751bb3d1c247a82692dff92464b274">7.2、删除service</a></li>
      <li><a href="#73namespace_525" rel="nofollow" data-token="52e5cdd53cfa960ac91e2d18a55e9a23">7.3、删除namespace</a></li>
      <li><a href="#74Secret_530" rel="nofollow" data-token="48605d6b778d474e3813ce218a6d58dc">7.4、删除Secret</a></li>
      <li><a href="#75configmap_535" rel="nofollow" data-token="0a4c139ab1f529ed7cc208944662fa2b">7.5、删除configmap</a></li>
     </ul>
     <li><a href="#8kubectl_edit_540" rel="nofollow" data-token="9d1f851a33b2db35a8e0ea76914b986c">8、kubectl edit</a></li>
     <ul>
      <li><a href="#81ReplicaSetyaml_542" rel="nofollow" data-token="d5b1e3c5aeab94b11eacd40c1fbf9fd1">8.1、修改ReplicaSet控制器的yaml清单内容</a></li>
     </ul>
     <li><a href="#9kubectl_exec_548" rel="nofollow" data-token="6e323d48f869f76e16ff220f377d3bff">9、kubectl exec</a></li>
     <ul>
      <li><a href="#91pod_550" rel="nofollow" data-token="1a4f48434e093dbd84ffddc1222688e8">9.1、进入pod内的容器</a></li>
      <li><a href="#92pod_561" rel="nofollow" data-token="0a6c4fce651067cee5a8e1e31d5a823d">9.2、进入pod内指定容器</a></li>
     </ul>
     <li><a href="#10kubectl_logs_573" rel="nofollow" data-token="4daff7b7cb8e834184cc22289acfb96a">10、kubectl logs</a></li>
     <ul>
      <li><a href="#101pod_575" rel="nofollow" data-token="dbec9f70c1ff9dcc34cc3488c6da2502">10.1、查看pod内的容器日志</a></li>
      <li><a href="#102pod_584" rel="nofollow" data-token="e47375f0bc8ba429174424da7c3f946f">10.2、查看pod内指定容器的日志</a></li>
     </ul>
     <li><a href="#11kubectl_explain_593" rel="nofollow" data-token="dfe1560a2642743da343d6925ef94e15">11、kubectl explain</a></li>
     <ul>
      <li><a href="#111pod_595" rel="nofollow" data-token="5e8b3692868a06c4f0e664fc91f1ac30">11.1、查看pod资源清单字段</a></li>
      <li><a href="#112podmetadata_609" rel="nofollow" data-token="2b3a87a310b6e90cc9a3d11ef10468fd">11.2、查看pod资源清单理metadata字段下的字段（以此类推）</a></li>
      <li><a href="#113ReplicaSet_625" rel="nofollow" data-token="8be892cda05dd4f87eb368caad7b494f">11.3、查看ReplicaSet资源清单字段</a></li>
     </ul>
     <li><a href="#12kubectl_rollout_644" rel="nofollow" data-token="f798ad074d9e9fc3d4a4813ce73474e5">12、kubectl rollout</a></li>
     <ul>
      <li><a href="#121deployment_651" rel="nofollow" data-token="f8dc0bbf707e7d982896edd136aa9fe1">12.1、查看deployment滚动更新历史版本</a></li>
      <li><a href="#122pod_659" rel="nofollow" data-token="b4586ab9cfcc5ab55cbc462315c78ae8">12.2、更新一个pod后暂停更新</a></li>
      <li><a href="#123_673" rel="nofollow" data-token="8126a91cc84a19ac6f4e3f40467524b0">12.3、解除暂停状态，继续更新</a></li>
      <li><a href="#124_680" rel="nofollow" data-token="8515e5301da047a8bc28af57e0d6da92">12.4、回滚到指定版本</a></li>
      <li><a href="#125deployment_702" rel="nofollow" data-token="9d9990c2c3a443c051ffbf5d76cf62e6">12.5、监控deployment更新状态</a></li>
     </ul>
     <li><a href="#13kubectl_scale_707" rel="nofollow" data-token="87545c59dea47e1738a477318978c78b">13、kubectl scale</a></li>
     <ul>
      <li><a href="#131_711" rel="nofollow" data-token="d4b3bac485e99416278f4ccbf8a8fe4f">13.1、扩容和缩容</a></li>
     </ul>
     <li><a href="#14kubectl_patch_720" rel="nofollow" data-token="b801ba0af5f5d0c8ca4fa2617b2a3e43">14、kubectl patch</a></li>
     <ul>
      <li><a href="#141deployment_722" rel="nofollow" data-token="6037041fe00cabf94932c6508b0cdc1a">14.1、修改deployment副本数</a></li>
      <li><a href="#142deployment_727" rel="nofollow" data-token="ccbc159c61a503299e88a165912b258a">14.2、修改deployment滚动更新策略</a></li>
     </ul>
     <li><a href="#15kubectl_set_747" rel="nofollow" data-token="e1b58f34a584288ccee37f718fed7ad5">15、kubectl set</a></li>
     <ul>
      <li><a href="#151kubectl_set_image_749" rel="nofollow" data-token="8c06b761695a3690e9bcc6f2c1cb701a">15.1、kubectl set image</a></li>
      <ul>
       <li><a href="#1511deployment_751" rel="nofollow" data-token="dc686cca257221d1463152b47f3f0bfd">15.1.1、修改deployment的镜像版本</a></li>
       <li><a href="#1512daemonset_756" rel="nofollow" data-token="fb01111f7c6933efe9622f805efba8b6">15.1.2、修改daemonset的镜像版本</a></li>
      </ul>
     </ul>
     <li><a href="#16kubectl_config_761" rel="nofollow" data-token="2ab73ca8773562e2dcb01d0aa79baacf">16、kubectl config</a></li>
     <ul>
      <li><a href="#161kubectl_config_view_kubeconfig__kubeconfig__763" rel="nofollow" data-token="d86688574bd67bc9664f611e000e86b4">16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件</a></li>
     </ul>
     <li><a href="#kubectl_clusterinfo_786" rel="nofollow" data-token="b76608ec8b566dca96e98ba0ed30c86e">kubectl cluster-info：查看集群信息</a></li>
     <li><a href="#kubectl_apiversions_Kubernetes_API__API__794" rel="nofollow" data-token="4c8e29a106a94bbddb879a09ba7fadfa">kubectl api-versions：查询 Kubernetes API 支持的 API 版本</a></li>
     <li><a href="#kubectl_apiresourcesk8s_806" rel="nofollow" data-token="fabbf467ccd7a76eb42e469970aab477">kubectl api-resources：查看k8s支持的资源类型</a></li>
     <ul>
      <li><a href="#_819" rel="nofollow" data-token="b08692659d65b7e989ef3c431d3e58a3">查看指定群组支持的资源类型</a></li>
     </ul>
    </ul>
   </ul>
  </div>
  <p></p> 
  <h1><a id="k8s_1"></a>一、k8s集群搭建</h1> 
  <p>可以参考我的另一篇文章搭建一个集群进行演练：<a href="https://blog.csdn.net/cyfblog/article/details/97666349" rel="nofollow">k8s核心组件----kubeadm初始化集群（v1.14.2）</a></p> 
  <h1><a id="kubectl_3"></a>二、kubectl简介</h1> 
  <p>kubectl 是 Kubernetes 的命令行工具（CLI），是 Kubernetes 用户和管理员必备的管理工具。</p> 
  <p>kubectl 提供了大量的子命令，方便管理 Kubernetes 集群中的各种功能。以下是查看子命令的帮助命令：</p> 
  <ul> 
   <li>kubectl -h：查看子命令列表</li> 
   <li>kubectl options：查看全局选项</li> 
   <li>kubectl --help：查看子命令的帮助</li> 
   <li>kubectl [command] [PARAMS] -o=：设置输出格式（如 json、yaml、jsonpath 等）</li> 
   <li>kubectl explain [RESOURCE]：查看资源的定义</li> 
  </ul> 
  <h1><a id="_12"></a>三、命令行自动补全配置</h1> 
  <p>为了方便练习k8s常用命令使用，配置命令行自动补全</p> 
  <pre><code class="prism language-shell">Centos
yum <span class="token function">install</span> -y bash-completion
<span class="token function">source</span> /usr/share/bash-completion/bash_completion
<span class="token function">source</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>kubectl completion bash<span class="token punctuation">)</span>
<span class="token keyword">echo</span> <span class="token string">"source &lt;(kubectl completion bash)"</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc

Ubuntu
<span class="token function">curl</span> -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.2/bin/linux/amd64/kubectl
<span class="token function">chmod</span> +x kubectl 
<span class="token function">mv</span> kubectl  /usr/local/bin/
<span class="token function">sudo</span> <span class="token function">mv</span> kubectl  /usr/local/bin/
<span class="token function">source</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>kubectl completion bash<span class="token punctuation">)</span>
<span class="token keyword">echo</span> <span class="token string">"source &lt;(kubectl completion bash)"</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
</code></pre> 
  <h1><a id="kubectl_29"></a>四、kubectl常用命令总结</h1> 
  <h2><a id="1kubectl_version_30"></a>1、kubectl version</h2> 
  <p>输出 client 和 server 的版本信息</p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl version </span>
Client Version: version.Info<span class="token punctuation">{</span>Major:<span class="token string">"1"</span>, Minor:<span class="token string">"14"</span>, GitVersion:<span class="token string">"v1.14.2"</span>, GitCommit:<span class="token string">"66049e3b21efe110454d67df4fa62b08ea79a19b"</span>, GitTreeState:<span class="token string">"clean"</span>, BuildDate:<span class="token string">"2019-05-16T16:23:09Z"</span>, GoVersion:<span class="token string">"go1.12.5"</span>, Compiler:<span class="token string">"gc"</span>, Platform:<span class="token string">"linux/amd64"</span><span class="token punctuation">}</span>
Server Version: version.Info<span class="token punctuation">{</span>Major:<span class="token string">"1"</span>, Minor:<span class="token string">"14"</span>, GitVersion:<span class="token string">"v1.14.2"</span>, GitCommit:<span class="token string">"66049e3b21efe110454d67df4fa62b08ea79a19b"</span>, GitTreeState:<span class="token string">"clean"</span>, BuildDate:<span class="token string">"2019-05-16T16:14:56Z"</span>, GoVersion:<span class="token string">"go1.12.5"</span>, Compiler:<span class="token string">"gc"</span>, Platform:<span class="token string">"linux/amd64"</span><span class="token punctuation">}</span>
</code></pre> 
  <h2><a id="2kubectl_run_37"></a>2、kubectl run</h2> 
  <p>用法：<code>kubectl run NAME --image=image [--env="key=value"] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [--command] -- [COMMAND] [args...] [options]</code></p> 
  <h3><a id="21nginx280nginx_40"></a>2.1、创建一个镜像为nginx、副本为2、暴露端口为80的nginx容器</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl run nginx --image=nginx --replicas=2 --port=80</span>
kubectl run --generator<span class="token operator">=</span>deployment/apps.v1 is DEPRECATED and will be removed <span class="token keyword">in</span> a future version. Use kubectl run --generator<span class="token operator">=</span>run-pod/v1 or kubectl create instead.
deployment.apps/nginx created
</code></pre> 
  <h2><a id="3kubectl_create_46"></a>3、kubectl create</h2> 
  <p>用法：<code>kubectl create -f FILENAME [options]</code>，创建资源</p> 
  <h3><a id="31dashboardyaml_48"></a>3.1、创建dashboard通过yaml文件</h3> 
  <p>可以参考我的另一篇文章：<a href="https://blog.csdn.net/cyfblog/article/details/97761406" rel="nofollow" data-token="5f11040f4183654d6dd5c29509edab0a">k8s UI组件----Kubernetes Dashboard</a></p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl create -f kubernetes-dashboard.yaml </span>
secret/kubernetes-dashboard-certs created
serviceaccount/kubernetes-dashboard created
role.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created
rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard-minimal created
deployment.apps/kubernetes-dashboard created
service/kubernetes-dashboard created
</code></pre> 
  <h3><a id="32kubectl_create_namespacenamespace_59"></a>3.2、kubectl create namespace：创建namespace</h3> 
  <p>用法：kubectl create namespace NAME [–dry-run] [options]</p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create namespace cyf</span>
namespace/cyf created
</code></pre> 
  <h3><a id="33kubectl_create_secretsecret_65"></a>3.3、kubectl create secret：创建secret</h3> 
  <p>用法：<code>kubectl create secret [flags] [options]</code></p> 
  <h4><a id="331TLS_Secret_67"></a>3.3.1、创建一个TLS Secret</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ingress<span class="token punctuation">]</span><span class="token comment"># kubectl create secret tls tomcat-ingress-sercret --cert=tls.crt --key=tls.key </span>
secret/tomcat-ingress-sercret created
<span class="token punctuation">[</span>root@master ingress<span class="token punctuation">]</span><span class="token comment"># kubectl get secrets </span>
NAME                     TYPE                                  DATA   AGE
default-token-g5zk6      kubernetes.io/service-account-token   3      5d14h
tomcat-ingress-sercret   kubernetes.io/tls                     2      11s
<span class="token punctuation">[</span>root@master ingress<span class="token punctuation">]</span><span class="token comment"># kubectl describe secrets tomcat-ingress-sercret </span>
Name:         tomcat-ingress-sercret
Namespace:    default
Labels:       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Annotations:  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

Type:  kubernetes.io/tls

Data
<span class="token operator">==</span><span class="token operator">==</span>
tls.crt:  1294 bytes
tls.key:  1675 bytes
</code></pre> 
  <h4><a id="332generic_Secret_88"></a>3.3.2、创建一个generic Secret</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master configmap<span class="token punctuation">]</span><span class="token comment"># kubectl create secret generic mysql-root-password --from-literal=password=Myp@ss123</span>
secret/mysql-root-password created
<span class="token punctuation">[</span>root@master configmap<span class="token punctuation">]</span><span class="token comment"># kubectl get secrets </span>
NAME                    TYPE                                  DATA   AGE
default-token-g5zk6     kubernetes.io/service-account-token   3      9d
mysql-root-password     Opaque                                1      10s <span class="token comment">#Opaque：模糊类型</span>
tomcat-ingress-secret   kubernetes.io/tls                     2      4d7h
</code></pre> 
  <h3><a id="34kubectl_create_configmapconfigmap_98"></a>3.4、kubectl create configmap：创建configmap</h3> 
  <p>用法：<code>kubectl create configmap NAME [--from-file=[key=]source] [--from-literal=key1=value1] [--dry-run] [options]</code></p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create configmap nginx-config --from-literal=nginx_port=80 --from-literal=server_name=myapp.cyf.com</span>
configmap/nginx-config created
</code></pre> 
  <h3><a id="35kubectl_create_serviceaccountserviceaccount_104"></a>3.5、kubectl create serviceaccount：创建serviceaccount</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl create serviceaccount admin</span>
serviceaccount/admin created
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create serviceaccount mysa -o yaml --dry-run </span>
apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: null
  name: mysa
</code></pre> 
  <h2><a id="4kubectl_get_115"></a>4、kubectl get</h2> 
  <p>用法：<code>kubectl get [(-o|--output=)json|yaml|wide|custom-columns=...|custom-columns-file=...|go-template=...|go-template-file=...|jsonpath=...|jsonpath-file=...] (TYPE[.VERSION][.GROUP] [NAME | -l label] | TYPE[.VERSION][.GROUP]/NAME ...) [flags] [options]</code></p> 
  <h3><a id="41kubectl_get_nodes_118"></a>4.1、kubectl get nodes</h3> 
  <h4><a id="411_119"></a>4.1.1、获取节点信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes</span>
NAME     STATUS   ROLES    AGE   VERSION
master   Ready    master   16h   v1.14.2
node1    Ready    worker   16h   v1.14.2
</code></pre> 
  <h4><a id="412_126"></a>4.1.2、获取节点详细信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes -o wide</span>
NAME     STATUS   ROLES    AGE   VERSION   INTERNAL-IP      EXTERNAL-IP   OS-IMAGE                KERNEL-VERSION          CONTAINER-RUNTIME
master   Ready    master   16h   v1.14.2   192.168.10.48    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        CentOS Linux 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>   3.10.0-957.el7.x86_64   docker://19.3.1
node1    Ready    worker   16h   v1.14.2   192.168.10.148   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        CentOS Linux 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>   3.10.0-957.el7.x86_64   docker://19.3.1
</code></pre> 
  <h4><a id="413_133"></a>4.1.3、获取节点标签</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes --show-labels </span>
NAME     STATUS   ROLES    AGE   VERSION   LABELS
master   Ready    master   2d    v1.14.2   beta.kubernetes.io/arch<span class="token operator">=</span>amd64,beta.kubernetes.io/os<span class="token operator">=</span>linux,kubernetes.io/arch<span class="token operator">=</span>amd64,kubernetes.io/hostname<span class="token operator">=</span>master,kubernetes.io/os<span class="token operator">=</span>linux,node-role.kubernetes.io/master<span class="token operator">=</span>
node1    Ready    worker   2d    v1.14.2   beta.kubernetes.io/arch<span class="token operator">=</span>amd64,beta.kubernetes.io/os<span class="token operator">=</span>linux,kubernetes.io/arch<span class="token operator">=</span>amd64,kubernetes.io/hostname<span class="token operator">=</span>node1,kubernetes.io/os<span class="token operator">=</span>linux,node-role.kubernetes.io/worker<span class="token operator">=</span>worker
</code></pre> 
  <h4><a id="414_140"></a>4.1.4、给节点打标签</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl label nodes node1 disktype=ssd</span>
node/node1 labeled
</code></pre> 
  <h3><a id="42kubectl_get_pods_145"></a>4.2、kubectl get pods</h3> 
  <h4><a id="421namespacePodndefault_146"></a>4.2.1、获取指定namespace的Pod信息（不加-n默认获取default）</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -n default </span>
NAME                     READY   STATUS    RESTARTS   AGE
nginx-755464dd6c-b56mr   1/1     Running   0          52s
nginx-755464dd6c-ggwzv   1/1     Running   0          52s
</code></pre> 
  <h4><a id="422namespacePod_153"></a>4.2.2、获取所有namespace的Pod信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods --all-namespaces</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -A</span>
NAMESPACE     NAME                                    READY   STATUS    RESTARTS   AGE
default       nginx-755464dd6c-b56mr                  1/1     Running   0          3m12s
default       nginx-755464dd6c-ggwzv                  1/1     Running   0          3m12s
kube-system   coredns-fb8b8dccf-b9cwb                 1/1     Running   1          17h
kube-system   coredns-fb8b8dccf-qcdv2                 1/1     Running   1          17h
kube-system   etcd-master                             1/1     Running   1          17h
kube-system   kube-apiserver-master                   1/1     Running   1          17h
kube-system   kube-controller-manager-master          1/1     Running   1          17h
kube-system   kube-flannel-ds-amd64-4kn7q             1/1     Running   1          17h
kube-system   kube-flannel-ds-amd64-xpd8f             1/1     Running   1          17h
kube-system   kube-proxy-htdpc                        1/1     Running   1          17h
kube-system   kube-proxy-q49ff                        1/1     Running   1          17h
kube-system   kube-scheduler-master                   1/1     Running   1          17h
kube-system   kubernetes-dashboard-6c98b7f57c-q6zp7   1/1     Running   1          16h
</code></pre> 
  <h4><a id="423Pod_172"></a>4.2.3、获取Pod的详细信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -o wide</span>
NAME                     READY   STATUS    RESTARTS   AGE     IP            NODE    NOMINATED NODE   READINESS GATES
nginx-755464dd6c-b56mr   1/1     Running   0          5m31s   10.244.1.11   node1   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
nginx-755464dd6c-ggwzv   1/1     Running   0          5m31s   10.244.1.10   node1   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -A -o wide</span>
NAMESPACE     NAME                                    READY   STATUS    RESTARTS   AGE    IP               NODE     NOMINATED NODE   READINESS GATES
default       nginx-755464dd6c-b56mr                  1/1     Running   0          6m4s   10.244.1.11      node1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
default       nginx-755464dd6c-ggwzv                  1/1     Running   0          6m4s   10.244.1.10      node1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-system   coredns-fb8b8dccf-b9cwb                 1/1     Running   1          17h    10.244.1.9       node1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-system   coredns-fb8b8dccf-qcdv2                 1/1     Running   1          17h    10.244.1.8       node1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> 
  <h4><a id="424Podlabels_186"></a>4.2.4、获取Pod的labels</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods --show-labels </span>
NAME                     READY   STATUS    RESTARTS   AGE   LABELS
nginx-755464dd6c-b56mr   1/1     Running   0          27h   pod-template-hash<span class="token operator">=</span>755464dd6c,run<span class="token operator">=</span>nginx
nginx-755464dd6c-ggwzv   1/1     Running   0          27h   pod-template-hash<span class="token operator">=</span>755464dd6c,run<span class="token operator">=</span>nginx
pod-demo                 2/2     Running   0          58s   apps<span class="token operator">=</span>myapp,tier<span class="token operator">=</span>frontend

</code></pre> 
  <h4><a id="425podkeyvalue_195"></a>4.2.5、查看所有pod对于指定标签的key是否有value，有则显示，没有则空白</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -L apps,run</span>
NAME                     READY   STATUS    RESTARTS   AGE   APPS    RUN
nginx-755464dd6c-b56mr   1/1     Running   0          27h           nginx
nginx-755464dd6c-ggwzv   1/1     Running   0          27h           nginx
pod-demo                 2/2     Running   0          15m   myapp
</code></pre> 
  <h4><a id="426keypod_203"></a>4.2.6、获取含有指定标签key的pod</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -l apps --show-labels </span>
NAME       READY   STATUS    RESTARTS   AGE    LABELS
pod-demo   2/2     Running   0          112s   apps<span class="token operator">=</span>myapp,tier<span class="token operator">=</span>frontend
</code></pre> 
  <h4><a id="427keyvaluepod_209"></a>4.2.7、获取含有指定标签key=value的pod</h4> 
  <p>等值关系：<code>=</code>和<code>!=</code></p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -l release=stable --show-labels </span>
NAME       READY   STATUS    RESTARTS   AGE   LABELS
pod-demo   2/2     Running   0          39m   apps<span class="token operator">=</span>myapp,release<span class="token operator">=</span>stable,tier<span class="token operator">=</span>frontend
</code></pre> 
  <h4><a id="428keyvaluepodinnotin_216"></a>4.2.8、获取标签key的value在（不在）集合中的pod（in表示在集合，notin表示不在集合）</h4> 
  <p>集合关系：<br> <code>key in （value1，value2...）</code><br> <code>key notin （value1，value2...）</code><br> <code>key</code><br> <code>!key</code></p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -l "release in (canary,beta,alpha)"</span>
NAME                     READY   STATUS    RESTARTS   AGE
nginx-755464dd6c-ggwzv   1/1     Running   0          28h
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -l "release notin (canary,beta,alpha)"</span>
NAME                     READY   STATUS    RESTARTS   AGE
nginx-755464dd6c-b56mr   1/1     Running   0          28h
pod-demo                 2/2     Running   0          53m
</code></pre> 
  <h4><a id="427podIP_231"></a>4.2.7、获取podIP</h4> 
  <p>kubectl get pod pod-name -o jsonpath=’{.status.podIP}’</p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods nginx-755464dd6c-b56mr -o jsonpath='{.status.podIP}'</span>
10.244.1.11
</code></pre> 
  <h4><a id="428podyaml_237"></a>4.2.8、导出指定pod的yaml配置</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods myapp-deploy-74fb9bdf9b-2rt79 -o yaml --export</span>
Flag --export has been deprecated, This flag is deprecated and will be removed <span class="token keyword">in</span> future.
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  generateName: myapp-deploy-74fb9bdf9b-
  labels:
    app: myapp
    pod-template-hash: 74fb9bdf9b
    release: canary
  ownerReferences:
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
  <h3><a id="43kubectl_get_namespacesnamespace_253"></a>4.3、kubectl get namespaces：获取namespace信息</h3> 
  <h4><a id="431namespace_254"></a>4.3.1、获取所有namespace信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get ns</span>
NAME              STATUS   AGE
default           Active   18h
kube-node-lease   Active   18h
kube-public       Active   18h
kube-system       Active   18h
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get namespaces </span>
NAME              STATUS   AGE
default           Active   18h
kube-node-lease   Active   18h
kube-public       Active   18h
kube-system       Active   18h
</code></pre> 
  <h4><a id="432namespace_269"></a>4.3.2、获取指定namespace信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get namespaces kube-system</span>
NAME          STATUS   AGE
kube-system   Active   18h
</code></pre> 
  <h4><a id="433namespaceyaml_275"></a>4.3.3、获取指定namespace的yaml格式信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get namespaces kube-system -o yaml</span>
apiVersion: v1
kind: Namespace
metadata:
  creationTimestamp: <span class="token string">"2019-07-29T09:28:58Z"</span>
  name: kube-system
  resourceVersion: <span class="token string">"10"</span>
  selfLink: /api/v1/namespaces/kube-system
  uid: 4ad779da-b1e3-11e9-ac67-0800273a2eb7
spec:
  finalizers:
  - kubernetes
status:
  phase: Active
</code></pre> 
  <h4><a id="434namespacejson_292"></a>4.3.4、获取指定namespace的json格式信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get namespaces kube-system -o json</span>
<span class="token punctuation">{</span>
    <span class="token string">"apiVersion"</span><span class="token keyword">:</span> <span class="token string">"v1"</span>,
    <span class="token string">"kind"</span><span class="token keyword">:</span> <span class="token string">"Namespace"</span>,
    <span class="token string">"metadata"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
        <span class="token string">"creationTimestamp"</span><span class="token keyword">:</span> <span class="token string">"2019-07-29T09:28:58Z"</span>,
        <span class="token string">"name"</span><span class="token keyword">:</span> <span class="token string">"kube-system"</span>,
        <span class="token string">"resourceVersion"</span><span class="token keyword">:</span> <span class="token string">"10"</span>,
        <span class="token string">"selfLink"</span><span class="token keyword">:</span> <span class="token string">"/api/v1/namespaces/kube-system"</span>,
        <span class="token string">"uid"</span><span class="token keyword">:</span> <span class="token string">"4ad779da-b1e3-11e9-ac67-0800273a2eb7"</span>
    <span class="token punctuation">}</span>,
    <span class="token string">"spec"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
        <span class="token string">"finalizers"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
            <span class="token string">"kubernetes"</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>,
    <span class="token string">"status"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
        <span class="token string">"phase"</span><span class="token keyword">:</span> <span class="token string">"Active"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
  <h3><a id="44kubectl_get_rsReplicaSet_315"></a>4.4、kubectl get rs：获取ReplicaSet控制器信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get rs</span>
NAME    DESIRED   CURRENT   READY   AGE
myapp   2         2         2       24s
</code></pre> 
  <h3><a id="45kubectl_get_deploy__kubectl_get_deployment_321"></a>4.5、kubectl get deploy &amp;&amp; kubectl get deployment</h3> 
  <h4><a id="451Deployment_322"></a>4.5.1、获取Deployment控制器信息</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get deploy</span>
NAME           READY   UP-TO-DATE   AVAILABLE   AGE
myapp-deploy   2/2     2            2           22s
nginx          1/1     1            1           19h
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get deployments</span>
NAME           READY   UP-TO-DATE   AVAILABLE   AGE
myapp-deploy   2/2     2            2           22s
nginx          1/1     1            1           19h
</code></pre> 
  <h4><a id="452ReplicaSetrsmyappdeploy74fb9bdf9bdeploymyappdeploypodmyappdeploy74fb9bdf9brd4nf_333"></a>4.5.2、与ReplicaSet的联系。<code>rs名称：myapp-deploy-74fb9bdf9b，deploy名称：myapp-deploy，pod名称：myapp-deploy-74fb9bdf9b-rd4nf</code></h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get rs </span>
NAME                      DESIRED   CURRENT   READY   AGE
myapp-deploy-74fb9bdf9b   2         2         2       48s
nginx-755464dd6c          1         1         1       19h
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods</span>
NAME                            READY   STATUS    RESTARTS   AGE
myapp-deploy-74fb9bdf9b-rd4nf   1/1     Running   0          7m42s
myapp-deploy-74fb9bdf9b-slfst   1/1     Running   0          7m42s
nginx-755464dd6c-2pgbs          1/1     Running   0          19h
</code></pre> 
  <h4><a id="453_345"></a>4.5.3、滚动更新</h4> 
  <p>修改版本号后的滚动更新过程</p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -w</span>
NAME                            READY   STATUS    RESTARTS   AGE
myapp-deploy-74fb9bdf9b-rd4nf   1/1     Running   0          33h
myapp-deploy-74fb9bdf9b-slfst   1/1     Running   0          33h
nginx-755464dd6c-2pgbs          1/1     Running   0          2d4h
myapp-deploy-74fb9bdf9b-lqm77   0/1     Pending   0          33h
myapp-deploy-74fb9bdf9b-lqm77   0/1     Pending   0          33h
myapp-deploy-74fb9bdf9b-lqm77   0/1     ContainerCreating   0          33h
myapp-deploy-74fb9bdf9b-lqm77   1/1     Running             0          33h
myapp-deploy-66cfdc5675-g8dgm   0/1     Pending             0          33h
myapp-deploy-66cfdc5675-g8dgm   0/1     Pending             0          33h
myapp-deploy-66cfdc5675-g8dgm   0/1     ContainerCreating   0          33h
myapp-deploy-66cfdc5675-g8dgm   1/1     Running             0          33h
myapp-deploy-74fb9bdf9b-lqm77   1/1     Terminating         0          33h
myapp-deploy-66cfdc5675-c7fxx   0/1     Pending             0          33h
myapp-deploy-66cfdc5675-c7fxx   0/1     Pending             0          33h
myapp-deploy-66cfdc5675-c7fxx   0/1     ContainerCreating   0          33h
myapp-deploy-66cfdc5675-c7fxx   1/1     Running             0          33h
myapp-deploy-74fb9bdf9b-lqm77   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-rd4nf   1/1     Terminating         0          33h
myapp-deploy-66cfdc5675-xj5qq   0/1     Pending             0          33h
myapp-deploy-66cfdc5675-xj5qq   0/1     Pending             0          33h
myapp-deploy-66cfdc5675-xj5qq   0/1     ContainerCreating   0          33h
myapp-deploy-74fb9bdf9b-lqm77   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-lqm77   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-rd4nf   0/1     Terminating         0          33h
myapp-deploy-66cfdc5675-xj5qq   1/1     Running             0          33h
myapp-deploy-74fb9bdf9b-slfst   1/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-rd4nf   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-rd4nf   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-slfst   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-slfst   0/1     Terminating         0          33h
myapp-deploy-74fb9bdf9b-slfst   0/1     Terminating         0          33h
</code></pre> 
  <p>查看滚动更新后历史版本和现在运行版本</p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get rs -o wide</span>
NAME                      DESIRED   CURRENT   READY   AGE    CONTAINERS   IMAGES                 SELECTOR
myapp-deploy-66cfdc5675   3         3         3       100s   myapp        ikubernetes/myapp:v2   app<span class="token operator">=</span>myapp,pod-template-hash<span class="token operator">=</span>66cfdc5675,release<span class="token operator">=</span>canary
myapp-deploy-74fb9bdf9b   0         0         0       16m    myapp        ikubernetes/myapp:v1   app<span class="token operator">=</span>myapp,pod-template-hash<span class="token operator">=</span>74fb9bdf9b,release<span class="token operator">=</span>canary
</code></pre> 
  <h3><a id="46kubectl_get_svcservice_390"></a>4.6、kubectl get svc：获取service信息</h3> 
  <h4><a id="461service_391"></a>4.6.1、获取默认命名空间的service</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get svc</span>
NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>   AGE
kubernetes   ClusterIP   10.96.0.1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        443/TCP   3d5h
</code></pre> 
  <h4><a id="462service_397"></a>4.6.2、获取指定命名空间的service</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ingress-nginx<span class="token punctuation">]</span><span class="token comment"># kubectl get svc -n ingress-nginx </span>
NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>                      AGE
default-http-backend   ClusterIP   10.109.114.81    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        80/TCP                       45m
ingress-nginx          NodePort    10.106.125.159   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        80:30080/TCP,443:30443/TCP   73s
</code></pre> 
  <h3><a id="47kubectl_get_secretssecrets_404"></a>4.7、kubectl get secrets：获取secrets信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ingress<span class="token punctuation">]</span><span class="token comment"># kubectl get secrets </span>
NAME                     TYPE                                  DATA   AGE
default-token-g5zk6      kubernetes.io/service-account-token   3      5d14h
tomcat-ingress-sercret   kubernetes.io/tls                     2      11s
</code></pre> 
  <h3><a id="48kubectl_get_pvpv_411"></a>4.8、kubectl get pv：获取pv信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master volumes<span class="token punctuation">]</span><span class="token comment"># kubectl get pv</span>
NAME    CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM   STORAGECLASS   REASON   AGE
pv001   1Gi        RWO,RWX        Retain           Available                                   10s
pv002   1Gi        RWX            Retain           Available                                   10s
pv003   1Gi        RWO,RWX        Retain           Available                                   10s
pv004   1Gi        RWO,RWX        Retain           Available                                   10s
pv005   1Gi        RWO,RWX        Retain           Available                                   10s
</code></pre> 
  <h3><a id="49kubectl_get_pvcpvc_421"></a>4.9、kubectl get pvc：获取pvc信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master volumes<span class="token punctuation">]</span><span class="token comment"># kubectl get pvc</span>
NAME    STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   AGE
mypvc   Bound    pv002    1Gi        RWX                           43s
</code></pre> 
  <h3><a id="410kubectl_get_configmap__kubectl_get_cmconfigMap_427"></a>4.10、kubectl get configmap &amp;&amp; kubectl get cm：获取configMap信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get cm</span>
NAME           DATA   AGE
nginx-config   2      4m11s
</code></pre> 
  <h3><a id="411kubectl_get_stsstatefulSet_433"></a>4.11、kubectl get sts：获取statefulSet控制器信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get sts</span>
NAME    READY   AGE
myapp   3/3     30s
</code></pre> 
  <h3><a id="412kubectl_get_serviceaccounts__kubectl_get_saserviceaccount_439"></a>4.12、kubectl get serviceaccounts &amp;&amp; kubectl get sa：获取serviceaccount信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get serviceaccounts &amp;&amp; kubectl get sa</span>
NAME      SECRETS   AGE
admin     1         3m49s
default   1         10d
NAME      SECRETS   AGE
admin     1         3m50s
default   1         10d
</code></pre> 
  <h2><a id="5kubectl_label_449"></a>5、kubectl label</h2> 
  <p>用法：<code>kubectl label [--overwrite] (-f FILENAME | TYPE NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--resource-version=version]</code>，资源标签设定</p> 
  <h3><a id="51podkeyvalue_451"></a>5.1、给一个pod打一个没有存在的标签key=value，</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl label pods pod-demo release=canary</span>
pod/pod-demo labeled
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods pod-demo --show-labels </span>
NAME       READY   STATUS    RESTARTS   AGE   LABELS
pod-demo   2/2     Running   0          33m   apps<span class="token operator">=</span>myapp,release<span class="token operator">=</span>canary,tier<span class="token operator">=</span>frontend
</code></pre> 
  <h3><a id="52pod_459"></a>5.2、给一个pod已经存在的标签重新赋值</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl label pods pod-demo release=stable</span>
error: <span class="token string">'release'</span> already has a value <span class="token punctuation">(</span>canary<span class="token punctuation">)</span>, and --overwrite is <span class="token boolean">false</span>
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl label pods pod-demo release=stable --overwrite</span>
pod/pod-demo labeled
</code></pre> 
  <h3><a id="53key_466"></a>5.3、通过key删除标签</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes --show-labels </span>
NAME     STATUS   ROLES    AGE    VERSION   LABELS
master   Ready    master   8d     v1.14.2   beta.kubernetes.io/arch<span class="token operator">=</span>amd64,beta.kubernetes.io/os<span class="token operator">=</span>linux,kubernetes.io/arch<span class="token operator">=</span>amd64,kubernetes.io/hostname<span class="token operator">=</span>master,kubernetes.io/os<span class="token operator">=</span>linux,node-role.kubernetes.io/master<span class="token operator">=</span>
node1    Ready    worker   8d     v1.14.2   beta.kubernetes.io/arch<span class="token operator">=</span>amd64,beta.kubernetes.io/os<span class="token operator">=</span>linux,disktype<span class="token operator">=</span>ssd,hostname<span class="token operator">=</span>node1,kubernetes.io/arch<span class="token operator">=</span>amd64,kubernetes.io/hostname<span class="token operator">=</span>node1,kubernetes.io/os<span class="token operator">=</span>linux,node-role.kubernetes.io/worker<span class="token operator">=</span>worker
node2    Ready    worker   5d6h   v1.14.2   beta.kubernetes.io/arch<span class="token operator">=</span>amd64,beta.kubernetes.io/os<span class="token operator">=</span>linux,hostname<span class="token operator">=</span>node2,kubernetes.io/arch<span class="token operator">=</span>amd64,kubernetes.io/hostname<span class="token operator">=</span>node2,kubernetes.io/os<span class="token operator">=</span>linux,node-role.kubernetes.io/worker<span class="token operator">=</span>worker
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl label nodes node1 disktype-</span>
node/node1 labeled
</code></pre> 
  <h2><a id="6kubectl_describe_476"></a>6、kubectl describe</h2> 
  <p>用法：<code>kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | -l label] | TYPE/NAME) [options]</code>，显示资源的详细描述</p> 
  <h3><a id="61pod_478"></a>6.1、查看某个pod的详细信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl describe pods pod-demo </span>
Name:               pod-demo
Namespace:          default
Priority:           0
PriorityClassName:  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Node:               node1/192.168.10.148
Start Time:         Tue, 30 Jul 2019 18:17:38 +0800
Labels:             apps<span class="token operator">=</span>myapp
                    tier<span class="token operator">=</span>frontend
Annotations:        <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Status:             Running
IP:                 10.244.1.14
</code></pre> 
  <h3><a id="62serviceaccount_493"></a>6.2、查看创建的serviceaccount的详细信息</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl describe sa admin </span>
Name:                admin
Namespace:           default
Labels:              <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Annotations:         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Image pull secrets:  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span> <span class="token comment">#设置镜像拉取的镜像仓库，用sa替代imagePullSecrets</span>
Mountable secrets:   admin-token-f6h28
Tokens:              admin-token-f6h28
Events:              <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre> 
  <h2><a id="7kubectl_delete_505"></a>7、kubectl delete</h2> 
  <p>用法：<code>kubectl delete ([-f FILENAME] | [-k DIRECTORY] | TYPE [(NAME | -l label | --all)]) [options]</code>，删除资源</p> 
  <h3><a id="71pods_507"></a>7.1、删除pods资源</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods</span>
NAME          READY   STATUS    RESTARTS   AGE
myapp-l9pbb   1/1     Running   0          7m1s
myapp-nlw6m   1/1     Running   0          10m
myapp-ppktd   1/1     Running   0          10m
myapp-wmbnc   1/1     Running   0          28m
myapp-wpfpn   1/1     Running   0          10m
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl delete pods myapp-l9pbb </span>
pod <span class="token string">"myapp-l9pbb"</span> deleted
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
  <h3><a id="72service_520"></a>7.2、删除service</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl delete svc redis </span>
<span class="token function">service</span> <span class="token string">"redis"</span> deleted
</code></pre> 
  <h3><a id="73namespace_525"></a>7.3、删除namespace</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete ns cyf </span>
namespace <span class="token string">"cyf"</span> deleted
</code></pre> 
  <h3><a id="74Secret_530"></a>7.4、删除Secret</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ingress<span class="token punctuation">]</span><span class="token comment"># kubectl delete secrets tomcat-ingress-sercret </span>
secret <span class="token string">"tomcat-ingress-sercret"</span> deleted
</code></pre> 
  <h3><a id="75configmap_535"></a>7.5、删除configmap</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master configmap<span class="token punctuation">]</span><span class="token comment"># kubectl delete configmaps nginx</span>
configmap <span class="token string">"nginx"</span> deleted
</code></pre> 
  <h2><a id="8kubectl_edit_540"></a>8、kubectl edit</h2> 
  <p>用法：<code>kubectl edit (RESOURCE/NAME | -f FILENAME) [options]</code>，编辑资源清单</p> 
  <h3><a id="81ReplicaSetyaml_542"></a>8.1、修改ReplicaSet控制器的yaml清单内容</h3> 
  <p>注意：修改容器版本，不会自动更新（手动删除pod后自动更新：灰度发布）</p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl edit rs myapp </span>
replicaset.extensions/myapp edited
</code></pre> 
  <h2><a id="9kubectl_exec_548"></a>9、kubectl exec</h2> 
  <p>用法：<code>kubectl exec POD [-c CONTAINER] -- COMMAND [args...] [options]</code>，类似docker exec，进入容器</p> 
  <h3><a id="91pod_550"></a>9.1、进入pod内的容器</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl exec -it myapp-lmj45 -- /bin/sh</span>
/ <span class="token comment"># ls</span>
bin    dev    etc    home   lib    media  mnt    proc   root   run    sbin   srv    sys    tmp    usr    var
/ <span class="token comment"># exit</span>
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl exec -it myapp-lmj45 sh</span>
/ <span class="token comment"># ls</span>
bin    dev    etc    home   lib    media  mnt    proc   root   run    sbin   srv    sys    tmp    usr    var
/ <span class="token comment"># </span>
</code></pre> 
  <h3><a id="92pod_561"></a>9.2、进入pod内指定容器</h3> 
  <p>用法：<code>kubectl exec -it pod-name -c container-name -- /bin/sh</code></p> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl exec -it myapp-lmj45 -c myapp-container sh</span>
/ <span class="token comment"># ls</span>
bin    dev    etc    home   lib    media  mnt    proc   root   run    sbin   srv    sys    tmp    usr    var
/ <span class="token comment"># exit</span>
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl exec -it myapp-lmj45 -c myapp-container -- /bin/sh</span>
/ <span class="token comment"># ls</span>
bin    dev    etc    home   lib    media  mnt    proc   root   run    sbin   srv    sys    tmp    usr    var
/ <span class="token comment"># </span>
</code></pre> 
  <h2><a id="10kubectl_logs_573"></a>10、kubectl logs</h2> 
  <p>用法：<code>kubectl logs [-f] [-p] (POD | TYPE/NAME) [-c CONTAINER] [options]</code>，类似于docker logs，查看容器日志</p> 
  <h3><a id="101pod_575"></a>10.1、查看pod内的容器日志</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl logs myapp-lmj45 --tail 300 -f</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:42 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:42 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:43 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:43 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:44 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
</code></pre> 
  <h3><a id="102pod_584"></a>10.2、查看pod内指定容器的日志</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl logs myapp-lmj45 -c myapp-container --tail 300 -f</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:42 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:42 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:43 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:43 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
10.244.0.0 - - <span class="token punctuation">[</span>31/Jul/2019:22:06:44 +0000<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> 200 65 <span class="token string">"-"</span> <span class="token string">"curl/7.29.0"</span> <span class="token string">"-"</span>
</code></pre> 
  <h2><a id="11kubectl_explain_593"></a>11、kubectl explain</h2> 
  <p>用法：<code>kubectl explain RESOURCE [options]</code>，显示各种资源清单的字段解释</p> 
  <h3><a id="111pod_595"></a>11.1、查看pod资源清单字段</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl explain pod</span>
KIND:     Pod
VERSION:  v1

DESCRIPTION:
     Pod is a collection of containers that can run on a host. This resource is
     created by clients and scheduled onto hosts.

FIELDS:
   apiVersion	<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
  <h3><a id="112podmetadata_609"></a>11.2、查看pod资源清单理metadata字段下的字段（以此类推）</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl explain pod.metadata</span>
KIND:     Pod
VERSION:  v1
RESOURCE: metadata <span class="token operator">&lt;</span>Object<span class="token operator">&gt;</span>
DESCRIPTION:
     Standard object's metadata. More info:
     https://git.k8s.io/community/contributors/devel/api-conventions.md<span class="token comment">#metadata</span>

     ObjectMeta is metadata that all persisted resources must have, <span class="token function">which</span>
     includes all objects <span class="token function">users</span> must create.
FIELDS:
   annotations	<span class="token operator">&lt;</span>map<span class="token punctuation">[</span>string<span class="token punctuation">]</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
  <h3><a id="113ReplicaSet_625"></a>11.3、查看ReplicaSet资源清单字段</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl explain rs</span>
KIND:     ReplicaSet
VERSION:  extensions/v1beta1

DESCRIPTION:
     DEPRECATED - This group version of ReplicaSet is deprecated by
     apps/v1beta2/ReplicaSet. See the release notes <span class="token keyword">for</span> <span class="token function">more</span> information.
     ReplicaSet ensures that a specified number of pod replicas are running at
     any given time.

FIELDS:
   apiVersion	<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
     APIVersion defines the versioned schema of this representation of an
     object. Servers should convert recognized schemas to the latest internal
     value, and may reject unrecognized values. More info:
 <span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
  <h2><a id="12kubectl_rollout_644"></a>12、kubectl rollout</h2> 
  <p>用法：<code>kubectl rollout SUBCOMMAND [options]</code>，滚动更新<br> 类型：</p> 
  <ul> 
   <li>deployments</li> 
   <li>daemonsets</li> 
   <li>statefulsets</li> 
  </ul> 
  <h3><a id="121deployment_651"></a>12.1、查看deployment滚动更新历史版本</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl rollout history deployment myapp-deploy </span>
deployment.extensions/myapp-deploy 
REVISION  CHANGE-CAUSE
1         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
2         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre> 
  <h3><a id="122pod_659"></a>12.2、更新一个pod后暂停更新</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl rollout pause deployment myapp-deploy</span>
deployment.extensions/myapp-deploy paused
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -l app=myapp -w</span>
NAME                            READY   STATUS    RESTARTS   AGE
myapp-deploy-66cfdc5675-cnm4m   1/1     Running   0          12s
myapp-deploy-66cfdc5675-jzghg   1/1     Running   0          12s
myapp-deploy-66cfdc5675-zkc94   1/1     Running   0          12s
myapp-deploy-668ff4dc58-fq6hp   0/1     Pending   0          0s
myapp-deploy-668ff4dc58-fq6hp   0/1     Pending   0          0s
myapp-deploy-668ff4dc58-fq6hp   0/1     ContainerCreating   0          0s
myapp-deploy-668ff4dc58-fq6hp   1/1     Running             0          9s
</code></pre> 
  <h3><a id="123_673"></a>12.3、解除暂停状态，继续更新</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl rollout resume deployment myapp-deploy </span>
deployment.extensions/myapp-deploy resumed
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl rollout status deployment myapp-deploy </span>
deployment <span class="token string">"myapp-deploy"</span> successfully rolled out
</code></pre> 
  <h3><a id="124_680"></a>12.4、回滚到指定版本</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl rollout history deployment myapp-deploy </span>
deployment.extensions/myapp-deploy 
REVISION  CHANGE-CAUSE
1         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
2         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
3         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl rollout undo deployment myapp-deploy --to-revision=1</span>
deployment.extensions/myapp-deploy rolled back
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get rs -o wide</span>
NAME                      DESIRED   CURRENT   READY   AGE     CONTAINERS   IMAGES                 SELECTOR
myapp-deploy-668ff4dc58   0         0         0       4m      myapp        ikubernetes/myapp:v3   app<span class="token operator">=</span>myapp,pod-template-hash<span class="token operator">=</span>668ff4dc58,release<span class="token operator">=</span>canary
myapp-deploy-66cfdc5675   0         0         0       4m23s   myapp        ikubernetes/myapp:v2   app<span class="token operator">=</span>myapp,pod-template-hash<span class="token operator">=</span>66cfdc5675,release<span class="token operator">=</span>canary
myapp-deploy-74fb9bdf9b   5         5         5       5m8s    myapp        ikubernetes/myapp:v1   app<span class="token operator">=</span>myapp,pod-template-hash<span class="token operator">=</span>74fb9bdf9b,release<span class="token operator">=</span>canary
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl rollout history deployment myapp-deploy </span>
deployment.extensions/myapp-deploy 
REVISION  CHANGE-CAUSE
2         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
3         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
4         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre> 
  <h3><a id="125deployment_702"></a>12.5、监控deployment更新状态</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl rollout status deployment myapp-deploy </span>
Waiting <span class="token keyword">for</span> deployment <span class="token string">"myapp-deploy"</span> rollout to finish: 1 out of 3 new replicas have been updated<span class="token punctuation">..</span>.
</code></pre> 
  <h2><a id="13kubectl_scale_707"></a>13、kubectl scale</h2> 
  <p><code>Deployment, ReplicaSet, Replication Controller, or StatefulSet</code>，pod副本的扩容和缩容</p> 
  <p>用法：<code>kubectl scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME)</code></p> 
  <h3><a id="131_711"></a>13.1、扩容和缩容</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl scale sts myapp --replicas=2</span>
statefulset.apps/myapp scaled
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl get pods</span>
NAME      READY   STATUS    RESTARTS   AGE
myapp-0   1/1     Running   0          14m
myapp-1   1/1     Running   0          14m
</code></pre> 
  <h2><a id="14kubectl_patch_720"></a>14、kubectl patch</h2> 
  <p>用法：<code>kubectl patch (-f FILENAME | TYPE NAME) -p PATCH [options]</code></p> 
  <h3><a id="141deployment_722"></a>14.1、修改deployment副本数</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl patch deployment myapp-deploy -p '{"spec":{"replicas":5}}'</span>
deployment.extensions/myapp-deploy patched
</code></pre> 
  <h3><a id="142deployment_727"></a>14.2、修改deployment滚动更新策略</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl patch deployment myapp-deploy -p '{"spec":{"strategy":{"rollingUpdate":{"maxSurge":1,"maxUnavailable":0}}}}'</span>
deployment.extensions/myapp-deploy patched
<span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl describe deployments myapp-deploy </span>
Name:                   myapp-deploy
Namespace:              default
CreationTimestamp:      Fri, 02 Aug 2019 01:33:47 +0800
Labels:                 app<span class="token operator">=</span>myapp
                        release<span class="token operator">=</span>canary
Annotations:            deployment.kubernetes.io/revision: 2
                        kubectl.kubernetes.io/last-applied-configuration:
                          <span class="token punctuation">{</span><span class="token string">"apiVersion"</span><span class="token keyword">:</span><span class="token string">"apps/v1"</span>,<span class="token string">"kind"</span><span class="token keyword">:</span><span class="token string">"Deployment"</span>,<span class="token string">"metadata"</span>:<span class="token punctuation">{</span><span class="token string">"annotations"</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"myapp-deploy"</span>,<span class="token string">"namespace"</span><span class="token keyword">:</span><span class="token string">"default"</span><span class="token punctuation">}</span>,<span class="token string">"spec"</span>:<span class="token punctuation">{</span><span class="token string">"replicas"</span>:3<span class="token punctuation">..</span>.
Selector:               app<span class="token operator">=</span>myapp,release<span class="token operator">=</span>canary
Replicas:               5 desired <span class="token operator">|</span> 5 updated <span class="token operator">|</span> 5 total <span class="token operator">|</span> 5 available <span class="token operator">|</span> 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  0 max unavailable, 1 max surge <span class="token comment">#已经修改</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
  <h2><a id="15kubectl_set_747"></a>15、kubectl set</h2> 
  <p>用法：<code>kubectl set SUBCOMMAND [options]</code></p> 
  <h3><a id="151kubectl_set_image_749"></a>15.1、kubectl set image</h3> 
  <p>用法：<code>kubectl set image (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N [options]</code></p> 
  <h4><a id="1511deployment_751"></a>15.1.1、修改deployment的镜像版本</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl set image deployment myapp-deploy myapp=ikubernetes/myapp:v3 </span>
deployment.extensions/myapp-deploy image updated
</code></pre> 
  <h4><a id="1512daemonset_756"></a>15.1.2、修改daemonset的镜像版本</h4> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl set image daemonsets filebeat-ds filebeat=ikubernetes/filebeat:5.6.6-alpine</span>
daemonset.extensions/filebeat-ds image updated
</code></pre> 
  <h2><a id="16kubectl_config_761"></a>16、kubectl config</h2> 
  <p>用法：<code>kubectl config SUBCOMMAND [options]</code></p> 
  <h3><a id="161kubectl_config_view_kubeconfig__kubeconfig__763"></a>16.1、kubectl config view：显示合并的 kubeconfig 配置或一个指定的 kubeconfig 文件</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master yaml<span class="token punctuation">]</span><span class="token comment"># kubectl config view </span>
apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: DATA+OMITTED
    server: https://192.168.10.48:6443
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: kubernetes-admin
  name: kubernetes-admin@kubernetes
current-context: kubernetes-admin@kubernetes
kind: Config
preferences: <span class="token punctuation">{</span><span class="token punctuation">}</span>
users:
- name: kubernetes-admin
  user:
    client-certificate-data: REDACTED
    client-key-data: REDACTED
</code></pre> 
  <h2><a id="kubectl_clusterinfo_786"></a>kubectl cluster-info：查看集群信息</h2> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl cluster-info</span>
Kubernetes master is running at https://192.168.10.48:6443
KubeDNS is running at https://192.168.10.48:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use <span class="token string">'kubectl cluster-info dump'</span><span class="token keyword">.</span>
</code></pre> 
  <h2><a id="kubectl_apiversions_Kubernetes_API__API__794"></a>kubectl api-versions：查询 Kubernetes API 支持的 API 版本</h2> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl api-versions </span>
admissionregistration.k8s.io/v1beta1
apiextensions.k8s.io/v1beta1
apiregistration.k8s.io/v1
apiregistration.k8s.io/v1beta1
apps/v1
apps/v1beta1
apps/v1beta2
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
  <h2><a id="kubectl_apiresourcesk8s_806"></a>kubectl api-resources：查看k8s支持的资源类型</h2> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl api-resources</span>
NAME                              SHORTNAMES   APIGROUP                       NAMESPACED   KIND
bindings                                                                      <span class="token boolean">true</span>         Binding
componentstatuses                 cs                                          <span class="token boolean">false</span>        ComponentStatus
configmaps                        cm                                          <span class="token boolean">true</span>         ConfigMap
endpoints                         ep                                          <span class="token boolean">true</span>         Endpoints
events                            ev                                          <span class="token boolean">true</span>         Event
limitranges                       limits                                      <span class="token boolean">true</span>         LimitRange
namespaces                        ns                                          <span class="token boolean">false</span>        Namespace
nodes                             no                                          <span class="token boolean">false</span>        Node
</code></pre> 
  <h3><a id="_819"></a>查看指定群组支持的资源类型</h3> 
  <pre><code class="prism language-shell"><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl api-resources --api-group=storage.k8s.io</span>
NAME                SHORTNAMES   APIGROUP         NAMESPACED   KIND
csidrivers                       storage.k8s.io   <span class="token boolean">false</span>        CSIDriver
csinodes                         storage.k8s.io   <span class="token boolean">false</span>        CSINode
storageclasses      sc           storage.k8s.io   <span class="token boolean">false</span>        StorageClass
volumeattachments                storage.k8s.io   <span class="token boolean">false</span>        VolumeAttachment
</code></pre> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
