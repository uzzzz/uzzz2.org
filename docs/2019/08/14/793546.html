<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Hue-release-4.3.0集成Ambari2.7.3 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Hue-release-4.3.0集成Ambari2.7.3" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="文章目录 环境搭建 hue-release-4.3.0.zip hue-4.3.0-stacks hue-4.3.0-common-services 重启ambari服务-添加Hue服务 问题修复 问题1：hue_env_python = &#39; 问题2：Failed to execute command &#39;/usr/bin/yum -y install saslwrapper-devel&#39;, exited with code &#39;1&#39;, message: &#39;Error: Nothing to do 问题3：Execution of &#39;http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz&#39; returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory 问题4：Execution of &#39;cd /usr/local/hue &amp;&amp; make apps&#39; returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory 问题5：/bin/bash: mvn: command not found 问题6：/usr/local/hue目录错误 问题7：Execution of &#39;/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site &#39;hive.security.authorization.sqlstd.confwhitelist.append&#39; &#39;hive.server2.logging.operation.verbose&#39;&#39; returned 1. [ERROR] &quot;hive-site&quot; not found in server response. 问题8：Execution of &#39;cd /user/local/hue &amp;&amp; source ./build/env/bin/activate&#39; returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory 问题9：Configuration parameter &#39;java_home&#39; was not found in configurations dictionary! 问题10：hue集成hive时获取hive_server_hosts错误 问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误 问题12：Invalid HTTP_HOST header: &#39;10.180.210.242:8888&#39;. You may need to add u&#39;10.180.210.242&#39; to ALLOWED_HOSTS. 问题13：Table &#39;hue.auth_user&#39; doesn&#39;t exist 问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误 Hue集成Ambari完毕 环境搭建 组件 描述 Ambari 2.7.1 HDP 3.0.1 Hue 4.3.0 Ambari2.7.1集群搭建流程参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/86595945 下载hue-4.3.0源码包：hue-release-4.3.0.zip https://github.com/cloudera/hue/releases/tag/release-4.3.0 下载依赖： python-simplejson-3.8.2-12.1.x86_64.rpm saslwrapper-0.16-5.el7.x86_64.rpm saslwrapper-devel-0.16-5.el7.x86_64.rpm 安装完毕Ambari集群，下载ambari-hue-service：http://github.com/snakecy/ambari-hue-service git clone https://github.com/snakecy/ambari-hue-service.git hue-release-4.3.0.zip # hue编译环境 yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven yum install -y gcc openssl-devel [root@manager241 tgm]# unzip hue-release-4.3.0.zip [root@manager241 tgm]# mv hue-release-4.3.0 /opt/ [root@manager241 tgm]# cd /opt/ [root@manager241 opt]# mv hue-release-4.3.0 hue-4.3.0 [root@manager241 opt]# cd hue-4.3.0 [root@manager241 hue-4.3.0]# make apps [root@manager241 opt]# touch hue-4.3.0/build/env/bin/replace_py_pwd.py [root@manager241 opt]# cd hue-4.3.0/build/env/bin/ [root@manager241 bin]# vim replace_py_pwd.py import os import re files = os.listdir(&#39;./&#39;) def replaceStr(file): with open(file, &#39;r&#39;) as f: str = f.read() str1 = re.sub(&quot;/opt/hue-4.3.0/build/env/bin/python2.7&quot;, &quot;/usr/local/hue-4.3.0/build/env/bin/python2.7&quot;, str) with open(file, &#39;w&#39;) as f: f.write(str1) for f in files: replaceStr(f) [root@manager241 bin]# chmod +x replace_py_pwd.py [root@manager241 opt]# tar -zcvf hue-4.3.0.tgz hue-4.3.0/ [root@manager241 opt]# mkdir -p /var/www/html/hue [root@manager241 opt]# cp hue-4.3.0.tgz /var/www/html/hue/ [root@manager241 opt]# cd /root/tgm/ [root@manager241 tgm]# cp python-simplejson-3.8.2-12.1.x86_64.rpm /var/www/html/hue/ [root@manager241 tgm]# cp saslwrapper-* /var/www/html/hue/ [root@manager241 tgm]# cd /var/www/html/hue/ [root@manager241 hue]# yum install createrepo -y [root@manager241 hue]# createrepo /var/www/html/hue/ hue-4.3.0-stacks [root@manager241 hue]# cd /var/lib/ambari-server/resources/stacks/HDP/3.0/services/ [root@manager241 services]# mkdir HUE [root@manager241 services]# cd HUE/ [root@manager241 HUE]# touch metainfo.xml [root@manager241 HUE]# chmod +x metainfo.xml # metainfo.xml 内容如下: &lt;?xml version=&quot;1.0&quot;?&gt; &lt;!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. --&gt; &lt;metainfo&gt; &lt;schemaVersion&gt;2.0&lt;/schemaVersion&gt; &lt;services&gt; &lt;service&gt; &lt;name&gt;HUE&lt;/name&gt; &lt;extends&gt;common-services/HUE/4.3.0&lt;/extends&gt; &lt;version&gt;4.3.0&lt;/version&gt; &lt;osSpecifics&gt; &lt;osSpecific&gt; &lt;osFamily&gt;any&lt;/osFamily&gt; &lt;packages&gt; &lt;package&gt;&lt;name&gt;wget&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;tar&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;asciidoc&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;krb5-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libxml2-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libxslt-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;openldap-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-setuptools&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-psycopg2&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;sqlite-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;rsync&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;saslwrapper-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;pycrypto&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;gmp-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libyaml-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-plain&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-gssapi&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libffi-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;MySQL-client&lt;/name&gt;&lt;/package&gt; &lt;/packages&gt; &lt;/osSpecific&gt; &lt;/osSpecifics&gt; &lt;/service&gt; &lt;/services&gt; &lt;/metainfo&gt; hue-4.3.0-common-services [root@manager241 HUE]# cd /var/lib/ambari-server/resources/common-services/ [root@manager241 common-services]# mkdir HUE [root@manager241 tgm]# cp -r ambari-hue-service/ /var/lib/ambari-server/resources/common-services/HUE/ [root@manager241 common-services]# cd HUE/ [root@manager241 HUE]# mv ambari-hue-service 4.3.0 [root@manager241 HUE]# chmod -R +x 4.3.0/ 重启ambari服务-添加Hue服务 [root@manager241 ~]# ambari-server restart [root@manager241 ~]# ambari-agent restart Ambari页面-服务-添加服务-选中hue服务-点击下一步-配置数据库-进行部署 在部署的过程中出现各种问题，问题解决，参考后面“问题修复” 问题修复 问题1：hue_env_python = ’ 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 或者download_url修改为： import commands download_url = commands.getoutput(&#39;cat /etc/yum.repo.d/hue.repo | grep &quot;baseurl&quot; | awk -F= \&#39;{ print $2&quot;hue.tgz&quot;}\&#39;&#39;) 问题2：Failed to execute command ‘/usr/bin/yum -y install saslwrapper-devel’, exited with code ‘1’, message: &#39;Error: Nothing to do 解决： [root@manager241 ~]# cd /etc/yum.repos.d/ [root@manager241 yum.repos.d]# cp centos.repo hue.repo [root@manager241 yum.repos.d]# vim hue.repo [hue] name=hue baseurl=http://10.180.210.241/hue/ gpgcheck=0 enabled=1 [root@manager241 yum.repos.d]# scp hue.repo master241.bigdata:$PWD [root@manager241 yum.repos.d]# scp hue.repo worker241.bigdata:$PWD 问题3：Execution of ‘http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz’ returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py 修改为： 问题4：Execution of ‘cd /usr/local/hue &amp;&amp; make apps’ returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 问题5：/bin/bash: mvn: command not found 解决：问题原因，在hue节点执行make apps时需要maven环境，所以在hue的安装节点需要搭建hue编译的环境 # 搭建maven环境 参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/91375219 # 安装环境 yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven 问题6：/usr/local/hue目录错误 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py 修改为： 问题7：Execution of ‘/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site ‘hive.security.authorization.sqlstd.confwhitelist.append’ ‘hive.server2.logging.operation.verbose’’ returned 1. [ERROR] “hive-site” not found in server response. 解决：遇到这种问题，安装相对应的组件（Hive、Oozie、Hbase、Spark2） 问题8：Execution of ‘cd /user/local/hue &amp;&amp; source ./build/env/bin/activate’ returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/hue_server.py 修改为： 问题9：Configuration parameter ‘java_home’ was not found in configurations dictionary! 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 问题10：hue集成hive时获取hive_server_hosts错误 问题描述： 在hue操作hive的时候，获取不到hive的hiveserver2连接（hive_server_host,hive_server_port） ，手动修改配置文件/usr/local/hue/desktop/conf/pseudo-distributed.ini中有关hive的信息，重启hue时会重置配置文件，使手动配置的hiveserver2信息丢失。 解决： vim /var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/scripts/params.py 修改为： hive_server_hosts = default(&quot;/clusterHostInfo/hive_server_hosts&quot;, []) hive_server_host = config[&#39;clusterHostInfo&#39;][&#39;hive_server_hosts&#39;][0] 问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 404 spark_thriftserver_hosts = default(&quot;/clusterHostInfo/spark_thriftserver_hosts&quot;, []) 405 spark_thriftserver_host = &quot;localhost&quot; 406 spark_hiveserver2_thrift_port = &quot;10002&quot; 407 spark_history_server_url = &#39;&#39; 408 if len(spark_thriftserver_hosts) &gt; 0: 409 spark_thriftserver_host = spark_thriftserver_hosts[0] 410 spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 411 spark_jobhistoryserver_hosts = default(&quot;/clusterHostInfo/spark_jobhistoryserver_hosts&quot;, []) 412 if len(spark_jobhistoryserver_hosts) &gt; 0: 413 spark_history_server_host = spark_jobhistoryserver_hosts[0] 414 else: 415 spark_history_server_host = &quot;localhost&quot; 416 spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark-defaults&#39;][&#39;spark.history.ui.port&#39;] 417 spark_history_server_url = format(&quot;http://{spark_history_server_host}:{spark_history_ui_port}&quot;) 修改为： 403 # configurations of Spark 404 #spark_thriftserver_hosts = default(&quot;/clusterHostInfo/spark_thriftserver_hosts&quot;, []) 405 #spark_thriftserver_host = &quot;localhost&quot; 406 #spark_hiveserver2_thrift_port = &quot;10002&quot; 407 #spark_history_server_url = &#39;&#39; 408 #if len(spark_thriftserver_hosts) &gt; 0: 409 # spark_thriftserver_host = spark_thriftserver_hosts[0] 410 # spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 411 # spark_jobhistoryserver_hosts = default(&quot;/clusterHostInfo/spark_jobhistoryserver_hosts&quot;, []) 412 # if len(spark_jobhistoryserver_hosts) &gt; 0: 413 # spark_history_server_host = spark_jobhistoryserver_hosts[0] 414 # else: 415 # spark_history_server_host = &quot;localhost&quot; 416 # spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark-defaults&#39;][&#39;spark.history.ui.port&#39;] 417 # spark_history_server_url = format(&quot;http://{spark_history_server_host}:{spark_history_ui_port}&quot;) 418 spark_thriftserver_host = default(&quot;/clusterHostInfo/spark2_thriftserver_hosts&quot;, [])[0] 419 spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark2-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 420 spark_jobhistoryserver_host = default(&quot;/clusterHostInfo/spark2_jobhistoryserver_hosts&quot;, [])[0] 421 spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark2-defaults&#39;][&#39;spark.history.ui.port&#39;] 422 spark_history_server_url = format(&quot;http://{spark_jobhistoryserver_host}:{spark_history_ui_port}&quot;) 问题12：Invalid HTTP_HOST header: ‘10.180.210.242:8888’. You may need to add u’10.180.210.242’ to ALLOWED_HOSTS. 解决： vim /usr/local/hue-4.3.0/desktop/core/src/desktop/settings.py 修改为： 问题13：Table ‘hue.auth_user’ doesn’t exist 解决： 登录ambari页面-点击服务选中hue-点击操作-点击Metastoresync，同步数据库 问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误 vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/configuration/hue-desktop-site.xml Ambari页面临时解决： 服务-HUE-配置参数-ADVANCED-高级设置hue-desktop-site Django Debug Mode设置为false 服务-HUE-配置参数-ADVANCED-高级设置pseudo-distributed.ini allowed_hosts={desktop_allowed_hosts} 修改为 allowed_hosts=* 另外如果后期永久修改需要在配置文件中修改解决： 修改为： Hue集成Ambari完毕 代码参考：https://github.com/tgm2018/Hue4.3.0" />
<meta property="og:description" content="文章目录 环境搭建 hue-release-4.3.0.zip hue-4.3.0-stacks hue-4.3.0-common-services 重启ambari服务-添加Hue服务 问题修复 问题1：hue_env_python = &#39; 问题2：Failed to execute command &#39;/usr/bin/yum -y install saslwrapper-devel&#39;, exited with code &#39;1&#39;, message: &#39;Error: Nothing to do 问题3：Execution of &#39;http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz&#39; returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory 问题4：Execution of &#39;cd /usr/local/hue &amp;&amp; make apps&#39; returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory 问题5：/bin/bash: mvn: command not found 问题6：/usr/local/hue目录错误 问题7：Execution of &#39;/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site &#39;hive.security.authorization.sqlstd.confwhitelist.append&#39; &#39;hive.server2.logging.operation.verbose&#39;&#39; returned 1. [ERROR] &quot;hive-site&quot; not found in server response. 问题8：Execution of &#39;cd /user/local/hue &amp;&amp; source ./build/env/bin/activate&#39; returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory 问题9：Configuration parameter &#39;java_home&#39; was not found in configurations dictionary! 问题10：hue集成hive时获取hive_server_hosts错误 问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误 问题12：Invalid HTTP_HOST header: &#39;10.180.210.242:8888&#39;. You may need to add u&#39;10.180.210.242&#39; to ALLOWED_HOSTS. 问题13：Table &#39;hue.auth_user&#39; doesn&#39;t exist 问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误 Hue集成Ambari完毕 环境搭建 组件 描述 Ambari 2.7.1 HDP 3.0.1 Hue 4.3.0 Ambari2.7.1集群搭建流程参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/86595945 下载hue-4.3.0源码包：hue-release-4.3.0.zip https://github.com/cloudera/hue/releases/tag/release-4.3.0 下载依赖： python-simplejson-3.8.2-12.1.x86_64.rpm saslwrapper-0.16-5.el7.x86_64.rpm saslwrapper-devel-0.16-5.el7.x86_64.rpm 安装完毕Ambari集群，下载ambari-hue-service：http://github.com/snakecy/ambari-hue-service git clone https://github.com/snakecy/ambari-hue-service.git hue-release-4.3.0.zip # hue编译环境 yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven yum install -y gcc openssl-devel [root@manager241 tgm]# unzip hue-release-4.3.0.zip [root@manager241 tgm]# mv hue-release-4.3.0 /opt/ [root@manager241 tgm]# cd /opt/ [root@manager241 opt]# mv hue-release-4.3.0 hue-4.3.0 [root@manager241 opt]# cd hue-4.3.0 [root@manager241 hue-4.3.0]# make apps [root@manager241 opt]# touch hue-4.3.0/build/env/bin/replace_py_pwd.py [root@manager241 opt]# cd hue-4.3.0/build/env/bin/ [root@manager241 bin]# vim replace_py_pwd.py import os import re files = os.listdir(&#39;./&#39;) def replaceStr(file): with open(file, &#39;r&#39;) as f: str = f.read() str1 = re.sub(&quot;/opt/hue-4.3.0/build/env/bin/python2.7&quot;, &quot;/usr/local/hue-4.3.0/build/env/bin/python2.7&quot;, str) with open(file, &#39;w&#39;) as f: f.write(str1) for f in files: replaceStr(f) [root@manager241 bin]# chmod +x replace_py_pwd.py [root@manager241 opt]# tar -zcvf hue-4.3.0.tgz hue-4.3.0/ [root@manager241 opt]# mkdir -p /var/www/html/hue [root@manager241 opt]# cp hue-4.3.0.tgz /var/www/html/hue/ [root@manager241 opt]# cd /root/tgm/ [root@manager241 tgm]# cp python-simplejson-3.8.2-12.1.x86_64.rpm /var/www/html/hue/ [root@manager241 tgm]# cp saslwrapper-* /var/www/html/hue/ [root@manager241 tgm]# cd /var/www/html/hue/ [root@manager241 hue]# yum install createrepo -y [root@manager241 hue]# createrepo /var/www/html/hue/ hue-4.3.0-stacks [root@manager241 hue]# cd /var/lib/ambari-server/resources/stacks/HDP/3.0/services/ [root@manager241 services]# mkdir HUE [root@manager241 services]# cd HUE/ [root@manager241 HUE]# touch metainfo.xml [root@manager241 HUE]# chmod +x metainfo.xml # metainfo.xml 内容如下: &lt;?xml version=&quot;1.0&quot;?&gt; &lt;!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. --&gt; &lt;metainfo&gt; &lt;schemaVersion&gt;2.0&lt;/schemaVersion&gt; &lt;services&gt; &lt;service&gt; &lt;name&gt;HUE&lt;/name&gt; &lt;extends&gt;common-services/HUE/4.3.0&lt;/extends&gt; &lt;version&gt;4.3.0&lt;/version&gt; &lt;osSpecifics&gt; &lt;osSpecific&gt; &lt;osFamily&gt;any&lt;/osFamily&gt; &lt;packages&gt; &lt;package&gt;&lt;name&gt;wget&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;tar&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;asciidoc&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;krb5-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libxml2-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libxslt-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;openldap-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-setuptools&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-psycopg2&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;sqlite-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;rsync&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;saslwrapper-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;pycrypto&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;gmp-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libyaml-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-plain&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-gssapi&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libffi-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;MySQL-client&lt;/name&gt;&lt;/package&gt; &lt;/packages&gt; &lt;/osSpecific&gt; &lt;/osSpecifics&gt; &lt;/service&gt; &lt;/services&gt; &lt;/metainfo&gt; hue-4.3.0-common-services [root@manager241 HUE]# cd /var/lib/ambari-server/resources/common-services/ [root@manager241 common-services]# mkdir HUE [root@manager241 tgm]# cp -r ambari-hue-service/ /var/lib/ambari-server/resources/common-services/HUE/ [root@manager241 common-services]# cd HUE/ [root@manager241 HUE]# mv ambari-hue-service 4.3.0 [root@manager241 HUE]# chmod -R +x 4.3.0/ 重启ambari服务-添加Hue服务 [root@manager241 ~]# ambari-server restart [root@manager241 ~]# ambari-agent restart Ambari页面-服务-添加服务-选中hue服务-点击下一步-配置数据库-进行部署 在部署的过程中出现各种问题，问题解决，参考后面“问题修复” 问题修复 问题1：hue_env_python = ’ 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 或者download_url修改为： import commands download_url = commands.getoutput(&#39;cat /etc/yum.repo.d/hue.repo | grep &quot;baseurl&quot; | awk -F= \&#39;{ print $2&quot;hue.tgz&quot;}\&#39;&#39;) 问题2：Failed to execute command ‘/usr/bin/yum -y install saslwrapper-devel’, exited with code ‘1’, message: &#39;Error: Nothing to do 解决： [root@manager241 ~]# cd /etc/yum.repos.d/ [root@manager241 yum.repos.d]# cp centos.repo hue.repo [root@manager241 yum.repos.d]# vim hue.repo [hue] name=hue baseurl=http://10.180.210.241/hue/ gpgcheck=0 enabled=1 [root@manager241 yum.repos.d]# scp hue.repo master241.bigdata:$PWD [root@manager241 yum.repos.d]# scp hue.repo worker241.bigdata:$PWD 问题3：Execution of ‘http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz’ returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py 修改为： 问题4：Execution of ‘cd /usr/local/hue &amp;&amp; make apps’ returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 问题5：/bin/bash: mvn: command not found 解决：问题原因，在hue节点执行make apps时需要maven环境，所以在hue的安装节点需要搭建hue编译的环境 # 搭建maven环境 参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/91375219 # 安装环境 yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven 问题6：/usr/local/hue目录错误 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py 修改为： 问题7：Execution of ‘/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site ‘hive.security.authorization.sqlstd.confwhitelist.append’ ‘hive.server2.logging.operation.verbose’’ returned 1. [ERROR] “hive-site” not found in server response. 解决：遇到这种问题，安装相对应的组件（Hive、Oozie、Hbase、Spark2） 问题8：Execution of ‘cd /user/local/hue &amp;&amp; source ./build/env/bin/activate’ returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/hue_server.py 修改为： 问题9：Configuration parameter ‘java_home’ was not found in configurations dictionary! 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 问题10：hue集成hive时获取hive_server_hosts错误 问题描述： 在hue操作hive的时候，获取不到hive的hiveserver2连接（hive_server_host,hive_server_port） ，手动修改配置文件/usr/local/hue/desktop/conf/pseudo-distributed.ini中有关hive的信息，重启hue时会重置配置文件，使手动配置的hiveserver2信息丢失。 解决： vim /var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/scripts/params.py 修改为： hive_server_hosts = default(&quot;/clusterHostInfo/hive_server_hosts&quot;, []) hive_server_host = config[&#39;clusterHostInfo&#39;][&#39;hive_server_hosts&#39;][0] 问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 404 spark_thriftserver_hosts = default(&quot;/clusterHostInfo/spark_thriftserver_hosts&quot;, []) 405 spark_thriftserver_host = &quot;localhost&quot; 406 spark_hiveserver2_thrift_port = &quot;10002&quot; 407 spark_history_server_url = &#39;&#39; 408 if len(spark_thriftserver_hosts) &gt; 0: 409 spark_thriftserver_host = spark_thriftserver_hosts[0] 410 spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 411 spark_jobhistoryserver_hosts = default(&quot;/clusterHostInfo/spark_jobhistoryserver_hosts&quot;, []) 412 if len(spark_jobhistoryserver_hosts) &gt; 0: 413 spark_history_server_host = spark_jobhistoryserver_hosts[0] 414 else: 415 spark_history_server_host = &quot;localhost&quot; 416 spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark-defaults&#39;][&#39;spark.history.ui.port&#39;] 417 spark_history_server_url = format(&quot;http://{spark_history_server_host}:{spark_history_ui_port}&quot;) 修改为： 403 # configurations of Spark 404 #spark_thriftserver_hosts = default(&quot;/clusterHostInfo/spark_thriftserver_hosts&quot;, []) 405 #spark_thriftserver_host = &quot;localhost&quot; 406 #spark_hiveserver2_thrift_port = &quot;10002&quot; 407 #spark_history_server_url = &#39;&#39; 408 #if len(spark_thriftserver_hosts) &gt; 0: 409 # spark_thriftserver_host = spark_thriftserver_hosts[0] 410 # spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 411 # spark_jobhistoryserver_hosts = default(&quot;/clusterHostInfo/spark_jobhistoryserver_hosts&quot;, []) 412 # if len(spark_jobhistoryserver_hosts) &gt; 0: 413 # spark_history_server_host = spark_jobhistoryserver_hosts[0] 414 # else: 415 # spark_history_server_host = &quot;localhost&quot; 416 # spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark-defaults&#39;][&#39;spark.history.ui.port&#39;] 417 # spark_history_server_url = format(&quot;http://{spark_history_server_host}:{spark_history_ui_port}&quot;) 418 spark_thriftserver_host = default(&quot;/clusterHostInfo/spark2_thriftserver_hosts&quot;, [])[0] 419 spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark2-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 420 spark_jobhistoryserver_host = default(&quot;/clusterHostInfo/spark2_jobhistoryserver_hosts&quot;, [])[0] 421 spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark2-defaults&#39;][&#39;spark.history.ui.port&#39;] 422 spark_history_server_url = format(&quot;http://{spark_jobhistoryserver_host}:{spark_history_ui_port}&quot;) 问题12：Invalid HTTP_HOST header: ‘10.180.210.242:8888’. You may need to add u’10.180.210.242’ to ALLOWED_HOSTS. 解决： vim /usr/local/hue-4.3.0/desktop/core/src/desktop/settings.py 修改为： 问题13：Table ‘hue.auth_user’ doesn’t exist 解决： 登录ambari页面-点击服务选中hue-点击操作-点击Metastoresync，同步数据库 问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误 vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/configuration/hue-desktop-site.xml Ambari页面临时解决： 服务-HUE-配置参数-ADVANCED-高级设置hue-desktop-site Django Debug Mode设置为false 服务-HUE-配置参数-ADVANCED-高级设置pseudo-distributed.ini allowed_hosts={desktop_allowed_hosts} 修改为 allowed_hosts=* 另外如果后期永久修改需要在配置文件中修改解决： 修改为： Hue集成Ambari完毕 代码参考：https://github.com/tgm2018/Hue4.3.0" />
<link rel="canonical" href="https://uzzz.org/2019/08/14/793546.html" />
<meta property="og:url" content="https://uzzz.org/2019/08/14/793546.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-14T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"文章目录 环境搭建 hue-release-4.3.0.zip hue-4.3.0-stacks hue-4.3.0-common-services 重启ambari服务-添加Hue服务 问题修复 问题1：hue_env_python = &#39; 问题2：Failed to execute command &#39;/usr/bin/yum -y install saslwrapper-devel&#39;, exited with code &#39;1&#39;, message: &#39;Error: Nothing to do 问题3：Execution of &#39;http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz&#39; returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory 问题4：Execution of &#39;cd /usr/local/hue &amp;&amp; make apps&#39; returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory 问题5：/bin/bash: mvn: command not found 问题6：/usr/local/hue目录错误 问题7：Execution of &#39;/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site &#39;hive.security.authorization.sqlstd.confwhitelist.append&#39; &#39;hive.server2.logging.operation.verbose&#39;&#39; returned 1. [ERROR] &quot;hive-site&quot; not found in server response. 问题8：Execution of &#39;cd /user/local/hue &amp;&amp; source ./build/env/bin/activate&#39; returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory 问题9：Configuration parameter &#39;java_home&#39; was not found in configurations dictionary! 问题10：hue集成hive时获取hive_server_hosts错误 问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误 问题12：Invalid HTTP_HOST header: &#39;10.180.210.242:8888&#39;. You may need to add u&#39;10.180.210.242&#39; to ALLOWED_HOSTS. 问题13：Table &#39;hue.auth_user&#39; doesn&#39;t exist 问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误 Hue集成Ambari完毕 环境搭建 组件 描述 Ambari 2.7.1 HDP 3.0.1 Hue 4.3.0 Ambari2.7.1集群搭建流程参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/86595945 下载hue-4.3.0源码包：hue-release-4.3.0.zip https://github.com/cloudera/hue/releases/tag/release-4.3.0 下载依赖： python-simplejson-3.8.2-12.1.x86_64.rpm saslwrapper-0.16-5.el7.x86_64.rpm saslwrapper-devel-0.16-5.el7.x86_64.rpm 安装完毕Ambari集群，下载ambari-hue-service：http://github.com/snakecy/ambari-hue-service git clone https://github.com/snakecy/ambari-hue-service.git hue-release-4.3.0.zip # hue编译环境 yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven yum install -y gcc openssl-devel [root@manager241 tgm]# unzip hue-release-4.3.0.zip [root@manager241 tgm]# mv hue-release-4.3.0 /opt/ [root@manager241 tgm]# cd /opt/ [root@manager241 opt]# mv hue-release-4.3.0 hue-4.3.0 [root@manager241 opt]# cd hue-4.3.0 [root@manager241 hue-4.3.0]# make apps [root@manager241 opt]# touch hue-4.3.0/build/env/bin/replace_py_pwd.py [root@manager241 opt]# cd hue-4.3.0/build/env/bin/ [root@manager241 bin]# vim replace_py_pwd.py import os import re files = os.listdir(&#39;./&#39;) def replaceStr(file): with open(file, &#39;r&#39;) as f: str = f.read() str1 = re.sub(&quot;/opt/hue-4.3.0/build/env/bin/python2.7&quot;, &quot;/usr/local/hue-4.3.0/build/env/bin/python2.7&quot;, str) with open(file, &#39;w&#39;) as f: f.write(str1) for f in files: replaceStr(f) [root@manager241 bin]# chmod +x replace_py_pwd.py [root@manager241 opt]# tar -zcvf hue-4.3.0.tgz hue-4.3.0/ [root@manager241 opt]# mkdir -p /var/www/html/hue [root@manager241 opt]# cp hue-4.3.0.tgz /var/www/html/hue/ [root@manager241 opt]# cd /root/tgm/ [root@manager241 tgm]# cp python-simplejson-3.8.2-12.1.x86_64.rpm /var/www/html/hue/ [root@manager241 tgm]# cp saslwrapper-* /var/www/html/hue/ [root@manager241 tgm]# cd /var/www/html/hue/ [root@manager241 hue]# yum install createrepo -y [root@manager241 hue]# createrepo /var/www/html/hue/ hue-4.3.0-stacks [root@manager241 hue]# cd /var/lib/ambari-server/resources/stacks/HDP/3.0/services/ [root@manager241 services]# mkdir HUE [root@manager241 services]# cd HUE/ [root@manager241 HUE]# touch metainfo.xml [root@manager241 HUE]# chmod +x metainfo.xml # metainfo.xml 内容如下: &lt;?xml version=&quot;1.0&quot;?&gt; &lt;!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. --&gt; &lt;metainfo&gt; &lt;schemaVersion&gt;2.0&lt;/schemaVersion&gt; &lt;services&gt; &lt;service&gt; &lt;name&gt;HUE&lt;/name&gt; &lt;extends&gt;common-services/HUE/4.3.0&lt;/extends&gt; &lt;version&gt;4.3.0&lt;/version&gt; &lt;osSpecifics&gt; &lt;osSpecific&gt; &lt;osFamily&gt;any&lt;/osFamily&gt; &lt;packages&gt; &lt;package&gt;&lt;name&gt;wget&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;tar&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;asciidoc&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;krb5-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libxml2-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libxslt-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;openldap-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-setuptools&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;python-psycopg2&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;sqlite-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;rsync&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;saslwrapper-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;pycrypto&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;gmp-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libyaml-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-plain&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;cyrus-sasl-gssapi&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;libffi-devel&lt;/name&gt;&lt;/package&gt; &lt;package&gt;&lt;name&gt;MySQL-client&lt;/name&gt;&lt;/package&gt; &lt;/packages&gt; &lt;/osSpecific&gt; &lt;/osSpecifics&gt; &lt;/service&gt; &lt;/services&gt; &lt;/metainfo&gt; hue-4.3.0-common-services [root@manager241 HUE]# cd /var/lib/ambari-server/resources/common-services/ [root@manager241 common-services]# mkdir HUE [root@manager241 tgm]# cp -r ambari-hue-service/ /var/lib/ambari-server/resources/common-services/HUE/ [root@manager241 common-services]# cd HUE/ [root@manager241 HUE]# mv ambari-hue-service 4.3.0 [root@manager241 HUE]# chmod -R +x 4.3.0/ 重启ambari服务-添加Hue服务 [root@manager241 ~]# ambari-server restart [root@manager241 ~]# ambari-agent restart Ambari页面-服务-添加服务-选中hue服务-点击下一步-配置数据库-进行部署 在部署的过程中出现各种问题，问题解决，参考后面“问题修复” 问题修复 问题1：hue_env_python = ’ 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 或者download_url修改为： import commands download_url = commands.getoutput(&#39;cat /etc/yum.repo.d/hue.repo | grep &quot;baseurl&quot; | awk -F= \\&#39;{ print $2&quot;hue.tgz&quot;}\\&#39;&#39;) 问题2：Failed to execute command ‘/usr/bin/yum -y install saslwrapper-devel’, exited with code ‘1’, message: &#39;Error: Nothing to do 解决： [root@manager241 ~]# cd /etc/yum.repos.d/ [root@manager241 yum.repos.d]# cp centos.repo hue.repo [root@manager241 yum.repos.d]# vim hue.repo [hue] name=hue baseurl=http://10.180.210.241/hue/ gpgcheck=0 enabled=1 [root@manager241 yum.repos.d]# scp hue.repo master241.bigdata:$PWD [root@manager241 yum.repos.d]# scp hue.repo worker241.bigdata:$PWD 问题3：Execution of ‘http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz’ returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py 修改为： 问题4：Execution of ‘cd /usr/local/hue &amp;&amp; make apps’ returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 问题5：/bin/bash: mvn: command not found 解决：问题原因，在hue节点执行make apps时需要maven环境，所以在hue的安装节点需要搭建hue编译的环境 # 搭建maven环境 参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/91375219 # 安装环境 yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven 问题6：/usr/local/hue目录错误 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py 修改为： 问题7：Execution of ‘/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site ‘hive.security.authorization.sqlstd.confwhitelist.append’ ‘hive.server2.logging.operation.verbose’’ returned 1. [ERROR] “hive-site” not found in server response. 解决：遇到这种问题，安装相对应的组件（Hive、Oozie、Hbase、Spark2） 问题8：Execution of ‘cd /user/local/hue &amp;&amp; source ./build/env/bin/activate’ returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/hue_server.py 修改为： 问题9：Configuration parameter ‘java_home’ was not found in configurations dictionary! 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 修改为： 问题10：hue集成hive时获取hive_server_hosts错误 问题描述： 在hue操作hive的时候，获取不到hive的hiveserver2连接（hive_server_host,hive_server_port） ，手动修改配置文件/usr/local/hue/desktop/conf/pseudo-distributed.ini中有关hive的信息，重启hue时会重置配置文件，使手动配置的hiveserver2信息丢失。 解决： vim /var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/scripts/params.py 修改为： hive_server_hosts = default(&quot;/clusterHostInfo/hive_server_hosts&quot;, []) hive_server_host = config[&#39;clusterHostInfo&#39;][&#39;hive_server_hosts&#39;][0] 问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误 解决： vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py 404 spark_thriftserver_hosts = default(&quot;/clusterHostInfo/spark_thriftserver_hosts&quot;, []) 405 spark_thriftserver_host = &quot;localhost&quot; 406 spark_hiveserver2_thrift_port = &quot;10002&quot; 407 spark_history_server_url = &#39;&#39; 408 if len(spark_thriftserver_hosts) &gt; 0: 409 spark_thriftserver_host = spark_thriftserver_hosts[0] 410 spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 411 spark_jobhistoryserver_hosts = default(&quot;/clusterHostInfo/spark_jobhistoryserver_hosts&quot;, []) 412 if len(spark_jobhistoryserver_hosts) &gt; 0: 413 spark_history_server_host = spark_jobhistoryserver_hosts[0] 414 else: 415 spark_history_server_host = &quot;localhost&quot; 416 spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark-defaults&#39;][&#39;spark.history.ui.port&#39;] 417 spark_history_server_url = format(&quot;http://{spark_history_server_host}:{spark_history_ui_port}&quot;) 修改为： 403 # configurations of Spark 404 #spark_thriftserver_hosts = default(&quot;/clusterHostInfo/spark_thriftserver_hosts&quot;, []) 405 #spark_thriftserver_host = &quot;localhost&quot; 406 #spark_hiveserver2_thrift_port = &quot;10002&quot; 407 #spark_history_server_url = &#39;&#39; 408 #if len(spark_thriftserver_hosts) &gt; 0: 409 # spark_thriftserver_host = spark_thriftserver_hosts[0] 410 # spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 411 # spark_jobhistoryserver_hosts = default(&quot;/clusterHostInfo/spark_jobhistoryserver_hosts&quot;, []) 412 # if len(spark_jobhistoryserver_hosts) &gt; 0: 413 # spark_history_server_host = spark_jobhistoryserver_hosts[0] 414 # else: 415 # spark_history_server_host = &quot;localhost&quot; 416 # spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark-defaults&#39;][&#39;spark.history.ui.port&#39;] 417 # spark_history_server_url = format(&quot;http://{spark_history_server_host}:{spark_history_ui_port}&quot;) 418 spark_thriftserver_host = default(&quot;/clusterHostInfo/spark2_thriftserver_hosts&quot;, [])[0] 419 spark_hiveserver2_thrift_port = str(config[&#39;configurations&#39;][&#39;spark2-hive-site-override&#39;][&#39;hive.server2.thrift.port&#39;]).strip() 420 spark_jobhistoryserver_host = default(&quot;/clusterHostInfo/spark2_jobhistoryserver_hosts&quot;, [])[0] 421 spark_history_ui_port = config[&#39;configurations&#39;][&#39;spark2-defaults&#39;][&#39;spark.history.ui.port&#39;] 422 spark_history_server_url = format(&quot;http://{spark_jobhistoryserver_host}:{spark_history_ui_port}&quot;) 问题12：Invalid HTTP_HOST header: ‘10.180.210.242:8888’. You may need to add u’10.180.210.242’ to ALLOWED_HOSTS. 解决： vim /usr/local/hue-4.3.0/desktop/core/src/desktop/settings.py 修改为： 问题13：Table ‘hue.auth_user’ doesn’t exist 解决： 登录ambari页面-点击服务选中hue-点击操作-点击Metastoresync，同步数据库 问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误 vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/configuration/hue-desktop-site.xml Ambari页面临时解决： 服务-HUE-配置参数-ADVANCED-高级设置hue-desktop-site Django Debug Mode设置为false 服务-HUE-配置参数-ADVANCED-高级设置pseudo-distributed.ini allowed_hosts={desktop_allowed_hosts} 修改为 allowed_hosts=* 另外如果后期永久修改需要在配置文件中修改解决： 修改为： Hue集成Ambari完毕 代码参考：https://github.com/tgm2018/Hue4.3.0","@type":"BlogPosting","url":"https://uzzz.org/2019/08/14/793546.html","headline":"Hue-release-4.3.0集成Ambari2.7.3","dateModified":"2019-08-14T00:00:00+08:00","datePublished":"2019-08-14T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/08/14/793546.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>Hue-release-4.3.0集成Ambari2.7.3</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <p></p>
  <div class="toc">
   <h3>文章目录</h3>
   <ul>
    <li><a href="#_1" rel="nofollow" data-token="8a30654a115283081dff09f9c63581c5">环境搭建</a></li>
    <li><a href="#huerelease430zip_22" rel="nofollow" data-token="51cef6a2daf57ccde3a3e9ee08c25ae5">hue-release-4.3.0.zip</a></li>
    <li><a href="#hue430stacks_73" rel="nofollow" data-token="e454e9d89468b99932cd22332e41f84d">hue-4.3.0-stacks</a></li>
    <li><a href="#hue430commonservices_140" rel="nofollow" data-token="8a9b9f4f4664e8a6e5592d070e8d2403">hue-4.3.0-common-services</a></li>
    <li><a href="#ambariHue_150" rel="nofollow" data-token="7b0d893c9d92536623e13080c8da8282">重启ambari服务-添加Hue服务</a></li>
    <li><a href="#_159" rel="nofollow" data-token="ebdbe034faadd568d7f54bba2d63d49a">问题修复</a></li>
    <ul>
     <li><a href="#1hue_env_python___160" rel="nofollow" data-token="7f6fdcf1d1e8b95a29c61912c4b4d1a1">问题1：hue_env_python = '</a></li>
     <li><a href="#2Failed_to_execute_command_usrbinyum_y_install_saslwrapperdevel_exited_with_code_1_message_Error_Nothing_to_do_174" rel="nofollow" data-token="b4672dedfc4071bd508e5db8659010de">问题2：Failed to execute command '/usr/bin/yum -y install saslwrapper-devel', exited with code '1', message: 'Error: Nothing to do</a></li>
     <li><a href="#3Execution_of_http10180210241huehue430tgz__xargs_wget_O_huetgz_returned_123_binbash_http10180210241huehue430tgz_No_such_file_or_directory_191" rel="nofollow" data-token="82e292227b749ae156807d0093f1d949">问题3：Execution of 'http://10.180.210.241/hue/hue-4.3.0.tgz | xargs wget -O hue.tgz' returned 123. /bin/bash: http://10.180.210.241/hue/hue-4.3.0.tgz: No such file or directory</a></li>
     <li><a href="#4Execution_of_cd_usrlocalhue__make_apps_returned_1_binbash_line_0_cd_usrlocalhue_No_such_file_or_directory_198" rel="nofollow" data-token="b6b608b0c6d9a1c6ecd953a3e2473bc2">问题4：Execution of 'cd /usr/local/hue &amp;&amp; make apps' returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory</a></li>
     <li><a href="#5binbash_mvn_command_not_found_205" rel="nofollow" data-token="03d81b36af239f247984271562c462dc">问题5：/bin/bash: mvn: command not found</a></li>
     <li><a href="#6usrlocalhue_216" rel="nofollow" data-token="039fa05dbeb05d18f7ff7e71c18a4c5f">问题6：/usr/local/hue目录错误</a></li>
     <li><a href="#7Execution_of_varlibambariagentcachecommonservicesHUE430packagefilesconfigssh_set_manager241bigdata_HD45_hivesite_hivesecurityauthorizationsqlstdconfwhitelistappend_hiveserver2loggingoperationverbose_returned_1_ERROR_hivesite_not_found_in_server_response_223" rel="nofollow" data-token="a93492952a41fb221f73f1bdb26b5f8f">问题7：Execution of '/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site 'hive.security.authorization.sqlstd.confwhitelist.append' 'hive.server2.logging.operation.verbose'' returned 1. [ERROR] "hive-site" not found in server response.</a></li>
     <li><a href="#8Execution_of_cd_userlocalhue__source_buildenvbinactivate_returned_1_binbash_line_0_cd_userlocalhue_No_such_file_or_directory_226" rel="nofollow" data-token="72bc3a9cbba155c61a036a70fdfe5a6d">问题8：Execution of 'cd /user/local/hue &amp;&amp; source ./build/env/bin/activate' returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory</a></li>
     <li><a href="#9Configuration_parameter_java_home_was_not_found_in_configurations_dictionary_233" rel="nofollow" data-token="fe653a75a1bf51befde637102b228ac6">问题9：Configuration parameter 'java_home' was not found in configurations dictionary!</a></li>
     <li><a href="#10huehivehive_server_hosts_240" rel="nofollow" data-token="5235da965588549c063aff6e762eb504">问题10：hue集成hive时获取hive_server_hosts错误</a></li>
     <li><a href="#11huespark_sqlsql_server_hostsql_server_port_253" rel="nofollow" data-token="8eac8c0f8c021b55a7888abf45e1472a">问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误</a></li>
     <li><a href="#12Invalid_HTTP_HOST_header_101802102428888_You_may_need_to_add_u10180210242_to_ALLOWED_HOSTS_297" rel="nofollow" data-token="59feb65034fcade454079ec45c5ff167">问题12：Invalid HTTP_HOST header: '10.180.210.242:8888'. You may need to add u'10.180.210.242' to ALLOWED_HOSTS.</a></li>
     <li><a href="#13Table_hueauth_user_doesnt_exist_304" rel="nofollow" data-token="161850aa612319ad005504f0dac3420b">问题13：Table 'hue.auth_user' doesn't exist</a></li>
     <li><a href="#14Debug404_308" rel="nofollow" data-token="746910e11b45bf00d8365e2bed57ffc9">问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误</a></li>
    </ul>
    <li><a href="#HueAmbari_323" rel="nofollow" data-token="b2b0d6a1ebec7bab623e8ee9383984f9">Hue集成Ambari完毕</a></li>
   </ul>
  </div>
  <p></p> 
  <h1><a id="_1"></a>环境搭建</h1> 
  <table> 
   <thead> 
    <tr> 
     <th>组件</th> 
     <th>描述</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>Ambari</td> 
     <td>2.7.1</td> 
    </tr> 
    <tr> 
     <td>HDP</td> 
     <td>3.0.1</td> 
    </tr> 
    <tr> 
     <td>Hue</td> 
     <td>4.3.0</td> 
    </tr> 
   </tbody> 
  </table>
  <ul> 
   <li>Ambari2.7.1集群搭建流程参考：<a href="https://blog.csdn.net/Happy_Sunshine_Boy/article/details/86595945" rel="nofollow">https://blog.csdn.net/Happy_Sunshine_Boy/article/details/86595945</a></li> 
   <li>下载hue-4.3.0源码包：hue-release-4.3.0.zip 
    <ul> 
     <li><a href="https://github.com/cloudera/hue/releases/tag/release-4.3.0" rel="nofollow" data-token="fd01942fd9e790f174554fd817ed9e0b">https://github.com/cloudera/hue/releases/tag/release-4.3.0</a></li> 
    </ul> </li> 
   <li>下载依赖：</li> 
  </ul> 
  <pre><code class="prism language-shell">python-simplejson-3.8.2-12.1.x86_64.rpm
saslwrapper-0.16-5.el7.x86_64.rpm
saslwrapper-devel-0.16-5.el7.x86_64.rpm
</code></pre> 
  <ul> 
   <li>安装完毕Ambari集群，下载ambari-hue-service：<a href="http://github.com/snakecy/ambari-hue-service" rel="nofollow" data-token="f156ff56629c1e89375ab8afcf54be7e">http://github.com/snakecy/ambari-hue-service</a></li> 
  </ul> 
  <pre><code class="prism language-shell"><span class="token function">git</span> clone https://github.com/snakecy/ambari-hue-service.git

</code></pre> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717091146242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h1><a id="huerelease430zip_22"></a>hue-release-4.3.0.zip</h1> 
  <pre><code class="prism language-shell"><span class="token comment"># hue编译环境</span>
yum <span class="token function">install</span> -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel <span class="token function">make</span>  mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven
yum <span class="token function">install</span> -y gcc openssl-devel

</code></pre> 
  <pre><code class="prism language-linux">[root@manager241 tgm]# unzip hue-release-4.3.0.zip
[root@manager241 tgm]# mv hue-release-4.3.0 /opt/
[root@manager241 tgm]# cd /opt/
[root@manager241 opt]# mv hue-release-4.3.0 hue-4.3.0
[root@manager241 opt]# cd hue-4.3.0
[root@manager241 hue-4.3.0]# make apps

</code></pre> 
  <pre><code class="prism language-python"><span class="token punctuation">[</span>root@manager241 opt<span class="token punctuation">]</span><span class="token comment"># touch hue-4.3.0/build/env/bin/replace_py_pwd.py</span>
<span class="token punctuation">[</span>root@manager241 opt<span class="token punctuation">]</span><span class="token comment"># cd hue-4.3.0/build/env/bin/</span>
<span class="token punctuation">[</span>root@manager241 <span class="token builtin">bin</span><span class="token punctuation">]</span><span class="token comment"># vim replace_py_pwd.py</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> re

files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">replaceStr</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token builtin">str</span> <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        str1 <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"/opt/hue-4.3.0/build/env/bin/python2.7"</span><span class="token punctuation">,</span> <span class="token string">"/usr/local/hue-4.3.0/build/env/bin/python2.7"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str1<span class="token punctuation">)</span>

<span class="token keyword">for</span> f <span class="token keyword">in</span> files<span class="token punctuation">:</span>
    replaceStr<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@manager241 <span class="token builtin">bin</span><span class="token punctuation">]</span><span class="token comment"># chmod +x replace_py_pwd.py</span>
</code></pre> 
  <pre><code class="prism language-linux">[root@manager241 opt]# tar -zcvf hue-4.3.0.tgz hue-4.3.0/

[root@manager241 opt]# mkdir -p /var/www/html/hue
[root@manager241 opt]# cp hue-4.3.0.tgz /var/www/html/hue/

[root@manager241 opt]# cd /root/tgm/
[root@manager241 tgm]# cp python-simplejson-3.8.2-12.1.x86_64.rpm /var/www/html/hue/
[root@manager241 tgm]# cp saslwrapper-* /var/www/html/hue/

[root@manager241 tgm]# cd /var/www/html/hue/
[root@manager241 hue]# yum install createrepo -y
[root@manager241 hue]# createrepo /var/www/html/hue/

</code></pre> 
  <h1><a id="hue430stacks_73"></a>hue-4.3.0-stacks</h1> 
  <pre><code class="prism language-xml">[root@manager241 hue]# cd /var/lib/ambari-server/resources/stacks/HDP/3.0/services/
[root@manager241 services]# mkdir HUE
[root@manager241 services]# cd HUE/
[root@manager241 HUE]# touch metainfo.xml
[root@manager241 HUE]# chmod +x metainfo.xml
#  metainfo.xml 内容如下:
<span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token comment">&lt;!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>metainfo</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schemaVersion</span><span class="token punctuation">&gt;</span></span>2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schemaVersion</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>services</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>HUE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>extends</span><span class="token punctuation">&gt;</span></span>common-services/HUE/4.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>extends</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>osSpecifics</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>osSpecific</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>osFamily</span><span class="token punctuation">&gt;</span></span>any<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>osFamily</span><span class="token punctuation">&gt;</span></span>
	  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packages</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>wget<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>   
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>tar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>asciidoc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>krb5-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>libxml2-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>libxslt-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>		   
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>openldap-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>python-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>python-setuptools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
          	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>python-psycopg2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>sqlite-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>rsync<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>saslwrapper-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>pycrypto<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>gmp-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>libyaml-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>cyrus-sasl-plain<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>cyrus-sasl-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>cyrus-sasl-gssapi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>libffi-devel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
          	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>MySQL-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packages</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>osSpecific</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>osSpecifics</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>services</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>metainfo</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
  <h1><a id="hue430commonservices_140"></a>hue-4.3.0-common-services</h1> 
  <pre><code class="prism language-linux">[root@manager241 HUE]# cd /var/lib/ambari-server/resources/common-services/
[root@manager241 common-services]# mkdir HUE
[root@manager241 tgm]# cp -r ambari-hue-service/ /var/lib/ambari-server/resources/common-services/HUE/
[root@manager241 common-services]# cd HUE/
[root@manager241 HUE]# mv ambari-hue-service 4.3.0
[root@manager241 HUE]# chmod -R +x 4.3.0/

</code></pre> 
  <h1><a id="ambariHue_150"></a>重启ambari服务-添加Hue服务</h1> 
  <pre><code class="prism language-linux">[root@manager241 ~]# ambari-server restart
[root@manager241 ~]# ambari-agent restart

Ambari页面-服务-添加服务-选中hue服务-点击下一步-配置数据库-进行部署
在部署的过程中出现各种问题，问题解决，参考后面“问题修复”
</code></pre> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717103758973.png" alt="在这里插入图片描述"></p> 
  <h1><a id="_159"></a>问题修复</h1> 
  <h2><a id="1hue_env_python___160"></a>问题1：hue_env_python = ’</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717104253160.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：</li> 
  </ul> 
  <p>vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py<img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717104456138.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717104648335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>或者download_url修改为：</li> 
  </ul> 
  <pre><code class="prism language-python"><span class="token keyword">import</span> commands

download_url <span class="token operator">=</span> commands<span class="token punctuation">.</span>getoutput<span class="token punctuation">(</span><span class="token string">'cat /etc/yum.repo.d/hue.repo | grep "baseurl" | awk -F= \'{ print $2"hue.tgz"}\''</span><span class="token punctuation">)</span>

</code></pre> 
  <h2><a id="2Failed_to_execute_command_usrbinyum_y_install_saslwrapperdevel_exited_with_code_1_message_Error_Nothing_to_do_174"></a>问题2：Failed to execute command ‘/usr/bin/yum -y install saslwrapper-devel’, exited with code ‘1’, message: 'Error: Nothing to do</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717105316746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：</li> 
  </ul> 
  <pre><code class="prism language-linux">[root@manager241 ~]# cd /etc/yum.repos.d/
[root@manager241 yum.repos.d]# cp centos.repo hue.repo
[root@manager241 yum.repos.d]# vim hue.repo
[hue]
name=hue
baseurl=http://10.180.210.241/hue/
gpgcheck=0
enabled=1

[root@manager241 yum.repos.d]# scp hue.repo master241.bigdata:$PWD
[root@manager241 yum.repos.d]# scp hue.repo worker241.bigdata:$PWD

</code></pre> 
  <h2><a id="3Execution_of_http10180210241huehue430tgz__xargs_wget_O_huetgz_returned_123_binbash_http10180210241huehue430tgz_No_such_file_or_directory_191"></a>问题3：Execution of ‘<a href="http://10.180.210.241/hue/hue-4.3.0.tgz" rel="nofollow" data-token="d6b6caf36fba2ef8ade58c12cfa23af3">http://10.180.210.241/hue/hue-4.3.0.tgz</a> | xargs wget -O hue.tgz’ returned 123. /bin/bash: <a href="http://10.180.210.241/hue/hue-4.3.0.tgz:" rel="nofollow" data-token="204a00cefc6bf0defc53e6d8a5d369de">http://10.180.210.241/hue/hue-4.3.0.tgz:</a> No such file or directory</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717110103123.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717110324119.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190724091902607.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
  </ul> 
  <h2><a id="4Execution_of_cd_usrlocalhue__make_apps_returned_1_binbash_line_0_cd_usrlocalhue_No_such_file_or_directory_198"></a>问题4：Execution of ‘cd /usr/local/hue &amp;&amp; make apps’ returned 1. /bin/bash: line 0: cd: /usr/local/hue: No such file or directory</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717111038824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717111319862.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717111357965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
  </ul> 
  <h2><a id="5binbash_mvn_command_not_found_205"></a>问题5：/bin/bash: mvn: command not found</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/201907171117096.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：问题原因，在hue节点执行make apps时需要maven环境，所以在hue的安装节点需要搭建hue编译的环境</li> 
  </ul> 
  <pre><code class="prism language-linux"># 搭建maven环境
参考：https://blog.csdn.net/Happy_Sunshine_Boy/article/details/91375219

# 安装环境
yum install -y ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi cyrus-sasl-plain gcc gcc-c++ krb5-devel libffi-devel libxml2-devel libxslt-devel make  mysql mysql-devel openldap-devel python-devel sqlite-devel gmp-devel libtidy maven

</code></pre> 
  <h2><a id="6usrlocalhue_216"></a>问题6：/usr/local/hue目录错误</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717121706657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/common.py<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717121807578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717121903409.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
  </ul> 
  <h2><a id="7Execution_of_varlibambariagentcachecommonservicesHUE430packagefilesconfigssh_set_manager241bigdata_HD45_hivesite_hivesecurityauthorizationsqlstdconfwhitelistappend_hiveserver2loggingoperationverbose_returned_1_ERROR_hivesite_not_found_in_server_response_223"></a>问题7：Execution of ‘/var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/files/configs.sh set manager241.bigdata HD45 hive-site ‘hive.security.authorization.sqlstd.confwhitelist.append’ ‘hive.server2.logging.operation.verbose’’ returned 1. [ERROR] “hive-site” not found in server response.</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717122448623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：遇到这种问题，安装相对应的组件（Hive、Oozie、Hbase、Spark2）</li> 
  </ul> 
  <h2><a id="8Execution_of_cd_userlocalhue__source_buildenvbinactivate_returned_1_binbash_line_0_cd_userlocalhue_No_such_file_or_directory_226"></a>问题8：Execution of ‘cd /user/local/hue &amp;&amp; source ./build/env/bin/activate’ returned 1. /bin/bash: line 0: cd: /user/local/hue: No such file or directory</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717135235362.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/hue_server.py<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717135357349.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019071713545767.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
  </ul> 
  <h2><a id="9Configuration_parameter_java_home_was_not_found_in_configurations_dictionary_233"></a>问题9：Configuration parameter ‘java_home’ was not found in configurations dictionary!</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717135757360.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717135920344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717140024208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
  </ul> 
  <h2><a id="10huehivehive_server_hosts_240"></a>问题10：hue集成hive时获取hive_server_hosts错误</h2> 
  <pre><code class="prism language-shell">问题描述：
	在hue操作hive的时候，获取不到hive的hiveserver2连接（hive_server_host,hive_server_port）
，手动修改配置文件/usr/local/hue/desktop/conf/pseudo-distributed.ini中有关hive的信息，重启hue时会重置配置文件，使手动配置的hiveserver2信息丢失。
解决：
vim /var/lib/ambari-agent/cache/common-services/HUE/4.3.0/package/scripts/params.py
修改为：
hive_server_hosts <span class="token operator">=</span>  default<span class="token punctuation">(</span><span class="token string">"/clusterHostInfo/hive_server_hosts"</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
hive_server_host <span class="token operator">=</span> config<span class="token punctuation">[</span><span class="token string">'clusterHostInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'hive_server_hosts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span>

</code></pre> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190813202457534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="11huespark_sqlsql_server_hostsql_server_port_253"></a>问题11：hue集成spark_sql时报错获取sql_server_host,sql_server_port错误</h2> 
  <pre><code class="prism language-shell">解决：
vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/package/scripts/params.py

404 spark_thriftserver_hosts <span class="token operator">=</span> default<span class="token punctuation">(</span><span class="token string">"/clusterHostInfo/spark_thriftserver_hosts"</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
405 spark_thriftserver_host <span class="token operator">=</span> <span class="token string">"localhost"</span>
406 spark_hiveserver2_thrift_port <span class="token operator">=</span> <span class="token string">"10002"</span>
407 spark_history_server_url <span class="token operator">=</span> <span class="token string">''</span>
408 <span class="token keyword">if</span> len<span class="token punctuation">(</span>spark_thriftserver_hosts<span class="token punctuation">)</span> <span class="token operator">&gt;</span> 0:
409   spark_thriftserver_host <span class="token operator">=</span> spark_thriftserver_hosts<span class="token punctuation">[</span>0<span class="token punctuation">]</span>
410   spark_hiveserver2_thrift_port <span class="token operator">=</span> str<span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'configurations'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'spark-hive-site-override'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'hive.server2.thrift.port'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
411   spark_jobhistoryserver_hosts <span class="token operator">=</span> default<span class="token punctuation">(</span><span class="token string">"/clusterHostInfo/spark_jobhistoryserver_hosts"</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
412   <span class="token keyword">if</span> len<span class="token punctuation">(</span>spark_jobhistoryserver_hosts<span class="token punctuation">)</span> <span class="token operator">&gt;</span> 0:
413     spark_history_server_host <span class="token operator">=</span> spark_jobhistoryserver_hosts<span class="token punctuation">[</span>0<span class="token punctuation">]</span>
414   else:
415     spark_history_server_host <span class="token operator">=</span> <span class="token string">"localhost"</span>
416   spark_history_ui_port <span class="token operator">=</span> config<span class="token punctuation">[</span><span class="token string">'configurations'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'spark-defaults'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'spark.history.ui.port'</span><span class="token punctuation">]</span>
417   spark_history_server_url <span class="token operator">=</span> format<span class="token punctuation">(</span><span class="token string">"http://{spark_history_server_host}:{spark_history_ui_port}"</span><span class="token punctuation">)</span>

修改为：
403 <span class="token comment"># configurations of Spark</span>
404 <span class="token comment">#spark_thriftserver_hosts = default("/clusterHostInfo/spark_thriftserver_hosts", [])</span>
405 <span class="token comment">#spark_thriftserver_host = "localhost"</span>
406 <span class="token comment">#spark_hiveserver2_thrift_port = "10002"</span>
407 <span class="token comment">#spark_history_server_url = ''</span>
408 <span class="token comment">#if len(spark_thriftserver_hosts) &gt; 0:</span>
409 <span class="token comment"># spark_thriftserver_host = spark_thriftserver_hosts[0]</span>
410 <span class="token comment"># spark_hiveserver2_thrift_port = str(config['configurations']['spark-hive-site-override']['hive.server2.thrift.port']).strip()</span>
411 <span class="token comment"># spark_jobhistoryserver_hosts = default("/clusterHostInfo/spark_jobhistoryserver_hosts", [])</span>
412 <span class="token comment"># if len(spark_jobhistoryserver_hosts) &gt; 0:</span>
413 <span class="token comment"># spark_history_server_host = spark_jobhistoryserver_hosts[0]</span>
414 <span class="token comment"># else:</span>
415 <span class="token comment"># spark_history_server_host = "localhost"</span>
416 <span class="token comment"># spark_history_ui_port = config['configurations']['spark-defaults']['spark.history.ui.port']</span>
417 <span class="token comment"># spark_history_server_url = format("http://{spark_history_server_host}:{spark_history_ui_port}")</span>
418 spark_thriftserver_host <span class="token operator">=</span> default<span class="token punctuation">(</span><span class="token string">"/clusterHostInfo/spark2_thriftserver_hosts"</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span>
419 spark_hiveserver2_thrift_port <span class="token operator">=</span> str<span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'configurations'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'spark2-hive-site-override'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'hive.server2.thrift.port'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
420 spark_jobhistoryserver_host <span class="token operator">=</span> default<span class="token punctuation">(</span><span class="token string">"/clusterHostInfo/spark2_jobhistoryserver_hosts"</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span>
421 spark_history_ui_port <span class="token operator">=</span> config<span class="token punctuation">[</span><span class="token string">'configurations'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'spark2-defaults'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'spark.history.ui.port'</span><span class="token punctuation">]</span>
422 spark_history_server_url <span class="token operator">=</span> format<span class="token punctuation">(</span><span class="token string">"http://{spark_jobhistoryserver_host}:{spark_history_ui_port}"</span><span class="token punctuation">)</span>

</code></pre> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190814091252870.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="12Invalid_HTTP_HOST_header_101802102428888_You_may_need_to_add_u10180210242_to_ALLOWED_HOSTS_297"></a>问题12：Invalid HTTP_HOST header: ‘10.180.210.242:8888’. You may need to add u’10.180.210.242’ to ALLOWED_HOSTS.</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717140245425.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> vim /usr/local/hue-4.3.0/desktop/core/src/desktop/settings.py<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717140430535.png" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717140509525.png" alt="在这里插入图片描述"></li> 
  </ul> 
  <h2><a id="13Table_hueauth_user_doesnt_exist_304"></a>问题13：Table ‘hue.auth_user’ doesn’t exist</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717140658230.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <ul> 
   <li>解决：<br> 登录ambari页面-点击服务选中hue-点击操作-点击Metastoresync，同步数据库</li> 
  </ul> 
  <h2><a id="14Debug404_308"></a>问题14：访问不存在的接口出现Debug错误信息，不显示404页面错误</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190719161437787.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> vim /var/lib/ambari-server/resources/common-services/HUE/4.3.0/configuration/hue-desktop-site.xml</p> 
  <ul> 
   <li>Ambari页面临时解决：</li> 
  </ul> 
  <ol> 
   <li>服务-HUE-配置参数-ADVANCED-高级设置hue-desktop-site<br> Django Debug Mode设置为false</li> 
   <li>服务-HUE-配置参数-ADVANCED-高级设置pseudo-distributed.ini<br> allowed_hosts={desktop_allowed_hosts}<br> 修改为<br> allowed_hosts=*</li> 
  </ol> 
  <ul> 
   <li>另外如果后期永久修改需要在配置文件中修改解决：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190719155714941.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>修改为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190719155751946.png" alt="在这里插入图片描述"></li> 
  </ul> 
  <h1><a id="HueAmbari_323"></a>Hue集成Ambari完毕</h1> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190717141135437.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hhcHB5X1N1bnNoaW5lX0JveQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 代码参考：<a href="https://github.com/tgm2018/Hue4.3.0" rel="nofollow" data-token="34a078de415aee78e2c3a8c0389f1dee">https://github.com/tgm2018/Hue4.3.0</a></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
