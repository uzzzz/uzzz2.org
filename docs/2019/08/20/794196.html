<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>网络结构搜索之梯度可微 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="网络结构搜索之梯度可微" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="前面介绍了强化学习方法，但屠龙刀毕竟不是人人有。梯度可微算法在保证精度可接受的前提下大幅缩短了训练周期，开启了网络结构搜索的平民化浪潮。 MobileNetV2 FBNet ShiftNet Gumbel-Softmax SNAS DARTS ProxylessNAS P-DARTS PC-DARTS DenseNAS DARTS DARTS 由 CMU 和 DeepMind 提出，最终发表在 ICLR 2019上。DARTS 在有限资源条件下将模型精度提升到可接受的程度，而且开放代码（quark0/darts）。可谓 NAS 领域内的一大贡献。美中不足的是代码仅在单 GPU 下搜索，以至于后续的 chenxin061/pdarts 和 yuhuixu1993/PC-DARTS 亦维持此设置，成为扩展的阻碍。 DARTS 将搜索空间放宽为连续的，以便可以通过梯度下降来优化体系结构的验证集性能。在所有混合操作中联合学习架构 α \alpha α 和权重 w w w。这意味着一个双层优化问题，其中 α \alpha α 作为上层变量， w w w 作为下层变量： min ⁡ α L v a l ( w ∗ ( α ) , α ) s.t. w ∗ ( α ) = a r g m i n w L t r a i n ( w , α ) \begin{aligned} \min_\alpha \quad &amp;amp; \mathcal{L}_{val}(w^*(\alpha), \alpha) \\ \text{s.t.} \quad &amp;amp;w^*(\alpha) = \mathrm{argmin}_w \enspace \mathcal{L}_{train}(w, \alpha) \end{aligned} αmin​s.t.​Lval​(w∗(α),α)w∗(α)=argminw​Ltrain​(w,α)​ DARTS 求结构梯度的近似解： ∇ α L v a l ( w ∗ ( α ) , α ) ≈ ∇ α L v a l ( w − ξ ∇ w L t r a i n ( w , α ) , α ) \begin{aligned} &amp;amp;\nabla_\alpha \mathcal{L}_{val}(w^*(\alpha), \alpha) \\ \approx &amp;amp;\nabla_\alpha \mathcal{L}_{val}(w - \xi \nabla_{w} \mathcal{L}_{train}(w, \alpha), \alpha) \end{aligned} ≈​∇α​Lval​(w∗(α),α)∇α​Lval​(w−ξ∇w​Ltrain​(w,α),α)​ 其中 w w w 表示算法维护的当前权重， ξ \xi ξ 是内部优化步骤的学习率。思路是通过仅使用单个训练步骤来调整 w w w 来近似 w ∗ ( α ) w^*(\alpha) w∗(α)，而不是训练至收敛来完全求解内部优化。 从形式上讲，DARTS 将搜索网络分解为若干（ L L L）个的单元（cell）。每个单元组织为具有 N N N 个节点的有向无环图（DAG），其中每个节点定义一个网络层。预定义操作空间 O \mathcal{O} O，其中每个元素 o &amp;NegativeThinSpace; ( ⋅ ) o\!\left(\cdot\right) o(⋅) 是在网络层执行的固定操作（例如，identity connection, and 3 × 3 3\times3 3×3 convolution）。在单元内，目标是从 O \mathcal{O} O 中选择一个操作来连接每对节点。设一对节点为 ( i , j ) \left(i,j\right) (i,j)，其中 0 ⩽ i &amp;lt; j ⩽ N − 1 {0}\leqslant{i}&amp;lt;{j}\leqslant{N-1} 0⩽i&lt;j⩽N−1，DARTS 的核心思想是将从 i i i 传播到 j j j 的信息表示为 ∣ O ∣ \left|\mathcal{O}\right| ∣O∣ 操作的加权和，即 f i , j &amp;NegativeThinSpace; ( x i ) = ∑ o ∈ O exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } ⋅ o &amp;NegativeThinSpace; ( x i ) {f_{i,j}\!\left(\mathbf{x}_i\right)}={{\sum_{o\in\mathcal{O}}}\frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}\cdot o\!\left(\mathbf{x}_i\right)} fi,j​(xi​)=∑o∈O​∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​⋅o(xi​)，其中 x i \mathbf{x}_i xi​ 是第 i i i 个节点的输出， α i , j o \alpha_{i,j}^o αi,jo​ 是加权操作的超参数 o &amp;NegativeThinSpace; ( x i ) o\!\left(\mathbf{x}_i\right) o(xi​)。节点的输出是所有输入流的总和，即 x j = ∑ i &amp;lt; j f i , j &amp;NegativeThinSpace; ( x i ) {\mathbf{x}_j}={{\sum_{i&amp;lt;j}}f_{i,j}\!\left(\mathbf{x}_i\right)} xj​=∑i&lt;j​fi,j​(xi​)，整个单元格的输出是通过连接节点 x 2 \mathbf{x}_2 x2​– x N − 1 \mathbf{x}_{N-1} xN−1​ 的输出而形成的，即 c o n c a t &amp;NegativeThinSpace; ( x 2 , x 3 , … , x N − 1 ) \mathrm{concat}\!\left(\mathbf{x}_2,\mathbf{x}_3,\ldots,\mathbf{x}_{N-1}\right) concat(x2​,x3​,…,xN−1​) 。请注意，前两个节点 x 0 \mathbf{x}_0 x0​ 和 x 1 \mathbf{x}_1 x1​ 是单元的输入节点，在架构搜索期间是固定的。 搜索过程完成后，在每个边 ( i , j ) \left(i,j\right) (i,j) 上，保留具有最大 α i , j o \alpha_{i,j}^o αi,jo​ 值的操作 o o o，并且每个节点 j j j 连接到具有最大 α i , j o \alpha_{i,j}^o αi,jo​ 的两个先例（ i &amp;lt; j {i}&amp;lt;{j} i&lt;j）。 实验中， 在 CIFAR-10 上搜索基础单元，由组件构建网络从头训练得到 ImageNet 上的结果。 DARTS 在 O \mathcal{O} O 中包括以下操作： 3 × 3 separable convolution 5 × 5 separable convolution 3 × 3 dilated separable convolution 5 × 5 dilated separable convolution 3 × 3 max pooling 3 × 3 average pooling identity z e r o zero zero。 所有操作步长为1（如果适用），填充卷积特征图以保持其空间分辨率。使用 ReLU-Conv-BN 顺序进行卷积运算，并且每个可分离卷积总是应用两次（[NASNet] [AmoebaNet][PNAS]）。 卷积单元由 N = 7 N=7 N=7 个节点组成，其中定义输出节点为所有中间节点（不包括输入节点）的深度级联。其余的设置遵循 [NASNet] [AmoebaNet][PNAS]，然后通过将多个单元堆叠在一起形成网络。单元 k k k 的第一和第二节点分别设置为等于单元 k − 2 k-2 k−2 和单元 k − 1 k-1 k−1 的输出，并且根据需要插入 1 × 1 1 \times 1 1×1 卷积。 位于网络总深度的1/3和2/3处的单元是约简单元，其中与输入节点相邻的所有操作步长为2。因此，体系结构编码是 ( α n o r m a l , α r e d u c e ) (\alpha_{normal}, \alpha_{reduce}) (αnormal​,αreduce​)，其中 α n o r m a l \alpha_{normal} αnormal​ 由所有正常单元共享， α r e d u c e \alpha_{reduce} αreduce​ 由所有约简单元共享。 为了更好地理解深度对架构搜索的影响，DARTS 通过将堆栈中的单元数量从8增加到20来对 CIFAR-10进行架构搜索。由于单个 GPU 显存的限制，初始通道数量从16减少到6。测试误差，略低于较浅网络。 P-DARTS P-DARTS 是同济大学和华为诺亚方舟实验室提出的一种渐进式的可微分网络结构搜索方法，致力于提升 DARTS 的迁移性能。在 CIFAR10和 CIFAR100数据集上搜索基本单元，单个P100 GPU上只需要7个小时。在DARTS中，网络结构搜索是在一个拥有8个 cell 的搜索网络上进行的，然而却是在一个拥有20个 cell 的网络上测试的，在搜索网络和测试网络之间有一个很大的深度差异。 P-DARTS 渐进地增加搜索网络深度。P-DARTS 提出搜索空间近似，划分学习阶段，减少候选操作的种类的同时增加深度，从而降低显存和时间消耗。算法能够在16 GB 显存的 GPU 上运行。 上一阶段结尾将一些操作从搜索空间中删去，因此需要从头开始训练网络参数和结构参数。但是训练一个更深的网络往往比训练一个较浅的网络更难。信息往往倾向于通过 skip-connect 流动，而不是卷积。作者提出搜索空间正则，在 skip-connect 操作添加操作层面的 Dropout 来防止其过拟合到 skip-connect 上，同时限制最终结构中的 skip-connect 操作数量来进一步提高稳定性。 作者同时观察到测试时的识别准确率与搜索到的结构中的 skip-connect 操作数量与最终性能高度相关。因此，作者提出第二个搜索空间正则方法，即在最终生成的网络结构中，保留固定数量的 skip-connect 操作。具体的，作者根据最终阶段的结构参数，只保留权值最大的 M 个 skip-connect 操作，这一正则方法保证了搜索过程的稳定性。在本文中， M=2 。 P-DARTS 能够在 16 GB 显存的 GPU 上完成搜索。 PC-DARTS DARTS 将操作选择转换为固定操作集的加权组合，为寻找有效的网络架构提供了快速解决方案。但联合训练超网络和搜索最优结构，内存和计算开销很大。P-DARTS 减少搜索空间，而这一近似会导致可能牺牲已发现架构的最优性。PC-DARTS 通过对超网络的一小部分进行采样以减少网络空间中的冗余，从而在不损害性能的情况下提高搜索效率。具体来说，PC-DARTS 在通道子集中执行操作搜索，并保持其他部分不变。采样不同通道可能造成在选择超网络的边时出现不一致。PC-DARTS 通过引入边正则（edge normalization）来解决这个问题，在搜索过程中添加了一组新的边级超参数，以减少搜索中的不确定性。项目地址为：yuhuixu1993/PC-DARTS。 PC-DARTS 即部分连接 DARTS，核心思想是直观的：随机抽取其中的一个子集进行操作选择，同时直接放过其余部分，而不是将所有通道都送到操作选择块中。PC-DARTS 假设该子集的计算能近似替代所有通道。除了内存和计算成本都大大降低之外，采样带来了另一个好处，即操作搜索正则化，不易陷入局部最优。然而，PC-DARTS 也带来了副作用，即网络连接的选择将变得不稳定，因为在迭代中会采样不同的信道子集。因此，PC-DARTS 引入边正则（edge normalization）来通过显式学习一组额外的边选择超参数来稳定对网络连接的搜索。通过在整个训练过程中共享这些超参数，所学习的网络结构不易受迭代中通道采样的影响，因此更加稳定。 得益于部分连接策略，PC-DARTS 能够相应地增加批量大小。在实践中，PC-DARTS 为每个操作选择随机抽取 1 / K 1/K 1/K 的通道，这将减少几乎 K K K 倍的内存成本。这使得我们可以在搜索过程中使用 K × K\times K× 批量大小，不仅可以将搜索速度加快 K K K 倍，而且还稳定了搜索，特别是对于大型数据集。 当然，以上都是作者观点。读代码的话会发现通道不是随机取的，而是固定取前 1 / K 1/K 1/K。所以“边正则”概念就有点飘了。DARTS 不仅仅选择操作，还会像剪枝一样确定连接。然而同层会有多个 softmax 输出，从中选最大显得不甚合理。额外加一组结构参数应该可以改善这一点。 DARTS 的缺点在于其内存效率低下。为了适应 ∣ O ∣ |\mathcal{O}| ∣O∣ 操作，在搜索架构的主要部分中， ∣ O ∣ |\mathcal{O}| ∣O∣ 操作副本及其输出需要存储在每个节点（即每个网络层），导致 ∣ O ∣ × |\mathcal{O}|\times ∣O∣× 次内存使用。要装进GPU，必须在搜索期间减小批量大小，这不可避免地降低搜索速度，并且较小的批量大小可能降低搜索稳定性和准确性。 或者，内存效率的另一种解决方案是部分通道连接，如下图所示。以 x i \mathbf{x}_i xi​ 与 x j \mathbf{x}_j xj​ 的连接为例。这涉及定义一个通道采样掩码 S i , j \mathbf{S}_{i,j} Si,j​，它为所选通道分配 1 1 1，为屏蔽的通道分配 0 0 0。所选通道送入 ∣ O ∣ \left|\mathcal{O}\right| ∣O∣ 混合操作计算，而屏蔽通道则绕过这些操作，即直接复制到输出， f i , j P C &amp;NegativeThinSpace; ( x i ; S i , j ) = ∑ o ∈ O exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } ⋅ o &amp;NegativeThinSpace; ( S i , j ∗ x i ) + ( 1 − S i , j ) ∗ x i . {f_{i,j}^\mathrm{PC}\!\left(\mathbf{x}_i;\mathbf{S}_{i,j}\right)}={{\sum_{o\in\mathcal{O}}}\frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}\cdot o\!\left(\mathbf{S}_{i,j}\ast\mathbf{x}_i\right)+\left(1-\mathbf{S}_{i,j}\right)\ast\mathbf{x}_i}. fi,jPC​(xi​;Si,j​)=o∈O∑​∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​⋅o(Si,j​∗xi​)+(1−Si,j​)∗xi​. 其中， S i , j ∗ x i \mathbf{S}_{i,j}\ast\mathbf{x}_i Si,j​∗xi​ 和 ( 1 − S i , j ) ∗ x i \left(1-\mathbf{S}_{i,j}\right)\ast\mathbf{x}_i (1−Si,j​)∗xi​ 分别表示选定和屏蔽的通道。 在实践中，PC-DARTS 将 K K K 视为超参数，设置选中通道的比例为 1 / K 1/K 1/K。 通过改变 K K K，可以在架构搜索准确度（较小的 K K K）和效率（较大的 K K K）之间进行权衡以取得平衡。 K K K 带来的直接好处是 f i , j P C &amp;NegativeThinSpace; ( x i ; S i , j ) f_{i,j}^\mathrm{PC}\!\left(\mathbf{x}_i;\mathbf{S}_{i,j}\right) fi,jPC​(xi​;Si,j​) 计算减少 K K K 次。这允许使用更大的批量大小进行结构搜索。随即有两方面的好处： 首先，计算成本也可以减少 K K K 倍。 此外，较大的批量大小意味着可以在每次迭代期间对更多训练数据进行采样。这对于结构搜索尤为重要。在大多数情况下，一个操作相对于另一个操作的优势并不显著，除非在一个小批量中包含更多的训练数据，以减少更新网络权重和架构参数的不确定性。 通道采样对神经架构搜索的影响既有有积极的也有消极的： 在好的一面，为混合操作输入一小部分通道，同时保持其余部分不变，可以减少在选择操作时的偏向。换句话说，对于边 ( i , j ) \left(i,j\right) (i,j)，给定输入 x i \mathbf{x}_i xi​，使用两组超参数 { α i , j o } \left\{\alpha_{i,j}^o\right\} {αi,jo​} 和 { α i , j ′ o } \left\{\alpha_{i,j}^{\prime o}\right\} {αi,j′o​} 的差别大大减少了，因为只有一小部分（ 1 / K 1/K 1/K）的输入通道将通过混合操作，而其余通道保持不变。这削弱了 O \mathcal{O} O 中无参数操作（如 skip-connect、max-pooling 等）相对于含参操作（例如各种卷积）的优势。在早期阶段，搜索算法通常更青睐无参操作，因为它们没有训练参数，从而产生更一致的输出，即 o &amp;NegativeThinSpace; ( x i ) o\!\left(\mathbf{x}_i\right) o(xi​)。相比之下，在参数得到充分优化之前，含参操作在迭代中传播的信息不一致。因此，无参操作通常会在开始时累积较大的权重（即 α i , j o \alpha_{i,j}^o αi,jo​），这使得含参操作即使在经过良好训练之后也很难击败它们。当（执行结构搜索的）代理数据集很难时，这种现象尤其显著，这阻碍了 DARTS 在 ImageNet 上获得令人满意的搜索结果。 不利的一面是，和 DARTS 一样，在一个单元格中，每个输出节点 x j \mathbf{x}_j xj​ 需要从其先例 { x 0 , x 1 , … , x j − 1 } \left\{\mathbf{x}_0,\mathbf{x}_1,\ldots,\mathbf{x}_{j-1}\right\} {x0​,x1​,…,xj−1​} 中选取两个输入节点，候选操作权重为 max ⁡ o α 0 , j o , max ⁡ o α 1 , j o , … , max ⁡ o α j − 1 , j o \max_o\alpha_{0,j}^o,\max_o\alpha_{1,j}^o,\ldots,\max_o\alpha_{j-1,j}^o maxo​α0,jo​,maxo​α1,jo​,…,maxo​αj−1,jo​。然而，这些架构参数通过迭代中的随机采样通道进行优化。因此，当采样通道随时间变化时，由它们确定的最佳连接性可能不稳定。这可能导致所得网络架构中出现预期之外的波动。为了缓解这个问题，PC-DARTS 引入了边正则化， β i , j \beta_{i,j} βi,j​ 明确地权衡每个边 ( i , j ) \left(i,j\right) (i,j)，因此 x j \mathbf{x}_j xj​ 的计算成为： x j P C = ∑ i &amp;lt; j exp ⁡ { β i , j } ∑ i ′ &amp;lt; j exp ⁡ { β i ′ , j } ⋅ f i , j &amp;NegativeThinSpace; ( x i ) . \mathbf{x}_j^\mathrm{PC}={\sum_{i&amp;lt;j}\frac{\exp\left\{\beta_{i,j}\right\}}{{\sum_{i&amp;#x27;&amp;lt;j}}\exp\left\{\beta_{i&amp;#x27;,j}\right\}}\cdot f_{i,j}\!\left(\mathbf{x}_i\right)}. xjPC​=i&lt;j∑​∑i′&lt;j​exp{βi′,j​}exp{βi,j​}​⋅fi,j​(xi​). 具体来说，在架构搜索完成后，边 ( i , j ) \left(i,j\right) (i,j) 的连接由 { α i , j o } \left\{\alpha_{i,j}^o\right\} {αi,jo​} 和 β i , j \beta_{i,j} βi,j​ 确定。PC-DARTS 归一化系数，然后相乘，即 exp ⁡ { β i , j } ∑ i ′ &amp;lt; j exp ⁡ { β i ′ , j } ⋅ exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } \frac{\exp\left\{\beta_{i,j}\right\}}{{\sum_{i&amp;#x27;&amp;lt;j}}\exp\left\{\beta_{i&amp;#x27;,j}\right\}} \cdot \frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}} ∑i′&lt;j​exp{βi′,j​}exp{βi,j​}​⋅∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​。 由于 β i , j \beta_{i,j} βi,j​ 在训练过程中共享，因此学习的网络架构不易受迭代间采样通道影响，从而使架构搜索更加稳定。 P-DARTS 在 skip-connect 之后应用了 dropout，以避免参数化和无参数操作之间的信息不平衡。 SNAS 随机神经网络架构搜索（Stochastic Neural Architecture Search，SNAS），是商汤发表在 ICLR 2019上的一篇文章，吸收了 ENAS 和 DARTS 的优点。SNAS 的实质似乎就是将 DARTS 中的 Softmax 换成了Concrete distribution 并加了资源约束项，然而整个叙述却十分复杂。SNAS 在同一轮反向传播中训练神经运算的参数和架构的分布参数（这样真的好？）。号称的思想是，利用泛化损失中的梯度信息提高基于强化学习的 NAS 的效率。 与基于强化学习的方法[ENAS]相比，SNAS 的搜索优化可微分，搜索效率更高，可以在更少的迭代次数下收敛到更高准确率。 与其他可微分的方法[DARTS]相比，SNAS 直接优化 NAS 任务的目标函数，搜索结果偏差更小，可以直接通过一阶优化搜索。 同时优化网络损失函数的期望和网络前向时延的期望，可以自动生成硬件友好的稀疏网络。 SNAS 的实验设置基本与 DARTS 相同。 SNAS 将子网络运行延迟作为目标的正规化项： E Z ∼ p α ( Z ) [ L θ ( Z ) + η C ( Z ) ] = E Z ∼ p α ( Z ) [ L θ ( Z ) ] + η E Z ∼ p α ( Z ) [ C ( Z ) ] , \begin{aligned} \mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[L_{\mathit{\theta}}(\mathit{Z})+\eta C(\mathit{Z})]=\mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[L_{\mathit{\theta}}(\mathit{Z})]+\eta \mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[C(\mathit{Z})], \end{aligned} EZ∼pα​(Z)​[Lθ​(Z)+ηC(Z)]=EZ∼pα​(Z)​[Lθ​(Z)]+ηEZ∼pα​(Z)​[C(Z)],​ 其中 C ( Z ) C(\mathit{Z}) C(Z) 是与随机变量 Z \mathit{Z} Z 相关联的子网络的时间成本，包含3项指标： 参数量; 浮点运算（float-point operations， FLOPs）的数量; 内存访问成本（memory access cost，MAC）。 FBNet 与 BSN 相同，FBNet 以随机超网络表示搜索空间。将寻找最佳架构的问题放宽为找到产生最优体系结构的分布。借助于 Gumbel Softmax 可以使用基于梯度的优化（如 SGD）直接训练架构分布。损失包括交叉熵损失和延迟损失。相当于宏搜索版的 SNAS。 随机超网络对候选块进行采样，采样概率为 P θ l ( b l = b l , i ) = softmax ( θ l , i ; θ l ) = exp ⁡ ( θ l , i ) ∑ i exp ⁡ ( θ l , i ) . P_{\bm{\theta}_{l}}(b_l = b_{l,i}) = \text{softmax}(\theta_{l,i}; \bm{\theta}_l) = \frac{\exp(\theta_{l,i})}{\sum_i \exp(\theta_{l,i})}. Pθl​​(bl​=bl,i​)=softmax(θl,i​;θl​)=∑i​exp(θl,i​)exp(θl,i​)​. θ l \bm{\theta}_l θl​ 包含的参数确定在第 l l l 层采样每个块的概率。同样，第 l l l 层的输出可以表示为 x l + 1 = ∑ i m l , i ⋅ b l , i ( x l ) , x_{l+1} = \sum_i m_{l, i} \cdot b_{l, i}(x_{l}), xl+1​=i∑​ml,i​⋅bl,i​(xl​), 其中 m l , i m_{l,i} ml,i​ 是 { 0 , 1 } \{0, 1\} {0,1} 中的随机变量，如果采样块 b l , i b_{l, i} bl,i​，则计算结果为1。采样概率由前面的等式确定。 b l , i ( x l ) b_{l, i}(x_{l}) bl,i​(xl​) 表示给定输入特征图 x l x_{l} xl​ 的情况下，第 l l l 层的第 i i i 块的输出。FBNet 让每个层独立采样，因此，采样架构 a a a 的概率可以描述为 P θ ( a ) = ∏ l P θ l ( b l = b l , i ( a ) ) , P_{\bm{\theta}}(a) = \prod_l P_{\bm{\theta}_l} (b_l = b_{l,i}^{(a)}), Pθ​(a)=l∏​Pθl​​(bl​=bl,i(a)​), 其中 θ \bm{\theta} θ 为一个向量，元素 θ l , i \theta_{l,i} θl,i​ 为第 i i i 块的第 l l l 层的采样参数。 b l , i ( a ) b_{l,i}^{(a)} bl,i(a)​ 表示在采样架构中 a a a，在第 l l l 层中选中第 i i i 个块。 松弛求解最佳架构 a ∈ A a \in \mathcal{A} a∈A 问题为优化随机超网络的概率 P θ P_\theta Pθ​ 以实现最小预期损失，公式重写为 min&nbsp; θ min&nbsp; w a E a ∼ P θ { L ( a , w a ) } . \underset{\bm{\theta}}{\text{min }} \underset{w_a}{\text{min }} \mathbf{E}_{a \sim P_{\bm{\theta}}} \{\mathcal{L}(a, w_a) \}. θmin&nbsp;​wa​min&nbsp;​Ea∼Pθ​​{L(a,wa​)}. 将离散掩码变量 m l , i m_{l,i} ml,i​ 放宽为由 Gumbel Softmax 函数计算的连续随机变量： m l , i = GumbelSoftmax ( θ l , i ∣ θ l ) = exp ⁡ [ ( θ l , i + g l , i ) / τ ] ∑ i exp ⁡ [ ( θ l , i + g l , i ) / τ ] , \begin{aligned} m_{l, i} &amp;amp; = \text{GumbelSoftmax}(\theta_{l, i}|\bm{\theta_{l}}) \\ &amp;amp; = \frac{\exp[(\theta_{l,i} + g_{l,i})/\tau]}{\sum_i \exp[(\theta_{l,i} + g_{l,i})/\tau]}, \end{aligned} ml,i​​=GumbelSoftmax(θl,i​∣θl​)=∑i​exp[(θl,i​+gl,i​)/τ]exp[(θl,i​+gl,i​)/τ]​,​ 其中 g l , i ∼ Gumbel(0,&nbsp;1) g_{l,i} \sim \text{Gumbel(0, 1)} gl,i​∼Gumbel(0,&nbsp;1) 是 Gumbel 分布的随机噪声。Gumbel Softmax 函数由温度参数 τ \tau τ 控制。当 τ \tau τ 接近0时，它近似于 P θ ( a ) = ∏ l P θ l ( b l = b l , i ( a ) ) P_{\bm{\theta}}(a) = \prod_l P_{\bm{\theta}_l} (b_l = b_{l,i}^{(a)}) Pθ​(a)=∏l​Pθl​​(bl​=bl,i(a)​) 中分布的离散分类抽样。随着 τ \tau τ 变大， m l , i m_{l,i} ml,i​ 成为一个连续的随机变量。无论 τ \tau τ 的值如何，掩码 m l , i m_{l,i} ml,i​ 都对参数 θ l , i \theta_{l, i} θl,i​ 可微。DNAS 和 SNAS 同样使用 Gumbel Softmax 进行网络结构搜索。 对于延迟项，FBNet 使用基于查找表的模型进行效率估计，因此 LAT ( a ) \text{LAT}(a) LAT(a) 公式可以写为 LAT ( a ) = ∑ l ∑ i m l , i ⋅ LAT ( b l , i ) . \text{LAT}(a) = \sum_l \sum_i m_{l,i} \cdot \text{LAT} (b_{l,i}). LAT(a)=l∑​i∑​ml,i​⋅LAT(bl,i​). 每个运算符 LAT ( b l , i ) \text{LAT} (b_{l,i}) LAT(bl,i​) 的延迟是一个常数系数，从而架构 a a a 的整体延迟相对于掩码 m l , i m_{l,i} ml,i​ 是可微分的。 训练过程为： 随机取 ImageNet 的100类在8 GPU 机器上训练随机超网络90个 epoch，batchsize=192； 挑选出最优结构后，在 ImageNet 上训练360个 epoch，batchsize=256。 FBNet 的搜索空间参考 MobileNetV2 和 ShiftNet ，网络首尾固定，中间的22层可调，如 Table 1 所示。 块结构如下图所示，深度分离卷积可选3x3或5x5的卷积核，块内的首尾1x1卷积可替换为 group + channel shuffle。 值得注意的是网络没有使用 BN，论文也未谈到这一点。但 fbnet_builder 中是有的。 从 ImageNet 中随即取100类作为训练集，历经90个 epoch。找到最优结构后，从头训练模型。损失函数为： L ( a , w a ) = &nbsp;CE ( a , w a ) ⋅ α log ⁡ ( LAT ( a ) ) β \begin{aligned} \mathcal{L}(a, w_a) = \text{ CE}(a, w_a) \cdot \alpha \log(\text{LAT}(a))^\beta \end{aligned} L(a,wa​)=&nbsp;CE(a,wa​)⋅αlog(LAT(a))β​ 第一项 CE ( a , w a ) \text{CE}(a, w_a) CE(a,wa​) 表示架构 a a a 与相应参数 w a w_a wa​ 的交叉熵损失。第二项 LAT ( a ) \text{LAT}(a) LAT(a) 表示目标硬件上体系结构的延迟，以微秒为单位。系数 α \alpha α 控制损失函数的总体大小。指数系数 β \beta β 调制延迟项的大小。除了 log 外，形式与 MnasNet 类似。 FBNet 预先测试每个 op 的耗时，创建查找表来估计不同模型的延时。目标设备为 Samsung Galaxy S8和 iPhone X。 LAT ( a ) = ∑ l LAT ( b l ( a ) ) , \begin{aligned} \text{LAT}(a) = \sum_l \text{LAT} (b_l^{(a)}), \end{aligned} LAT(a)=l∑​LAT(bl(a)​),​ 其中 b l ( a ) b_l^{(a)} bl(a)​ 表示架构 a a a 来自第 l l l 层的块。 FBNet 将模型量化到 int8 在 Caffe2上测试，为对比将其他方法也进行了转换。 ProxylessNAS D R DARTS ProxylessNAS BinaryConnect REINFORCE MobileNetV2 可微 NAS 通过网络架构的连续表示来降低训练时长，但会遇到高 GPU 内存消耗问题（随候选集大小线性增长）。ProxylessNAS 着眼于减少内存消耗，在训练时采样两条路径。采用强化学习和梯度下降两种方法训练 CPU、GPU 以及移动处理器3个平台上的模型。文中试图套用 BinaryConnect ，大讲二值化。然而路径二值化并不能降低内存消耗，实际运行机理与此毫不相干。直接在目标数据集上训练也有点噱头，因为分摊下来每条路径的训练轮数不多。论文题目不如改成随机采样更新的 Softmax 近似。而且，采样路径却未提 BatchNorm 如何应对。一个鲜明的例子是 DenseNAS 也使用路径采样方法，但未提及二值化。 ProxylessNAS 受 DARTS 和 One-Shot 的启发 ， 将 NAS 定义为路径级修剪过程。 ProxylessNAS 在目标硬件上学习专用网络结构，但硬件目标（以延迟为例）不可微分。为此，其将网络延迟建模为连续函数，并作为正则化损失进行优化，类似于 SNAS。此外，ProxylessNAS 还提出了一种基于 REINFORCE规则 的算法（Proxyless-R），作为处理硬件度量的替代策略。 ProxylessNAS 将路径 N 选择一分解为多个二进制选择任务。 直觉是，如果一条路径是特定位置的最佳选择，那么与任何其他路径相比，它应该是更好的选择。 在结构参数的更新步骤中： 首先根据多项分布 ( p 1 , ⋯ &amp;ThinSpace; , p N ) (p_1, \cdots, p_N) (p1​,⋯,pN​) 对两条路径进行采样，并屏蔽所有其他路径，就好像它们不存在一样。因此，候选数暂时从 N N N 减少到2，而路径权重 { p i } \{p_i\} {pi​} 和二进制门 { g i } \{g_i\} {gi​} 相应地重置。 然后，我们使用通过公式(4)计算的梯度更新这两个采样路径的架构参数。 最后，由于通过将 softmax 应用于架构参数来计算路径权重，需要通过乘以比率来重新调整这两个更新的架构参数的值，以保持未采样路径的路径权重不变。 这样，在每个更新步骤中，一个采样路径被增强（路径权重增大），另一个采样路径被衰减（路径权重减小），而所有其他路径保持不变。这样，无论 N N N 的值如何，在架构参数的每个更新步骤中仅涉及两条路径，从而将内存需求降低到训练紧凑模型的相同水平。 为了使延迟可微分，ProxylessNAS 将网络的延迟建模为神经网络维度的连续函数。考虑具有候选集 { o j } \{o_j\} {oj​} 的混合操作，并且每个 o j o_j oj​ 与路径权重 p j p_j pj​ 相关联，该权重表示选择 o j o_j oj​ 的概率。因此，混合操作（即可学习块）的预期延迟如下： E [ latency i ] = ∑ j p j i × F ( o j i ) , \mathbb{E} [\text{latency}_i] = \sum_j p_j^i \times F(o_j^i), E[latencyi​]=j∑​pji​×F(oji​), 其中 E [ latency i ] \mathbb{E} [\text{latency}_i] E[latencyi​] 是 i t h i^{th} ith 可学习块的预期延迟， F ( ⋅ ) F(\cdot) F(⋅) 表示延迟预测模型， F ( o j i ) F(o_j^i) F(oji​) 是 o j i o_j^i oji​ 的预测延迟。因此， E [ latency i ] \mathbb{E} [\text{latency}_i] E[latencyi​] 关于体系结构参数的梯度为： ∂ E [ latency i ] &nbsp; / &nbsp; ∂ p j i = F ( o j i ) \partial \mathbb{E} [\text{latency}_i]~/~\partial p_j^i = F(o_j^i) ∂E[latencyi​]&nbsp;/&nbsp;∂pji​=F(oji​)。 对于具有一系列混合操作的整个网络，由于这些操作在推理期间按顺序执行，因此网络的预期延迟可以用这些混合操作的总预期延迟之和表示： E [ latency ] = ∑ i E [ latency i ] , \mathbb{E} [\text{latency}] = \sum_i \mathbb{E} [\text{latency}_i], E[latency]=i∑​E[latencyi​], Proxyless-G 通过乘以比例因子 λ 2 ( &amp;gt; 0 ) \lambda_2 (&amp;gt; 0) λ2​(&gt;0) 将网络的预期延迟纳入正常损失函数，该比例因子控制精度和延迟之间的权衡。最终的损失函数给出为 L o s s = L o s s C E + λ 1 ∣ ∣ w ∣ ∣ 2 2 + λ 2 E [ latency ] , Loss = Loss_{CE} + \lambda_1 ||w||_2^2 + {\color{red} \lambda_2 \mathbb{E}[\text{latency}]}, Loss=LossCE​+λ1​∣∣w∣∣22​+λ2​E[latency], 其中 L o s s C E Loss_{CE} LossCE​ 表示交叉熵损失， λ 1 ∣ ∣ w ∣ ∣ 2 2 \lambda_1 ||w||_2^2 λ1​∣∣w∣∣22​ 是权重衰减项。 ProxylessNAS 还可以利用 REINFORCE 来训练二值化权重。考虑具有二进制化参数 α \alpha α 的网络，更新二进制化参数的目的是找到最大化某个奖励 R ( ⋅ ) R(\cdot) R(⋅) 的最佳二进制门 g g g 。为便于说明，这里假设网络只有一个混合操作。因此，根据 REINFORCE ，对二进制化参数进行了以下更新： J ( α ) = E g ∼ α [ R ( N g ) ] = ∑ i p i R ( N ( e = o i ) ) , ∇ α J ( α ) = ∑ i R ( N ( e = o i ) ) ∇ α p i = ∑ i R ( N ( e = o i ) ) p i ∇ α log ⁡ ( p i ) , = E g ∼ α [ R ( N g ) ∇ α log ⁡ ( p ( g ) ) ] ≈ 1 M ∑ i = 1 M R ( N g i ) ∇ α log ⁡ ( p ( g i ) ) , \begin{aligned} J(\alpha) &amp;amp;= \mathbb{E}_{g \sim \alpha}[R(\mathcal{N}_g)] = \sum_i p_i R(\mathcal{N}(e = o_i)), \\ \nabla_\alpha J(\alpha) &amp;amp;= \sum_i R(\mathcal{N}(e = o_i)) \nabla_\alpha p_i = \sum_i R(\mathcal{N}(e = o_i)) p_i \nabla_\alpha \log(p_i), \\ &amp;amp;= \mathbb{E}_{g \sim \alpha} [R(\mathcal{N}_g) \nabla_\alpha \log(p(g))] \approx \frac{1}{M} \sum_{i=1}^M R(\mathcal{N}_{g^i}) \nabla_\alpha \log(p(g^i)), \end{aligned} J(α)∇α​J(α)​=Eg∼α​[R(Ng​)]=i∑​pi​R(N(e=oi​)),=i∑​R(N(e=oi​))∇α​pi​=i∑​R(N(e=oi​))pi​∇α​log(pi​),=Eg∼α​[R(Ng​)∇α​log(p(g))]≈M1​i=1∑M​R(Ngi​)∇α​log(p(gi)),​ 其中 g i g^i gi 表示第 i t h i^{th} ith 个采样二进制门， p ( g i ) p(g^i) p(gi) 表示根据公式2采样 g i g^i gi 的概率， N g i \mathcal{N}_{g^i} Ngi​ 是根据二进制门 g i g^i gi 的紧凑型网络。由于上式不需要 R ( N g ) R(\mathcal{N}_g) R(Ng​) 对 g g g 可微，因此它可以处理不可微分的目标。一个有趣的观察是，公式eq:reinforce具有与标准 NAS 类似的形式，但它不是一个连续的决策过程，并且没有使用 RNN 元控制器。此外，由于基于梯度的更新和基于 REINFORCE 的更新对于相同的二值化体系结构参数基本上是两个不同的更新规则，因此可以将它们组合以形成体系结构参数的新更新规则。 Proxyless-R 与 MnasNet 类似，使用 A C C ( m ) × [ L A T ( m ) / T ] w ACC(m) \times [ LAT(m) / T]^w ACC(m)×[LAT(m)/T]w 作为优化目标，其中 A C C ( m ) ACC(m) ACC(m) 表示模型 m m m 的准确率， L A T ( m ) LAT(m) LAT(m) 表示 m m m 的延迟， T T T 是目标延迟， w w w 是用于控制准确性和延迟之间权衡的超参数。 ProxylessNAS 与 DARTS 在验证集上训练结构参数 α {\alpha} α，而 FBNet 未进行划分。 ProxylessNAS 设置一系列 MBConv，卷积核大小可选 { 3 , 5 , 7 } \{3, 5, 7\} {3,5,7} 扩张系数为 { 3 , 6 } \{3, 6\} {3,6}。 令人困惑的是 ProxylessNAS 的 batchsize=256，FBNet 为192。FBNet 只用 ImageNet 的1/10，ProxylessNAS 使用全部，二者训练时间却相同。FBNet 估计 MnasNet 的成本为91000 GPU hours；ProxylessNAS 实现的是40000。假定 ProxylessNAS 用的是 V100（测试平台是这一型号）， FBNet 的设备似乎与之存在代差。 Single-Path NAS Single-Path NAS 是一种单路径（或者 superkernel）方法。用一个7x7的大卷积，来代表3x3、5x5和7x7的三种卷积，把外边一圈 mask 清零掉就变成了3x3或5x5。扩张系数类似，认为6包含两个3，实现高度的参数复用。 省显存，然而本质还是搜索空间小。基础网络参考 FBNet，仅搜索 expansion rate 和 kernel size。Single-Path NAS 代码 dstamoulis/single-path-nas 完全开源，依赖 TensorFlow 和 TPU，使用 facebook/FAI-PEP 分析模型每层的运行时间。比较有意思的是文中的表格，几种搜索算法结果并未拉开差距。 DenseNAS DenseNAS 由地平线和华中科技大学联合提出，号称可以搜索网络结构中每个 block 的宽度和对应的空间分辨率。DenseNAS 构建一个密集连接的搜索空间。每个块的滤波器的数量（即宽度）以小步幅逐渐增加。搜索空间参考 MobileNetV2 并采用密集连接的形式构建。搜索空间比之前一些算法大。然而 DenseNAS 与 FBNet 一样训练集取 ImageNet 的1/10，同时类似 ProxylessNAS 采样路径训练，反而比二者训练时间缩短一半。 如下图所示，DenseNAS 在三个不同的级别（layer、block 和 network）定义搜索空间： 每个层都包含所有候选操作； 一个块可以分为两个组件：头部层和堆叠层； 整个网络使用具有增量宽度的块构建。 层为搜索空间中的基本结构。一层代表一组候选操作。搜索空间中的操作集合如表 Table 1 所示。 每个块由若干层组成，拥有固定宽度和相应的空间分辨率。头部层处理具有不同通道数和空间分辨率的输入张量，并转换为固定宽度和空间分辨率。头部层不包括跳过连接，因为它是所有块所必需的。头部层之后是许多堆叠层（图中的例子中是三层）。之后，堆叠层中的操作以相同数量的通道和空间分辨率执行。 MnasNet、ProxylessNAS 和 FBNet 设置固定数量的块。DenseNAS 在搜索空间中设计了更多具有不同宽度的块，并允许搜索架构只包含块的子集，从而使搜索算法能够自由地选择具有特定宽度的块，同时丢弃其他块。 整个超网络架构定义为 A r c h Arch Arch，并假设它包含 N N N 个块： A r c h = { B 1 , B 2 , . . . , B N } Arch = \{B_1, B_2, ..., B_N\} Arch={B1​,B2​,...,BN​}。 DenseNAS 将整个网络划分为几个阶段。每个阶段拥有不同的宽度范围和固定的空间分辨率。超网络从头到尾，块的宽度以小步幅逐渐增长。网络的早期阶段设定较小的宽度增长步幅，因为设置较大将导致巨大的计算成本。后期阶段增长幅度逐渐变大。如结构图所示，在第3阶段，空间分辨率设置为 28 × 28 28 \times 28 28×28，宽度增长步幅为8。宽度增长步幅在第4阶段变为16，阶段5变为64。 定义块 B i B_i Bi​ 和后续块 B j B_j Bj​（ j &amp;gt; i j &amp;gt; i j&gt;i）之间的连接为 C i j C_{ij} Cij​。 B i B_i Bi​ 和 B j B_j Bj​ 的空间分辨率分别为 H i × W i H_i \times W_i Hi​×Wi​（通常 H i = W i H_i = W_i Hi​=Wi​）和 H j × W j H_j \times W_j Hj​×Wj​。DenseNAS 限制连接仅在空间分辨率相差不超过两倍的块之间。因此，当 j − i ≤ m j - i \leq m j−i≤m 且 H j / H i ≤ 2 H_j / H_i \leq 2 Hj​/Hi​≤2 时， C i j C_{ij} Cij​ 存在。搜索空间基于密集连接的块构建。 但是，只选择一条路径来导出最终的结构。DenseNAS 不仅搜索每个块中的层数，而且还搜索块宽度和块数。同时确定执行空间下采样的层。目标是在搜索空间中找到一条良好的路径，代表架构的最佳深度和宽度配置。 设 b i b_i bi​ 为第 i i i 个块 B i B_i Bi​ 的输出张量。每个块连接到后续 m m m 块。为了将块连接松弛为连续表示，DenseNAS 为块的每个输出路径分配块级架构参数。也就是说，对于从块 B i B_i Bi​ 到 B j B_j Bj​ 的路径，它们之间的路径有一个参数 β i j \beta_{ij} βij​。与计算每个操作的权重类似，使用 softmax 函数计算两个块之间所有路径的概率： p i j = exp ⁡ ( β i j ) ∑ k = 1 m exp ⁡ ( β i k ) . p_{ij} = \frac{\exp(\beta_{ij})}{\sum_{k=1}^m \exp(\beta_{ik})}. pij​=∑k=1m​exp(βik​)exp(βij​)​. 假设块 B i B_i Bi​ 需要来自先前块的 m ′ m&amp;#x27; m′ 输入张量，即 B i − m ′ B_{i-m&amp;#x27;} Bi−m′​, B i − m ′ + 1 B_{i-m&amp;#x27;+1} Bi−m′+1​, B i − m ′ + 2 B_{i-m&amp;#x27;+2} Bi−m′+2​ … B i − 1 B_{i-1} Bi−1​。来自这些块的输入张量在通道数和空间分辨率上有所不同。因此，每个输入张量由 B i B_i Bi​ 中的头部层变换为统一大小，然后求和。设 H i k H_{ik} Hik​ 表示块 B i B_i Bi​ 中第 k k k 个头部层对输入张量 B i − k B_{i-k} Bi−k​ 的转换，其中 k = 1.. m ′ k=1..m&amp;#x27; k=1..m′。转换后的输入张量之和可通过以下公式计算： x i = ∑ k = 1 m ′ p i − k , i ⋅ H i k ( x i − k ) . x_i = \sum_{k=1}^{m&amp;#x27;} p_{i-k, i} \cdot H_{ik}(x_{i-k}). xi​=k=1∑m′​pi−k,i​⋅Hik​(xi−k​). 值得注意的是，路径概率在块输出维度上标准化，但应用于后续块的输入维度（更具体地说，在头部层上）。头部层本质上是是候选操作的混合加权和。层级参数 α \alpha α 控制要选择的操作，而外部块级参数 β \beta β 决定要连接的块。 DenseNAS 的训练方式与 DARTS 类似，权重和架构的优化过程按 epoch 交替进行。搜索过程完成后，根据结构参数导出体系结构： 在层级别，选择具有最大体系结构权重的候选操作，即 a r g m a x o ∈ O α o ℓ argmax_{o \in \mathcal{O}} \alpha_o^\ell argmaxo∈O​αoℓ​； 在网络级，使用 Viterbi 算法根据每个块的输出路径概率来选择连接具有最高总转移概率的块的路径。 超网络包括搜索空间中的所有可能路径和操作。 one-shot 搜索方法在训练超级网络时会丢掉一些路径。该技术使独立模型的性能预测更准确。为了减少内存消耗并加快搜索过程，DenseNAS 采用了 drop-path 训练策略： 当训练操作权重时，DenseNAS 在每一层根据结构参数分布 { α o ℓ ∣ o ∈ O } \{\alpha_o^\ell | o \in \mathcal{O}\} {αoℓ​∣o∈O} 从候选操作中采样出一条路径。丢弃路径训练不仅加速了搜索，而且减弱了搜索空间中不同结构的操作权重之间的耦合效应。 训练结构参数时，像 ProxylessNAS一样根据结构权重分布在每个层中对两个操作进行采样。为了保持未采样的操作的体系结构权重不变，DenseNAS 计算重新平衡偏差以调整采样和新更新的参数。 b i a s s = ln ⁡ ∑ o ∈ O s exp ⁡ ( α o ℓ ) ∑ o ∈ O s exp ⁡ ( α ′ o ℓ ) \mathtt{bias}_s = \ln \frac{\sum_{o \in \mathcal{O}_s} \exp(\alpha_o^\ell)}{\sum_{o \in \mathcal{O}_s} \exp({\alpha&amp;#x27;}_o^\ell)} biass​=ln∑o∈Os​​exp(α′oℓ​)∑o∈Os​​exp(αoℓ​)​ 其中 O s \mathcal{O}_s Os​ 指的是采样的一组操作， α o ℓ \alpha_o^\ell αoℓ​ 指的是层 ℓ \ell ℓ 中最初采样的结构参数， α ′ o ℓ {\alpha&amp;#x27;}_o^\ell α′oℓ​ 是相应更新后的结构参数。训练时 b i a s s \mathtt{bias}_s biass​ 不断累加？ DSO-NAS DSO-NAS 是初创企业图森未来的一篇文章，投 ICLR 2019 被拒。文中对比了不同方法的参数量和计算量。评审中附加了更多实验数据，从中可以看出在网络延迟方面不尽人意。 DSO-NAS 与 ProxylessNAS 一样将网络搜索看作是剪枝过程，采用团队前作 SSS(Sparse Structure Selection) 进行优化。不同的是 DSO-NAS 的 block 内部细分为4层，连接较为复杂。 参考资料： 如何评价google Searching for MobileNetV3？ The Lightweight Face Recognition Challenge guan-yuan/awesome-AutoML-and-Lightweight-Models Literature on Neural Architecture Search D-X-Y/Awesome-NAS google-research/nasbench microsoft/nni 神经网络架构搜索（Neural Architecture Search）杂谈 Xuanyi Dong ENAS的原理和代码解析 业界 | 谷歌提出移动端AutoML模型MnasNet：精度无损速度更快 多图演示高效的神经架构搜索 Gumbel-Softmax Trick和Gumbel分布 旷视提出One-Shot模型搜索框架的新变体 另一种可微架构搜索：商汤提出在反传中学习架构参数的SNAS ICLR 2019｜随机神经网络结构搜索 (SNAS) 论文笔记系列-Neural Architecture Search With Reinforcement Learning ENAS: 更有效地设计神经网络模型(AutoML) 万字解读商汤科技ICLR2019论文：随机神经网络结构搜索 同济和华为诺亚提出：渐进式可微网络结构搜索，显著提升可微式搜索的性能和稳定性，已开源 论文解读：Single-Path NAS 【ICLR 19】DARTS可微网络结构搜索 CVPR 2018 | 商汤科技Oral论文详解：BlockQNN自动网络设计方法 AutoML：NAS 之 Randomly Wired Neural Networks A Survey on Neural Architecture Search Neural architecture search AutoML (1) - Introduction Review: NASNet — Neural Architecture Search Network (Image Classification) ENAS的原理和代码解析 论文笔记系列-Neural Architecture Search With Reinforcement Learning 旷视首席科学家孙剑：深度学习变革视觉计算丨CCF-GAIR 2019 DenseNAS：密集连接搜索空间下的高灵活度网络结构搜索 | 大牛讲堂 强化学习系列（六）：时间差分算法（Temporal-Difference Learning) 强化学习 - 时间差分学习(Temporal-Difference Learning) A3C、PPO、GAE笔记 One-Shot 神经网络搜索(NAS)的searching阶段到底在做什么？ AutoML for Object Detection 解读小米MoGA：超过MobileNetV3的移动端GPU敏感型搜索 如何通俗地讲解 viterbi 算法？" />
<meta property="og:description" content="前面介绍了强化学习方法，但屠龙刀毕竟不是人人有。梯度可微算法在保证精度可接受的前提下大幅缩短了训练周期，开启了网络结构搜索的平民化浪潮。 MobileNetV2 FBNet ShiftNet Gumbel-Softmax SNAS DARTS ProxylessNAS P-DARTS PC-DARTS DenseNAS DARTS DARTS 由 CMU 和 DeepMind 提出，最终发表在 ICLR 2019上。DARTS 在有限资源条件下将模型精度提升到可接受的程度，而且开放代码（quark0/darts）。可谓 NAS 领域内的一大贡献。美中不足的是代码仅在单 GPU 下搜索，以至于后续的 chenxin061/pdarts 和 yuhuixu1993/PC-DARTS 亦维持此设置，成为扩展的阻碍。 DARTS 将搜索空间放宽为连续的，以便可以通过梯度下降来优化体系结构的验证集性能。在所有混合操作中联合学习架构 α \alpha α 和权重 w w w。这意味着一个双层优化问题，其中 α \alpha α 作为上层变量， w w w 作为下层变量： min ⁡ α L v a l ( w ∗ ( α ) , α ) s.t. w ∗ ( α ) = a r g m i n w L t r a i n ( w , α ) \begin{aligned} \min_\alpha \quad &amp;amp; \mathcal{L}_{val}(w^*(\alpha), \alpha) \\ \text{s.t.} \quad &amp;amp;w^*(\alpha) = \mathrm{argmin}_w \enspace \mathcal{L}_{train}(w, \alpha) \end{aligned} αmin​s.t.​Lval​(w∗(α),α)w∗(α)=argminw​Ltrain​(w,α)​ DARTS 求结构梯度的近似解： ∇ α L v a l ( w ∗ ( α ) , α ) ≈ ∇ α L v a l ( w − ξ ∇ w L t r a i n ( w , α ) , α ) \begin{aligned} &amp;amp;\nabla_\alpha \mathcal{L}_{val}(w^*(\alpha), \alpha) \\ \approx &amp;amp;\nabla_\alpha \mathcal{L}_{val}(w - \xi \nabla_{w} \mathcal{L}_{train}(w, \alpha), \alpha) \end{aligned} ≈​∇α​Lval​(w∗(α),α)∇α​Lval​(w−ξ∇w​Ltrain​(w,α),α)​ 其中 w w w 表示算法维护的当前权重， ξ \xi ξ 是内部优化步骤的学习率。思路是通过仅使用单个训练步骤来调整 w w w 来近似 w ∗ ( α ) w^*(\alpha) w∗(α)，而不是训练至收敛来完全求解内部优化。 从形式上讲，DARTS 将搜索网络分解为若干（ L L L）个的单元（cell）。每个单元组织为具有 N N N 个节点的有向无环图（DAG），其中每个节点定义一个网络层。预定义操作空间 O \mathcal{O} O，其中每个元素 o &amp;NegativeThinSpace; ( ⋅ ) o\!\left(\cdot\right) o(⋅) 是在网络层执行的固定操作（例如，identity connection, and 3 × 3 3\times3 3×3 convolution）。在单元内，目标是从 O \mathcal{O} O 中选择一个操作来连接每对节点。设一对节点为 ( i , j ) \left(i,j\right) (i,j)，其中 0 ⩽ i &amp;lt; j ⩽ N − 1 {0}\leqslant{i}&amp;lt;{j}\leqslant{N-1} 0⩽i&lt;j⩽N−1，DARTS 的核心思想是将从 i i i 传播到 j j j 的信息表示为 ∣ O ∣ \left|\mathcal{O}\right| ∣O∣ 操作的加权和，即 f i , j &amp;NegativeThinSpace; ( x i ) = ∑ o ∈ O exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } ⋅ o &amp;NegativeThinSpace; ( x i ) {f_{i,j}\!\left(\mathbf{x}_i\right)}={{\sum_{o\in\mathcal{O}}}\frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}\cdot o\!\left(\mathbf{x}_i\right)} fi,j​(xi​)=∑o∈O​∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​⋅o(xi​)，其中 x i \mathbf{x}_i xi​ 是第 i i i 个节点的输出， α i , j o \alpha_{i,j}^o αi,jo​ 是加权操作的超参数 o &amp;NegativeThinSpace; ( x i ) o\!\left(\mathbf{x}_i\right) o(xi​)。节点的输出是所有输入流的总和，即 x j = ∑ i &amp;lt; j f i , j &amp;NegativeThinSpace; ( x i ) {\mathbf{x}_j}={{\sum_{i&amp;lt;j}}f_{i,j}\!\left(\mathbf{x}_i\right)} xj​=∑i&lt;j​fi,j​(xi​)，整个单元格的输出是通过连接节点 x 2 \mathbf{x}_2 x2​– x N − 1 \mathbf{x}_{N-1} xN−1​ 的输出而形成的，即 c o n c a t &amp;NegativeThinSpace; ( x 2 , x 3 , … , x N − 1 ) \mathrm{concat}\!\left(\mathbf{x}_2,\mathbf{x}_3,\ldots,\mathbf{x}_{N-1}\right) concat(x2​,x3​,…,xN−1​) 。请注意，前两个节点 x 0 \mathbf{x}_0 x0​ 和 x 1 \mathbf{x}_1 x1​ 是单元的输入节点，在架构搜索期间是固定的。 搜索过程完成后，在每个边 ( i , j ) \left(i,j\right) (i,j) 上，保留具有最大 α i , j o \alpha_{i,j}^o αi,jo​ 值的操作 o o o，并且每个节点 j j j 连接到具有最大 α i , j o \alpha_{i,j}^o αi,jo​ 的两个先例（ i &amp;lt; j {i}&amp;lt;{j} i&lt;j）。 实验中， 在 CIFAR-10 上搜索基础单元，由组件构建网络从头训练得到 ImageNet 上的结果。 DARTS 在 O \mathcal{O} O 中包括以下操作： 3 × 3 separable convolution 5 × 5 separable convolution 3 × 3 dilated separable convolution 5 × 5 dilated separable convolution 3 × 3 max pooling 3 × 3 average pooling identity z e r o zero zero。 所有操作步长为1（如果适用），填充卷积特征图以保持其空间分辨率。使用 ReLU-Conv-BN 顺序进行卷积运算，并且每个可分离卷积总是应用两次（[NASNet] [AmoebaNet][PNAS]）。 卷积单元由 N = 7 N=7 N=7 个节点组成，其中定义输出节点为所有中间节点（不包括输入节点）的深度级联。其余的设置遵循 [NASNet] [AmoebaNet][PNAS]，然后通过将多个单元堆叠在一起形成网络。单元 k k k 的第一和第二节点分别设置为等于单元 k − 2 k-2 k−2 和单元 k − 1 k-1 k−1 的输出，并且根据需要插入 1 × 1 1 \times 1 1×1 卷积。 位于网络总深度的1/3和2/3处的单元是约简单元，其中与输入节点相邻的所有操作步长为2。因此，体系结构编码是 ( α n o r m a l , α r e d u c e ) (\alpha_{normal}, \alpha_{reduce}) (αnormal​,αreduce​)，其中 α n o r m a l \alpha_{normal} αnormal​ 由所有正常单元共享， α r e d u c e \alpha_{reduce} αreduce​ 由所有约简单元共享。 为了更好地理解深度对架构搜索的影响，DARTS 通过将堆栈中的单元数量从8增加到20来对 CIFAR-10进行架构搜索。由于单个 GPU 显存的限制，初始通道数量从16减少到6。测试误差，略低于较浅网络。 P-DARTS P-DARTS 是同济大学和华为诺亚方舟实验室提出的一种渐进式的可微分网络结构搜索方法，致力于提升 DARTS 的迁移性能。在 CIFAR10和 CIFAR100数据集上搜索基本单元，单个P100 GPU上只需要7个小时。在DARTS中，网络结构搜索是在一个拥有8个 cell 的搜索网络上进行的，然而却是在一个拥有20个 cell 的网络上测试的，在搜索网络和测试网络之间有一个很大的深度差异。 P-DARTS 渐进地增加搜索网络深度。P-DARTS 提出搜索空间近似，划分学习阶段，减少候选操作的种类的同时增加深度，从而降低显存和时间消耗。算法能够在16 GB 显存的 GPU 上运行。 上一阶段结尾将一些操作从搜索空间中删去，因此需要从头开始训练网络参数和结构参数。但是训练一个更深的网络往往比训练一个较浅的网络更难。信息往往倾向于通过 skip-connect 流动，而不是卷积。作者提出搜索空间正则，在 skip-connect 操作添加操作层面的 Dropout 来防止其过拟合到 skip-connect 上，同时限制最终结构中的 skip-connect 操作数量来进一步提高稳定性。 作者同时观察到测试时的识别准确率与搜索到的结构中的 skip-connect 操作数量与最终性能高度相关。因此，作者提出第二个搜索空间正则方法，即在最终生成的网络结构中，保留固定数量的 skip-connect 操作。具体的，作者根据最终阶段的结构参数，只保留权值最大的 M 个 skip-connect 操作，这一正则方法保证了搜索过程的稳定性。在本文中， M=2 。 P-DARTS 能够在 16 GB 显存的 GPU 上完成搜索。 PC-DARTS DARTS 将操作选择转换为固定操作集的加权组合，为寻找有效的网络架构提供了快速解决方案。但联合训练超网络和搜索最优结构，内存和计算开销很大。P-DARTS 减少搜索空间，而这一近似会导致可能牺牲已发现架构的最优性。PC-DARTS 通过对超网络的一小部分进行采样以减少网络空间中的冗余，从而在不损害性能的情况下提高搜索效率。具体来说，PC-DARTS 在通道子集中执行操作搜索，并保持其他部分不变。采样不同通道可能造成在选择超网络的边时出现不一致。PC-DARTS 通过引入边正则（edge normalization）来解决这个问题，在搜索过程中添加了一组新的边级超参数，以减少搜索中的不确定性。项目地址为：yuhuixu1993/PC-DARTS。 PC-DARTS 即部分连接 DARTS，核心思想是直观的：随机抽取其中的一个子集进行操作选择，同时直接放过其余部分，而不是将所有通道都送到操作选择块中。PC-DARTS 假设该子集的计算能近似替代所有通道。除了内存和计算成本都大大降低之外，采样带来了另一个好处，即操作搜索正则化，不易陷入局部最优。然而，PC-DARTS 也带来了副作用，即网络连接的选择将变得不稳定，因为在迭代中会采样不同的信道子集。因此，PC-DARTS 引入边正则（edge normalization）来通过显式学习一组额外的边选择超参数来稳定对网络连接的搜索。通过在整个训练过程中共享这些超参数，所学习的网络结构不易受迭代中通道采样的影响，因此更加稳定。 得益于部分连接策略，PC-DARTS 能够相应地增加批量大小。在实践中，PC-DARTS 为每个操作选择随机抽取 1 / K 1/K 1/K 的通道，这将减少几乎 K K K 倍的内存成本。这使得我们可以在搜索过程中使用 K × K\times K× 批量大小，不仅可以将搜索速度加快 K K K 倍，而且还稳定了搜索，特别是对于大型数据集。 当然，以上都是作者观点。读代码的话会发现通道不是随机取的，而是固定取前 1 / K 1/K 1/K。所以“边正则”概念就有点飘了。DARTS 不仅仅选择操作，还会像剪枝一样确定连接。然而同层会有多个 softmax 输出，从中选最大显得不甚合理。额外加一组结构参数应该可以改善这一点。 DARTS 的缺点在于其内存效率低下。为了适应 ∣ O ∣ |\mathcal{O}| ∣O∣ 操作，在搜索架构的主要部分中， ∣ O ∣ |\mathcal{O}| ∣O∣ 操作副本及其输出需要存储在每个节点（即每个网络层），导致 ∣ O ∣ × |\mathcal{O}|\times ∣O∣× 次内存使用。要装进GPU，必须在搜索期间减小批量大小，这不可避免地降低搜索速度，并且较小的批量大小可能降低搜索稳定性和准确性。 或者，内存效率的另一种解决方案是部分通道连接，如下图所示。以 x i \mathbf{x}_i xi​ 与 x j \mathbf{x}_j xj​ 的连接为例。这涉及定义一个通道采样掩码 S i , j \mathbf{S}_{i,j} Si,j​，它为所选通道分配 1 1 1，为屏蔽的通道分配 0 0 0。所选通道送入 ∣ O ∣ \left|\mathcal{O}\right| ∣O∣ 混合操作计算，而屏蔽通道则绕过这些操作，即直接复制到输出， f i , j P C &amp;NegativeThinSpace; ( x i ; S i , j ) = ∑ o ∈ O exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } ⋅ o &amp;NegativeThinSpace; ( S i , j ∗ x i ) + ( 1 − S i , j ) ∗ x i . {f_{i,j}^\mathrm{PC}\!\left(\mathbf{x}_i;\mathbf{S}_{i,j}\right)}={{\sum_{o\in\mathcal{O}}}\frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}\cdot o\!\left(\mathbf{S}_{i,j}\ast\mathbf{x}_i\right)+\left(1-\mathbf{S}_{i,j}\right)\ast\mathbf{x}_i}. fi,jPC​(xi​;Si,j​)=o∈O∑​∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​⋅o(Si,j​∗xi​)+(1−Si,j​)∗xi​. 其中， S i , j ∗ x i \mathbf{S}_{i,j}\ast\mathbf{x}_i Si,j​∗xi​ 和 ( 1 − S i , j ) ∗ x i \left(1-\mathbf{S}_{i,j}\right)\ast\mathbf{x}_i (1−Si,j​)∗xi​ 分别表示选定和屏蔽的通道。 在实践中，PC-DARTS 将 K K K 视为超参数，设置选中通道的比例为 1 / K 1/K 1/K。 通过改变 K K K，可以在架构搜索准确度（较小的 K K K）和效率（较大的 K K K）之间进行权衡以取得平衡。 K K K 带来的直接好处是 f i , j P C &amp;NegativeThinSpace; ( x i ; S i , j ) f_{i,j}^\mathrm{PC}\!\left(\mathbf{x}_i;\mathbf{S}_{i,j}\right) fi,jPC​(xi​;Si,j​) 计算减少 K K K 次。这允许使用更大的批量大小进行结构搜索。随即有两方面的好处： 首先，计算成本也可以减少 K K K 倍。 此外，较大的批量大小意味着可以在每次迭代期间对更多训练数据进行采样。这对于结构搜索尤为重要。在大多数情况下，一个操作相对于另一个操作的优势并不显著，除非在一个小批量中包含更多的训练数据，以减少更新网络权重和架构参数的不确定性。 通道采样对神经架构搜索的影响既有有积极的也有消极的： 在好的一面，为混合操作输入一小部分通道，同时保持其余部分不变，可以减少在选择操作时的偏向。换句话说，对于边 ( i , j ) \left(i,j\right) (i,j)，给定输入 x i \mathbf{x}_i xi​，使用两组超参数 { α i , j o } \left\{\alpha_{i,j}^o\right\} {αi,jo​} 和 { α i , j ′ o } \left\{\alpha_{i,j}^{\prime o}\right\} {αi,j′o​} 的差别大大减少了，因为只有一小部分（ 1 / K 1/K 1/K）的输入通道将通过混合操作，而其余通道保持不变。这削弱了 O \mathcal{O} O 中无参数操作（如 skip-connect、max-pooling 等）相对于含参操作（例如各种卷积）的优势。在早期阶段，搜索算法通常更青睐无参操作，因为它们没有训练参数，从而产生更一致的输出，即 o &amp;NegativeThinSpace; ( x i ) o\!\left(\mathbf{x}_i\right) o(xi​)。相比之下，在参数得到充分优化之前，含参操作在迭代中传播的信息不一致。因此，无参操作通常会在开始时累积较大的权重（即 α i , j o \alpha_{i,j}^o αi,jo​），这使得含参操作即使在经过良好训练之后也很难击败它们。当（执行结构搜索的）代理数据集很难时，这种现象尤其显著，这阻碍了 DARTS 在 ImageNet 上获得令人满意的搜索结果。 不利的一面是，和 DARTS 一样，在一个单元格中，每个输出节点 x j \mathbf{x}_j xj​ 需要从其先例 { x 0 , x 1 , … , x j − 1 } \left\{\mathbf{x}_0,\mathbf{x}_1,\ldots,\mathbf{x}_{j-1}\right\} {x0​,x1​,…,xj−1​} 中选取两个输入节点，候选操作权重为 max ⁡ o α 0 , j o , max ⁡ o α 1 , j o , … , max ⁡ o α j − 1 , j o \max_o\alpha_{0,j}^o,\max_o\alpha_{1,j}^o,\ldots,\max_o\alpha_{j-1,j}^o maxo​α0,jo​,maxo​α1,jo​,…,maxo​αj−1,jo​。然而，这些架构参数通过迭代中的随机采样通道进行优化。因此，当采样通道随时间变化时，由它们确定的最佳连接性可能不稳定。这可能导致所得网络架构中出现预期之外的波动。为了缓解这个问题，PC-DARTS 引入了边正则化， β i , j \beta_{i,j} βi,j​ 明确地权衡每个边 ( i , j ) \left(i,j\right) (i,j)，因此 x j \mathbf{x}_j xj​ 的计算成为： x j P C = ∑ i &amp;lt; j exp ⁡ { β i , j } ∑ i ′ &amp;lt; j exp ⁡ { β i ′ , j } ⋅ f i , j &amp;NegativeThinSpace; ( x i ) . \mathbf{x}_j^\mathrm{PC}={\sum_{i&amp;lt;j}\frac{\exp\left\{\beta_{i,j}\right\}}{{\sum_{i&amp;#x27;&amp;lt;j}}\exp\left\{\beta_{i&amp;#x27;,j}\right\}}\cdot f_{i,j}\!\left(\mathbf{x}_i\right)}. xjPC​=i&lt;j∑​∑i′&lt;j​exp{βi′,j​}exp{βi,j​}​⋅fi,j​(xi​). 具体来说，在架构搜索完成后，边 ( i , j ) \left(i,j\right) (i,j) 的连接由 { α i , j o } \left\{\alpha_{i,j}^o\right\} {αi,jo​} 和 β i , j \beta_{i,j} βi,j​ 确定。PC-DARTS 归一化系数，然后相乘，即 exp ⁡ { β i , j } ∑ i ′ &amp;lt; j exp ⁡ { β i ′ , j } ⋅ exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } \frac{\exp\left\{\beta_{i,j}\right\}}{{\sum_{i&amp;#x27;&amp;lt;j}}\exp\left\{\beta_{i&amp;#x27;,j}\right\}} \cdot \frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}} ∑i′&lt;j​exp{βi′,j​}exp{βi,j​}​⋅∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​。 由于 β i , j \beta_{i,j} βi,j​ 在训练过程中共享，因此学习的网络架构不易受迭代间采样通道影响，从而使架构搜索更加稳定。 P-DARTS 在 skip-connect 之后应用了 dropout，以避免参数化和无参数操作之间的信息不平衡。 SNAS 随机神经网络架构搜索（Stochastic Neural Architecture Search，SNAS），是商汤发表在 ICLR 2019上的一篇文章，吸收了 ENAS 和 DARTS 的优点。SNAS 的实质似乎就是将 DARTS 中的 Softmax 换成了Concrete distribution 并加了资源约束项，然而整个叙述却十分复杂。SNAS 在同一轮反向传播中训练神经运算的参数和架构的分布参数（这样真的好？）。号称的思想是，利用泛化损失中的梯度信息提高基于强化学习的 NAS 的效率。 与基于强化学习的方法[ENAS]相比，SNAS 的搜索优化可微分，搜索效率更高，可以在更少的迭代次数下收敛到更高准确率。 与其他可微分的方法[DARTS]相比，SNAS 直接优化 NAS 任务的目标函数，搜索结果偏差更小，可以直接通过一阶优化搜索。 同时优化网络损失函数的期望和网络前向时延的期望，可以自动生成硬件友好的稀疏网络。 SNAS 的实验设置基本与 DARTS 相同。 SNAS 将子网络运行延迟作为目标的正规化项： E Z ∼ p α ( Z ) [ L θ ( Z ) + η C ( Z ) ] = E Z ∼ p α ( Z ) [ L θ ( Z ) ] + η E Z ∼ p α ( Z ) [ C ( Z ) ] , \begin{aligned} \mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[L_{\mathit{\theta}}(\mathit{Z})+\eta C(\mathit{Z})]=\mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[L_{\mathit{\theta}}(\mathit{Z})]+\eta \mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[C(\mathit{Z})], \end{aligned} EZ∼pα​(Z)​[Lθ​(Z)+ηC(Z)]=EZ∼pα​(Z)​[Lθ​(Z)]+ηEZ∼pα​(Z)​[C(Z)],​ 其中 C ( Z ) C(\mathit{Z}) C(Z) 是与随机变量 Z \mathit{Z} Z 相关联的子网络的时间成本，包含3项指标： 参数量; 浮点运算（float-point operations， FLOPs）的数量; 内存访问成本（memory access cost，MAC）。 FBNet 与 BSN 相同，FBNet 以随机超网络表示搜索空间。将寻找最佳架构的问题放宽为找到产生最优体系结构的分布。借助于 Gumbel Softmax 可以使用基于梯度的优化（如 SGD）直接训练架构分布。损失包括交叉熵损失和延迟损失。相当于宏搜索版的 SNAS。 随机超网络对候选块进行采样，采样概率为 P θ l ( b l = b l , i ) = softmax ( θ l , i ; θ l ) = exp ⁡ ( θ l , i ) ∑ i exp ⁡ ( θ l , i ) . P_{\bm{\theta}_{l}}(b_l = b_{l,i}) = \text{softmax}(\theta_{l,i}; \bm{\theta}_l) = \frac{\exp(\theta_{l,i})}{\sum_i \exp(\theta_{l,i})}. Pθl​​(bl​=bl,i​)=softmax(θl,i​;θl​)=∑i​exp(θl,i​)exp(θl,i​)​. θ l \bm{\theta}_l θl​ 包含的参数确定在第 l l l 层采样每个块的概率。同样，第 l l l 层的输出可以表示为 x l + 1 = ∑ i m l , i ⋅ b l , i ( x l ) , x_{l+1} = \sum_i m_{l, i} \cdot b_{l, i}(x_{l}), xl+1​=i∑​ml,i​⋅bl,i​(xl​), 其中 m l , i m_{l,i} ml,i​ 是 { 0 , 1 } \{0, 1\} {0,1} 中的随机变量，如果采样块 b l , i b_{l, i} bl,i​，则计算结果为1。采样概率由前面的等式确定。 b l , i ( x l ) b_{l, i}(x_{l}) bl,i​(xl​) 表示给定输入特征图 x l x_{l} xl​ 的情况下，第 l l l 层的第 i i i 块的输出。FBNet 让每个层独立采样，因此，采样架构 a a a 的概率可以描述为 P θ ( a ) = ∏ l P θ l ( b l = b l , i ( a ) ) , P_{\bm{\theta}}(a) = \prod_l P_{\bm{\theta}_l} (b_l = b_{l,i}^{(a)}), Pθ​(a)=l∏​Pθl​​(bl​=bl,i(a)​), 其中 θ \bm{\theta} θ 为一个向量，元素 θ l , i \theta_{l,i} θl,i​ 为第 i i i 块的第 l l l 层的采样参数。 b l , i ( a ) b_{l,i}^{(a)} bl,i(a)​ 表示在采样架构中 a a a，在第 l l l 层中选中第 i i i 个块。 松弛求解最佳架构 a ∈ A a \in \mathcal{A} a∈A 问题为优化随机超网络的概率 P θ P_\theta Pθ​ 以实现最小预期损失，公式重写为 min&nbsp; θ min&nbsp; w a E a ∼ P θ { L ( a , w a ) } . \underset{\bm{\theta}}{\text{min }} \underset{w_a}{\text{min }} \mathbf{E}_{a \sim P_{\bm{\theta}}} \{\mathcal{L}(a, w_a) \}. θmin&nbsp;​wa​min&nbsp;​Ea∼Pθ​​{L(a,wa​)}. 将离散掩码变量 m l , i m_{l,i} ml,i​ 放宽为由 Gumbel Softmax 函数计算的连续随机变量： m l , i = GumbelSoftmax ( θ l , i ∣ θ l ) = exp ⁡ [ ( θ l , i + g l , i ) / τ ] ∑ i exp ⁡ [ ( θ l , i + g l , i ) / τ ] , \begin{aligned} m_{l, i} &amp;amp; = \text{GumbelSoftmax}(\theta_{l, i}|\bm{\theta_{l}}) \\ &amp;amp; = \frac{\exp[(\theta_{l,i} + g_{l,i})/\tau]}{\sum_i \exp[(\theta_{l,i} + g_{l,i})/\tau]}, \end{aligned} ml,i​​=GumbelSoftmax(θl,i​∣θl​)=∑i​exp[(θl,i​+gl,i​)/τ]exp[(θl,i​+gl,i​)/τ]​,​ 其中 g l , i ∼ Gumbel(0,&nbsp;1) g_{l,i} \sim \text{Gumbel(0, 1)} gl,i​∼Gumbel(0,&nbsp;1) 是 Gumbel 分布的随机噪声。Gumbel Softmax 函数由温度参数 τ \tau τ 控制。当 τ \tau τ 接近0时，它近似于 P θ ( a ) = ∏ l P θ l ( b l = b l , i ( a ) ) P_{\bm{\theta}}(a) = \prod_l P_{\bm{\theta}_l} (b_l = b_{l,i}^{(a)}) Pθ​(a)=∏l​Pθl​​(bl​=bl,i(a)​) 中分布的离散分类抽样。随着 τ \tau τ 变大， m l , i m_{l,i} ml,i​ 成为一个连续的随机变量。无论 τ \tau τ 的值如何，掩码 m l , i m_{l,i} ml,i​ 都对参数 θ l , i \theta_{l, i} θl,i​ 可微。DNAS 和 SNAS 同样使用 Gumbel Softmax 进行网络结构搜索。 对于延迟项，FBNet 使用基于查找表的模型进行效率估计，因此 LAT ( a ) \text{LAT}(a) LAT(a) 公式可以写为 LAT ( a ) = ∑ l ∑ i m l , i ⋅ LAT ( b l , i ) . \text{LAT}(a) = \sum_l \sum_i m_{l,i} \cdot \text{LAT} (b_{l,i}). LAT(a)=l∑​i∑​ml,i​⋅LAT(bl,i​). 每个运算符 LAT ( b l , i ) \text{LAT} (b_{l,i}) LAT(bl,i​) 的延迟是一个常数系数，从而架构 a a a 的整体延迟相对于掩码 m l , i m_{l,i} ml,i​ 是可微分的。 训练过程为： 随机取 ImageNet 的100类在8 GPU 机器上训练随机超网络90个 epoch，batchsize=192； 挑选出最优结构后，在 ImageNet 上训练360个 epoch，batchsize=256。 FBNet 的搜索空间参考 MobileNetV2 和 ShiftNet ，网络首尾固定，中间的22层可调，如 Table 1 所示。 块结构如下图所示，深度分离卷积可选3x3或5x5的卷积核，块内的首尾1x1卷积可替换为 group + channel shuffle。 值得注意的是网络没有使用 BN，论文也未谈到这一点。但 fbnet_builder 中是有的。 从 ImageNet 中随即取100类作为训练集，历经90个 epoch。找到最优结构后，从头训练模型。损失函数为： L ( a , w a ) = &nbsp;CE ( a , w a ) ⋅ α log ⁡ ( LAT ( a ) ) β \begin{aligned} \mathcal{L}(a, w_a) = \text{ CE}(a, w_a) \cdot \alpha \log(\text{LAT}(a))^\beta \end{aligned} L(a,wa​)=&nbsp;CE(a,wa​)⋅αlog(LAT(a))β​ 第一项 CE ( a , w a ) \text{CE}(a, w_a) CE(a,wa​) 表示架构 a a a 与相应参数 w a w_a wa​ 的交叉熵损失。第二项 LAT ( a ) \text{LAT}(a) LAT(a) 表示目标硬件上体系结构的延迟，以微秒为单位。系数 α \alpha α 控制损失函数的总体大小。指数系数 β \beta β 调制延迟项的大小。除了 log 外，形式与 MnasNet 类似。 FBNet 预先测试每个 op 的耗时，创建查找表来估计不同模型的延时。目标设备为 Samsung Galaxy S8和 iPhone X。 LAT ( a ) = ∑ l LAT ( b l ( a ) ) , \begin{aligned} \text{LAT}(a) = \sum_l \text{LAT} (b_l^{(a)}), \end{aligned} LAT(a)=l∑​LAT(bl(a)​),​ 其中 b l ( a ) b_l^{(a)} bl(a)​ 表示架构 a a a 来自第 l l l 层的块。 FBNet 将模型量化到 int8 在 Caffe2上测试，为对比将其他方法也进行了转换。 ProxylessNAS D R DARTS ProxylessNAS BinaryConnect REINFORCE MobileNetV2 可微 NAS 通过网络架构的连续表示来降低训练时长，但会遇到高 GPU 内存消耗问题（随候选集大小线性增长）。ProxylessNAS 着眼于减少内存消耗，在训练时采样两条路径。采用强化学习和梯度下降两种方法训练 CPU、GPU 以及移动处理器3个平台上的模型。文中试图套用 BinaryConnect ，大讲二值化。然而路径二值化并不能降低内存消耗，实际运行机理与此毫不相干。直接在目标数据集上训练也有点噱头，因为分摊下来每条路径的训练轮数不多。论文题目不如改成随机采样更新的 Softmax 近似。而且，采样路径却未提 BatchNorm 如何应对。一个鲜明的例子是 DenseNAS 也使用路径采样方法，但未提及二值化。 ProxylessNAS 受 DARTS 和 One-Shot 的启发 ， 将 NAS 定义为路径级修剪过程。 ProxylessNAS 在目标硬件上学习专用网络结构，但硬件目标（以延迟为例）不可微分。为此，其将网络延迟建模为连续函数，并作为正则化损失进行优化，类似于 SNAS。此外，ProxylessNAS 还提出了一种基于 REINFORCE规则 的算法（Proxyless-R），作为处理硬件度量的替代策略。 ProxylessNAS 将路径 N 选择一分解为多个二进制选择任务。 直觉是，如果一条路径是特定位置的最佳选择，那么与任何其他路径相比，它应该是更好的选择。 在结构参数的更新步骤中： 首先根据多项分布 ( p 1 , ⋯ &amp;ThinSpace; , p N ) (p_1, \cdots, p_N) (p1​,⋯,pN​) 对两条路径进行采样，并屏蔽所有其他路径，就好像它们不存在一样。因此，候选数暂时从 N N N 减少到2，而路径权重 { p i } \{p_i\} {pi​} 和二进制门 { g i } \{g_i\} {gi​} 相应地重置。 然后，我们使用通过公式(4)计算的梯度更新这两个采样路径的架构参数。 最后，由于通过将 softmax 应用于架构参数来计算路径权重，需要通过乘以比率来重新调整这两个更新的架构参数的值，以保持未采样路径的路径权重不变。 这样，在每个更新步骤中，一个采样路径被增强（路径权重增大），另一个采样路径被衰减（路径权重减小），而所有其他路径保持不变。这样，无论 N N N 的值如何，在架构参数的每个更新步骤中仅涉及两条路径，从而将内存需求降低到训练紧凑模型的相同水平。 为了使延迟可微分，ProxylessNAS 将网络的延迟建模为神经网络维度的连续函数。考虑具有候选集 { o j } \{o_j\} {oj​} 的混合操作，并且每个 o j o_j oj​ 与路径权重 p j p_j pj​ 相关联，该权重表示选择 o j o_j oj​ 的概率。因此，混合操作（即可学习块）的预期延迟如下： E [ latency i ] = ∑ j p j i × F ( o j i ) , \mathbb{E} [\text{latency}_i] = \sum_j p_j^i \times F(o_j^i), E[latencyi​]=j∑​pji​×F(oji​), 其中 E [ latency i ] \mathbb{E} [\text{latency}_i] E[latencyi​] 是 i t h i^{th} ith 可学习块的预期延迟， F ( ⋅ ) F(\cdot) F(⋅) 表示延迟预测模型， F ( o j i ) F(o_j^i) F(oji​) 是 o j i o_j^i oji​ 的预测延迟。因此， E [ latency i ] \mathbb{E} [\text{latency}_i] E[latencyi​] 关于体系结构参数的梯度为： ∂ E [ latency i ] &nbsp; / &nbsp; ∂ p j i = F ( o j i ) \partial \mathbb{E} [\text{latency}_i]~/~\partial p_j^i = F(o_j^i) ∂E[latencyi​]&nbsp;/&nbsp;∂pji​=F(oji​)。 对于具有一系列混合操作的整个网络，由于这些操作在推理期间按顺序执行，因此网络的预期延迟可以用这些混合操作的总预期延迟之和表示： E [ latency ] = ∑ i E [ latency i ] , \mathbb{E} [\text{latency}] = \sum_i \mathbb{E} [\text{latency}_i], E[latency]=i∑​E[latencyi​], Proxyless-G 通过乘以比例因子 λ 2 ( &amp;gt; 0 ) \lambda_2 (&amp;gt; 0) λ2​(&gt;0) 将网络的预期延迟纳入正常损失函数，该比例因子控制精度和延迟之间的权衡。最终的损失函数给出为 L o s s = L o s s C E + λ 1 ∣ ∣ w ∣ ∣ 2 2 + λ 2 E [ latency ] , Loss = Loss_{CE} + \lambda_1 ||w||_2^2 + {\color{red} \lambda_2 \mathbb{E}[\text{latency}]}, Loss=LossCE​+λ1​∣∣w∣∣22​+λ2​E[latency], 其中 L o s s C E Loss_{CE} LossCE​ 表示交叉熵损失， λ 1 ∣ ∣ w ∣ ∣ 2 2 \lambda_1 ||w||_2^2 λ1​∣∣w∣∣22​ 是权重衰减项。 ProxylessNAS 还可以利用 REINFORCE 来训练二值化权重。考虑具有二进制化参数 α \alpha α 的网络，更新二进制化参数的目的是找到最大化某个奖励 R ( ⋅ ) R(\cdot) R(⋅) 的最佳二进制门 g g g 。为便于说明，这里假设网络只有一个混合操作。因此，根据 REINFORCE ，对二进制化参数进行了以下更新： J ( α ) = E g ∼ α [ R ( N g ) ] = ∑ i p i R ( N ( e = o i ) ) , ∇ α J ( α ) = ∑ i R ( N ( e = o i ) ) ∇ α p i = ∑ i R ( N ( e = o i ) ) p i ∇ α log ⁡ ( p i ) , = E g ∼ α [ R ( N g ) ∇ α log ⁡ ( p ( g ) ) ] ≈ 1 M ∑ i = 1 M R ( N g i ) ∇ α log ⁡ ( p ( g i ) ) , \begin{aligned} J(\alpha) &amp;amp;= \mathbb{E}_{g \sim \alpha}[R(\mathcal{N}_g)] = \sum_i p_i R(\mathcal{N}(e = o_i)), \\ \nabla_\alpha J(\alpha) &amp;amp;= \sum_i R(\mathcal{N}(e = o_i)) \nabla_\alpha p_i = \sum_i R(\mathcal{N}(e = o_i)) p_i \nabla_\alpha \log(p_i), \\ &amp;amp;= \mathbb{E}_{g \sim \alpha} [R(\mathcal{N}_g) \nabla_\alpha \log(p(g))] \approx \frac{1}{M} \sum_{i=1}^M R(\mathcal{N}_{g^i}) \nabla_\alpha \log(p(g^i)), \end{aligned} J(α)∇α​J(α)​=Eg∼α​[R(Ng​)]=i∑​pi​R(N(e=oi​)),=i∑​R(N(e=oi​))∇α​pi​=i∑​R(N(e=oi​))pi​∇α​log(pi​),=Eg∼α​[R(Ng​)∇α​log(p(g))]≈M1​i=1∑M​R(Ngi​)∇α​log(p(gi)),​ 其中 g i g^i gi 表示第 i t h i^{th} ith 个采样二进制门， p ( g i ) p(g^i) p(gi) 表示根据公式2采样 g i g^i gi 的概率， N g i \mathcal{N}_{g^i} Ngi​ 是根据二进制门 g i g^i gi 的紧凑型网络。由于上式不需要 R ( N g ) R(\mathcal{N}_g) R(Ng​) 对 g g g 可微，因此它可以处理不可微分的目标。一个有趣的观察是，公式eq:reinforce具有与标准 NAS 类似的形式，但它不是一个连续的决策过程，并且没有使用 RNN 元控制器。此外，由于基于梯度的更新和基于 REINFORCE 的更新对于相同的二值化体系结构参数基本上是两个不同的更新规则，因此可以将它们组合以形成体系结构参数的新更新规则。 Proxyless-R 与 MnasNet 类似，使用 A C C ( m ) × [ L A T ( m ) / T ] w ACC(m) \times [ LAT(m) / T]^w ACC(m)×[LAT(m)/T]w 作为优化目标，其中 A C C ( m ) ACC(m) ACC(m) 表示模型 m m m 的准确率， L A T ( m ) LAT(m) LAT(m) 表示 m m m 的延迟， T T T 是目标延迟， w w w 是用于控制准确性和延迟之间权衡的超参数。 ProxylessNAS 与 DARTS 在验证集上训练结构参数 α {\alpha} α，而 FBNet 未进行划分。 ProxylessNAS 设置一系列 MBConv，卷积核大小可选 { 3 , 5 , 7 } \{3, 5, 7\} {3,5,7} 扩张系数为 { 3 , 6 } \{3, 6\} {3,6}。 令人困惑的是 ProxylessNAS 的 batchsize=256，FBNet 为192。FBNet 只用 ImageNet 的1/10，ProxylessNAS 使用全部，二者训练时间却相同。FBNet 估计 MnasNet 的成本为91000 GPU hours；ProxylessNAS 实现的是40000。假定 ProxylessNAS 用的是 V100（测试平台是这一型号）， FBNet 的设备似乎与之存在代差。 Single-Path NAS Single-Path NAS 是一种单路径（或者 superkernel）方法。用一个7x7的大卷积，来代表3x3、5x5和7x7的三种卷积，把外边一圈 mask 清零掉就变成了3x3或5x5。扩张系数类似，认为6包含两个3，实现高度的参数复用。 省显存，然而本质还是搜索空间小。基础网络参考 FBNet，仅搜索 expansion rate 和 kernel size。Single-Path NAS 代码 dstamoulis/single-path-nas 完全开源，依赖 TensorFlow 和 TPU，使用 facebook/FAI-PEP 分析模型每层的运行时间。比较有意思的是文中的表格，几种搜索算法结果并未拉开差距。 DenseNAS DenseNAS 由地平线和华中科技大学联合提出，号称可以搜索网络结构中每个 block 的宽度和对应的空间分辨率。DenseNAS 构建一个密集连接的搜索空间。每个块的滤波器的数量（即宽度）以小步幅逐渐增加。搜索空间参考 MobileNetV2 并采用密集连接的形式构建。搜索空间比之前一些算法大。然而 DenseNAS 与 FBNet 一样训练集取 ImageNet 的1/10，同时类似 ProxylessNAS 采样路径训练，反而比二者训练时间缩短一半。 如下图所示，DenseNAS 在三个不同的级别（layer、block 和 network）定义搜索空间： 每个层都包含所有候选操作； 一个块可以分为两个组件：头部层和堆叠层； 整个网络使用具有增量宽度的块构建。 层为搜索空间中的基本结构。一层代表一组候选操作。搜索空间中的操作集合如表 Table 1 所示。 每个块由若干层组成，拥有固定宽度和相应的空间分辨率。头部层处理具有不同通道数和空间分辨率的输入张量，并转换为固定宽度和空间分辨率。头部层不包括跳过连接，因为它是所有块所必需的。头部层之后是许多堆叠层（图中的例子中是三层）。之后，堆叠层中的操作以相同数量的通道和空间分辨率执行。 MnasNet、ProxylessNAS 和 FBNet 设置固定数量的块。DenseNAS 在搜索空间中设计了更多具有不同宽度的块，并允许搜索架构只包含块的子集，从而使搜索算法能够自由地选择具有特定宽度的块，同时丢弃其他块。 整个超网络架构定义为 A r c h Arch Arch，并假设它包含 N N N 个块： A r c h = { B 1 , B 2 , . . . , B N } Arch = \{B_1, B_2, ..., B_N\} Arch={B1​,B2​,...,BN​}。 DenseNAS 将整个网络划分为几个阶段。每个阶段拥有不同的宽度范围和固定的空间分辨率。超网络从头到尾，块的宽度以小步幅逐渐增长。网络的早期阶段设定较小的宽度增长步幅，因为设置较大将导致巨大的计算成本。后期阶段增长幅度逐渐变大。如结构图所示，在第3阶段，空间分辨率设置为 28 × 28 28 \times 28 28×28，宽度增长步幅为8。宽度增长步幅在第4阶段变为16，阶段5变为64。 定义块 B i B_i Bi​ 和后续块 B j B_j Bj​（ j &amp;gt; i j &amp;gt; i j&gt;i）之间的连接为 C i j C_{ij} Cij​。 B i B_i Bi​ 和 B j B_j Bj​ 的空间分辨率分别为 H i × W i H_i \times W_i Hi​×Wi​（通常 H i = W i H_i = W_i Hi​=Wi​）和 H j × W j H_j \times W_j Hj​×Wj​。DenseNAS 限制连接仅在空间分辨率相差不超过两倍的块之间。因此，当 j − i ≤ m j - i \leq m j−i≤m 且 H j / H i ≤ 2 H_j / H_i \leq 2 Hj​/Hi​≤2 时， C i j C_{ij} Cij​ 存在。搜索空间基于密集连接的块构建。 但是，只选择一条路径来导出最终的结构。DenseNAS 不仅搜索每个块中的层数，而且还搜索块宽度和块数。同时确定执行空间下采样的层。目标是在搜索空间中找到一条良好的路径，代表架构的最佳深度和宽度配置。 设 b i b_i bi​ 为第 i i i 个块 B i B_i Bi​ 的输出张量。每个块连接到后续 m m m 块。为了将块连接松弛为连续表示，DenseNAS 为块的每个输出路径分配块级架构参数。也就是说，对于从块 B i B_i Bi​ 到 B j B_j Bj​ 的路径，它们之间的路径有一个参数 β i j \beta_{ij} βij​。与计算每个操作的权重类似，使用 softmax 函数计算两个块之间所有路径的概率： p i j = exp ⁡ ( β i j ) ∑ k = 1 m exp ⁡ ( β i k ) . p_{ij} = \frac{\exp(\beta_{ij})}{\sum_{k=1}^m \exp(\beta_{ik})}. pij​=∑k=1m​exp(βik​)exp(βij​)​. 假设块 B i B_i Bi​ 需要来自先前块的 m ′ m&amp;#x27; m′ 输入张量，即 B i − m ′ B_{i-m&amp;#x27;} Bi−m′​, B i − m ′ + 1 B_{i-m&amp;#x27;+1} Bi−m′+1​, B i − m ′ + 2 B_{i-m&amp;#x27;+2} Bi−m′+2​ … B i − 1 B_{i-1} Bi−1​。来自这些块的输入张量在通道数和空间分辨率上有所不同。因此，每个输入张量由 B i B_i Bi​ 中的头部层变换为统一大小，然后求和。设 H i k H_{ik} Hik​ 表示块 B i B_i Bi​ 中第 k k k 个头部层对输入张量 B i − k B_{i-k} Bi−k​ 的转换，其中 k = 1.. m ′ k=1..m&amp;#x27; k=1..m′。转换后的输入张量之和可通过以下公式计算： x i = ∑ k = 1 m ′ p i − k , i ⋅ H i k ( x i − k ) . x_i = \sum_{k=1}^{m&amp;#x27;} p_{i-k, i} \cdot H_{ik}(x_{i-k}). xi​=k=1∑m′​pi−k,i​⋅Hik​(xi−k​). 值得注意的是，路径概率在块输出维度上标准化，但应用于后续块的输入维度（更具体地说，在头部层上）。头部层本质上是是候选操作的混合加权和。层级参数 α \alpha α 控制要选择的操作，而外部块级参数 β \beta β 决定要连接的块。 DenseNAS 的训练方式与 DARTS 类似，权重和架构的优化过程按 epoch 交替进行。搜索过程完成后，根据结构参数导出体系结构： 在层级别，选择具有最大体系结构权重的候选操作，即 a r g m a x o ∈ O α o ℓ argmax_{o \in \mathcal{O}} \alpha_o^\ell argmaxo∈O​αoℓ​； 在网络级，使用 Viterbi 算法根据每个块的输出路径概率来选择连接具有最高总转移概率的块的路径。 超网络包括搜索空间中的所有可能路径和操作。 one-shot 搜索方法在训练超级网络时会丢掉一些路径。该技术使独立模型的性能预测更准确。为了减少内存消耗并加快搜索过程，DenseNAS 采用了 drop-path 训练策略： 当训练操作权重时，DenseNAS 在每一层根据结构参数分布 { α o ℓ ∣ o ∈ O } \{\alpha_o^\ell | o \in \mathcal{O}\} {αoℓ​∣o∈O} 从候选操作中采样出一条路径。丢弃路径训练不仅加速了搜索，而且减弱了搜索空间中不同结构的操作权重之间的耦合效应。 训练结构参数时，像 ProxylessNAS一样根据结构权重分布在每个层中对两个操作进行采样。为了保持未采样的操作的体系结构权重不变，DenseNAS 计算重新平衡偏差以调整采样和新更新的参数。 b i a s s = ln ⁡ ∑ o ∈ O s exp ⁡ ( α o ℓ ) ∑ o ∈ O s exp ⁡ ( α ′ o ℓ ) \mathtt{bias}_s = \ln \frac{\sum_{o \in \mathcal{O}_s} \exp(\alpha_o^\ell)}{\sum_{o \in \mathcal{O}_s} \exp({\alpha&amp;#x27;}_o^\ell)} biass​=ln∑o∈Os​​exp(α′oℓ​)∑o∈Os​​exp(αoℓ​)​ 其中 O s \mathcal{O}_s Os​ 指的是采样的一组操作， α o ℓ \alpha_o^\ell αoℓ​ 指的是层 ℓ \ell ℓ 中最初采样的结构参数， α ′ o ℓ {\alpha&amp;#x27;}_o^\ell α′oℓ​ 是相应更新后的结构参数。训练时 b i a s s \mathtt{bias}_s biass​ 不断累加？ DSO-NAS DSO-NAS 是初创企业图森未来的一篇文章，投 ICLR 2019 被拒。文中对比了不同方法的参数量和计算量。评审中附加了更多实验数据，从中可以看出在网络延迟方面不尽人意。 DSO-NAS 与 ProxylessNAS 一样将网络搜索看作是剪枝过程，采用团队前作 SSS(Sparse Structure Selection) 进行优化。不同的是 DSO-NAS 的 block 内部细分为4层，连接较为复杂。 参考资料： 如何评价google Searching for MobileNetV3？ The Lightweight Face Recognition Challenge guan-yuan/awesome-AutoML-and-Lightweight-Models Literature on Neural Architecture Search D-X-Y/Awesome-NAS google-research/nasbench microsoft/nni 神经网络架构搜索（Neural Architecture Search）杂谈 Xuanyi Dong ENAS的原理和代码解析 业界 | 谷歌提出移动端AutoML模型MnasNet：精度无损速度更快 多图演示高效的神经架构搜索 Gumbel-Softmax Trick和Gumbel分布 旷视提出One-Shot模型搜索框架的新变体 另一种可微架构搜索：商汤提出在反传中学习架构参数的SNAS ICLR 2019｜随机神经网络结构搜索 (SNAS) 论文笔记系列-Neural Architecture Search With Reinforcement Learning ENAS: 更有效地设计神经网络模型(AutoML) 万字解读商汤科技ICLR2019论文：随机神经网络结构搜索 同济和华为诺亚提出：渐进式可微网络结构搜索，显著提升可微式搜索的性能和稳定性，已开源 论文解读：Single-Path NAS 【ICLR 19】DARTS可微网络结构搜索 CVPR 2018 | 商汤科技Oral论文详解：BlockQNN自动网络设计方法 AutoML：NAS 之 Randomly Wired Neural Networks A Survey on Neural Architecture Search Neural architecture search AutoML (1) - Introduction Review: NASNet — Neural Architecture Search Network (Image Classification) ENAS的原理和代码解析 论文笔记系列-Neural Architecture Search With Reinforcement Learning 旷视首席科学家孙剑：深度学习变革视觉计算丨CCF-GAIR 2019 DenseNAS：密集连接搜索空间下的高灵活度网络结构搜索 | 大牛讲堂 强化学习系列（六）：时间差分算法（Temporal-Difference Learning) 强化学习 - 时间差分学习(Temporal-Difference Learning) A3C、PPO、GAE笔记 One-Shot 神经网络搜索(NAS)的searching阶段到底在做什么？ AutoML for Object Detection 解读小米MoGA：超过MobileNetV3的移动端GPU敏感型搜索 如何通俗地讲解 viterbi 算法？" />
<link rel="canonical" href="https://uzzz.org/2019/08/20/794196.html" />
<meta property="og:url" content="https://uzzz.org/2019/08/20/794196.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-20T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"前面介绍了强化学习方法，但屠龙刀毕竟不是人人有。梯度可微算法在保证精度可接受的前提下大幅缩短了训练周期，开启了网络结构搜索的平民化浪潮。 MobileNetV2 FBNet ShiftNet Gumbel-Softmax SNAS DARTS ProxylessNAS P-DARTS PC-DARTS DenseNAS DARTS DARTS 由 CMU 和 DeepMind 提出，最终发表在 ICLR 2019上。DARTS 在有限资源条件下将模型精度提升到可接受的程度，而且开放代码（quark0/darts）。可谓 NAS 领域内的一大贡献。美中不足的是代码仅在单 GPU 下搜索，以至于后续的 chenxin061/pdarts 和 yuhuixu1993/PC-DARTS 亦维持此设置，成为扩展的阻碍。 DARTS 将搜索空间放宽为连续的，以便可以通过梯度下降来优化体系结构的验证集性能。在所有混合操作中联合学习架构 α \\alpha α 和权重 w w w。这意味着一个双层优化问题，其中 α \\alpha α 作为上层变量， w w w 作为下层变量： min ⁡ α L v a l ( w ∗ ( α ) , α ) s.t. w ∗ ( α ) = a r g m i n w L t r a i n ( w , α ) \\begin{aligned} \\min_\\alpha \\quad &amp;amp; \\mathcal{L}_{val}(w^*(\\alpha), \\alpha) \\\\ \\text{s.t.} \\quad &amp;amp;w^*(\\alpha) = \\mathrm{argmin}_w \\enspace \\mathcal{L}_{train}(w, \\alpha) \\end{aligned} αmin​s.t.​Lval​(w∗(α),α)w∗(α)=argminw​Ltrain​(w,α)​ DARTS 求结构梯度的近似解： ∇ α L v a l ( w ∗ ( α ) , α ) ≈ ∇ α L v a l ( w − ξ ∇ w L t r a i n ( w , α ) , α ) \\begin{aligned} &amp;amp;\\nabla_\\alpha \\mathcal{L}_{val}(w^*(\\alpha), \\alpha) \\\\ \\approx &amp;amp;\\nabla_\\alpha \\mathcal{L}_{val}(w - \\xi \\nabla_{w} \\mathcal{L}_{train}(w, \\alpha), \\alpha) \\end{aligned} ≈​∇α​Lval​(w∗(α),α)∇α​Lval​(w−ξ∇w​Ltrain​(w,α),α)​ 其中 w w w 表示算法维护的当前权重， ξ \\xi ξ 是内部优化步骤的学习率。思路是通过仅使用单个训练步骤来调整 w w w 来近似 w ∗ ( α ) w^*(\\alpha) w∗(α)，而不是训练至收敛来完全求解内部优化。 从形式上讲，DARTS 将搜索网络分解为若干（ L L L）个的单元（cell）。每个单元组织为具有 N N N 个节点的有向无环图（DAG），其中每个节点定义一个网络层。预定义操作空间 O \\mathcal{O} O，其中每个元素 o &amp;NegativeThinSpace; ( ⋅ ) o\\!\\left(\\cdot\\right) o(⋅) 是在网络层执行的固定操作（例如，identity connection, and 3 × 3 3\\times3 3×3 convolution）。在单元内，目标是从 O \\mathcal{O} O 中选择一个操作来连接每对节点。设一对节点为 ( i , j ) \\left(i,j\\right) (i,j)，其中 0 ⩽ i &amp;lt; j ⩽ N − 1 {0}\\leqslant{i}&amp;lt;{j}\\leqslant{N-1} 0⩽i&lt;j⩽N−1，DARTS 的核心思想是将从 i i i 传播到 j j j 的信息表示为 ∣ O ∣ \\left|\\mathcal{O}\\right| ∣O∣ 操作的加权和，即 f i , j &amp;NegativeThinSpace; ( x i ) = ∑ o ∈ O exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } ⋅ o &amp;NegativeThinSpace; ( x i ) {f_{i,j}\\!\\left(\\mathbf{x}_i\\right)}={{\\sum_{o\\in\\mathcal{O}}}\\frac{\\exp\\left\\{\\alpha_{i,j}^o\\right\\}}{{\\sum_{o&amp;#x27;\\in\\mathcal{O}}}\\exp\\left\\{\\alpha_{i,j}^{o&amp;#x27;}\\right\\}}\\cdot o\\!\\left(\\mathbf{x}_i\\right)} fi,j​(xi​)=∑o∈O​∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​⋅o(xi​)，其中 x i \\mathbf{x}_i xi​ 是第 i i i 个节点的输出， α i , j o \\alpha_{i,j}^o αi,jo​ 是加权操作的超参数 o &amp;NegativeThinSpace; ( x i ) o\\!\\left(\\mathbf{x}_i\\right) o(xi​)。节点的输出是所有输入流的总和，即 x j = ∑ i &amp;lt; j f i , j &amp;NegativeThinSpace; ( x i ) {\\mathbf{x}_j}={{\\sum_{i&amp;lt;j}}f_{i,j}\\!\\left(\\mathbf{x}_i\\right)} xj​=∑i&lt;j​fi,j​(xi​)，整个单元格的输出是通过连接节点 x 2 \\mathbf{x}_2 x2​– x N − 1 \\mathbf{x}_{N-1} xN−1​ 的输出而形成的，即 c o n c a t &amp;NegativeThinSpace; ( x 2 , x 3 , … , x N − 1 ) \\mathrm{concat}\\!\\left(\\mathbf{x}_2,\\mathbf{x}_3,\\ldots,\\mathbf{x}_{N-1}\\right) concat(x2​,x3​,…,xN−1​) 。请注意，前两个节点 x 0 \\mathbf{x}_0 x0​ 和 x 1 \\mathbf{x}_1 x1​ 是单元的输入节点，在架构搜索期间是固定的。 搜索过程完成后，在每个边 ( i , j ) \\left(i,j\\right) (i,j) 上，保留具有最大 α i , j o \\alpha_{i,j}^o αi,jo​ 值的操作 o o o，并且每个节点 j j j 连接到具有最大 α i , j o \\alpha_{i,j}^o αi,jo​ 的两个先例（ i &amp;lt; j {i}&amp;lt;{j} i&lt;j）。 实验中， 在 CIFAR-10 上搜索基础单元，由组件构建网络从头训练得到 ImageNet 上的结果。 DARTS 在 O \\mathcal{O} O 中包括以下操作： 3 × 3 separable convolution 5 × 5 separable convolution 3 × 3 dilated separable convolution 5 × 5 dilated separable convolution 3 × 3 max pooling 3 × 3 average pooling identity z e r o zero zero。 所有操作步长为1（如果适用），填充卷积特征图以保持其空间分辨率。使用 ReLU-Conv-BN 顺序进行卷积运算，并且每个可分离卷积总是应用两次（[NASNet] [AmoebaNet][PNAS]）。 卷积单元由 N = 7 N=7 N=7 个节点组成，其中定义输出节点为所有中间节点（不包括输入节点）的深度级联。其余的设置遵循 [NASNet] [AmoebaNet][PNAS]，然后通过将多个单元堆叠在一起形成网络。单元 k k k 的第一和第二节点分别设置为等于单元 k − 2 k-2 k−2 和单元 k − 1 k-1 k−1 的输出，并且根据需要插入 1 × 1 1 \\times 1 1×1 卷积。 位于网络总深度的1/3和2/3处的单元是约简单元，其中与输入节点相邻的所有操作步长为2。因此，体系结构编码是 ( α n o r m a l , α r e d u c e ) (\\alpha_{normal}, \\alpha_{reduce}) (αnormal​,αreduce​)，其中 α n o r m a l \\alpha_{normal} αnormal​ 由所有正常单元共享， α r e d u c e \\alpha_{reduce} αreduce​ 由所有约简单元共享。 为了更好地理解深度对架构搜索的影响，DARTS 通过将堆栈中的单元数量从8增加到20来对 CIFAR-10进行架构搜索。由于单个 GPU 显存的限制，初始通道数量从16减少到6。测试误差，略低于较浅网络。 P-DARTS P-DARTS 是同济大学和华为诺亚方舟实验室提出的一种渐进式的可微分网络结构搜索方法，致力于提升 DARTS 的迁移性能。在 CIFAR10和 CIFAR100数据集上搜索基本单元，单个P100 GPU上只需要7个小时。在DARTS中，网络结构搜索是在一个拥有8个 cell 的搜索网络上进行的，然而却是在一个拥有20个 cell 的网络上测试的，在搜索网络和测试网络之间有一个很大的深度差异。 P-DARTS 渐进地增加搜索网络深度。P-DARTS 提出搜索空间近似，划分学习阶段，减少候选操作的种类的同时增加深度，从而降低显存和时间消耗。算法能够在16 GB 显存的 GPU 上运行。 上一阶段结尾将一些操作从搜索空间中删去，因此需要从头开始训练网络参数和结构参数。但是训练一个更深的网络往往比训练一个较浅的网络更难。信息往往倾向于通过 skip-connect 流动，而不是卷积。作者提出搜索空间正则，在 skip-connect 操作添加操作层面的 Dropout 来防止其过拟合到 skip-connect 上，同时限制最终结构中的 skip-connect 操作数量来进一步提高稳定性。 作者同时观察到测试时的识别准确率与搜索到的结构中的 skip-connect 操作数量与最终性能高度相关。因此，作者提出第二个搜索空间正则方法，即在最终生成的网络结构中，保留固定数量的 skip-connect 操作。具体的，作者根据最终阶段的结构参数，只保留权值最大的 M 个 skip-connect 操作，这一正则方法保证了搜索过程的稳定性。在本文中， M=2 。 P-DARTS 能够在 16 GB 显存的 GPU 上完成搜索。 PC-DARTS DARTS 将操作选择转换为固定操作集的加权组合，为寻找有效的网络架构提供了快速解决方案。但联合训练超网络和搜索最优结构，内存和计算开销很大。P-DARTS 减少搜索空间，而这一近似会导致可能牺牲已发现架构的最优性。PC-DARTS 通过对超网络的一小部分进行采样以减少网络空间中的冗余，从而在不损害性能的情况下提高搜索效率。具体来说，PC-DARTS 在通道子集中执行操作搜索，并保持其他部分不变。采样不同通道可能造成在选择超网络的边时出现不一致。PC-DARTS 通过引入边正则（edge normalization）来解决这个问题，在搜索过程中添加了一组新的边级超参数，以减少搜索中的不确定性。项目地址为：yuhuixu1993/PC-DARTS。 PC-DARTS 即部分连接 DARTS，核心思想是直观的：随机抽取其中的一个子集进行操作选择，同时直接放过其余部分，而不是将所有通道都送到操作选择块中。PC-DARTS 假设该子集的计算能近似替代所有通道。除了内存和计算成本都大大降低之外，采样带来了另一个好处，即操作搜索正则化，不易陷入局部最优。然而，PC-DARTS 也带来了副作用，即网络连接的选择将变得不稳定，因为在迭代中会采样不同的信道子集。因此，PC-DARTS 引入边正则（edge normalization）来通过显式学习一组额外的边选择超参数来稳定对网络连接的搜索。通过在整个训练过程中共享这些超参数，所学习的网络结构不易受迭代中通道采样的影响，因此更加稳定。 得益于部分连接策略，PC-DARTS 能够相应地增加批量大小。在实践中，PC-DARTS 为每个操作选择随机抽取 1 / K 1/K 1/K 的通道，这将减少几乎 K K K 倍的内存成本。这使得我们可以在搜索过程中使用 K × K\\times K× 批量大小，不仅可以将搜索速度加快 K K K 倍，而且还稳定了搜索，特别是对于大型数据集。 当然，以上都是作者观点。读代码的话会发现通道不是随机取的，而是固定取前 1 / K 1/K 1/K。所以“边正则”概念就有点飘了。DARTS 不仅仅选择操作，还会像剪枝一样确定连接。然而同层会有多个 softmax 输出，从中选最大显得不甚合理。额外加一组结构参数应该可以改善这一点。 DARTS 的缺点在于其内存效率低下。为了适应 ∣ O ∣ |\\mathcal{O}| ∣O∣ 操作，在搜索架构的主要部分中， ∣ O ∣ |\\mathcal{O}| ∣O∣ 操作副本及其输出需要存储在每个节点（即每个网络层），导致 ∣ O ∣ × |\\mathcal{O}|\\times ∣O∣× 次内存使用。要装进GPU，必须在搜索期间减小批量大小，这不可避免地降低搜索速度，并且较小的批量大小可能降低搜索稳定性和准确性。 或者，内存效率的另一种解决方案是部分通道连接，如下图所示。以 x i \\mathbf{x}_i xi​ 与 x j \\mathbf{x}_j xj​ 的连接为例。这涉及定义一个通道采样掩码 S i , j \\mathbf{S}_{i,j} Si,j​，它为所选通道分配 1 1 1，为屏蔽的通道分配 0 0 0。所选通道送入 ∣ O ∣ \\left|\\mathcal{O}\\right| ∣O∣ 混合操作计算，而屏蔽通道则绕过这些操作，即直接复制到输出， f i , j P C &amp;NegativeThinSpace; ( x i ; S i , j ) = ∑ o ∈ O exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } ⋅ o &amp;NegativeThinSpace; ( S i , j ∗ x i ) + ( 1 − S i , j ) ∗ x i . {f_{i,j}^\\mathrm{PC}\\!\\left(\\mathbf{x}_i;\\mathbf{S}_{i,j}\\right)}={{\\sum_{o\\in\\mathcal{O}}}\\frac{\\exp\\left\\{\\alpha_{i,j}^o\\right\\}}{{\\sum_{o&amp;#x27;\\in\\mathcal{O}}}\\exp\\left\\{\\alpha_{i,j}^{o&amp;#x27;}\\right\\}}\\cdot o\\!\\left(\\mathbf{S}_{i,j}\\ast\\mathbf{x}_i\\right)+\\left(1-\\mathbf{S}_{i,j}\\right)\\ast\\mathbf{x}_i}. fi,jPC​(xi​;Si,j​)=o∈O∑​∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​⋅o(Si,j​∗xi​)+(1−Si,j​)∗xi​. 其中， S i , j ∗ x i \\mathbf{S}_{i,j}\\ast\\mathbf{x}_i Si,j​∗xi​ 和 ( 1 − S i , j ) ∗ x i \\left(1-\\mathbf{S}_{i,j}\\right)\\ast\\mathbf{x}_i (1−Si,j​)∗xi​ 分别表示选定和屏蔽的通道。 在实践中，PC-DARTS 将 K K K 视为超参数，设置选中通道的比例为 1 / K 1/K 1/K。 通过改变 K K K，可以在架构搜索准确度（较小的 K K K）和效率（较大的 K K K）之间进行权衡以取得平衡。 K K K 带来的直接好处是 f i , j P C &amp;NegativeThinSpace; ( x i ; S i , j ) f_{i,j}^\\mathrm{PC}\\!\\left(\\mathbf{x}_i;\\mathbf{S}_{i,j}\\right) fi,jPC​(xi​;Si,j​) 计算减少 K K K 次。这允许使用更大的批量大小进行结构搜索。随即有两方面的好处： 首先，计算成本也可以减少 K K K 倍。 此外，较大的批量大小意味着可以在每次迭代期间对更多训练数据进行采样。这对于结构搜索尤为重要。在大多数情况下，一个操作相对于另一个操作的优势并不显著，除非在一个小批量中包含更多的训练数据，以减少更新网络权重和架构参数的不确定性。 通道采样对神经架构搜索的影响既有有积极的也有消极的： 在好的一面，为混合操作输入一小部分通道，同时保持其余部分不变，可以减少在选择操作时的偏向。换句话说，对于边 ( i , j ) \\left(i,j\\right) (i,j)，给定输入 x i \\mathbf{x}_i xi​，使用两组超参数 { α i , j o } \\left\\{\\alpha_{i,j}^o\\right\\} {αi,jo​} 和 { α i , j ′ o } \\left\\{\\alpha_{i,j}^{\\prime o}\\right\\} {αi,j′o​} 的差别大大减少了，因为只有一小部分（ 1 / K 1/K 1/K）的输入通道将通过混合操作，而其余通道保持不变。这削弱了 O \\mathcal{O} O 中无参数操作（如 skip-connect、max-pooling 等）相对于含参操作（例如各种卷积）的优势。在早期阶段，搜索算法通常更青睐无参操作，因为它们没有训练参数，从而产生更一致的输出，即 o &amp;NegativeThinSpace; ( x i ) o\\!\\left(\\mathbf{x}_i\\right) o(xi​)。相比之下，在参数得到充分优化之前，含参操作在迭代中传播的信息不一致。因此，无参操作通常会在开始时累积较大的权重（即 α i , j o \\alpha_{i,j}^o αi,jo​），这使得含参操作即使在经过良好训练之后也很难击败它们。当（执行结构搜索的）代理数据集很难时，这种现象尤其显著，这阻碍了 DARTS 在 ImageNet 上获得令人满意的搜索结果。 不利的一面是，和 DARTS 一样，在一个单元格中，每个输出节点 x j \\mathbf{x}_j xj​ 需要从其先例 { x 0 , x 1 , … , x j − 1 } \\left\\{\\mathbf{x}_0,\\mathbf{x}_1,\\ldots,\\mathbf{x}_{j-1}\\right\\} {x0​,x1​,…,xj−1​} 中选取两个输入节点，候选操作权重为 max ⁡ o α 0 , j o , max ⁡ o α 1 , j o , … , max ⁡ o α j − 1 , j o \\max_o\\alpha_{0,j}^o,\\max_o\\alpha_{1,j}^o,\\ldots,\\max_o\\alpha_{j-1,j}^o maxo​α0,jo​,maxo​α1,jo​,…,maxo​αj−1,jo​。然而，这些架构参数通过迭代中的随机采样通道进行优化。因此，当采样通道随时间变化时，由它们确定的最佳连接性可能不稳定。这可能导致所得网络架构中出现预期之外的波动。为了缓解这个问题，PC-DARTS 引入了边正则化， β i , j \\beta_{i,j} βi,j​ 明确地权衡每个边 ( i , j ) \\left(i,j\\right) (i,j)，因此 x j \\mathbf{x}_j xj​ 的计算成为： x j P C = ∑ i &amp;lt; j exp ⁡ { β i , j } ∑ i ′ &amp;lt; j exp ⁡ { β i ′ , j } ⋅ f i , j &amp;NegativeThinSpace; ( x i ) . \\mathbf{x}_j^\\mathrm{PC}={\\sum_{i&amp;lt;j}\\frac{\\exp\\left\\{\\beta_{i,j}\\right\\}}{{\\sum_{i&amp;#x27;&amp;lt;j}}\\exp\\left\\{\\beta_{i&amp;#x27;,j}\\right\\}}\\cdot f_{i,j}\\!\\left(\\mathbf{x}_i\\right)}. xjPC​=i&lt;j∑​∑i′&lt;j​exp{βi′,j​}exp{βi,j​}​⋅fi,j​(xi​). 具体来说，在架构搜索完成后，边 ( i , j ) \\left(i,j\\right) (i,j) 的连接由 { α i , j o } \\left\\{\\alpha_{i,j}^o\\right\\} {αi,jo​} 和 β i , j \\beta_{i,j} βi,j​ 确定。PC-DARTS 归一化系数，然后相乘，即 exp ⁡ { β i , j } ∑ i ′ &amp;lt; j exp ⁡ { β i ′ , j } ⋅ exp ⁡ { α i , j o } ∑ o ′ ∈ O exp ⁡ { α i , j o ′ } \\frac{\\exp\\left\\{\\beta_{i,j}\\right\\}}{{\\sum_{i&amp;#x27;&amp;lt;j}}\\exp\\left\\{\\beta_{i&amp;#x27;,j}\\right\\}} \\cdot \\frac{\\exp\\left\\{\\alpha_{i,j}^o\\right\\}}{{\\sum_{o&amp;#x27;\\in\\mathcal{O}}}\\exp\\left\\{\\alpha_{i,j}^{o&amp;#x27;}\\right\\}} ∑i′&lt;j​exp{βi′,j​}exp{βi,j​}​⋅∑o′∈O​exp{αi,jo′​}exp{αi,jo​}​。 由于 β i , j \\beta_{i,j} βi,j​ 在训练过程中共享，因此学习的网络架构不易受迭代间采样通道影响，从而使架构搜索更加稳定。 P-DARTS 在 skip-connect 之后应用了 dropout，以避免参数化和无参数操作之间的信息不平衡。 SNAS 随机神经网络架构搜索（Stochastic Neural Architecture Search，SNAS），是商汤发表在 ICLR 2019上的一篇文章，吸收了 ENAS 和 DARTS 的优点。SNAS 的实质似乎就是将 DARTS 中的 Softmax 换成了Concrete distribution 并加了资源约束项，然而整个叙述却十分复杂。SNAS 在同一轮反向传播中训练神经运算的参数和架构的分布参数（这样真的好？）。号称的思想是，利用泛化损失中的梯度信息提高基于强化学习的 NAS 的效率。 与基于强化学习的方法[ENAS]相比，SNAS 的搜索优化可微分，搜索效率更高，可以在更少的迭代次数下收敛到更高准确率。 与其他可微分的方法[DARTS]相比，SNAS 直接优化 NAS 任务的目标函数，搜索结果偏差更小，可以直接通过一阶优化搜索。 同时优化网络损失函数的期望和网络前向时延的期望，可以自动生成硬件友好的稀疏网络。 SNAS 的实验设置基本与 DARTS 相同。 SNAS 将子网络运行延迟作为目标的正规化项： E Z ∼ p α ( Z ) [ L θ ( Z ) + η C ( Z ) ] = E Z ∼ p α ( Z ) [ L θ ( Z ) ] + η E Z ∼ p α ( Z ) [ C ( Z ) ] , \\begin{aligned} \\mathbb{E}_{\\mathit{Z}\\sim p_{\\mathit{\\alpha}}(\\mathit{Z})}[L_{\\mathit{\\theta}}(\\mathit{Z})+\\eta C(\\mathit{Z})]=\\mathbb{E}_{\\mathit{Z}\\sim p_{\\mathit{\\alpha}}(\\mathit{Z})}[L_{\\mathit{\\theta}}(\\mathit{Z})]+\\eta \\mathbb{E}_{\\mathit{Z}\\sim p_{\\mathit{\\alpha}}(\\mathit{Z})}[C(\\mathit{Z})], \\end{aligned} EZ∼pα​(Z)​[Lθ​(Z)+ηC(Z)]=EZ∼pα​(Z)​[Lθ​(Z)]+ηEZ∼pα​(Z)​[C(Z)],​ 其中 C ( Z ) C(\\mathit{Z}) C(Z) 是与随机变量 Z \\mathit{Z} Z 相关联的子网络的时间成本，包含3项指标： 参数量; 浮点运算（float-point operations， FLOPs）的数量; 内存访问成本（memory access cost，MAC）。 FBNet 与 BSN 相同，FBNet 以随机超网络表示搜索空间。将寻找最佳架构的问题放宽为找到产生最优体系结构的分布。借助于 Gumbel Softmax 可以使用基于梯度的优化（如 SGD）直接训练架构分布。损失包括交叉熵损失和延迟损失。相当于宏搜索版的 SNAS。 随机超网络对候选块进行采样，采样概率为 P θ l ( b l = b l , i ) = softmax ( θ l , i ; θ l ) = exp ⁡ ( θ l , i ) ∑ i exp ⁡ ( θ l , i ) . P_{\\bm{\\theta}_{l}}(b_l = b_{l,i}) = \\text{softmax}(\\theta_{l,i}; \\bm{\\theta}_l) = \\frac{\\exp(\\theta_{l,i})}{\\sum_i \\exp(\\theta_{l,i})}. Pθl​​(bl​=bl,i​)=softmax(θl,i​;θl​)=∑i​exp(θl,i​)exp(θl,i​)​. θ l \\bm{\\theta}_l θl​ 包含的参数确定在第 l l l 层采样每个块的概率。同样，第 l l l 层的输出可以表示为 x l + 1 = ∑ i m l , i ⋅ b l , i ( x l ) , x_{l+1} = \\sum_i m_{l, i} \\cdot b_{l, i}(x_{l}), xl+1​=i∑​ml,i​⋅bl,i​(xl​), 其中 m l , i m_{l,i} ml,i​ 是 { 0 , 1 } \\{0, 1\\} {0,1} 中的随机变量，如果采样块 b l , i b_{l, i} bl,i​，则计算结果为1。采样概率由前面的等式确定。 b l , i ( x l ) b_{l, i}(x_{l}) bl,i​(xl​) 表示给定输入特征图 x l x_{l} xl​ 的情况下，第 l l l 层的第 i i i 块的输出。FBNet 让每个层独立采样，因此，采样架构 a a a 的概率可以描述为 P θ ( a ) = ∏ l P θ l ( b l = b l , i ( a ) ) , P_{\\bm{\\theta}}(a) = \\prod_l P_{\\bm{\\theta}_l} (b_l = b_{l,i}^{(a)}), Pθ​(a)=l∏​Pθl​​(bl​=bl,i(a)​), 其中 θ \\bm{\\theta} θ 为一个向量，元素 θ l , i \\theta_{l,i} θl,i​ 为第 i i i 块的第 l l l 层的采样参数。 b l , i ( a ) b_{l,i}^{(a)} bl,i(a)​ 表示在采样架构中 a a a，在第 l l l 层中选中第 i i i 个块。 松弛求解最佳架构 a ∈ A a \\in \\mathcal{A} a∈A 问题为优化随机超网络的概率 P θ P_\\theta Pθ​ 以实现最小预期损失，公式重写为 min&nbsp; θ min&nbsp; w a E a ∼ P θ { L ( a , w a ) } . \\underset{\\bm{\\theta}}{\\text{min }} \\underset{w_a}{\\text{min }} \\mathbf{E}_{a \\sim P_{\\bm{\\theta}}} \\{\\mathcal{L}(a, w_a) \\}. θmin&nbsp;​wa​min&nbsp;​Ea∼Pθ​​{L(a,wa​)}. 将离散掩码变量 m l , i m_{l,i} ml,i​ 放宽为由 Gumbel Softmax 函数计算的连续随机变量： m l , i = GumbelSoftmax ( θ l , i ∣ θ l ) = exp ⁡ [ ( θ l , i + g l , i ) / τ ] ∑ i exp ⁡ [ ( θ l , i + g l , i ) / τ ] , \\begin{aligned} m_{l, i} &amp;amp; = \\text{GumbelSoftmax}(\\theta_{l, i}|\\bm{\\theta_{l}}) \\\\ &amp;amp; = \\frac{\\exp[(\\theta_{l,i} + g_{l,i})/\\tau]}{\\sum_i \\exp[(\\theta_{l,i} + g_{l,i})/\\tau]}, \\end{aligned} ml,i​​=GumbelSoftmax(θl,i​∣θl​)=∑i​exp[(θl,i​+gl,i​)/τ]exp[(θl,i​+gl,i​)/τ]​,​ 其中 g l , i ∼ Gumbel(0,&nbsp;1) g_{l,i} \\sim \\text{Gumbel(0, 1)} gl,i​∼Gumbel(0,&nbsp;1) 是 Gumbel 分布的随机噪声。Gumbel Softmax 函数由温度参数 τ \\tau τ 控制。当 τ \\tau τ 接近0时，它近似于 P θ ( a ) = ∏ l P θ l ( b l = b l , i ( a ) ) P_{\\bm{\\theta}}(a) = \\prod_l P_{\\bm{\\theta}_l} (b_l = b_{l,i}^{(a)}) Pθ​(a)=∏l​Pθl​​(bl​=bl,i(a)​) 中分布的离散分类抽样。随着 τ \\tau τ 变大， m l , i m_{l,i} ml,i​ 成为一个连续的随机变量。无论 τ \\tau τ 的值如何，掩码 m l , i m_{l,i} ml,i​ 都对参数 θ l , i \\theta_{l, i} θl,i​ 可微。DNAS 和 SNAS 同样使用 Gumbel Softmax 进行网络结构搜索。 对于延迟项，FBNet 使用基于查找表的模型进行效率估计，因此 LAT ( a ) \\text{LAT}(a) LAT(a) 公式可以写为 LAT ( a ) = ∑ l ∑ i m l , i ⋅ LAT ( b l , i ) . \\text{LAT}(a) = \\sum_l \\sum_i m_{l,i} \\cdot \\text{LAT} (b_{l,i}). LAT(a)=l∑​i∑​ml,i​⋅LAT(bl,i​). 每个运算符 LAT ( b l , i ) \\text{LAT} (b_{l,i}) LAT(bl,i​) 的延迟是一个常数系数，从而架构 a a a 的整体延迟相对于掩码 m l , i m_{l,i} ml,i​ 是可微分的。 训练过程为： 随机取 ImageNet 的100类在8 GPU 机器上训练随机超网络90个 epoch，batchsize=192； 挑选出最优结构后，在 ImageNet 上训练360个 epoch，batchsize=256。 FBNet 的搜索空间参考 MobileNetV2 和 ShiftNet ，网络首尾固定，中间的22层可调，如 Table 1 所示。 块结构如下图所示，深度分离卷积可选3x3或5x5的卷积核，块内的首尾1x1卷积可替换为 group + channel shuffle。 值得注意的是网络没有使用 BN，论文也未谈到这一点。但 fbnet_builder 中是有的。 从 ImageNet 中随即取100类作为训练集，历经90个 epoch。找到最优结构后，从头训练模型。损失函数为： L ( a , w a ) = &nbsp;CE ( a , w a ) ⋅ α log ⁡ ( LAT ( a ) ) β \\begin{aligned} \\mathcal{L}(a, w_a) = \\text{ CE}(a, w_a) \\cdot \\alpha \\log(\\text{LAT}(a))^\\beta \\end{aligned} L(a,wa​)=&nbsp;CE(a,wa​)⋅αlog(LAT(a))β​ 第一项 CE ( a , w a ) \\text{CE}(a, w_a) CE(a,wa​) 表示架构 a a a 与相应参数 w a w_a wa​ 的交叉熵损失。第二项 LAT ( a ) \\text{LAT}(a) LAT(a) 表示目标硬件上体系结构的延迟，以微秒为单位。系数 α \\alpha α 控制损失函数的总体大小。指数系数 β \\beta β 调制延迟项的大小。除了 log 外，形式与 MnasNet 类似。 FBNet 预先测试每个 op 的耗时，创建查找表来估计不同模型的延时。目标设备为 Samsung Galaxy S8和 iPhone X。 LAT ( a ) = ∑ l LAT ( b l ( a ) ) , \\begin{aligned} \\text{LAT}(a) = \\sum_l \\text{LAT} (b_l^{(a)}), \\end{aligned} LAT(a)=l∑​LAT(bl(a)​),​ 其中 b l ( a ) b_l^{(a)} bl(a)​ 表示架构 a a a 来自第 l l l 层的块。 FBNet 将模型量化到 int8 在 Caffe2上测试，为对比将其他方法也进行了转换。 ProxylessNAS D R DARTS ProxylessNAS BinaryConnect REINFORCE MobileNetV2 可微 NAS 通过网络架构的连续表示来降低训练时长，但会遇到高 GPU 内存消耗问题（随候选集大小线性增长）。ProxylessNAS 着眼于减少内存消耗，在训练时采样两条路径。采用强化学习和梯度下降两种方法训练 CPU、GPU 以及移动处理器3个平台上的模型。文中试图套用 BinaryConnect ，大讲二值化。然而路径二值化并不能降低内存消耗，实际运行机理与此毫不相干。直接在目标数据集上训练也有点噱头，因为分摊下来每条路径的训练轮数不多。论文题目不如改成随机采样更新的 Softmax 近似。而且，采样路径却未提 BatchNorm 如何应对。一个鲜明的例子是 DenseNAS 也使用路径采样方法，但未提及二值化。 ProxylessNAS 受 DARTS 和 One-Shot 的启发 ， 将 NAS 定义为路径级修剪过程。 ProxylessNAS 在目标硬件上学习专用网络结构，但硬件目标（以延迟为例）不可微分。为此，其将网络延迟建模为连续函数，并作为正则化损失进行优化，类似于 SNAS。此外，ProxylessNAS 还提出了一种基于 REINFORCE规则 的算法（Proxyless-R），作为处理硬件度量的替代策略。 ProxylessNAS 将路径 N 选择一分解为多个二进制选择任务。 直觉是，如果一条路径是特定位置的最佳选择，那么与任何其他路径相比，它应该是更好的选择。 在结构参数的更新步骤中： 首先根据多项分布 ( p 1 , ⋯ &amp;ThinSpace; , p N ) (p_1, \\cdots, p_N) (p1​,⋯,pN​) 对两条路径进行采样，并屏蔽所有其他路径，就好像它们不存在一样。因此，候选数暂时从 N N N 减少到2，而路径权重 { p i } \\{p_i\\} {pi​} 和二进制门 { g i } \\{g_i\\} {gi​} 相应地重置。 然后，我们使用通过公式(4)计算的梯度更新这两个采样路径的架构参数。 最后，由于通过将 softmax 应用于架构参数来计算路径权重，需要通过乘以比率来重新调整这两个更新的架构参数的值，以保持未采样路径的路径权重不变。 这样，在每个更新步骤中，一个采样路径被增强（路径权重增大），另一个采样路径被衰减（路径权重减小），而所有其他路径保持不变。这样，无论 N N N 的值如何，在架构参数的每个更新步骤中仅涉及两条路径，从而将内存需求降低到训练紧凑模型的相同水平。 为了使延迟可微分，ProxylessNAS 将网络的延迟建模为神经网络维度的连续函数。考虑具有候选集 { o j } \\{o_j\\} {oj​} 的混合操作，并且每个 o j o_j oj​ 与路径权重 p j p_j pj​ 相关联，该权重表示选择 o j o_j oj​ 的概率。因此，混合操作（即可学习块）的预期延迟如下： E [ latency i ] = ∑ j p j i × F ( o j i ) , \\mathbb{E} [\\text{latency}_i] = \\sum_j p_j^i \\times F(o_j^i), E[latencyi​]=j∑​pji​×F(oji​), 其中 E [ latency i ] \\mathbb{E} [\\text{latency}_i] E[latencyi​] 是 i t h i^{th} ith 可学习块的预期延迟， F ( ⋅ ) F(\\cdot) F(⋅) 表示延迟预测模型， F ( o j i ) F(o_j^i) F(oji​) 是 o j i o_j^i oji​ 的预测延迟。因此， E [ latency i ] \\mathbb{E} [\\text{latency}_i] E[latencyi​] 关于体系结构参数的梯度为： ∂ E [ latency i ] &nbsp; / &nbsp; ∂ p j i = F ( o j i ) \\partial \\mathbb{E} [\\text{latency}_i]~/~\\partial p_j^i = F(o_j^i) ∂E[latencyi​]&nbsp;/&nbsp;∂pji​=F(oji​)。 对于具有一系列混合操作的整个网络，由于这些操作在推理期间按顺序执行，因此网络的预期延迟可以用这些混合操作的总预期延迟之和表示： E [ latency ] = ∑ i E [ latency i ] , \\mathbb{E} [\\text{latency}] = \\sum_i \\mathbb{E} [\\text{latency}_i], E[latency]=i∑​E[latencyi​], Proxyless-G 通过乘以比例因子 λ 2 ( &amp;gt; 0 ) \\lambda_2 (&amp;gt; 0) λ2​(&gt;0) 将网络的预期延迟纳入正常损失函数，该比例因子控制精度和延迟之间的权衡。最终的损失函数给出为 L o s s = L o s s C E + λ 1 ∣ ∣ w ∣ ∣ 2 2 + λ 2 E [ latency ] , Loss = Loss_{CE} + \\lambda_1 ||w||_2^2 + {\\color{red} \\lambda_2 \\mathbb{E}[\\text{latency}]}, Loss=LossCE​+λ1​∣∣w∣∣22​+λ2​E[latency], 其中 L o s s C E Loss_{CE} LossCE​ 表示交叉熵损失， λ 1 ∣ ∣ w ∣ ∣ 2 2 \\lambda_1 ||w||_2^2 λ1​∣∣w∣∣22​ 是权重衰减项。 ProxylessNAS 还可以利用 REINFORCE 来训练二值化权重。考虑具有二进制化参数 α \\alpha α 的网络，更新二进制化参数的目的是找到最大化某个奖励 R ( ⋅ ) R(\\cdot) R(⋅) 的最佳二进制门 g g g 。为便于说明，这里假设网络只有一个混合操作。因此，根据 REINFORCE ，对二进制化参数进行了以下更新： J ( α ) = E g ∼ α [ R ( N g ) ] = ∑ i p i R ( N ( e = o i ) ) , ∇ α J ( α ) = ∑ i R ( N ( e = o i ) ) ∇ α p i = ∑ i R ( N ( e = o i ) ) p i ∇ α log ⁡ ( p i ) , = E g ∼ α [ R ( N g ) ∇ α log ⁡ ( p ( g ) ) ] ≈ 1 M ∑ i = 1 M R ( N g i ) ∇ α log ⁡ ( p ( g i ) ) , \\begin{aligned} J(\\alpha) &amp;amp;= \\mathbb{E}_{g \\sim \\alpha}[R(\\mathcal{N}_g)] = \\sum_i p_i R(\\mathcal{N}(e = o_i)), \\\\ \\nabla_\\alpha J(\\alpha) &amp;amp;= \\sum_i R(\\mathcal{N}(e = o_i)) \\nabla_\\alpha p_i = \\sum_i R(\\mathcal{N}(e = o_i)) p_i \\nabla_\\alpha \\log(p_i), \\\\ &amp;amp;= \\mathbb{E}_{g \\sim \\alpha} [R(\\mathcal{N}_g) \\nabla_\\alpha \\log(p(g))] \\approx \\frac{1}{M} \\sum_{i=1}^M R(\\mathcal{N}_{g^i}) \\nabla_\\alpha \\log(p(g^i)), \\end{aligned} J(α)∇α​J(α)​=Eg∼α​[R(Ng​)]=i∑​pi​R(N(e=oi​)),=i∑​R(N(e=oi​))∇α​pi​=i∑​R(N(e=oi​))pi​∇α​log(pi​),=Eg∼α​[R(Ng​)∇α​log(p(g))]≈M1​i=1∑M​R(Ngi​)∇α​log(p(gi)),​ 其中 g i g^i gi 表示第 i t h i^{th} ith 个采样二进制门， p ( g i ) p(g^i) p(gi) 表示根据公式2采样 g i g^i gi 的概率， N g i \\mathcal{N}_{g^i} Ngi​ 是根据二进制门 g i g^i gi 的紧凑型网络。由于上式不需要 R ( N g ) R(\\mathcal{N}_g) R(Ng​) 对 g g g 可微，因此它可以处理不可微分的目标。一个有趣的观察是，公式eq:reinforce具有与标准 NAS 类似的形式，但它不是一个连续的决策过程，并且没有使用 RNN 元控制器。此外，由于基于梯度的更新和基于 REINFORCE 的更新对于相同的二值化体系结构参数基本上是两个不同的更新规则，因此可以将它们组合以形成体系结构参数的新更新规则。 Proxyless-R 与 MnasNet 类似，使用 A C C ( m ) × [ L A T ( m ) / T ] w ACC(m) \\times [ LAT(m) / T]^w ACC(m)×[LAT(m)/T]w 作为优化目标，其中 A C C ( m ) ACC(m) ACC(m) 表示模型 m m m 的准确率， L A T ( m ) LAT(m) LAT(m) 表示 m m m 的延迟， T T T 是目标延迟， w w w 是用于控制准确性和延迟之间权衡的超参数。 ProxylessNAS 与 DARTS 在验证集上训练结构参数 α {\\alpha} α，而 FBNet 未进行划分。 ProxylessNAS 设置一系列 MBConv，卷积核大小可选 { 3 , 5 , 7 } \\{3, 5, 7\\} {3,5,7} 扩张系数为 { 3 , 6 } \\{3, 6\\} {3,6}。 令人困惑的是 ProxylessNAS 的 batchsize=256，FBNet 为192。FBNet 只用 ImageNet 的1/10，ProxylessNAS 使用全部，二者训练时间却相同。FBNet 估计 MnasNet 的成本为91000 GPU hours；ProxylessNAS 实现的是40000。假定 ProxylessNAS 用的是 V100（测试平台是这一型号）， FBNet 的设备似乎与之存在代差。 Single-Path NAS Single-Path NAS 是一种单路径（或者 superkernel）方法。用一个7x7的大卷积，来代表3x3、5x5和7x7的三种卷积，把外边一圈 mask 清零掉就变成了3x3或5x5。扩张系数类似，认为6包含两个3，实现高度的参数复用。 省显存，然而本质还是搜索空间小。基础网络参考 FBNet，仅搜索 expansion rate 和 kernel size。Single-Path NAS 代码 dstamoulis/single-path-nas 完全开源，依赖 TensorFlow 和 TPU，使用 facebook/FAI-PEP 分析模型每层的运行时间。比较有意思的是文中的表格，几种搜索算法结果并未拉开差距。 DenseNAS DenseNAS 由地平线和华中科技大学联合提出，号称可以搜索网络结构中每个 block 的宽度和对应的空间分辨率。DenseNAS 构建一个密集连接的搜索空间。每个块的滤波器的数量（即宽度）以小步幅逐渐增加。搜索空间参考 MobileNetV2 并采用密集连接的形式构建。搜索空间比之前一些算法大。然而 DenseNAS 与 FBNet 一样训练集取 ImageNet 的1/10，同时类似 ProxylessNAS 采样路径训练，反而比二者训练时间缩短一半。 如下图所示，DenseNAS 在三个不同的级别（layer、block 和 network）定义搜索空间： 每个层都包含所有候选操作； 一个块可以分为两个组件：头部层和堆叠层； 整个网络使用具有增量宽度的块构建。 层为搜索空间中的基本结构。一层代表一组候选操作。搜索空间中的操作集合如表 Table 1 所示。 每个块由若干层组成，拥有固定宽度和相应的空间分辨率。头部层处理具有不同通道数和空间分辨率的输入张量，并转换为固定宽度和空间分辨率。头部层不包括跳过连接，因为它是所有块所必需的。头部层之后是许多堆叠层（图中的例子中是三层）。之后，堆叠层中的操作以相同数量的通道和空间分辨率执行。 MnasNet、ProxylessNAS 和 FBNet 设置固定数量的块。DenseNAS 在搜索空间中设计了更多具有不同宽度的块，并允许搜索架构只包含块的子集，从而使搜索算法能够自由地选择具有特定宽度的块，同时丢弃其他块。 整个超网络架构定义为 A r c h Arch Arch，并假设它包含 N N N 个块： A r c h = { B 1 , B 2 , . . . , B N } Arch = \\{B_1, B_2, ..., B_N\\} Arch={B1​,B2​,...,BN​}。 DenseNAS 将整个网络划分为几个阶段。每个阶段拥有不同的宽度范围和固定的空间分辨率。超网络从头到尾，块的宽度以小步幅逐渐增长。网络的早期阶段设定较小的宽度增长步幅，因为设置较大将导致巨大的计算成本。后期阶段增长幅度逐渐变大。如结构图所示，在第3阶段，空间分辨率设置为 28 × 28 28 \\times 28 28×28，宽度增长步幅为8。宽度增长步幅在第4阶段变为16，阶段5变为64。 定义块 B i B_i Bi​ 和后续块 B j B_j Bj​（ j &amp;gt; i j &amp;gt; i j&gt;i）之间的连接为 C i j C_{ij} Cij​。 B i B_i Bi​ 和 B j B_j Bj​ 的空间分辨率分别为 H i × W i H_i \\times W_i Hi​×Wi​（通常 H i = W i H_i = W_i Hi​=Wi​）和 H j × W j H_j \\times W_j Hj​×Wj​。DenseNAS 限制连接仅在空间分辨率相差不超过两倍的块之间。因此，当 j − i ≤ m j - i \\leq m j−i≤m 且 H j / H i ≤ 2 H_j / H_i \\leq 2 Hj​/Hi​≤2 时， C i j C_{ij} Cij​ 存在。搜索空间基于密集连接的块构建。 但是，只选择一条路径来导出最终的结构。DenseNAS 不仅搜索每个块中的层数，而且还搜索块宽度和块数。同时确定执行空间下采样的层。目标是在搜索空间中找到一条良好的路径，代表架构的最佳深度和宽度配置。 设 b i b_i bi​ 为第 i i i 个块 B i B_i Bi​ 的输出张量。每个块连接到后续 m m m 块。为了将块连接松弛为连续表示，DenseNAS 为块的每个输出路径分配块级架构参数。也就是说，对于从块 B i B_i Bi​ 到 B j B_j Bj​ 的路径，它们之间的路径有一个参数 β i j \\beta_{ij} βij​。与计算每个操作的权重类似，使用 softmax 函数计算两个块之间所有路径的概率： p i j = exp ⁡ ( β i j ) ∑ k = 1 m exp ⁡ ( β i k ) . p_{ij} = \\frac{\\exp(\\beta_{ij})}{\\sum_{k=1}^m \\exp(\\beta_{ik})}. pij​=∑k=1m​exp(βik​)exp(βij​)​. 假设块 B i B_i Bi​ 需要来自先前块的 m ′ m&amp;#x27; m′ 输入张量，即 B i − m ′ B_{i-m&amp;#x27;} Bi−m′​, B i − m ′ + 1 B_{i-m&amp;#x27;+1} Bi−m′+1​, B i − m ′ + 2 B_{i-m&amp;#x27;+2} Bi−m′+2​ … B i − 1 B_{i-1} Bi−1​。来自这些块的输入张量在通道数和空间分辨率上有所不同。因此，每个输入张量由 B i B_i Bi​ 中的头部层变换为统一大小，然后求和。设 H i k H_{ik} Hik​ 表示块 B i B_i Bi​ 中第 k k k 个头部层对输入张量 B i − k B_{i-k} Bi−k​ 的转换，其中 k = 1.. m ′ k=1..m&amp;#x27; k=1..m′。转换后的输入张量之和可通过以下公式计算： x i = ∑ k = 1 m ′ p i − k , i ⋅ H i k ( x i − k ) . x_i = \\sum_{k=1}^{m&amp;#x27;} p_{i-k, i} \\cdot H_{ik}(x_{i-k}). xi​=k=1∑m′​pi−k,i​⋅Hik​(xi−k​). 值得注意的是，路径概率在块输出维度上标准化，但应用于后续块的输入维度（更具体地说，在头部层上）。头部层本质上是是候选操作的混合加权和。层级参数 α \\alpha α 控制要选择的操作，而外部块级参数 β \\beta β 决定要连接的块。 DenseNAS 的训练方式与 DARTS 类似，权重和架构的优化过程按 epoch 交替进行。搜索过程完成后，根据结构参数导出体系结构： 在层级别，选择具有最大体系结构权重的候选操作，即 a r g m a x o ∈ O α o ℓ argmax_{o \\in \\mathcal{O}} \\alpha_o^\\ell argmaxo∈O​αoℓ​； 在网络级，使用 Viterbi 算法根据每个块的输出路径概率来选择连接具有最高总转移概率的块的路径。 超网络包括搜索空间中的所有可能路径和操作。 one-shot 搜索方法在训练超级网络时会丢掉一些路径。该技术使独立模型的性能预测更准确。为了减少内存消耗并加快搜索过程，DenseNAS 采用了 drop-path 训练策略： 当训练操作权重时，DenseNAS 在每一层根据结构参数分布 { α o ℓ ∣ o ∈ O } \\{\\alpha_o^\\ell | o \\in \\mathcal{O}\\} {αoℓ​∣o∈O} 从候选操作中采样出一条路径。丢弃路径训练不仅加速了搜索，而且减弱了搜索空间中不同结构的操作权重之间的耦合效应。 训练结构参数时，像 ProxylessNAS一样根据结构权重分布在每个层中对两个操作进行采样。为了保持未采样的操作的体系结构权重不变，DenseNAS 计算重新平衡偏差以调整采样和新更新的参数。 b i a s s = ln ⁡ ∑ o ∈ O s exp ⁡ ( α o ℓ ) ∑ o ∈ O s exp ⁡ ( α ′ o ℓ ) \\mathtt{bias}_s = \\ln \\frac{\\sum_{o \\in \\mathcal{O}_s} \\exp(\\alpha_o^\\ell)}{\\sum_{o \\in \\mathcal{O}_s} \\exp({\\alpha&amp;#x27;}_o^\\ell)} biass​=ln∑o∈Os​​exp(α′oℓ​)∑o∈Os​​exp(αoℓ​)​ 其中 O s \\mathcal{O}_s Os​ 指的是采样的一组操作， α o ℓ \\alpha_o^\\ell αoℓ​ 指的是层 ℓ \\ell ℓ 中最初采样的结构参数， α ′ o ℓ {\\alpha&amp;#x27;}_o^\\ell α′oℓ​ 是相应更新后的结构参数。训练时 b i a s s \\mathtt{bias}_s biass​ 不断累加？ DSO-NAS DSO-NAS 是初创企业图森未来的一篇文章，投 ICLR 2019 被拒。文中对比了不同方法的参数量和计算量。评审中附加了更多实验数据，从中可以看出在网络延迟方面不尽人意。 DSO-NAS 与 ProxylessNAS 一样将网络搜索看作是剪枝过程，采用团队前作 SSS(Sparse Structure Selection) 进行优化。不同的是 DSO-NAS 的 block 内部细分为4层，连接较为复杂。 参考资料： 如何评价google Searching for MobileNetV3？ The Lightweight Face Recognition Challenge guan-yuan/awesome-AutoML-and-Lightweight-Models Literature on Neural Architecture Search D-X-Y/Awesome-NAS google-research/nasbench microsoft/nni 神经网络架构搜索（Neural Architecture Search）杂谈 Xuanyi Dong ENAS的原理和代码解析 业界 | 谷歌提出移动端AutoML模型MnasNet：精度无损速度更快 多图演示高效的神经架构搜索 Gumbel-Softmax Trick和Gumbel分布 旷视提出One-Shot模型搜索框架的新变体 另一种可微架构搜索：商汤提出在反传中学习架构参数的SNAS ICLR 2019｜随机神经网络结构搜索 (SNAS) 论文笔记系列-Neural Architecture Search With Reinforcement Learning ENAS: 更有效地设计神经网络模型(AutoML) 万字解读商汤科技ICLR2019论文：随机神经网络结构搜索 同济和华为诺亚提出：渐进式可微网络结构搜索，显著提升可微式搜索的性能和稳定性，已开源 论文解读：Single-Path NAS 【ICLR 19】DARTS可微网络结构搜索 CVPR 2018 | 商汤科技Oral论文详解：BlockQNN自动网络设计方法 AutoML：NAS 之 Randomly Wired Neural Networks A Survey on Neural Architecture Search Neural architecture search AutoML (1) - Introduction Review: NASNet — Neural Architecture Search Network (Image Classification) ENAS的原理和代码解析 论文笔记系列-Neural Architecture Search With Reinforcement Learning 旷视首席科学家孙剑：深度学习变革视觉计算丨CCF-GAIR 2019 DenseNAS：密集连接搜索空间下的高灵活度网络结构搜索 | 大牛讲堂 强化学习系列（六）：时间差分算法（Temporal-Difference Learning) 强化学习 - 时间差分学习(Temporal-Difference Learning) A3C、PPO、GAE笔记 One-Shot 神经网络搜索(NAS)的searching阶段到底在做什么？ AutoML for Object Detection 解读小米MoGA：超过MobileNetV3的移动端GPU敏感型搜索 如何通俗地讲解 viterbi 算法？","@type":"BlogPosting","url":"https://uzzz.org/2019/08/20/794196.html","headline":"网络结构搜索之梯度可微","dateModified":"2019-08-20T00:00:00+08:00","datePublished":"2019-08-20T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/08/20/794196.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>网络结构搜索之梯度可微</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_content" class="article_content clearfix">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <p>前面介绍了强化学习方法，但屠龙刀毕竟不是人人有。梯度可微算法在保证精度可接受的前提下大幅缩短了训练周期，开启了网络结构搜索的平民化浪潮。</p> 
  <div class="mermaid">
   <svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-WAwpNis8R4ZGcyvp" height="278" width="831.75" viewbox="0 0 851.75 298">
    <g>
     <g class="output">
      <g class="clusters"></g>
      <g class="edgePaths">
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M254.11979166666666,212L241.75,187L241.75,139L241.75,91L241.75,66" marker-end="url(#arrowhead68)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead68" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M168.25,116L168.25,91L208.75,64.55102040816327" marker-end="url(#arrowhead69)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead69" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M89.5,212L89.5,187L276.75,146.09897610921502" marker-end="url(#arrowhead70)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead70" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M309.25,116L309.25,91L274.09375,66" marker-end="url(#arrowhead71)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead71" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M563.75,227.8188976377953L347.75,187L327.6979166666667,162" marker-end="url(#arrowhead72)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead72" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M563.75,218.34246575342465L492.25,187L472.1979166666667,162" marker-end="url(#arrowhead73)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead73" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M295.328125,212L327.75,187L393.375,162" marker-end="url(#arrowhead74)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead74" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M606.5416666666666,212L611.75,187L611.75,162" marker-end="url(#arrowhead75)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead75" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M639.75,223.45569620253164L759.75,187L759.75,162" marker-end="url(#arrowhead76)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead76" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M453.75,116L453.75,91L453.75,66" marker-end="url(#arrowhead77)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead77" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
      </g>
      <g class="edgeLabels">
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
      </g>
      <g class="nodes">
       <g class="node" style="opacity: 1;" id="MobileNetV2" transform="translate(265.5,235)">
        <rect rx="0" ry="0" x="-56.5" y="-23" width="113" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-46.5,-13)">
          <foreignobject width="93" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            MobileNetV2
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="FBNet" transform="translate(241.75,43)">
        <rect rx="0" ry="0" x="-33" y="-23" width="66" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-23,-13)">
          <foreignobject width="46" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            FBNet
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="ShiftNet" transform="translate(168.25,139)">
        <rect rx="0" ry="0" x="-38.5" y="-23" width="77" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-28.5,-13)">
          <foreignobject width="57" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            ShiftNet
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="Gumbel-Softmax" transform="translate(89.5,235)">
        <rect rx="0" ry="0" x="-69.5" y="-23" width="139" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-59.5,-13)">
          <foreignobject width="119" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            Gumbel-Softmax
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="SNAS" transform="translate(309.25,139)">
        <rect rx="0" ry="0" x="-32.5" y="-23" width="65" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-22.5,-13)">
          <foreignobject width="45" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            SNAS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="DARTS" transform="translate(601.75,235)">
        <rect rx="0" ry="0" x="-38" y="-23" width="76" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-28,-13)">
          <foreignobject width="56" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            DARTS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="ProxylessNAS" transform="translate(453.75,139)">
        <rect rx="0" ry="0" x="-62" y="-23" width="124" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-52,-13)">
          <foreignobject width="104" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            ProxylessNAS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="P-DARTS" transform="translate(611.75,139)">
        <rect rx="0" ry="0" x="-46" y="-23" width="92" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-36,-13)">
          <foreignobject width="72" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            P-DARTS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="PC-DARTS" transform="translate(759.75,139)">
        <rect rx="0" ry="0" x="-52" y="-23" width="104" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-42,-13)">
          <foreignobject width="84" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            PC-DARTS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="DenseNAS" transform="translate(453.75,43)">
        <rect rx="0" ry="0" x="-50.5" y="-23" width="101" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-40.5,-13)">
          <foreignobject width="81" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            DenseNAS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
      </g>
     </g>
    </g>
   </svg>
  </div> 
  <h2><a id="DARTShttpsopenreviewnetpdfidS1eYHoC5FX_16"></a><a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a></h2> 
  <p><a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 由 CMU 和 DeepMind 提出，最终发表在 ICLR 2019上。<a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 在有限资源条件下将模型精度提升到可接受的程度，而且开放代码（<a href="https://github.com/quark0/darts" rel="nofollow" data-token="c34936502801b8ca6c7521a268c8cf32">quark0/darts</a>）。可谓 NAS 领域内的一大贡献。美中不足的是代码仅在单 GPU 下搜索，以至于后续的 <a href="https://github.com/chenxin061/pdarts" rel="nofollow" data-token="c0b0795ee77cc5eabe1ef88280530077">chenxin061/pdarts</a> 和 <a href="https://github.com/yuhuixu1993/PC-DARTS" rel="nofollow" data-token="b637a2a9294a4b3b37b5584a725d39af">yuhuixu1993/PC-DARTS</a> 亦维持此设置，成为扩展的阻碍。</p> 
  <p><a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 将搜索空间放宽为连续的，以便可以通过梯度下降来优化体系结构的验证集性能。在所有混合操作中联合学习架构 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span></span></span></span></span> 和权重 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathit">w</span></span></span></span></span>。这意味着一个双层优化问题，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span></span></span></span></span> 作为上层变量，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathit">w</span></span></span></span></span> 作为下层变量：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <munder>
               <mi>
                min
               </mi>
               <mo>
                ⁡
               </mo>
               <mi>
                α
               </mi>
              </munder>
              <mspace width="1em"></mspace>
             </mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 v
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 l
                </mi>
               </mrow>
              </msub>
              <mo>
               (
              </mo>
              <msup>
               <mi>
                w
               </mi>
               <mo>
                ∗
               </mo>
              </msup>
              <mo>
               (
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mtext>
               s.t.
              </mtext>
              <mspace width="1em"></mspace>
             </mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <msup>
               <mi>
                w
               </mi>
               <mo>
                ∗
               </mo>
              </msup>
              <mo>
               (
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
              <mo>
               =
              </mo>
              <msub>
               <mrow>
                <mi mathvariant="normal">
                 a
                </mi>
                <mi mathvariant="normal">
                 r
                </mi>
                <mi mathvariant="normal">
                 g
                </mi>
                <mi mathvariant="normal">
                 m
                </mi>
                <mi mathvariant="normal">
                 i
                </mi>
                <mi mathvariant="normal">
                 n
                </mi>
               </mrow>
               <mi>
                w
               </mi>
              </msub>
              <mspace width="0.5em"></mspace>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 t
                </mi>
                <mi>
                 r
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 i
                </mi>
                <mi>
                 n
                </mi>
               </mrow>
              </msub>
              <mo>
               (
              </mo>
              <mi>
               w
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} \min_\alpha \quad &amp;amp; \mathcal{L}_{val}(w^*(\alpha), \alpha) \\ \text{s.t.} \quad &amp;amp;w^*(\alpha) = \mathrm{argmin}_w \enspace \mathcal{L}_{train}(w, \alpha) \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.34em; vertical-align: -1.42em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.92em;"><span class="" style="top: -4.08em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.1em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span></span></span><span class="" style="top: -2.24em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.42em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.92em;"><span class="" style="top: -4.08em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">v</span><span class="mord mathit mtight">a</span><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span><span class="" style="top: -2.24em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span style="margin-right: 0.01389em;" class="mord mathrm">g</span><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.057252em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.02691em;" class="mord mathit mtight">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.5em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span style="margin-right: 0.02778em;" class="mord mathit mtight">r</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.42em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 求结构梯度的近似解：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 v
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 l
                </mi>
               </mrow>
              </msub>
              <mo>
               (
              </mo>
              <msup>
               <mi>
                w
               </mi>
               <mo>
                ∗
               </mo>
              </msup>
              <mo>
               (
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mo>
              ≈
             </mo>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 v
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 l
                </mi>
               </mrow>
              </msub>
              <mo>
               (
              </mo>
              <mi>
               w
              </mi>
              <mo>
               −
              </mo>
              <mi>
               ξ
              </mi>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                w
               </mi>
              </msub>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 t
                </mi>
                <mi>
                 r
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 i
                </mi>
                <mi>
                 n
                </mi>
               </mrow>
              </msub>
              <mo>
               (
              </mo>
              <mi>
               w
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} &amp;amp;\nabla_\alpha \mathcal{L}_{val}(w^*(\alpha), \alpha) \\ \approx &amp;amp;\nabla_\alpha \mathcal{L}_{val}(w - \xi \nabla_{w} \mathcal{L}_{train}(w, \alpha), \alpha) \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3em; vertical-align: -1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mrel">≈</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">v</span><span class="mord mathit mtight">a</span><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">v</span><span class="mord mathit mtight">a</span><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.04601em;" class="mord mathit">ξ</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.02691em;" class="mord mathit mtight">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span style="margin-right: 0.02778em;" class="mord mathit mtight">r</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathit">w</span></span></span></span></span> 表示算法维护的当前权重，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          ξ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \xi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.04601em;" class="mord mathit">ξ</span></span></span></span></span> 是内部优化步骤的学习率。思路是通过仅使用单个训练步骤来调整 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathit">w</span></span></span></span></span> 来近似 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           w
          </mi>
          <mo>
           ∗
          </mo>
         </msup>
         <mo>
          (
         </mo>
         <mi>
          α
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         w^*(\alpha)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span></span></span>，而不是训练至收敛来完全求解内部优化。</p> 
  <p>从形式上讲，<a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 将搜索网络分解为若干（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          L
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         L
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">L</span></span></span></span></span>）个的单元（cell）。每个单元组织为具有 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          N
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         N
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.10903em;" class="mord mathit">N</span></span></span></span></span> 个节点的有向无环图（DAG），其中每个节点定义一个网络层。预定义操作空间 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="script">
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathcal{O}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span></span></span></span></span>，其中每个元素 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>&amp;NegativeThinSpace;
         <mrow>
          <mo fence="true">
           (
          </mo>
          <mo>
           ⋅
          </mo>
          <mo fence="true">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         o\!\left(\cdot\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">o</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">⋅</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> 是在网络层执行的固定操作（例如，identity connection, and <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          3
         </mn>
         <mo>
          ×
         </mo>
         <mn>
          3
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         3\times3
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span></span></span></span></span> convolution）。在单元内，目标是从 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="script">
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathcal{O}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span></span></span></span></span> 中选择一个操作来连接每对节点。设一对节点为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          (
         </mo>
         <mi>
          i
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          j
         </mi>
         <mo fence="true">
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left(i,j\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          0
         </mn>
         <mo>
          ⩽
         </mo>
         <mi>
          i
         </mi>
         <mo>
          &amp;lt;
         </mo>
         <mi>
          j
         </mi>
         <mo>
          ⩽
         </mo>
         <mrow>
          <mi>
           N
          </mi>
          <mo>
           −
          </mo>
          <mn>
           1
          </mn>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         {0}\leqslant{i}&amp;lt;{j}\leqslant{N-1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.78111em; vertical-align: -0.13667em;"></span><span class="mord"><span class="mord">0</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69862em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord mathit">i</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.05724em;" class="mord mathit">j</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathit">N</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span></span></span></span>，<a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 的核心思想是将从 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 传播到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span></span></span></span></span> 的信息表示为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          ∣
         </mo>
         <mi mathvariant="script">
          O
         </mi>
         <mo fence="true">
          ∣
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left|\mathcal{O}\right|
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">∣</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="mclose delimcenter" style="top: 0em;">∣</span></span></span></span></span></span> 操作的加权和，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
          </msub>&amp;NegativeThinSpace;
          <mrow>
           <mo fence="true">
            (
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo fence="true">
            )
           </mo>
          </mrow>
         </mrow>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             o
            </mi>
            <mo>
             ∈
            </mo>
            <mi mathvariant="script">
             O
            </mi>
           </mrow>
          </msub>
          <mfrac>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo fence="true">
              {
             </mo>
             <msubsup>
              <mi>
               α
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                j
               </mi>
              </mrow>
              <mi>
               o
              </mi>
             </msubsup>
             <mo fence="true">
              }
             </mo>
            </mrow>
           </mrow>
           <mrow>
            <msub>
             <mo>
              ∑
             </mo>
             <mrow>
              <msup>
               <mi>
                o
               </mi>
               <mo mathvariant="normal">
                ′
               </mo>
              </msup>
              <mo>
               ∈
              </mo>
              <mi mathvariant="script">
               O
              </mi>
             </mrow>
            </msub>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo fence="true">
              {
             </mo>
             <msubsup>
              <mi>
               α
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                j
               </mi>
              </mrow>
              <msup>
               <mi>
                o
               </mi>
               <mo mathvariant="normal">
                ′
               </mo>
              </msup>
             </msubsup>
             <mo fence="true">
              }
             </mo>
            </mrow>
           </mrow>
          </mfrac>
          <mo>
           ⋅
          </mo>
          <mi>
           o
          </mi>&amp;NegativeThinSpace;
          <mrow>
           <mo fence="true">
            (
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo fence="true">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         {f_{i,j}\!\left(\mathbf{x}_i\right)}={{\sum_{o\in\mathcal{O}}}\frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}\cdot o\!\left(\mathbf{x}_i\right)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathit">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.14032em; vertical-align: -0.83032em;"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.31em;"><span class="" style="top: -2.4925em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.28539em;"><span class="" style="top: -2.28539em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.349367em;"><span class=""></span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: 0.195167em;"></span><span class="mop mtight">exp</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">{</span></span><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.951629em;"><span class="" style="top: -2.28454em; margin-left: -0.0037em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -2.95163em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">}</span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.6125em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">exp</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">{</span></span><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738543em;"><span class="" style="top: -2.214em; margin-left: -0.0037em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.424886em;"><span class=""></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.83032em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">o</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span></span>，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个节点的输出，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mi>
           o
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{i,j}^o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05916em; vertical-align: -0.394772em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是加权操作的超参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>&amp;NegativeThinSpace;
         <mrow>
          <mo fence="true">
           (
          </mo>
          <msub>
           <mi mathvariant="bold">
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo fence="true">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         o\!\left(\mathbf{x}_i\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">o</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>。节点的输出是所有输入流的总和，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mi>
           j
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             &amp;lt;
            </mo>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
          </msub>&amp;NegativeThinSpace;
          <mrow>
           <mo fence="true">
            (
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo fence="true">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         {\mathbf{x}_j}={{\sum_{i&amp;lt;j}}f_{i,j}\!\left(\mathbf{x}_i\right)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.730548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.18582em; vertical-align: -0.435818em;"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">&lt;</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathit">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span></span>，整个单元格的输出是通过连接节点 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>–<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mrow>
           <mi>
            N
           </mi>
           <mo>
            −
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_{N-1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.652771em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.10903em;" class="mord mathit mtight">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的输出而形成的，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mrow>
          <mi mathvariant="normal">
           c
          </mi>
          <mi mathvariant="normal">
           o
          </mi>
          <mi mathvariant="normal">
           n
          </mi>
          <mi mathvariant="normal">
           c
          </mi>
          <mi mathvariant="normal">
           a
          </mi>
          <mi mathvariant="normal">
           t
          </mi>
         </mrow>&amp;NegativeThinSpace;
         <mrow>
          <mo fence="true">
           (
          </mo>
          <msub>
           <mi mathvariant="bold">
            x
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi mathvariant="bold">
            x
           </mi>
           <mn>
            3
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mo>
           …
          </mo>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi mathvariant="bold">
            x
           </mi>
           <mrow>
            <mi>
             N
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo fence="true">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathrm{concat}\!\left(\mathbf{x}_2,\mathbf{x}_3,\ldots,\mathbf{x}_{N-1}\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">c</span><span class="mord mathrm">o</span><span class="mord mathrm">n</span><span class="mord mathrm">c</span><span class="mord mathrm">a</span><span class="mord mathrm">t</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.10903em;" class="mord mathit mtight">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> 。请注意，前两个节点 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mn>
           0
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是单元的输入节点，在架构搜索期间是固定的。</p> 
  <p>搜索过程完成后，在每个边 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          (
         </mo>
         <mi>
          i
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          j
         </mi>
         <mo fence="true">
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left(i,j\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> 上，保留具有最大 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mi>
           o
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{i,j}^o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05916em; vertical-align: -0.394772em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 值的操作 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          o
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">o</span></span></span></span></span>，并且每个节点 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span></span></span></span></span> 连接到具有最大 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mi>
           o
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{i,j}^o
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05916em; vertical-align: -0.394772em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的两个先例（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
         <mo>
          &amp;lt;
         </mo>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         {i}&amp;lt;{j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69862em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord mathit">i</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.05724em;" class="mord mathit">j</span></span></span></span></span></span>）。</p> 
  <p>实验中， 在 CIFAR-10 上搜索基础单元，由组件构建网络从头训练得到 ImageNet 上的结果。</p> 
  <p><a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 在 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="script">
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathcal{O}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span></span></span></span></span> 中包括以下操作：</p> 
  <ul> 
   <li>3 × 3 separable convolution</li> 
   <li>5 × 5 separable convolution</li> 
   <li>3 × 3 dilated separable convolution</li> 
   <li>5 × 5 dilated separable convolution</li> 
   <li>3 × 3 max pooling</li> 
   <li>3 × 3 average pooling</li> 
   <li>identity</li> 
   <li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           z
          </mi>
          <mi>
           e
          </mi>
          <mi>
           r
          </mi>
          <mi>
           o
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          zero
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.04398em;" class="mord mathit">z</span><span class="mord mathit">e</span><span style="margin-right: 0.02778em;" class="mord mathit">r</span><span class="mord mathit">o</span></span></span></span></span>。</li> 
  </ul> 
  <p>所有操作步长为1（如果适用），填充卷积特征图以保持其空间分辨率。使用 ReLU-Conv-BN 顺序进行卷积运算，并且每个可分离卷积总是应用两次（<a href="http://openaccess.thecvf.com/content_cvpr_2018/papers/Zoph_Learning_Transferable_Architectures_CVPR_2018_paper.pdf" rel="nofollow" data-token="3f4126604c069ae127226d73e20db5b9">[NASNet]</a> <a href="https://arxiv.org/abs/1802.01548" rel="nofollow" data-token="2b8cb1b48ab9da27f732ac0cdcfdc929">[AmoebaNet]</a><a href="http://openaccess.thecvf.com/content_ECCV_2018/papers/Chenxi_Liu_Progressive_Neural_Architecture_ECCV_2018_paper.pdf" rel="nofollow" data-token="8cc71e9ca480fe0a972d48dd46b85a2b">[PNAS]</a>）。</p> 
  <p>卷积单元由 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          N
         </mi>
         <mo>
          =
         </mo>
         <mn>
          7
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         N=7
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.10903em;" class="mord mathit">N</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">7</span></span></span></span></span> 个节点组成，其中定义输出节点为所有中间节点（不包括输入节点）的深度级联。其余的设置遵循 <a href="http://openaccess.thecvf.com/content_cvpr_2018/papers/Zoph_Learning_Transferable_Architectures_CVPR_2018_paper.pdf" rel="nofollow" data-token="3f4126604c069ae127226d73e20db5b9">[NASNet]</a> <a href="https://arxiv.org/abs/1802.01548" rel="nofollow" data-token="2b8cb1b48ab9da27f732ac0cdcfdc929">[AmoebaNet]</a><a href="http://openaccess.thecvf.com/content_ECCV_2018/papers/Chenxi_Liu_Progressive_Neural_Architecture_ECCV_2018_paper.pdf" rel="nofollow" data-token="8cc71e9ca480fe0a972d48dd46b85a2b">[PNAS]</a>，然后通过将多个单元堆叠在一起形成网络。单元 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathit">k</span></span></span></span></span> 的第一和第二节点分别设置为等于单元 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
         <mo>
          −
         </mo>
         <mn>
          2
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         k-2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathit">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span> 和单元 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         k-1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathit">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 的输出，并且根据需要插入 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          1
         </mn>
         <mo>
          ×
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         1 \times 1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 卷积。 位于网络总深度的1/3和2/3处的单元是约简单元，其中与输入节点相邻的所有操作步长为2。因此，体系结构编码是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mi>
            o
           </mi>
           <mi>
            r
           </mi>
           <mi>
            m
           </mi>
           <mi>
            a
           </mi>
           <mi>
            l
           </mi>
          </mrow>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            r
           </mi>
           <mi>
            e
           </mi>
           <mi>
            d
           </mi>
           <mi>
            u
           </mi>
           <mi>
            c
           </mi>
           <mi>
            e
           </mi>
          </mrow>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         (\alpha_{normal}, \alpha_{reduce})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">o</span><span style="margin-right: 0.02778em;" class="mord mathit mtight">r</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathit mtight">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">d</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mi>
            o
           </mi>
           <mi>
            r
           </mi>
           <mi>
            m
           </mi>
           <mi>
            a
           </mi>
           <mi>
            l
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{normal}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">o</span><span style="margin-right: 0.02778em;" class="mord mathit mtight">r</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 由所有正常单元共享，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            r
           </mi>
           <mi>
            e
           </mi>
           <mi>
            d
           </mi>
           <mi>
            u
           </mi>
           <mi>
            c
           </mi>
           <mi>
            e
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{reduce}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathit mtight">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">d</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 由所有约简单元共享。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190703144038674.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="visualize-normal-crop"><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190703144107296.jpg" alt="visualize-reduction-crop"><br> 为了更好地理解深度对架构搜索的影响，<a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 通过将堆栈中的单元数量从8增加到20来对 CIFAR-10进行架构搜索。由于单个 GPU 显存的限制，初始通道数量从16减少到6。测试误差，略低于较浅网络。</p> 
  <h2><a id="PDARTShttpsarxivorgabs190412760_61"></a><a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a></h2> 
  <p><a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a> 是同济大学和华为诺亚方舟实验室提出的一种渐进式的可微分网络结构搜索方法，致力于提升 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 的迁移性能。在 CIFAR10和 CIFAR100数据集上搜索基本单元，单个P100 GPU上只需要7个小时。在DARTS中，网络结构搜索是在一个拥有8个 cell 的搜索网络上进行的，然而却是在一个拥有20个 cell 的网络上测试的，在搜索网络和测试网络之间有一个很大的深度差异。</p> 
  <ul> 
   <li><a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a> 渐进地增加搜索网络深度。<a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a> 提出搜索空间近似，划分学习阶段，减少候选操作的种类的同时增加深度，从而降低显存和时间消耗。算法能够在16 GB 显存的 GPU 上运行。</li> 
   <li>上一阶段结尾将一些操作从搜索空间中删去，因此需要从头开始训练网络参数和结构参数。但是训练一个更深的网络往往比训练一个较浅的网络更难。信息往往倾向于通过 skip-connect 流动，而不是卷积。作者提出搜索空间正则，在 skip-connect 操作添加操作层面的 Dropout 来防止其过拟合到 skip-connect 上，同时限制最终结构中的 skip-connect 操作数量来进一步提高稳定性。</li> 
   <li>作者同时观察到测试时的识别准确率与搜索到的结构中的 skip-connect 操作数量与最终性能高度相关。因此，作者提出第二个搜索空间正则方法，即在最终生成的网络结构中，保留固定数量的 skip-connect 操作。具体的，作者根据最终阶段的结构参数，只保留权值最大的 M 个 skip-connect 操作，这一正则方法保证了搜索过程的稳定性。在本文中， M=2 。</li> 
  </ul> 
  <p><a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a> 能够在 16 GB 显存的 GPU 上完成搜索。</p> 
  <h2><a id="PCDARTShttpsarxivorgabs190705737_71"></a><a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a></h2> 
  <p><a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 将操作选择转换为固定操作集的加权组合，为寻找有效的网络架构提供了快速解决方案。但联合训练超网络和搜索最优结构，内存和计算开销很大。<a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a> 减少搜索空间，而这一近似会导致可能牺牲已发现架构的最优性。<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 通过对超网络的一小部分进行采样以减少网络空间中的冗余，从而在不损害性能的情况下提高搜索效率。具体来说，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 在通道子集中执行操作搜索，并保持其他部分不变。采样不同通道可能造成在选择超网络的边时出现不一致。<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 通过引入<strong>边正则</strong>（edge normalization）来解决这个问题，在搜索过程中添加了一组新的边级超参数，以减少搜索中的不确定性。项目地址为：<a href="https://github.com/yuhuixu1993/PC-DARTS" rel="nofollow" data-token="b637a2a9294a4b3b37b5584a725d39af">yuhuixu1993/PC-DARTS</a>。</p> 
  <p><a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 即部分连接 DARTS，核心思想是直观的：随机抽取其中的一个子集进行操作选择，同时直接放过其余部分，而不是将所有通道都送到操作选择块中。<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 假设该子集的计算能近似替代所有通道。除了内存和计算成本都大大降低之外，采样带来了另一个好处，即操作搜索正则化，不易陷入局部最优。然而，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 也带来了副作用，即网络连接的选择将变得不稳定，因为在迭代中会采样不同的信道子集。因此，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 引入<strong>边正则</strong>（edge normalization）来通过显式学习一组额外的边选择超参数来稳定对网络连接的搜索。通过在整个训练过程中共享这些超参数，所学习的网络结构不易受迭代中通道采样的影响，因此更加稳定。</p> 
  <p>得益于部分连接策略，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 能够相应地增加批量大小。在实践中，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 为每个操作选择随机抽取 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          1
         </mn>
         <mi mathvariant="normal">
          /
         </mi>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         1/K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 的通道，这将减少几乎 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 倍的内存成本。这使得我们可以在搜索过程中使用 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
         <mo>
          ×
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         K\times
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span><span class="mord">×</span></span></span></span></span> 批量大小，不仅可以将搜索速度加快 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 倍，而且还稳定了搜索，特别是对于大型数据集。</p> 
  <p>当然，以上都是作者观点。读代码的话会发现通道不是随机取的，而是固定取前 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          1
         </mn>
         <mi mathvariant="normal">
          /
         </mi>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         1/K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span>。所以“边正则”概念就有点飘了。<a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 不仅仅选择操作，还会像剪枝一样确定连接。然而同层会有多个 softmax 输出，从中选最大显得不甚合理。额外加一组结构参数应该可以改善这一点。</p> 
  <p><a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 的缺点在于其内存效率低下。为了适应 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi mathvariant="script">
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         |\mathcal{O}|
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="mord">∣</span></span></span></span></span> 操作，在搜索架构的主要部分中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi mathvariant="script">
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         |\mathcal{O}|
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="mord">∣</span></span></span></span></span> 操作副本及其输出需要存储在每个节点（即每个网络层），导致 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi mathvariant="script">
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mo>
          ×
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         |\mathcal{O}|\times
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="mord">∣</span><span class="mord">×</span></span></span></span></span> 次内存使用。要装进GPU，必须在搜索期间减小批量大小，这不可避免地降低搜索速度，并且较小的批量大小可能降低搜索稳定性和准确性。</p> 
  <p>或者，内存效率的另一种解决方案是<strong>部分通道连接</strong>，如下图所示。以 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 与 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.730548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的连接为例。这涉及定义一个通道采样掩码 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           S
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{S}_{i,j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.972218em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，它为所选通道分配 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，为屏蔽的通道分配 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          0
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>。所选通道送入 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          ∣
         </mo>
         <mi mathvariant="script">
          O
         </mi>
         <mo fence="true">
          ∣
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left|\mathcal{O}\right|
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">∣</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="mclose delimcenter" style="top: 0em;">∣</span></span></span></span></span></span> 混合操作计算，而屏蔽通道则绕过这些操作，即直接复制到输出，<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190820093541270.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mrow>
           <msubsup>
            <mi>
             f
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="normal">
              P
             </mi>
             <mi mathvariant="normal">
              C
             </mi>
            </mrow>
           </msubsup>&amp;NegativeThinSpace;
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msub>
             <mi mathvariant="bold">
              x
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo separator="true">
             ;
            </mo>
            <msub>
             <mi mathvariant="bold">
              S
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
            <mo fence="true">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <munder>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              o
             </mi>
             <mo>
              ∈
             </mo>
             <mi mathvariant="script">
              O
             </mi>
            </mrow>
           </munder>
           <mfrac>
            <mrow>
             <mi>
              exp
             </mi>
             <mo>
              ⁡
             </mo>
             <mrow>
              <mo fence="true">
               {
              </mo>
              <msubsup>
               <mi>
                α
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 j
                </mi>
               </mrow>
               <mi>
                o
               </mi>
              </msubsup>
              <mo fence="true">
               }
              </mo>
             </mrow>
            </mrow>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mrow>
               <msup>
                <mi>
                 o
                </mi>
                <mo mathvariant="normal">
                 ′
                </mo>
               </msup>
               <mo>
                ∈
               </mo>
               <mi mathvariant="script">
                O
               </mi>
              </mrow>
             </munder>
             <mi>
              exp
             </mi>
             <mo>
              ⁡
             </mo>
             <mrow>
              <mo fence="true">
               {
              </mo>
              <msubsup>
               <mi>
                α
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 j
                </mi>
               </mrow>
               <msup>
                <mi>
                 o
                </mi>
                <mo mathvariant="normal">
                 ′
                </mo>
               </msup>
              </msubsup>
              <mo fence="true">
               }
              </mo>
             </mrow>
            </mrow>
           </mfrac>
           <mo>
            ⋅
           </mo>
           <mi>
            o
           </mi>&amp;NegativeThinSpace;
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msub>
             <mi mathvariant="bold">
              S
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
            <mo>
             ∗
            </mo>
            <msub>
             <mi mathvariant="bold">
              x
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo fence="true">
             )
            </mo>
           </mrow>
           <mo>
            +
           </mo>
           <mrow>
            <mo fence="true">
             (
            </mo>
            <mn>
             1
            </mn>
            <mo>
             −
            </mo>
            <msub>
             <mi mathvariant="bold">
              S
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
            <mo fence="true">
             )
            </mo>
           </mrow>
           <mo>
            ∗
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
          </mrow>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           {f_{i,j}^\mathrm{PC}\!\left(\mathbf{x}_i;\mathbf{S}_{i,j}\right)}={{\sum_{o\in\mathcal{O}}}\frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}\cdot o\!\left(\mathbf{S}_{i,j}\ast\mathbf{x}_i\right)+\left(1-\mathbf{S}_{i,j}\right)\ast\mathbf{x}_i}. 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathit">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">P</span><span class="mord mathrm mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.95648em; vertical-align: -1.32171em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.32171em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.63477em;"><span class="" style="top: -2.26em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.82278em;"><span class="" style="top: -2.42314em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">}</span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.78477em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">}</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.15297em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">o</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold">
           S
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
         <mo>
          ∗
         </mo>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{S}_{i,j}\ast\mathbf{x}_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.972218em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mrow>
          <mo fence="true">
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <msub>
           <mi mathvariant="bold">
            S
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo fence="true">
           )
          </mo>
         </mrow>
         <mo>
          ∗
         </mo>
         <msub>
          <mi mathvariant="bold">
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \left(1-\mathbf{S}_{i,j}\right)\ast\mathbf{x}_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 分别表示选定和屏蔽的通道。</p> 
  <p>在实践中，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 视为超参数，设置选中通道的比例为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          1
         </mn>
         <mi mathvariant="normal">
          /
         </mi>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         1/K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span>。 通过改变 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span>，可以在架构搜索准确度（较小的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span>）和效率（较大的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span>）之间进行权衡以取得平衡。</p> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 带来的直接好处是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            P
           </mi>
           <mi mathvariant="normal">
            C
           </mi>
          </mrow>
         </msubsup>&amp;NegativeThinSpace;
         <mrow>
          <mo fence="true">
           (
          </mo>
          <msub>
           <mi mathvariant="bold">
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="bold">
            S
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo fence="true">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         f_{i,j}^\mathrm{PC}\!\left(\mathbf{x}_i;\mathbf{S}_{i,j}\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.2361em; vertical-align: -0.394772em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathit">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.44134em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">P</span><span class="mord mathrm mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> 计算减少 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 次。这允许使用更大的批量大小进行结构搜索。随即有两方面的好处：</p> 
  <ul> 
   <li>首先，计算成本也可以减少 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           K
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          K
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span> 倍。</li> 
   <li>此外，较大的批量大小意味着可以在每次迭代期间对更多训练数据进行采样。这对于结构搜索尤为重要。在大多数情况下，一个操作相对于另一个操作的优势并不显著，除非在一个小批量中包含更多的训练数据，以减少更新网络权重和架构参数的不确定性。</li> 
  </ul> 
  <p>通道采样对神经架构搜索的影响既有有积极的也有消极的：</p> 
  <ul> 
   <li> <p>在好的一面，为混合操作输入一小部分通道，同时保持其余部分不变，可以减少在选择操作时的偏向。换句话说，对于边 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mo fence="true">
            (
           </mo>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
           <mo fence="true">
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \left(i,j\right)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>，给定输入 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           \mathbf{x}_i
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.59444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，使用两组超参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mo fence="true">
            {
           </mo>
           <msubsup>
            <mi>
             α
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             o
            </mi>
           </msubsup>
           <mo fence="true">
            }
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \left\{\alpha_{i,j}^o\right\}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.24477em; vertical-align: -0.394772em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">}</span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mo fence="true">
            {
           </mo>
           <msubsup>
            <mi>
             α
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mrow>
             <mo mathvariant="normal">
              ′
             </mo>
             <mi>
              o
             </mi>
            </mrow>
           </msubsup>
           <mo fence="true">
            }
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \left\{\alpha_{i,j}^{\prime o}\right\}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.24477em; vertical-align: -0.394772em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathit mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">}</span></span></span></span></span></span></span> 的差别大大减少了，因为只有一小部分（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mn>
            1
           </mn>
           <mi mathvariant="normal">
            /
           </mi>
           <mi>
            K
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           1/K
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span style="margin-right: 0.07153em;" class="mord mathit">K</span></span></span></span></span>）的输入通道将通过混合操作，而其余通道保持不变。这削弱了 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi mathvariant="script">
            O
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           \mathcal{O}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span></span></span></span></span> 中无参数操作（如 skip-connect、max-pooling 等）相对于含参操作（例如各种卷积）的优势。在早期阶段，搜索算法通常更青睐无参操作，因为它们没有训练参数，从而产生更一致的输出，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            o
           </mi>&amp;NegativeThinSpace;
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msub>
             <mi mathvariant="bold">
              x
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo fence="true">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex">
           o\!\left(\mathbf{x}_i\right)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">o</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>。相比之下，在参数得到充分优化之前，含参操作在迭代中传播的信息不一致。因此，无参操作通常会在开始时累积较大的权重（即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msubsup>
            <mi>
             α
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             o
            </mi>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           \alpha_{i,j}^o
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05916em; vertical-align: -0.394772em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span>），这使得含参操作即使在经过良好训练之后也很难击败它们。当（执行结构搜索的）代理数据集很难时，这种现象尤其显著，这阻碍了 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 在 ImageNet 上获得令人满意的搜索结果。</p> </li> 
   <li> <p>不利的一面是，和 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 一样，在一个单元格中，每个输出节点 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             j
            </mi>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           \mathbf{x}_j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.730548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 需要从其先例 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mo fence="true">
            {
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mn>
             0
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mo>
            …
           </mo>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mrow>
             <mi>
              j
             </mi>
             <mo>
              −
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msub>
           <mo fence="true">
            }
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \left\{\mathbf{x}_0,\mathbf{x}_1,\ldots,\mathbf{x}_{j-1}\right\}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">}</span></span></span></span></span></span> 中选取两个输入节点，候选操作权重为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             max
            </mi>
            <mo>
             ⁡
            </mo>
            <mi>
             o
            </mi>
           </msub>
           <msubsup>
            <mi>
             α
            </mi>
            <mrow>
             <mn>
              0
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             o
            </mi>
           </msubsup>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             max
            </mi>
            <mo>
             ⁡
            </mo>
            <mi>
             o
            </mi>
           </msub>
           <msubsup>
            <mi>
             α
            </mi>
            <mrow>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             o
            </mi>
           </msubsup>
           <mo separator="true">
            ,
           </mo>
           <mo>
            …
           </mo>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             max
            </mi>
            <mo>
             ⁡
            </mo>
            <mi>
             o
            </mi>
           </msub>
           <msubsup>
            <mi>
             α
            </mi>
            <mrow>
             <mi>
              j
             </mi>
             <mo>
              −
             </mo>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             o
            </mi>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           \max_o\alpha_{0,j}^o,\max_o\alpha_{1,j}^o,\ldots,\max_o\alpha_{j-1,j}^o
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05916em; vertical-align: -0.394772em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。然而，这些架构参数通过迭代中的随机采样通道进行优化。因此，当采样通道随时间变化时，由它们确定的最佳连接性可能不稳定。这可能导致所得网络架构中出现预期之外的波动。为了缓解这个问题，<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 引入了边正则化，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             β
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           \beta_{i,j}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 明确地权衡每个边 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mo fence="true">
            (
           </mo>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
           <mo fence="true">
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \left(i,j\right)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>，因此 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi mathvariant="bold">
             x
            </mi>
            <mi>
             j
            </mi>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           \mathbf{x}_j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.730548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的计算成为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <msubsup>
             <mi mathvariant="bold">
              x
             </mi>
             <mi>
              j
             </mi>
             <mrow>
              <mi mathvariant="normal">
               P
              </mi>
              <mi mathvariant="normal">
               C
              </mi>
             </mrow>
            </msubsup>
            <mo>
             =
            </mo>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                &amp;lt;
               </mo>
               <mi>
                j
               </mi>
              </mrow>
             </munder>
             <mfrac>
              <mrow>
               <mi>
                exp
               </mi>
               <mo>
                ⁡
               </mo>
               <mrow>
                <mo fence="true">
                 {
                </mo>
                <msub>
                 <mi>
                  β
                 </mi>
                 <mrow>
                  <mi>
                   i
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   j
                  </mi>
                 </mrow>
                </msub>
                <mo fence="true">
                 }
                </mo>
               </mrow>
              </mrow>
              <mrow>
               <munder>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <msup>
                  <mi>
                   i
                  </mi>
                  <mo mathvariant="normal">
                   ′
                  </mo>
                 </msup>
                 <mo>
                  &amp;lt;
                 </mo>
                 <mi>
                  j
                 </mi>
                </mrow>
               </munder>
               <mi>
                exp
               </mi>
               <mo>
                ⁡
               </mo>
               <mrow>
                <mo fence="true">
                 {
                </mo>
                <msub>
                 <mi>
                  β
                 </mi>
                 <mrow>
                  <msup>
                   <mi>
                    i
                   </mi>
                   <mo mathvariant="normal">
                    ′
                   </mo>
                  </msup>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   j
                  </mi>
                 </mrow>
                </msub>
                <mo fence="true">
                 }
                </mo>
               </mrow>
              </mrow>
             </mfrac>
             <mo>
              ⋅
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                j
               </mi>
              </mrow>
             </msub>&amp;NegativeThinSpace;
             <mrow>
              <mo fence="true">
               (
              </mo>
              <msub>
               <mi mathvariant="bold">
                x
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mo fence="true">
               )
              </mo>
             </mrow>
            </mrow>
            <mi mathvariant="normal">
             .
            </mi>
           </mrow>
           <annotation encoding="application/x-tex">
             \mathbf{x}_j^\mathrm{PC}={\sum_{i&amp;lt;j}\frac{\exp\left\{\beta_{i,j}\right\}}{{\sum_{i&amp;#x27;&amp;lt;j}}\exp\left\{\beta_{i&amp;#x27;,j}\right\}}\cdot f_{i,j}\!\left(\mathbf{x}_i\right)}. 
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">P</span><span class="mord mathrm mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.84078em; vertical-align: -1.41378em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">&lt;</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.17827em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">&lt;</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{</span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">}</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{</span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.12182em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathit">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: -0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span><span class="mord">.</span></span></span></span></span></span></p> </li> 
  </ul> 
  <p>具体来说，在架构搜索完成后，边 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          (
         </mo>
         <mi>
          i
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          j
         </mi>
         <mo fence="true">
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left(i,j\right)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> 的连接由 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          {
         </mo>
         <msubsup>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mi>
           o
          </mi>
         </msubsup>
         <mo fence="true">
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left\{\alpha_{i,j}^o\right\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.24477em; vertical-align: -0.394772em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.44134em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">}</span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           β
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta_{i,j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 确定。<a href="https://arxiv.org/abs/1907.05737" rel="nofollow" data-token="f3baee300781bf7d06258a9a1543fe8e">PC-DARTS</a> 归一化系数，然后相乘，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi>
            exp
           </mi>
           <mo>
            ⁡
           </mo>
           <mrow>
            <mo fence="true">
             {
            </mo>
            <msub>
             <mi>
              β
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
            <mo fence="true">
             }
            </mo>
           </mrow>
          </mrow>
          <mrow>
           <msub>
            <mo>
             ∑
            </mo>
            <mrow>
             <msup>
              <mi>
               i
              </mi>
              <mo mathvariant="normal">
               ′
              </mo>
             </msup>
             <mo>
              &amp;lt;
             </mo>
             <mi>
              j
             </mi>
            </mrow>
           </msub>
           <mi>
            exp
           </mi>
           <mo>
            ⁡
           </mo>
           <mrow>
            <mo fence="true">
             {
            </mo>
            <msub>
             <mi>
              β
             </mi>
             <mrow>
              <msup>
               <mi>
                i
               </mi>
               <mo mathvariant="normal">
                ′
               </mo>
              </msup>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
            <mo fence="true">
             }
            </mo>
           </mrow>
          </mrow>
         </mfrac>
         <mo>
          ⋅
         </mo>
         <mfrac>
          <mrow>
           <mi>
            exp
           </mi>
           <mo>
            ⁡
           </mo>
           <mrow>
            <mo fence="true">
             {
            </mo>
            <msubsup>
             <mi>
              α
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
             <mi>
              o
             </mi>
            </msubsup>
            <mo fence="true">
             }
            </mo>
           </mrow>
          </mrow>
          <mrow>
           <msub>
            <mo>
             ∑
            </mo>
            <mrow>
             <msup>
              <mi>
               o
              </mi>
              <mo mathvariant="normal">
               ′
              </mo>
             </msup>
             <mo>
              ∈
             </mo>
             <mi mathvariant="script">
              O
             </mi>
            </mrow>
           </msub>
           <mi>
            exp
           </mi>
           <mo>
            ⁡
           </mo>
           <mrow>
            <mo fence="true">
             {
            </mo>
            <msubsup>
             <mi>
              α
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
             <msup>
              <mi>
               o
              </mi>
              <mo mathvariant="normal">
               ′
              </mo>
             </msup>
            </msubsup>
            <mo fence="true">
             }
            </mo>
           </mrow>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\exp\left\{\beta_{i,j}\right\}}{{\sum_{i&amp;#x27;&amp;lt;j}}\exp\left\{\beta_{i&amp;#x27;,j}\right\}} \cdot \frac{\exp\left\{\alpha_{i,j}^o\right\}}{{\sum_{o&amp;#x27;\in\mathcal{O}}}\exp\left\{\alpha_{i,j}^{o&amp;#x27;}\right\}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.86205em; vertical-align: -0.829727em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.03232em;"><span class="" style="top: -2.4925em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.28539em;"><span class="" style="top: -2.28539em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mrel mtight">&lt;</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.460324em;"><span class=""></span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: 0.195167em;"></span><span class="mop mtight">exp</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">{</span></span><span class="mord mtight"><span style="margin-right: 0.05278em;" class="mord mathit mtight">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.05278em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.400914em;"><span class=""></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">}</span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.50732em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">exp</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top: 0em;"><span class="mtight">{</span></span><span class="mord mtight"><span style="margin-right: 0.05278em;" class="mord mathit mtight">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.05278em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top: 0em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.829727em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.14032em; vertical-align: -0.83032em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.31em;"><span class="" style="top: -2.4925em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.28539em;"><span class="" style="top: -2.28539em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.349367em;"><span class=""></span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: 0.195167em;"></span><span class="mop mtight">exp</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">{</span></span><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.951629em;"><span class="" style="top: -2.28454em; margin-left: -0.0037em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -2.95163em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">}</span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.6125em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">exp</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">{</span></span><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738543em;"><span class="" style="top: -2.214em; margin-left: -0.0037em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.424886em;"><span class=""></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.83032em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>。 由于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           β
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta_{i,j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 在训练过程中共享，因此学习的网络架构不易受迭代间采样通道影响，从而使架构搜索更加稳定。</p> 
  <p><a href="https://arxiv.org/abs/1904.12760" rel="nofollow" data-token="f0ef3a9a1a8e9687876d3bdc2e7eeec1">P-DARTS</a> 在 skip-connect 之后应用了 dropout，以避免参数化和无参数操作之间的信息不平衡。</p> 
  <h2><a id="SNAShttpsopenreviewnetpdfidrylqooRqK7_110"></a><a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a></h2> 
  <p>随机神经网络架构搜索（Stochastic Neural Architecture Search，SNAS），是商汤发表在 ICLR 2019上的一篇文章，吸收了 <a href="http://proceedings.mlr.press/v80/pham18a/pham18a.pdf" rel="nofollow" data-token="3b6f1ed261f290d54a0366148b7481f3">ENAS</a> 和 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 的优点。<a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 的实质似乎就是将 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 中的 Softmax 换成了<a href="https://openreview.net/forum?id=S1jE5L5gl" rel="nofollow" data-token="7f6e168faafb7f59b16879fbd879f305">Concrete distribution</a> 并加了资源约束项，然而整个叙述却十分复杂。<a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 在同一轮反向传播中训练神经运算的参数和架构的分布参数（这样真的好？）。号称的思想是，利用泛化损失中的梯度信息提高基于强化学习的 NAS 的效率。</p> 
  <ul> 
   <li>与基于强化学习的方法<a href="http://proceedings.mlr.press/v80/pham18a/pham18a.pdf" rel="nofollow" data-token="3b6f1ed261f290d54a0366148b7481f3">[ENAS]</a>相比，<a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 的搜索优化可微分，搜索效率更高，可以在更少的迭代次数下收敛到更高准确率。</li> 
   <li>与其他可微分的方法<a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">[DARTS]</a>相比，<a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 直接优化 NAS 任务的目标函数，搜索结果偏差更小，可以直接通过一阶优化搜索。</li> 
   <li>同时优化网络损失函数的期望和网络前向时延的期望，可以自动生成硬件友好的稀疏网络。</li> 
  </ul> 
  <p><a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 的实验设置基本与 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 相同。</p> 
  <p><a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 将子网络运行延迟作为目标的正规化项：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mrow>
                <mi>
                 Z
                </mi>
                <mo>
                 ∼
                </mo>
                <msub>
                 <mi>
                  p
                 </mi>
                 <mi>
                  α
                 </mi>
                </msub>
                <mo>
                 (
                </mo>
                <mi>
                 Z
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msub>
              <mo>
               [
              </mo>
              <msub>
               <mi>
                L
               </mi>
               <mi>
                θ
               </mi>
              </msub>
              <mo>
               (
              </mo>
              <mi>
               Z
              </mi>
              <mo>
               )
              </mo>
              <mo>
               +
              </mo>
              <mi>
               η
              </mi>
              <mi>
               C
              </mi>
              <mo>
               (
              </mo>
              <mi>
               Z
              </mi>
              <mo>
               )
              </mo>
              <mo>
               ]
              </mo>
              <mo>
               =
              </mo>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mrow>
                <mi>
                 Z
                </mi>
                <mo>
                 ∼
                </mo>
                <msub>
                 <mi>
                  p
                 </mi>
                 <mi>
                  α
                 </mi>
                </msub>
                <mo>
                 (
                </mo>
                <mi>
                 Z
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msub>
              <mo>
               [
              </mo>
              <msub>
               <mi>
                L
               </mi>
               <mi>
                θ
               </mi>
              </msub>
              <mo>
               (
              </mo>
              <mi>
               Z
              </mi>
              <mo>
               )
              </mo>
              <mo>
               ]
              </mo>
              <mo>
               +
              </mo>
              <mi>
               η
              </mi>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mrow>
                <mi>
                 Z
                </mi>
                <mo>
                 ∼
                </mo>
                <msub>
                 <mi>
                  p
                 </mi>
                 <mi>
                  α
                 </mi>
                </msub>
                <mo>
                 (
                </mo>
                <mi>
                 Z
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msub>
              <mo>
               [
              </mo>
              <mi>
               C
              </mi>
              <mo>
               (
              </mo>
              <mi>
               Z
              </mi>
              <mo>
               )
              </mo>
              <mo>
               ]
              </mo>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} \mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[L_{\mathit{\theta}}(\mathit{Z})+\eta C(\mathit{Z})]=\mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[L_{\mathit{\theta}}(\mathit{Z})]+\eta \mathbb{E}_{\mathit{Z}\sim p_{\mathit{\alpha}}(\mathit{Z})}[C(\mathit{Z})], \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.5em; vertical-align: -0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1em;"><span class="" style="top: -3.16em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">Z</span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">Z</span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathit mtight">θ</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">Z</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.03588em;" class="mord mathit">η</span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">Z</span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">Z</span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">Z</span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathit mtight">θ</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">Z</span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.03588em;" class="mord mathit">η</span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">Z</span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">Z</span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">Z</span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          C
         </mi>
         <mo>
          (
         </mo>
         <mi>
          Z
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         C(\mathit{Z})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">Z</span></span><span class="mclose">)</span></span></span></span></span> 是与随机变量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          Z
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathit{Z}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">Z</span></span></span></span></span></span> 相关联的子网络的时间成本，包含3项指标：</p> 
  <ul> 
   <li>参数量;</li> 
   <li>浮点运算（float-point operations， FLOPs）的数量;</li> 
   <li>内存访问成本（memory access cost，MAC）。</li> 
  </ul> 
  <h2><a id="FBNethttpsarxivorgabs181203443_132"></a><a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a></h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190703143012309.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <p>与 <a href="http://openaccess.thecvf.com/content_cvpr_2018/papers/Veniat_Learning_TimeMemory-Efficient_Deep_CVPR_2018_paper.pdf" rel="nofollow" data-token="d2b9d51ca37423d939da8493ef1d13f8">BSN</a> 相同，<a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 以随机超网络表示搜索空间。将寻找最佳架构的问题放宽为找到产生最优体系结构的分布。借助于 <a href="https://openreview.net/pdf?id=rkE3y85ee" rel="nofollow" data-token="9e52983ceb3b52cf0f49b24e71bad8ba">Gumbel Softmax</a> 可以使用基于梯度的优化（如 SGD）直接训练架构分布。损失包括交叉熵损失和延迟损失。相当于宏搜索版的 <a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a>。</p> 
  <p>随机超网络对候选块进行采样，采样概率为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            P
           </mi>
           <msub>
            <mi mathvariant="bold-italic">
             θ
            </mi>
            <mi>
             l
            </mi>
           </msub>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mi>
            l
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mtext>
           softmax
          </mtext>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            θ
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="bold-italic">
            θ
           </mi>
           <mi>
            l
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              θ
             </mi>
             <mrow>
              <mi>
               l
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               i
              </mi>
             </mrow>
            </msub>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <munder>
             <mo>
              ∑
             </mo>
             <mi>
              i
             </mi>
            </munder>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              θ
             </mi>
             <mrow>
              <mi>
               l
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               i
              </mi>
             </mrow>
            </msub>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           P_{\bm{\theta}_{l}}(b_l = b_{l,i}) = \text{softmax}(\theta_{l,i}; \bm{\theta}_l) = \frac{\exp(\theta_{l,i})}{\sum_i \exp(\theta_{l,i})}. 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00586em; vertical-align: -0.25586em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.25586em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.03194em;" class="mord boldsymbol">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.41271em; vertical-align: -0.98571em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.98571em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="bold-italic">
           θ
          </mi>
          <mi>
           l
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \bm{\theta}_l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.03194em;" class="mord boldsymbol">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 包含的参数确定在第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathit">l</span></span></span></span></span> 层采样每个块的概率。同样，第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathit">l</span></span></span></span></span> 层的输出可以表示为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo>
             +
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            i
           </mi>
          </munder>
          <msub>
           <mi>
            m
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           ⋅
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            l
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           x_{l+1} = \sum_i m_{l, i} \cdot b_{l, i}(x_{l}), 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32767em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           m
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         m_{l,i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          {
         </mo>
         <mn>
          0
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          1
         </mn>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \{0, 1\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span> 中的随机变量，如果采样块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         b_{l, i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，则计算结果为1。采样概率由前面的等式确定。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           l
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         b_{l, i}(x_{l})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 表示给定输入特征图 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           l
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{l}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的情况下，第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathit">l</span></span></span></span></span> 层的第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 块的输出。<a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 让每个层独立采样，因此，采样架构 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          a
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         a
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span> 的概率可以描述为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            P
           </mi>
           <mi mathvariant="bold-italic">
            θ
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           a
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∏
           </mo>
           <mi>
            l
           </mi>
          </munder>
          <msub>
           <mi>
            P
           </mi>
           <msub>
            <mi mathvariant="bold-italic">
             θ
            </mi>
            <mi>
             l
            </mi>
           </msub>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mi>
            l
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msubsup>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             a
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msubsup>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           P_{\bm{\theta}}(a) = \prod_l P_{\bm{\theta}_l} (b_l = b_{l,i}^{(a)}), 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.35212em; vertical-align: -1.30211em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.25586em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.48222em; vertical-align: -0.437416em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.437416em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold-italic">
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \bm{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03194em;" class="mord boldsymbol">θ</span></span></span></span></span></span></span> 为一个向量，元素 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{l,i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 为第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 块的第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathit">l</span></span></span></span></span> 层的采样参数。 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            a
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         b_{l,i}^{(a)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.48222em; vertical-align: -0.437416em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.437416em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示在采样架构中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          a
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         a
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span>，在第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathit">l</span></span></span></span></span> 层中选中第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个块。</p> 
  <p>松弛求解最佳架构 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          a
         </mi>
         <mo>
          ∈
         </mo>
         <mi mathvariant="script">
          A
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         a \in \mathcal{A}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathit">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">A</span></span></span></span></span></span> 问题为优化随机超网络的概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           P
          </mi>
          <mi>
           θ
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         P_\theta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.02778em;" class="mord mathit mtight">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 以实现最小预期损失，公式重写为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <munder>
           <mo>
            <mtext>
             min&nbsp;
            </mtext>
           </mo>
           <mi mathvariant="bold-italic">
            θ
           </mi>
          </munder>
          <munder>
           <mo>
            <mtext>
             min&nbsp;
            </mtext>
           </mo>
           <msub>
            <mi>
             w
            </mi>
            <mi>
             a
            </mi>
           </msub>
          </munder>
          <msub>
           <mi mathvariant="bold">
            E
           </mi>
           <mrow>
            <mi>
             a
            </mi>
            <mo>
             ∼
            </mo>
            <msub>
             <mi>
              P
             </mi>
             <mi mathvariant="bold-italic">
              θ
             </mi>
            </msub>
           </mrow>
          </msub>
          <mo>
           {
          </mo>
          <mi mathvariant="script">
           L
          </mi>
          <mo>
           (
          </mo>
          <mi>
           a
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mi>
            a
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           }
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           \underset{\bm{\theta}}{\text{min }} \underset{w_a}{\text{min }} \mathbf{E}_{a \sim P_{\bm{\theta}}} \{\mathcal{L}(a, w_a) \}. 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.5501em; vertical-align: -0.8001em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.34789em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop"><span class="mord text"><span class="mord">min&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.752108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.02691em;" class="mord mathit mtight">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: -0.02691em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop"><span class="mord text"><span class="mord">min&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8001em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mrel mtight">∼</span><span class="mord mtight"><span style="margin-right: 0.13889em;" class="mord mathit mtight">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-left: -0.13889em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.25586em;"><span class=""></span></span></span></span></span></span><span class="mopen">{</span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span><span class="mord">.</span></span></span></span></span></span></p> 
  <p>将离散掩码变量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           m
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         m_{l,i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 放宽为由 <a href="https://openreview.net/pdf?id=rkE3y85ee" rel="nofollow" data-token="9e52983ceb3b52cf0f49b24e71bad8ba">Gumbel Softmax</a> 函数计算的连续随机变量：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <msub>
              <mi>
               m
              </mi>
              <mrow>
               <mi>
                l
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                i
               </mi>
              </mrow>
             </msub>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mtext>
               GumbelSoftmax
              </mtext>
              <mo>
               (
              </mo>
              <msub>
               <mi>
                θ
               </mi>
               <mrow>
                <mi>
                 l
                </mi>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 i
                </mi>
               </mrow>
              </msub>
              <mi mathvariant="normal">
               ∣
              </mi>
              <msub>
               <mi mathvariant="bold-italic">
                θ
               </mi>
               <mi mathvariant="bold-italic">
                l
               </mi>
              </msub>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <mfrac>
               <mrow>
                <mi>
                 exp
                </mi>
                <mo>
                 ⁡
                </mo>
                <mo>
                 [
                </mo>
                <mo>
                 (
                </mo>
                <msub>
                 <mi>
                  θ
                 </mi>
                 <mrow>
                  <mi>
                   l
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   i
                  </mi>
                 </mrow>
                </msub>
                <mo>
                 +
                </mo>
                <msub>
                 <mi>
                  g
                 </mi>
                 <mrow>
                  <mi>
                   l
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   i
                  </mi>
                 </mrow>
                </msub>
                <mo>
                 )
                </mo>
                <mi mathvariant="normal">
                 /
                </mi>
                <mi>
                 τ
                </mi>
                <mo>
                 ]
                </mo>
               </mrow>
               <mrow>
                <munder>
                 <mo>
                  ∑
                 </mo>
                 <mi>
                  i
                 </mi>
                </munder>
                <mi>
                 exp
                </mi>
                <mo>
                 ⁡
                </mo>
                <mo>
                 [
                </mo>
                <mo>
                 (
                </mo>
                <msub>
                 <mi>
                  θ
                 </mi>
                 <mrow>
                  <mi>
                   l
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   i
                  </mi>
                 </mrow>
                </msub>
                <mo>
                 +
                </mo>
                <msub>
                 <mi>
                  g
                 </mi>
                 <mrow>
                  <mi>
                   l
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   i
                  </mi>
                 </mrow>
                </msub>
                <mo>
                 )
                </mo>
                <mi mathvariant="normal">
                 /
                </mi>
                <mi>
                 τ
                </mi>
                <mo>
                 ]
                </mo>
               </mrow>
              </mfrac>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} m_{l, i} &amp;amp; = \text{GumbelSoftmax}(\theta_{l, i}|\bm{\theta_{l}}) \\ &amp;amp; = \frac{\exp[(\theta_{l,i} + g_{l,i})/\tau]}{\sum_i \exp[(\theta_{l,i} + g_{l,i})/\tau]}, \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.21271em; vertical-align: -1.85636em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35636em;"><span class="" style="top: -4.94336em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.85636em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85636em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35636em;"><span class="" style="top: -4.94336em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">GumbelSoftmax</span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.03194em;" class="mord boldsymbol">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03194em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.0088em;" class="mord boldsymbol mtight">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.85636em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span style="margin-right: 0.1132em;" class="mord mathit">τ</span><span class="mclose">]</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span style="margin-right: 0.1132em;" class="mord mathit">τ</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.98571em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85636em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           g
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
         <mo>
          ∼
         </mo>
         <mtext>
          Gumbel(0,&nbsp;1)
         </mtext>
        </mrow>
        <annotation encoding="application/x-tex">
         g_{l,i} \sim \text{Gumbel(0, 1)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Gumbel(0,&nbsp;1)</span></span></span></span></span></span> 是 Gumbel 分布的随机噪声。Gumbel Softmax 函数由温度参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          τ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \tau
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.1132em;" class="mord mathit">τ</span></span></span></span></span> 控制。当 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          τ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \tau
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.1132em;" class="mord mathit">τ</span></span></span></span></span> 接近0时，它近似于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           P
          </mi>
          <mi mathvariant="bold-italic">
           θ
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          a
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mo>
           ∏
          </mo>
          <mi>
           l
          </mi>
         </msub>
         <msub>
          <mi>
           P
          </mi>
          <msub>
           <mi mathvariant="bold-italic">
            θ
           </mi>
           <mi>
            l
           </mi>
          </msub>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           l
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <msubsup>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            a
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P_{\bm{\theta}}(a) = \prod_l P_{\bm{\theta}_l} (b_l = b_{l,i}^{(a)})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04971em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.186398em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03194em;" class="mord boldsymbol mtight">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.25586em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.48222em; vertical-align: -0.437416em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.437416em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 中分布的离散分类抽样。随着 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          τ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \tau
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.1132em;" class="mord mathit">τ</span></span></span></span></span> 变大，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           m
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         m_{l,i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 成为一个连续的随机变量。无论 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          τ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \tau
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.1132em;" class="mord mathit">τ</span></span></span></span></span> 的值如何，掩码 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           m
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         m_{l,i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 都对参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{l, i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathit">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 可微。<a href="https://arxiv.org/abs/1812.00090" rel="nofollow" data-token="c3ab98162ed6fc006c2be970461e0a2b">DNAS</a> 和 <a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a> 同样使用 <a href="https://openreview.net/pdf?id=rkE3y85ee" rel="nofollow" data-token="9e52983ceb3b52cf0f49b24e71bad8ba">Gumbel Softmax</a> 进行网络结构搜索。</p> 
  <p>对于延迟项，<a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 使用基于查找表的模型进行效率估计，因此 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mtext>
          LAT
         </mtext>
         <mo>
          (
         </mo>
         <mi>
          a
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{LAT}(a)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span> 公式可以写为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mtext>
           LAT
          </mtext>
          <mo>
           (
          </mo>
          <mi>
           a
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            l
           </mi>
          </munder>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            i
           </mi>
          </munder>
          <msub>
           <mi>
            m
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           ⋅
          </mo>
          <mtext>
           LAT
          </mtext>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             l
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           \text{LAT}(a) = \sum_l \sum_i m_{l,i} \cdot \text{LAT} (b_{l,i}). 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.35212em; vertical-align: -1.30211em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span><br> 每个运算符 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mtext>
          LAT
         </mtext>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{LAT} (b_{l,i})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的延迟是一个常数系数，从而架构 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          a
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         a
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span> 的整体延迟相对于掩码 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           m
          </mi>
          <mrow>
           <mi>
            l
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         m_{l,i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是可微分的。</p> 
  <p>训练过程为：</p> 
  <ul> 
   <li>随机取 ImageNet 的100类在8 GPU 机器上训练随机超网络90个 epoch，batchsize=192；</li> 
   <li>挑选出最优结构后，在 ImageNet 上训练360个 epoch，batchsize=256。</li> 
  </ul> 
  <p><a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 的搜索空间参考 <a href="https://arxiv.org/abs/1801.04381" rel="nofollow" data-token="5a090bcd07c50b0975fde9ec7b1e46cc">MobileNetV2</a> 和 <a href="http://openaccess.thecvf.com/content_cvpr_2018/papers/Wu_Shift_A_Zero_CVPR_2018_paper.pdf" rel="nofollow" data-token="cee8ab6116a0f1eb3e2f14856ec8b513">ShiftNet</a> ，网络首尾固定，中间的22层可调，如 Table 1 所示。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190806105030218.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="Macro-architecture of the search space"><br> 块结构如下图所示，深度分离卷积可选3x3或5x5的卷积核，块内的首尾1x1卷积可替换为 group + channel shuffle。</p> 
  <blockquote> 
   <p>值得注意的是网络没有使用 BN，论文也未谈到这一点。但 <a href="https://github.com/facebookresearch/maskrcnn-benchmark/blob/master/maskrcnn_benchmark/modeling/backbone/fbnet_builder.py" rel="nofollow" data-token="9af4f1f2d90b5309e5522762a4b84cbe">fbnet_builder</a> 中是有的。</p> 
  </blockquote> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190806105549416.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="block"><br> 从 ImageNet 中随即取100类作为训练集，历经90个 epoch。找到最优结构后，从头训练模型。损失函数为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mi mathvariant="script">
               L
              </mi>
              <mo>
               (
              </mo>
              <mi>
               a
              </mi>
              <mo separator="true">
               ,
              </mo>
              <msub>
               <mi>
                w
               </mi>
               <mi>
                a
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo>
               =
              </mo>
              <mtext>
               &nbsp;CE
              </mtext>
              <mo>
               (
              </mo>
              <mi>
               a
              </mi>
              <mo separator="true">
               ,
              </mo>
              <msub>
               <mi>
                w
               </mi>
               <mi>
                a
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo>
               ⋅
              </mo>
              <mi>
               α
              </mi>
              <mi>
               log
              </mi>
              <mo>
               ⁡
              </mo>
              <mo>
               (
              </mo>
              <mtext>
               LAT
              </mtext>
              <mo>
               (
              </mo>
              <mi>
               a
              </mi>
              <mo>
               )
              </mo>
              <msup>
               <mo>
                )
               </mo>
               <mi>
                β
               </mi>
              </msup>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} \mathcal{L}(a, w_a) = \text{ CE}(a, w_a) \cdot \alpha \log(\text{LAT}(a))^\beta \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.55911em; vertical-align: -0.529554em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.02955em;"><span class="" style="top: -3.13045em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">&nbsp;CE</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05278em;" class="mord mathit mtight">β</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.529554em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> 第一项 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mtext>
          CE
         </mtext>
         <mo>
          (
         </mo>
         <mi>
          a
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           w
          </mi>
          <mi>
           a
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{CE}(a, w_a)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">CE</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 表示架构 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          a
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         a
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span> 与相应参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mi>
           a
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_a
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的交叉熵损失。第二项 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mtext>
          LAT
         </mtext>
         <mo>
          (
         </mo>
         <mi>
          a
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{LAT}(a)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span> 表示目标硬件上体系结构的延迟，以微秒为单位。系数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span></span></span></span></span> 控制损失函数的总体大小。指数系数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          β
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05278em;" class="mord mathit">β</span></span></span></span></span> 调制延迟项的大小。除了 log 外，形式与 <a href="https://arxiv.org/abs/1807.11626" rel="nofollow" data-token="31ff705a2a6a757c9721af3e292748fc">MnasNet</a> 类似。</p> 
  <p><a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 预先测试每个 op 的耗时，创建查找表来估计不同模型的延时。目标设备为 Samsung Galaxy S8和 iPhone X。</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mtext>
               LAT
              </mtext>
              <mo>
               (
              </mo>
              <mi>
               a
              </mi>
              <mo>
               )
              </mo>
              <mo>
               =
              </mo>
              <munder>
               <mo>
                ∑
               </mo>
               <mi>
                l
               </mi>
              </munder>
              <mtext>
               LAT
              </mtext>
              <mo>
               (
              </mo>
              <msubsup>
               <mi>
                b
               </mi>
               <mi>
                l
               </mi>
               <mrow>
                <mo>
                 (
                </mo>
                <mi>
                 a
                </mi>
                <mo>
                 )
                </mo>
               </mrow>
              </msubsup>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} \text{LAT}(a) = \sum_l \text{LAT} (b_l^{(a)}), \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.65212em; vertical-align: -1.07606em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.57606em;"><span class="" style="top: -3.57606em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">LAT</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.07606em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           b
          </mi>
          <mi>
           l
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            a
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         b_l^{(a)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathit mtight">l</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示架构 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          a
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         a
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">a</span></span></span></span></span> 来自第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathit">l</span></span></span></span></span> 层的块。</p> 
  <p><a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 将模型量化到 int8 在 Caffe2上测试，为对比将其他方法也进行了转换。</p> 
  <h2><a id="ProxylessNAShttpsopenreviewnetpdfidHylVB3AqYm_204"></a><a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a></h2> 
  <div class="mermaid">
   <svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-2jsXIKWwbJ3dvYiV" height="208" width="621" viewbox="0 0 641 228">
    <g>
     <g class="output">
      <g class="clusters"></g>
      <g class="edgePaths">
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M58,142L58,104L232.5,58.99154334038055" marker-end="url(#arrowhead89)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead89" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M209,142L209,104L262.2622950819672,66" marker-end="url(#arrowhead90)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead90" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M380,142L380,104L326.7377049180328,66" marker-end="url(#arrowhead91)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead91" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
       <g class="edgePath" style="opacity: 1;">
        <path class="path" d="M544.5,142L544.5,104L356.5,58.128" marker-end="url(#arrowhead92)" style="fill:none"></path>
        <defs>
         <marker id="arrowhead92" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto">
          <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path>
         </marker>
        </defs>
       </g>
      </g>
      <g class="edgeLabels">
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="translate(209,104)">
        <g transform="translate(-6,-13)" class="label">
         <foreignobject width="12" height="26">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel">D</span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="translate(380,104)">
        <g transform="translate(-6,-13)" class="label">
         <foreignobject width="12" height="26">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel">R</span>
          </div>
         </foreignobject>
        </g>
       </g>
       <g class="edgeLabel" style="opacity: 1;" transform="">
        <g transform="translate(0,0)" class="label">
         <foreignobject width="0" height="0">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
           <span class="edgeLabel"></span>
          </div>
         </foreignobject>
        </g>
       </g>
      </g>
      <g class="nodes">
       <g class="node" style="opacity: 1;" id="DARTS" transform="translate(58,165)">
        <rect rx="0" ry="0" x="-38" y="-23" width="76" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-28,-13)">
          <foreignobject width="56" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            DARTS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="ProxylessNAS" transform="translate(294.5,43)">
        <rect rx="0" ry="0" x="-62" y="-23" width="124" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-52,-13)">
          <foreignobject width="104" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            ProxylessNAS
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="BinaryConnect" transform="translate(209,165)">
        <rect rx="0" ry="0" x="-63" y="-23" width="126" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-53,-13)">
          <foreignobject width="106" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            BinaryConnect
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="REINFORCE" transform="translate(380,165)">
        <rect rx="0" ry="0" x="-58" y="-23" width="116" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-48,-13)">
          <foreignobject width="96" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            REINFORCE
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
       <g class="node" style="opacity: 1;" id="MobileNetV2" transform="translate(544.5,165)">
        <rect rx="0" ry="0" x="-56.5" y="-23" width="113" height="46"></rect>
        <g class="label" transform="translate(0,0)">
         <g transform="translate(-46.5,-13)">
          <foreignobject width="93" height="26">
           <div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">
            MobileNetV2
           </div>
          </foreignobject>
         </g>
        </g>
       </g>
      </g>
     </g>
    </g>
   </svg>
  </div> 
  <p>可微 NAS 通过网络架构的连续表示来降低训练时长，但会遇到高 GPU 内存消耗问题（随候选集大小线性增长）。<a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 着眼于减少内存消耗，在训练时采样两条路径。采用强化学习和梯度下降两种方法训练 CPU、GPU 以及移动处理器3个平台上的模型。文中试图套用 <a href="https://arxiv.org/abs/1511.00363" rel="nofollow" data-token="a4aec7b4b6e7d19e248c1d9a05d5e204">BinaryConnect</a> ，大讲二值化。然而路径二值化并不能降低内存消耗，实际运行机理与此毫不相干。直接在目标数据集上训练也有点噱头，因为分摊下来每条路径的训练轮数不多。论文题目不如改成随机采样更新的 Softmax 近似。而且，采样路径却未提 BatchNorm 如何应对。一个鲜明的例子是 <a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 也使用路径采样方法，但未提及二值化。</p> 
  <p><a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 受 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 和 <a href="http://proceedings.mlr.press/v80/bender18a/bender18a.pdf" rel="nofollow" data-token="224651b12ea0036699a119b0e09c951e">One-Shot</a> 的启发 ， 将 NAS 定义为路径级修剪过程。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190704101734969.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="method"><br> <a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 在目标硬件上学习专用网络结构，但硬件目标（以延迟为例）不可微分。为此，其将网络延迟建模为连续函数，并作为正则化损失进行优化，类似于 <a href="https://openreview.net/pdf?id=rylqooRqK7" rel="nofollow" data-token="f049af5f00f293ea4d4d1546354c14d7">SNAS</a>。此外，<a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 还提出了一种基于 <a href="https://link.springer.com/article/10.1007/BF00992696" rel="nofollow" data-token="83f98bc21feb043a0112bd0f0a1b2fda">REINFORCE规则</a> 的算法（Proxyless-R），作为处理硬件度量的替代策略。</p> 
  <p><a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 将路径 N 选择一分解为多个二进制选择任务。 直觉是，如果一条路径是特定位置的最佳选择，那么与任何其他路径相比，它应该是更好的选择。</p> 
  <p>在结构参数的更新步骤中：</p> 
  <ul> 
   <li>首先根据多项分布 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            p
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mo>
           ⋯
          </mo>&amp;ThinSpace;
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            p
           </mi>
           <mi>
            N
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          (p_1, \cdots, p_N)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.10903em;" class="mord mathit mtight">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 对两条路径进行采样，并屏蔽所有其他路径，就好像它们不存在一样。因此，候选数暂时从 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           N
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          N
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.10903em;" class="mord mathit">N</span></span></span></span></span> 减少到2，而路径权重 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mo>
           {
          </mo>
          <msub>
           <mi>
            p
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           }
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \{p_i\}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> 和二进制门 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mo>
           {
          </mo>
          <msub>
           <mi>
            g
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           }
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \{g_i\}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> 相应地重置。</li> 
   <li>然后，我们使用通过公式(4)计算的梯度更新这两个采样路径的架构参数。</li> 
   <li>最后，由于通过将 softmax 应用于架构参数来计算路径权重，需要通过乘以比率来重新调整这两个更新的架构参数的值，以保持未采样路径的路径权重不变。</li> 
  </ul> 
  <p>这样，在每个更新步骤中，一个采样路径被增强（路径权重增大），另一个采样路径被衰减（路径权重减小），而所有其他路径保持不变。这样，无论 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          N
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         N
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.10903em;" class="mord mathit">N</span></span></span></span></span> 的值如何，在架构参数的每个更新步骤中仅涉及两条路径，从而将内存需求降低到训练紧凑模型的相同水平。</p> 
  <p>为了使延迟可微分，<a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 将网络的延迟建模为神经网络维度的连续函数。考虑具有候选集 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          {
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           j
          </mi>
         </msub>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \{o_j\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> 的混合操作，并且每个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         o_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 与路径权重 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           p
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         p_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 相关联，该权重表示选择 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         o_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的概率。因此，混合操作（即可学习块）的预期延迟如下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="double-struck">
           E
          </mi>
          <mo>
           [
          </mo>
          <msub>
           <mtext>
            latency
           </mtext>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           ]
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            j
           </mi>
          </munder>
          <msubsup>
           <mi>
            p
           </mi>
           <mi>
            j
           </mi>
           <mi>
            i
           </mi>
          </msubsup>
          <mo>
           ×
          </mo>
          <mi>
           F
          </mi>
          <mo>
           (
          </mo>
          <msubsup>
           <mi>
            o
           </mi>
           <mi>
            j
           </mi>
           <mi>
            i
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           \mathbb{E} [\text{latency}_i] = \sum_j p_j^i \times F(o_j^i), 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">latency</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.46378em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.25777em; vertical-align: -0.383108em;"></span><span style="margin-right: 0.13889em;" class="mord mathit">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="double-struck">
          E
         </mi>
         <mo>
          [
         </mo>
         <msub>
          <mtext>
           latency
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbb{E} [\text{latency}_i]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">latency</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> 是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           i
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mi>
            h
           </mi>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         i^{th}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> 可学习块的预期延迟，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          F
         </mi>
         <mo>
          (
         </mo>
         <mo>
          ⋅
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         F(\cdot)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathit">F</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> 表示延迟预测模型，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          F
         </mi>
         <mo>
          (
         </mo>
         <msubsup>
          <mi>
           o
          </mi>
          <mi>
           j
          </mi>
          <mi>
           i
          </mi>
         </msubsup>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         F(o_j^i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span style="margin-right: 0.13889em;" class="mord mathit">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           o
          </mi>
          <mi>
           j
          </mi>
          <mi>
           i
          </mi>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         o_j^i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的预测延迟。因此，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="double-struck">
          E
         </mi>
         <mo>
          [
         </mo>
         <msub>
          <mtext>
           latency
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbb{E} [\text{latency}_i]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">latency</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> 关于体系结构参数的梯度为： <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∂
         </mi>
         <mi mathvariant="double-struck">
          E
         </mi>
         <mo>
          [
         </mo>
         <msub>
          <mtext>
           latency
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ]
         </mo>
         <mtext>
          &nbsp;
         </mtext>
         <mi mathvariant="normal">
          /
         </mi>
         <mtext>
          &nbsp;
         </mtext>
         <mi mathvariant="normal">
          ∂
         </mi>
         <msubsup>
          <mi>
           p
          </mi>
          <mi>
           j
          </mi>
          <mi>
           i
          </mi>
         </msubsup>
         <mo>
          =
         </mo>
         <mi>
          F
         </mi>
         <mo>
          (
         </mo>
         <msubsup>
          <mi>
           o
          </mi>
          <mi>
           j
          </mi>
          <mi>
           i
          </mi>
         </msubsup>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \partial \mathbb{E} [\text{latency}_i]~/~\partial p_j^i = F(o_j^i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">latency</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace nobreak">&nbsp;</span><span class="mord">/</span><span class="mspace nobreak">&nbsp;</span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span style="margin-right: 0.13889em;" class="mord mathit">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190820092243601.jpg" alt="method_illustration"><br> 对于具有一系列混合操作的整个网络，由于这些操作在推理期间按顺序执行，因此网络的预期延迟可以用这些混合操作的总预期延迟之和表示：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="double-struck">
           E
          </mi>
          <mo>
           [
          </mo>
          <mtext>
           latency
          </mtext>
          <mo>
           ]
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            i
           </mi>
          </munder>
          <mi mathvariant="double-struck">
           E
          </mi>
          <mo>
           [
          </mo>
          <msub>
           <mtext>
            latency
           </mtext>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           ]
          </mo>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           \mathbb{E} [\text{latency}] = \sum_i \mathbb{E} [\text{latency}_i], 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord text"><span class="mord">latency</span></span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32767em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">latency</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span></span></p> 
  <p>Proxyless-G 通过乘以比例因子 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           λ
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mo>
          &amp;gt;
         </mo>
         <mn>
          0
         </mn>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda_2 (&amp;gt; 0)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> 将网络的预期延迟纳入正常损失函数，该比例因子控制精度和延迟之间的权衡。最终的损失函数给出为</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           L
          </mi>
          <mi>
           o
          </mi>
          <mi>
           s
          </mi>
          <mi>
           s
          </mi>
          <mo>
           =
          </mo>
          <mi>
           L
          </mi>
          <mi>
           o
          </mi>
          <mi>
           s
          </mi>
          <msub>
           <mi>
            s
           </mi>
           <mrow>
            <mi>
             C
            </mi>
            <mi>
             E
            </mi>
           </mrow>
          </msub>
          <mo>
           +
          </mo>
          <msub>
           <mi>
            λ
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           w
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <msubsup>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mn>
            2
           </mn>
           <mn>
            2
           </mn>
          </msubsup>
          <mo>
           +
          </mo>
          <mstyle mathcolor="red">
           <msub>
            <mi>
             λ
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mi mathvariant="double-struck">
            E
           </mi>
           <mo>
            [
           </mo>
           <mtext>
            latency
           </mtext>
           <mo>
            ]
           </mo>
          </mstyle>
          <mo separator="true">
           ,
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           Loss = Loss_{CE} + \lambda_1 ||w||_2^2 + {\color{red} \lambda_2 \mathbb{E}[\text{latency}]}, 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">C</span><span style="margin-right: 0.05764em;" class="mord mathit mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord" style="color: red;"><span class="mord mathit" style="color: red;">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: red;"><span class="mord mtight" style="color: red;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: red;"><span class="mord mathbb" style="color: red;">E</span></span><span class="mopen" style="color: red;">[</span><span class="mord text" style="color: red;"><span class="mord" style="color: red;">latency</span></span><span class="mclose" style="color: red;">]</span></span><span class="mpunct">,</span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          L
         </mi>
         <mi>
          o
         </mi>
         <mi>
          s
         </mi>
         <msub>
          <mi>
           s
          </mi>
          <mrow>
           <mi>
            C
           </mi>
           <mi>
            E
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         Loss_{CE}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.07153em;" class="mord mathit mtight">C</span><span style="margin-right: 0.05764em;" class="mord mathit mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示交叉熵损失，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           λ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          w
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <msubsup>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mn>
           2
          </mn>
          <mn>
           2
          </mn>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda_1 ||w||_2^2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span style="margin-right: 0.02691em;" class="mord mathit">w</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是权重衰减项。</p> 
  <p><a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 还可以利用 <a href="http://www-anw.cs.umass.edu/~barto/courses/cs687/williams92simple.pdf" rel="nofollow" data-token="bc72a41f34c2283b371135b4d5a9568a">REINFORCE</a> 来训练二值化权重。考虑具有二进制化参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span></span></span></span></span> 的网络，更新二进制化参数的目的是找到最大化某个奖励 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          R
         </mi>
         <mo>
          (
         </mo>
         <mo>
          ⋅
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         R(\cdot)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> 的最佳二进制门 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          g
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         g
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.03588em;" class="mord mathit">g</span></span></span></span></span> 。为便于说明，这里假设网络只有一个混合操作。因此，根据 <a href="http://www-anw.cs.umass.edu/~barto/courses/cs687/williams92simple.pdf" rel="nofollow" data-token="bc72a41f34c2283b371135b4d5a9568a">REINFORCE</a> ，对二进制化参数进行了以下更新：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mi>
               J
              </mi>
              <mo>
               (
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mrow>
                <mi>
                 g
                </mi>
                <mo>
                 ∼
                </mo>
                <mi>
                 α
                </mi>
               </mrow>
              </msub>
              <mo>
               [
              </mo>
              <mi>
               R
              </mi>
              <mo>
               (
              </mo>
              <msub>
               <mi mathvariant="script">
                N
               </mi>
               <mi>
                g
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo>
               ]
              </mo>
              <mo>
               =
              </mo>
              <munder>
               <mo>
                ∑
               </mo>
               <mi>
                i
               </mi>
              </munder>
              <msub>
               <mi>
                p
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mi>
               R
              </mi>
              <mo>
               (
              </mo>
              <mi mathvariant="script">
               N
              </mi>
              <mo>
               (
              </mo>
              <mi>
               e
              </mi>
              <mo>
               =
              </mo>
              <msub>
               <mi>
                o
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <mi>
               J
              </mi>
              <mo>
               (
              </mo>
              <mi>
               α
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <munder>
               <mo>
                ∑
               </mo>
               <mi>
                i
               </mi>
              </munder>
              <mi>
               R
              </mi>
              <mo>
               (
              </mo>
              <mi mathvariant="script">
               N
              </mi>
              <mo>
               (
              </mo>
              <mi>
               e
              </mi>
              <mo>
               =
              </mo>
              <msub>
               <mi>
                o
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo>
               )
              </mo>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <msub>
               <mi>
                p
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               =
              </mo>
              <munder>
               <mo>
                ∑
               </mo>
               <mi>
                i
               </mi>
              </munder>
              <mi>
               R
              </mi>
              <mo>
               (
              </mo>
              <mi mathvariant="script">
               N
              </mi>
              <mo>
               (
              </mo>
              <mi>
               e
              </mi>
              <mo>
               =
              </mo>
              <msub>
               <mi>
                o
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo>
               )
              </mo>
              <msub>
               <mi>
                p
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <mi>
               log
              </mi>
              <mo>
               ⁡
              </mo>
              <mo>
               (
              </mo>
              <msub>
               <mi>
                p
               </mi>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle displaystyle="true" scriptlevel="0">
             <mrow>
              <mrow></mrow>
              <mo>
               =
              </mo>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mrow>
                <mi>
                 g
                </mi>
                <mo>
                 ∼
                </mo>
                <mi>
                 α
                </mi>
               </mrow>
              </msub>
              <mo>
               [
              </mo>
              <mi>
               R
              </mi>
              <mo>
               (
              </mo>
              <msub>
               <mi mathvariant="script">
                N
               </mi>
               <mi>
                g
               </mi>
              </msub>
              <mo>
               )
              </mo>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <mi>
               log
              </mi>
              <mo>
               ⁡
              </mo>
              <mo>
               (
              </mo>
              <mi>
               p
              </mi>
              <mo>
               (
              </mo>
              <mi>
               g
              </mi>
              <mo>
               )
              </mo>
              <mo>
               )
              </mo>
              <mo>
               ]
              </mo>
              <mo>
               ≈
              </mo>
              <mfrac>
               <mn>
                1
               </mn>
               <mi>
                M
               </mi>
              </mfrac>
              <munderover>
               <mo>
                ∑
               </mo>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 =
                </mo>
                <mn>
                 1
                </mn>
               </mrow>
               <mi>
                M
               </mi>
              </munderover>
              <mi>
               R
              </mi>
              <mo>
               (
              </mo>
              <msub>
               <mi mathvariant="script">
                N
               </mi>
               <msup>
                <mi>
                 g
                </mi>
                <mi>
                 i
                </mi>
               </msup>
              </msub>
              <mo>
               )
              </mo>
              <msub>
               <mi mathvariant="normal">
                ∇
               </mi>
               <mi>
                α
               </mi>
              </msub>
              <mi>
               log
              </mi>
              <mo>
               ⁡
              </mo>
              <mo>
               (
              </mo>
              <mi>
               p
              </mi>
              <mo>
               (
              </mo>
              <msup>
               <mi>
                g
               </mi>
               <mi>
                i
               </mi>
              </msup>
              <mo>
               )
              </mo>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} J(\alpha) &amp;amp;= \mathbb{E}_{g \sim \alpha}[R(\mathcal{N}_g)] = \sum_i p_i R(\mathcal{N}(e = o_i)), \\ \nabla_\alpha J(\alpha) &amp;amp;= \sum_i R(\mathcal{N}(e = o_i)) \nabla_\alpha p_i = \sum_i R(\mathcal{N}(e = o_i)) p_i \nabla_\alpha \log(p_i), \\ &amp;amp;= \mathbb{E}_{g \sim \alpha} [R(\mathcal{N}_g) \nabla_\alpha \log(p(g))] \approx \frac{1}{M} \sum_{i=1}^M R(\mathcal{N}_{g^i}) \nabla_\alpha \log(p(g^i)), \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 8.66135em; vertical-align: -4.08068em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.58068em;"><span class="" style="top: -7.35901em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span style="margin-right: 0.09618em;" class="mord mathit">J</span><span class="mopen">(</span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span><span class="" style="top: -4.73133em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span style="margin-right: 0.09618em;" class="mord mathit">J</span><span class="mopen">(</span><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="mclose">)</span></span></span><span class="" style="top: -1.32533em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.08068em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.58068em;"><span class="" style="top: -7.35901em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span><span class="mrel mtight">∼</span><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span class="" style="top: -4.73133em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span class="" style="top: -1.32533em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span><span class="mrel mtight">∼</span><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathit">p</span><span class="mopen">(</span><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathit">M</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.10903em;" class="mord mathit mtight">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.51484em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.757086em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.321268em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.0037em;" class="mord mathit mtight">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.08068em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p>其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           g
          </mi>
          <mi>
           i
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         g^i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0191em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> 表示第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           i
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mi>
            h
           </mi>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         i^{th}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> 个采样二进制门，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          p
         </mi>
         <mo>
          (
         </mo>
         <msup>
          <mi>
           g
          </mi>
          <mi>
           i
          </mi>
         </msup>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         p(g^i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 表示根据公式2采样 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           g
          </mi>
          <mi>
           i
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         g^i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0191em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> 的概率，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="script">
           N
          </mi>
          <msup>
           <mi>
            g
           </mi>
           <mi>
            i
           </mi>
          </msup>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathcal{N}_{g^i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0046em; vertical-align: -0.321268em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.51484em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.757086em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.321268em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是根据二进制门 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           g
          </mi>
          <mi>
           i
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         g^i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0191em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> 的紧凑型网络。由于上式不需要 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          R
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi mathvariant="script">
           N
          </mi>
          <mi>
           g
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         R(\mathcal{N}_g)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="mopen">(</span><span class="mord"><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathit mtight">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 对 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          g
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         g
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.03588em;" class="mord mathit">g</span></span></span></span></span> 可微，因此它可以处理不可微分的目标。一个有趣的观察是，公式eq:reinforce具有与标准 <a href="https://openreview.net/forum?id=r1Ue8Hcxg" rel="nofollow" data-token="6d9eced38bcb0f4cc7578f2369a7abe2">NAS</a> 类似的形式，但它不是一个连续的决策过程，并且没有使用 RNN 元控制器。此外，由于基于梯度的更新和基于 <a href="http://www-anw.cs.umass.edu/~barto/courses/cs687/williams92simple.pdf" rel="nofollow" data-token="bc72a41f34c2283b371135b4d5a9568a">REINFORCE</a> 的更新对于相同的二值化体系结构参数基本上是两个不同的更新规则，因此可以将它们组合以形成体系结构参数的新更新规则。</p> 
  <p>Proxyless-R 与 <a href="https://arxiv.org/abs/1807.11626" rel="nofollow" data-token="31ff705a2a6a757c9721af3e292748fc">MnasNet</a> 类似，使用 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
         <mi>
          C
         </mi>
         <mi>
          C
         </mi>
         <mo>
          (
         </mo>
         <mi>
          m
         </mi>
         <mo>
          )
         </mo>
         <mo>
          ×
         </mo>
         <mo>
          [
         </mo>
         <mi>
          L
         </mi>
         <mi>
          A
         </mi>
         <mi>
          T
         </mi>
         <mo>
          (
         </mo>
         <mi>
          m
         </mi>
         <mo>
          )
         </mo>
         <mi mathvariant="normal">
          /
         </mi>
         <mi>
          T
         </mi>
         <msup>
          <mo>
           ]
          </mo>
          <mi>
           w
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         ACC(m) \times [ LAT(m) / T]^w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">A</span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathit">L</span><span class="mord mathit">A</span><span style="margin-right: 0.13889em;" class="mord mathit">T</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mord">/</span><span style="margin-right: 0.13889em;" class="mord mathit">T</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.02691em;" class="mord mathit mtight">w</span></span></span></span></span></span></span></span></span></span></span></span> 作为优化目标，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
         <mi>
          C
         </mi>
         <mi>
          C
         </mi>
         <mo>
          (
         </mo>
         <mi>
          m
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         ACC(m)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">A</span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></span> 表示模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span> 的准确率，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          L
         </mi>
         <mi>
          A
         </mi>
         <mi>
          T
         </mi>
         <mo>
          (
         </mo>
         <mi>
          m
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         LAT(m)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mord mathit">A</span><span style="margin-right: 0.13889em;" class="mord mathit">T</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></span> 表示 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span> 的延迟，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         T
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathit">T</span></span></span></span></span> 是目标延迟，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathit">w</span></span></span></span></span> 是用于控制准确性和延迟之间权衡的超参数。</p> 
  <p><a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 与 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 在验证集上训练结构参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         {\alpha}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span></span></span></span></span></span>，而 <a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 未进行划分。</p> 
  <p><a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 设置一系列 MBConv，卷积核大小可选 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          {
         </mo>
         <mn>
          3
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          5
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          7
         </mn>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \{3, 5, 7\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">7</span><span class="mclose">}</span></span></span></span></span> 扩张系数为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          {
         </mo>
         <mn>
          3
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          6
         </mn>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \{3, 6\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">6</span><span class="mclose">}</span></span></span></span></span>。</p> 
  <p>令人困惑的是 <a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 的 batchsize=256，<a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 为192。<a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 只用 ImageNet 的1/10，<a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 使用全部，二者训练时间却相同。<a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 估计 <a href="https://arxiv.org/abs/1807.11626" rel="nofollow" data-token="31ff705a2a6a757c9721af3e292748fc">MnasNet</a> 的成本为91000 GPU hours；<a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 实现的是40000。假定 <a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 用的是 V100（测试平台是这一型号）， <a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 的设备似乎与之存在代差。</p> 
  <h2><a id="SinglePath_NAShttpsarxivorgabs190402877_269"></a><a href="https://arxiv.org/abs/1904.02877" rel="nofollow" data-token="ee9b6f1bf366e9f73cb08ca2d48b9ad9">Single-Path NAS</a></h2> 
  <p><a href="https://arxiv.org/abs/1904.02877" rel="nofollow" data-token="ee9b6f1bf366e9f73cb08ca2d48b9ad9">Single-Path NAS</a> 是一种单路径（或者 superkernel）方法。用一个7x7的大卷积，来代表3x3、5x5和7x7的三种卷积，把外边一圈 mask 清零掉就变成了3x3或5x5。扩张系数类似，认为6包含两个3，实现高度的参数复用。</p> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190703145129961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019070314522962.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <p>省显存，然而本质还是搜索空间小。基础网络参考 <a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a>，仅搜索 expansion rate 和 kernel size。<a href="https://arxiv.org/abs/1904.02877" rel="nofollow" data-token="ee9b6f1bf366e9f73cb08ca2d48b9ad9">Single-Path NAS</a> 代码 <a href="https://github.com/dstamoulis/single-path-nas" rel="nofollow" data-token="85c7516b735e44536fba164e85af3bd3">dstamoulis/single-path-nas</a> 完全开源，依赖 TensorFlow 和 TPU，使用 <a href="https://github.com/facebook/FAI-PEP" rel="nofollow" data-token="cc70ac37c06b64a299af50759f4be344">facebook/FAI-PEP</a> 分析模型每层的运行时间。比较有意思的是文中的表格，几种搜索算法结果并未拉开差距。</p> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190703194938952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="single-path nas"></p> 
  <h2><a id="DenseNAShttpsarxivorgabs190609607_278"></a><a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a></h2> 
  <p><a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 由地平线和华中科技大学联合提出，号称可以搜索网络结构中每个 block 的宽度和对应的空间分辨率。<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 构建一个密集连接的搜索空间。每个块的滤波器的数量（即宽度）以小步幅逐渐增加。搜索空间参考 <a href="https://arxiv.org/abs/1801.04381" rel="nofollow" data-token="5a090bcd07c50b0975fde9ec7b1e46cc">MobileNetV2</a> 并采用密集连接的形式构建。搜索空间比之前一些算法大。然而 <a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 与 <a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 一样训练集取 ImageNet 的1/10，同时类似 <a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 采样路径训练，反而比二者训练时间缩短一半。</p> 
  <p>如下图所示，<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 在三个不同的级别（<strong>layer</strong>、<strong>block</strong> 和 <strong>network</strong>）定义搜索空间：</p> 
  <ul> 
   <li>每个层都包含所有候选操作；</li> 
   <li>一个块可以分为两个组件：头部层和堆叠层；</li> 
   <li>整个网络使用具有增量宽度的块构建。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190820085808208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="search space"></li> 
  </ul> 
  <p>层为搜索空间中的基本结构。一层代表一组候选操作。搜索空间中的操作集合如表 Table 1 所示。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190820085846887.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpcmFuMTAz,size_16,color_FFFFFF,t_70" alt="Table 1"><br> 每个块由若干层组成，拥有固定宽度和相应的空间分辨率。头部层处理具有不同通道数和空间分辨率的输入张量，并转换为固定宽度和空间分辨率。头部层不包括跳过连接，因为它是所有块所必需的。头部层之后是许多堆叠层（图中的例子中是三层）。之后，堆叠层中的操作以相同数量的通道和空间分辨率执行。</p> 
  <p><a href="https://arxiv.org/abs/1807.11626" rel="nofollow" data-token="31ff705a2a6a757c9721af3e292748fc">MnasNet</a>、<a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 和 <a href="https://arxiv.org/abs/1812.03443" rel="nofollow" data-token="308ce9d1e7115093b9ada0ef731f846e">FBNet</a> 设置固定数量的块。<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 在搜索空间中设计了更多具有不同宽度的块，并允许搜索架构只包含块的子集，从而使搜索算法能够自由地选择具有特定宽度的块，同时丢弃其他块。</p> 
  <p>整个超网络架构定义为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
         <mi>
          r
         </mi>
         <mi>
          c
         </mi>
         <mi>
          h
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Arch
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">A</span><span style="margin-right: 0.02778em;" class="mord mathit">r</span><span class="mord mathit">c</span><span class="mord mathit">h</span></span></span></span></span>，并假设它包含 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          N
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         N
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.10903em;" class="mord mathit">N</span></span></span></span></span> 个块：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
         <mi>
          r
         </mi>
         <mi>
          c
         </mi>
         <mi>
          h
         </mi>
         <mo>
          =
         </mo>
         <mo>
          {
         </mo>
         <msub>
          <mi>
           B
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           B
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           N
          </mi>
         </msub>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         Arch = \{B_1, B_2, ..., B_N\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">A</span><span style="margin-right: 0.02778em;" class="mord mathit">r</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.10903em;" class="mord mathit mtight">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>。 <a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 将整个网络划分为几个阶段。每个阶段拥有不同的宽度范围和固定的空间分辨率。超网络从头到尾，块的宽度以小步幅逐渐增长。网络的早期阶段设定较小的宽度增长步幅，因为设置较大将导致巨大的计算成本。后期阶段增长幅度逐渐变大。如结构图所示，在第3阶段，空间分辨率设置为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          28
         </mn>
         <mo>
          ×
         </mo>
         <mn>
          28
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         28 \times 28
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mord">8</span></span></span></span></span>，宽度增长步幅为8。宽度增长步幅在第4阶段变为16，阶段5变为64。</p> 
  <p>定义块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和后续块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
         <mo>
          &amp;gt;
         </mo>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j &amp;gt; i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span>）之间的连接为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           C
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         C_{ij}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的空间分辨率分别为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           H
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ×
         </mo>
         <msub>
          <mi>
           W
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         H_i \times W_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>（通常 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           H
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           W
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         H_i = W_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>）和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           H
          </mi>
          <mi>
           j
          </mi>
         </msub>
         <mo>
          ×
         </mo>
         <msub>
          <mi>
           W
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         H_j \times W_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathit">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 限制连接仅在空间分辨率相差不超过两倍的块之间。因此，当 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
         <mo>
          −
         </mo>
         <mi>
          i
         </mi>
         <mo>
          ≤
         </mo>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j - i \leq m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05724em;" class="mord mathit">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.79549em; vertical-align: -0.13597em;"></span><span class="mord mathit">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span> 且 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           H
          </mi>
          <mi>
           j
          </mi>
         </msub>
         <mi mathvariant="normal">
          /
         </mi>
         <msub>
          <mi>
           H
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ≤
         </mo>
         <mn>
          2
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         H_j / H_i \leq 2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span> 时，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           C
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         C_{ij}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathit">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 存在。搜索空间基于密集连接的块构建。 但是，只选择一条路径来导出最终的结构。<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 不仅搜索每个块中的层数，而且还搜索块宽度和块数。同时确定执行空间下采样的层。目标是在搜索空间中找到一条良好的路径，代表架构的最佳深度和宽度配置。</p> 
  <p>设 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         b_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 为第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的输出张量。每个块连接到后续 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span> 块。为了将块连接松弛为连续表示，<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 为块的每个输出路径分配块级架构参数。也就是说，对于从块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的路径，它们之间的路径有一个参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           β
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta_{ij}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。与计算每个操作的权重类似，使用 <strong>softmax</strong> 函数计算两个块之间所有路径的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            p
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              β
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <munderover>
             <mo>
              ∑
             </mo>
             <mrow>
              <mi>
               k
              </mi>
              <mo>
               =
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mi>
              m
             </mi>
            </munderover>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              β
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mi>
               k
              </mi>
             </mrow>
            </msub>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           p_{ij} = \frac{\exp(\beta_{ij})}{\sum_{k=1}^m \exp(\beta_{ik})}. 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.421em; vertical-align: -0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.30571em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.05278em;" class="mord mathit">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathit mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.994002em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></span></p> 
  <p>假设块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 需要来自先前块的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           m
          </mi>
          <mo mathvariant="normal">
           ′
          </mo>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         m&amp;#x27;
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> 输入张量，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            −
           </mo>
           <msup>
            <mi>
             m
            </mi>
            <mo mathvariant="normal">
             ′
            </mo>
           </msup>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_{i-m&amp;#x27;}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            −
           </mo>
           <msup>
            <mi>
             m
            </mi>
            <mo mathvariant="normal">
             ′
            </mo>
           </msup>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_{i-m&amp;#x27;+1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            −
           </mo>
           <msup>
            <mi>
             m
            </mi>
            <mo mathvariant="normal">
             ′
            </mo>
           </msup>
           <mo>
            +
           </mo>
           <mn>
            2
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_{i-m&amp;#x27;+2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> … <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            −
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_{i-1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。来自这些块的输入张量在通道数和空间分辨率上有所不同。因此，每个输入张量由 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 中的头部层变换为统一大小，然后求和。设 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           H
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            k
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         H_{ik}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示块 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 中第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathit">k</span></span></span></span></span> 个头部层对输入张量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            −
           </mo>
           <mi>
            k
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_{i-k}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathit">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的转换，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1..
         </mn>
         <msup>
          <mi>
           m
          </mi>
          <mo mathvariant="normal">
           ′
          </mo>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         k=1..m&amp;#x27;
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathit">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>。转换后的输入张量之和可通过以下公式计算：</p> 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             k
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <msup>
            <mi>
             m
            </mi>
            <mo mathvariant="normal">
             ′
            </mo>
           </msup>
          </munderover>
          <msub>
           <mi>
            p
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             −
            </mo>
            <mi>
             k
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           ⋅
          </mo>
          <msub>
           <mi>
            H
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             k
            </mi>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             −
            </mo>
            <mi>
             k
            </mi>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
           x_i = \sum_{k=1}^{m&amp;#x27;} p_{i-k, i} \cdot H_{ik}(x_{i-k}). 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.2316em; vertical-align: -1.30211em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.92949em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.827829em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.08125em;" class="mord mathit">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span style="margin-right: 0.03148em;" class="mord mathit mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span></p> 
  <p><strong>值得注意的是，路径概率在块输出维度上标准化，但应用于后续块的输入维度（更具体地说，在头部层上）</strong>。头部层本质上是是候选操作的混合加权和。层级参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathit">α</span></span></span></span></span> 控制要选择的操作，而外部块级参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          β
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05278em;" class="mord mathit">β</span></span></span></span></span> 决定要连接的块。<br> <a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 的训练方式与 <a href="https://openreview.net/pdf?id=S1eYHoC5FX" rel="nofollow" data-token="895814a272426f742922801ee82e8b1b">DARTS</a> 类似，权重和架构的优化过程按 epoch 交替进行。搜索过程完成后，根据结构参数导出体系结构：</p> 
  <ul> 
   <li>在层级别，选择具有最大体系结构权重的候选操作，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           a
          </mi>
          <mi>
           r
          </mi>
          <mi>
           g
          </mi>
          <mi>
           m
          </mi>
          <mi>
           a
          </mi>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             o
            </mi>
            <mo>
             ∈
            </mo>
            <mi mathvariant="script">
             O
            </mi>
           </mrow>
          </msub>
          <msubsup>
           <mi>
            α
           </mi>
           <mi>
            o
           </mi>
           <mi mathvariant="normal">
            ℓ
           </mi>
          </msubsup>
         </mrow>
         <annotation encoding="application/x-tex">
          argmax_{o \in \mathcal{O}} \alpha_o^\ell
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09611em; vertical-align: -0.247em;"></span><span class="mord mathit">a</span><span style="margin-right: 0.02778em;" class="mord mathit">r</span><span style="margin-right: 0.03588em;" class="mord mathit">g</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.17737em;"><span class=""></span></span></span></span></span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；</li> 
   <li>在网络级，使用 Viterbi 算法根据每个块的输出路径概率来选择连接具有最高总转移概率的块的路径。</li> 
  </ul> 
  <p>超网络包括搜索空间中的所有可能路径和操作。 <a href="http://proceedings.mlr.press/v80/bender18a/bender18a.pdf" rel="nofollow" data-token="224651b12ea0036699a119b0e09c951e">one-shot</a> 搜索方法在训练超级网络时会丢掉一些路径。该技术使独立模型的性能预测更准确。为了减少内存消耗并加快搜索过程，<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 采用了 drop-path 训练策略：</p> 
  <ul> 
   <li>当训练操作权重时，<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 在每一层根据结构参数分布 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mo>
           {
          </mo>
          <msubsup>
           <mi>
            α
           </mi>
           <mi>
            o
           </mi>
           <mi mathvariant="normal">
            ℓ
           </mi>
          </msubsup>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           o
          </mi>
          <mo>
           ∈
          </mo>
          <mi mathvariant="script">
           O
          </mi>
          <mo>
           }
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \{\alpha_o^\ell | o \in \mathcal{O}\}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit">o</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="mclose">}</span></span></span></span></span> 从候选操作中采样出一条路径。丢弃路径训练不仅加速了搜索，而且减弱了搜索空间中不同结构的操作权重之间的耦合效应。</li> 
   <li>训练结构参数时，像 <a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a>一样根据结构权重分布在每个层中对两个操作进行采样。为了保持未采样的操作的体系结构权重不变，<a href="https://arxiv.org/abs/1906.09607" rel="nofollow" data-token="ce36d46140744e9858bd9fe81e2497ff">DenseNAS</a> 计算重新平衡偏差以调整采样和新更新的参数。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mrow>
             <mi mathvariant="monospace">
              b
             </mi>
             <mi mathvariant="monospace">
              i
             </mi>
             <mi mathvariant="monospace">
              a
             </mi>
             <mi mathvariant="monospace">
              s
             </mi>
            </mrow>
            <mi>
             s
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <mi>
            ln
           </mi>
           <mo>
            ⁡
           </mo>
           <mfrac>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                o
               </mi>
               <mo>
                ∈
               </mo>
               <msub>
                <mi mathvariant="script">
                 O
                </mi>
                <mi>
                 s
                </mi>
               </msub>
              </mrow>
             </munder>
             <mi>
              exp
             </mi>
             <mo>
              ⁡
             </mo>
             <mo>
              (
             </mo>
             <msubsup>
              <mi>
               α
              </mi>
              <mi>
               o
              </mi>
              <mi mathvariant="normal">
               ℓ
              </mi>
             </msubsup>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                o
               </mi>
               <mo>
                ∈
               </mo>
               <msub>
                <mi mathvariant="script">
                 O
                </mi>
                <mi>
                 s
                </mi>
               </msub>
              </mrow>
             </munder>
             <mi>
              exp
             </mi>
             <mo>
              ⁡
             </mo>
             <mo>
              (
             </mo>
             <msubsup>
              <msup>
               <mi>
                α
               </mi>
               <mo mathvariant="normal">
                ′
               </mo>
              </msup>
              <mi>
               o
              </mi>
              <mi mathvariant="normal">
               ℓ
              </mi>
             </msubsup>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
            \mathtt{bias}_s = \ln \frac{\sum_{o \in \mathcal{O}_s} \exp(\alpha_o^\ell)}{\sum_{o \in \mathcal{O}_s} \exp({\alpha&amp;#x27;}_o^\ell)} 
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76111em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">b</span><span class="mord mathtt">i</span><span class="mord mathtt">a</span><span class="mord mathtt">s</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.84563em; vertical-align: -1.20671em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.63892em;"><span class="" style="top: -2.1931em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39981em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.677892em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9169em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span><span class="" style="top: -3.13079em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.78981em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.02778em;" class="mord mathcal mtight">O</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39981em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.20671em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi mathvariant="script">
            O
           </mi>
           <mi>
            s
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          \mathcal{O}_s
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.02778em;" class="mord mathcal">O</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 指的是采样的一组操作，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi>
            α
           </mi>
           <mi>
            o
           </mi>
           <mi mathvariant="normal">
            ℓ
           </mi>
          </msubsup>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_o^\ell
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09611em; vertical-align: -0.247em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 指的是层 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="normal">
           ℓ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \ell
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">ℓ</span></span></span></span></span> 中最初采样的结构参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <msup>
            <mi>
             α
            </mi>
            <mo mathvariant="normal">
             ′
            </mo>
           </msup>
           <mi>
            o
           </mi>
           <mi mathvariant="normal">
            ℓ
           </mi>
          </msubsup>
         </mrow>
         <annotation encoding="application/x-tex">
          {\alpha&amp;#x27;}_o^\ell
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.2379em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathit">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9909em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">o</span></span></span><span class="" style="top: -3.20479em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是相应更新后的结构参数。训练时 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="monospace">
             b
            </mi>
            <mi mathvariant="monospace">
             i
            </mi>
            <mi mathvariant="monospace">
             a
            </mi>
            <mi mathvariant="monospace">
             s
            </mi>
           </mrow>
           <mi>
            s
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          \mathtt{bias}_s
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76111em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">b</span><span class="mord mathtt">i</span><span class="mord mathtt">a</span><span class="mord mathtt">s</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 不断累加？</li> 
  </ul> 
  <h2><a id="DSONAShttpsarxivorgabs181101567_325"></a><a href="https://arxiv.org/abs/1811.01567" rel="nofollow" data-token="b41a53d2a58b4be83fc1874ca22a27ee">DSO-NAS</a></h2> 
  <p><a href="https://arxiv.org/abs/1811.01567" rel="nofollow" data-token="b41a53d2a58b4be83fc1874ca22a27ee">DSO-NAS</a> 是初创企业图森未来的一篇文章，投 <a href="https://openreview.net/forum?id=ryxjH3R5KQ" rel="nofollow" data-token="49c409d07c723da21cc01290b3a9dea3">ICLR 2019</a> 被拒。文中对比了不同方法的参数量和计算量。评审中附加了更多实验数据，从中可以看出在网络延迟方面不尽人意。<br> <a href="https://arxiv.org/abs/1811.01567" rel="nofollow" data-token="b41a53d2a58b4be83fc1874ca22a27ee">DSO-NAS</a> 与 <a href="https://openreview.net/pdf?id=HylVB3AqYm" rel="nofollow" data-token="07f35ed647bc2ba93be268d892247a58">ProxylessNAS</a> 一样将网络搜索看作是剪枝过程，采用团队前作 <a href="http://openaccess.thecvf.com/content_ECCV_2018/papers/Zehao_Huang_Data-Driven_Sparse_Structure_ECCV_2018_paper.pdf" rel="nofollow" data-token="2214ee324a6b988f6aac1b39d4b00f7f">SSS</a>(Sparse Structure Selection) 进行优化。不同的是 <a href="https://arxiv.org/abs/1811.01567" rel="nofollow" data-token="b41a53d2a58b4be83fc1874ca22a27ee">DSO-NAS</a> 的 block 内部细分为4层，连接较为复杂。</p> 
  <h2><a id="_330"></a>参考资料：</h2> 
  <ul> 
   <li><a href="https://www.zhihu.com/question/323419310" rel="nofollow" data-token="2a614e147b264ebc6a5c3523ff517781">如何评价google Searching for MobileNetV3？</a></li> 
   <li><a href="http://39.104.128.76/overview" rel="nofollow" data-token="20b08c661f34282f947f8a73a6c94716">The Lightweight Face Recognition Challenge</a></li> 
   <li><a href="https://github.com/guan-yuan/awesome-AutoML-and-Lightweight-Models" rel="nofollow" data-token="d61a4d659aef5ef04db64c2baec7f5d4">guan-yuan/awesome-AutoML-and-Lightweight-Models</a></li> 
   <li><a href="https://www.automl.org/automl/literature-on-neural-architecture-search/" rel="nofollow" data-token="a4958e260e6cb116ffeff221af8ccaba">Literature on Neural Architecture Search</a></li> 
   <li><a href="https://github.com/D-X-Y/Awesome-NAS" rel="nofollow" data-token="73ab4fd5a90096f6d3ac8da720f6c2ed">D-X-Y/Awesome-NAS</a></li> 
   <li><a href="https://github.com/google-research/nasbench" rel="nofollow" data-token="69734dc610cebf16717c6007c5c0a670">google-research/nasbench</a></li> 
   <li><a href="https://github.com/microsoft/nni" rel="nofollow" data-token="4ec4aaf53bfd65186edcada6fbeb820b">microsoft/nni</a></li> 
   <li><a href="https://blog.csdn.net/jinzhuojun/article/details/84698471" rel="nofollow" data-token="c72ea410765d2de2ffcf3e58b174b7ba">神经网络架构搜索（Neural Architecture Search）杂谈</a></li> 
   <li><a href="https://xuanyidong.com/others/publication.html" rel="nofollow" data-token="e1891dd65bc430196956cad47cfcbd26">Xuanyi Dong</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/33958314" rel="nofollow" data-token="0458e9b5eafb27b041ccbd47ff997378">ENAS的原理和代码解析</a></li> 
   <li><a href="https://mp.weixin.qq.com/s/Mon3rpiLbBVvEhBjCO_ImQ" rel="nofollow" data-token="01fab027d8a687a605f9bbe0c6d99a6b">业界 | 谷歌提出移动端AutoML模型MnasNet：精度无损速度更快</a></li> 
   <li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODU3OTIyOA==&amp;mid=2650676856&amp;idx=1&amp;sn=40ddfcfb41a61ded552beedf1b09cb06&amp;chksm=bec2230b89b5aa1d11aa0686a8b9cf0a3512f82595ba7ef76218a5ce4f7cf9eda0cc1bf06b45&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;pass_ticket=KvSURAjwF5ayjTr2OTsAr9XNmCfcx6lXcHKmz%2ButOgY%3D#rd" rel="nofollow" data-token="124619367c82a3968ff3082d94ac4761">多图演示高效的神经架构搜索</a></li> 
   <li><a href="https://www.cnblogs.com/initial-h/p/9468974.html" rel="nofollow" data-token="35705f00628514ac648cbf2093250233">Gumbel-Softmax Trick和Gumbel分布</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/61144700" rel="nofollow" data-token="80c47e17e04b536360ba8893c573786a">旷视提出One-Shot模型搜索框架的新变体</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/55030505" rel="nofollow" data-token="f3a0607c39676d0c7d65a49aae775555">另一种可微架构搜索：商汤提出在反传中学习架构参数的SNAS</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/53920376" rel="nofollow" data-token="a82a7995fbdd7a0110854f6fee6f4a4a">ICLR 2019｜随机神经网络结构搜索 (SNAS)</a></li> 
   <li><a href="https://www.cnblogs.com/marsggbo/p/9347678.html" rel="nofollow" data-token="30c07bec9805802851cd5ddc13ff21c4">论文笔记系列-Neural Architecture Search With Reinforcement Learning</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/35339663" rel="nofollow" data-token="2e292f81c5028b49c22a653adfc191c1">ENAS: 更有效地设计神经网络模型(AutoML)</a></li> 
   <li><a href="https://mp.weixin.qq.com/s?__biz=MzI5NTIxNTg0OA==&amp;mid=2247494069&amp;idx=1&amp;sn=3ddfd19488e1017629410a3a72a2c89c&amp;chksm=ec545e32db23d724c3a9ae84cbd1bdda427a2a41f4429c6c162da5b9caee23e9a4ad14b21325&amp;mpshare=1&amp;scene=1&amp;srcid=0610WhUCWNIWzTbAbQ1AdNco&amp;pass_ticket=KvSURAjwF5ayjTr2OTsAr9XNmCfcx6lXcHKmz%2ButOgY%3D#rd" rel="nofollow" data-token="0a3dac6816a6c2435e402d54b826cef3">万字解读商汤科技ICLR2019论文：随机神经网络结构搜索</a></li> 
   <li><a href="https://mp.weixin.qq.com/s/CRR0z1JqBWlQ-sa8Rev1qA" rel="nofollow" data-token="1216612c1d757a290ede2b6fd624daf3">同济和华为诺亚提出：渐进式可微网络结构搜索，显著提升可微式搜索的性能和稳定性，已开源</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/63605721" rel="nofollow" data-token="955180f19c960d19e0e8c54c39a46ba3">论文解读：Single-Path NAS</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/65297911" rel="nofollow" data-token="98c4d3d361c1e48e94fe36ec5f7298bd">【ICLR 19】DARTS可微网络结构搜索</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/37257941" rel="nofollow" data-token="9f201465ea1bd63f0f2647b114d03fad">CVPR 2018 | 商汤科技Oral论文详解：BlockQNN自动网络设计方法</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/62523100" rel="nofollow" data-token="4d8eccf4254207af7cb763107c4dd6f0">AutoML：NAS 之 Randomly Wired Neural Networks</a></li> 
   <li><a href="https://arxiv.org/abs/1905.01392" rel="nofollow" data-token="5343a56582a11f62a469779564a72b5a">A Survey on Neural Architecture Search</a></li> 
   <li><a href="https://en.wikipedia.org/wiki/Neural_architecture_search" rel="nofollow" data-token="2760dd8bb01c3c65267718b56f85c9ba">Neural architecture search</a></li> 
   <li><a href="http://khanrc.github.io/nas-1-intro.html" rel="nofollow" data-token="92e233482828427fc31494aa5a184cdd">AutoML (1) - Introduction</a></li> 
   <li><a href="https://medium.com/@sh.tsang/review-nasnet-neural-architecture-search-network-image-classification-23139ea0425d" rel="nofollow" data-token="5af7782d70237332817a374389c839eb">Review: NASNet — Neural Architecture Search Network (Image Classification)</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/33958314" rel="nofollow" data-token="0458e9b5eafb27b041ccbd47ff997378">ENAS的原理和代码解析</a></li> 
   <li><a href="https://www.cnblogs.com/marsggbo/p/9347678.html" rel="nofollow" data-token="30c07bec9805802851cd5ddc13ff21c4">论文笔记系列-Neural Architecture Search With Reinforcement Learning</a></li> 
   <li><a href="https://www.leiphone.com/news/201907/0SwIwZzjWBlAD91O.html" rel="nofollow" data-token="e8e0292fad0b5076d449a7412d1abe5b">旷视首席科学家孙剑：深度学习变革视觉计算丨CCF-GAIR 2019</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/73578777" rel="nofollow" data-token="24e20c14f93d99dd70401070b5b5e042">DenseNAS：密集连接搜索空间下的高灵活度网络结构搜索 | 大牛讲堂</a></li> 
   <li><a href="https://blog.csdn.net/LagrangeSK/article/details/81239518" rel="nofollow" data-token="ee54b6c6ae0f14520502e3efba765fd9">强化学习系列（六）：时间差分算法（Temporal-Difference Learning)</a></li> 
   <li><a href="https://zhuanlan.zhihu.com/p/73083240" rel="nofollow" data-token="061284f834d77842e542c0b7f1829f46">强化学习 - 时间差分学习(Temporal-Difference Learning)</a></li> 
   <li><a href="https://zhkmxx9302013.github.io/post/3cc694a0.html" rel="nofollow" data-token="c37d7cccf927fd77cac7c26d9316fb73">A3C、PPO、GAE笔记</a></li> 
   <li><a href="https://www.zhihu.com/question/339002300" rel="nofollow" data-token="b8f00d7b24194c199f8b551ad896d65c">One-Shot 神经网络搜索(NAS)的searching阶段到底在做什么？</a></li> 
   <li><a href="http://www.skicyyu.org/Presentation/ICME2019_tutorial_slides/automl%20for%20detection-share.pdf" rel="nofollow" data-token="9122befcaf16775a779bac8896bb6d80">AutoML for Object Detection</a></li> 
   <li><a href="https://www.linkresearcher.com/theses/b50de39e-17e7-4c44-a309-74afc4cc9404" rel="nofollow" data-token="62faab340c976062f9fc4b4666c6593e">解读小米MoGA：超过MobileNetV3的移动端GPU敏感型搜索</a></li> 
   <li><a href="https://www.zhihu.com/question/20136144" rel="nofollow" data-token="dc2d26f180183f02b9ddf29898089d90">如何通俗地讲解 viterbi 算法？</a></li> 
  </ul> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
