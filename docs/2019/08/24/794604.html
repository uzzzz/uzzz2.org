<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>【Simulink】粒子群算法（PSO）整定PID参数（附代码和讲解） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="【Simulink】粒子群算法（PSO）整定PID参数（附代码和讲解）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="double_circle.slx 该文件是PSO整定PID算法的配套simulink文件（仿真直流电机启动），Matlab的版本是2017a。配套博文是【Simulink】粒子群算法整定PID参数（附代码和讲解） 立即下载 目录 0.背景 1.粒子群算法 1.1.算法简介 1.2.算法步骤 1.3.算法举例 2.PID自整定 2.1.基于M文件编写的PID参数自整定 *2.2.复杂系统的PID自整定（基于simulink仿真） 2.2.1.PSO优化PID的过程详解 2.2.2.在PSO优化过程中修改参数价值权重 0.背景 \qquad 调整PID参数时，我们常常需要按照各种方法查各种表，还要根据建立的数学模型和之前的结果做人工调整。这个过程常常是漫长的，而且最终得到的很可能也不是最优的参数。若系统的参数有改动，又要人工再调一次。而3个参数6个方向的调整，如果输入的变量很多，那么调节的可能性组合就更多了，这个工作常常不是非专业人士所能胜任的。 \qquad 现在我给大家介绍一种不需要知道内部原理也可以调整PID参数的方法，而且调整的思路是所需即所得——你需要的参数是什么样子的，这个算法就会往这个方向调整PID参数。如果这个系统是多输入多输出的，我需要让A输出的超调小一些，而B输出的调节时间可以尽量大一些，只需要调整我们的评价函数就可以让算法自动调参以满足客户需求了。那这样的算法使用起来是不是很容易呢？ 1.粒子群算法 1.1.算法简介 \qquad 粒子群算法（PSO）于1995年提出，和遗传算法一样，也是一种群体迭代算法，不同的是，粒子群算法需要整定的参数更少，不存在交叉和变异过程，所以收敛速度更快。 \qquad 由于是群体迭代算法，因此该算法一般做成并行的。如果做成串行的，也是可以运行的，就是会随着种群规模的增大越来越慢。对于Python运用熟练的朋友可以利用Python做成并行的，对于不熟悉并行算法的朋友，直接使用MATLAB就好了，因为MATLAB的矩阵运算已经集成了并行算法。 \qquad 为了让大家理解，我们做一个很形象的比喻。将我们的粒子群比作一群可以互相通讯的鸟，每只鸟不知道食物的具体位置，但是可以根据嗅觉知道离食物的距离和自己在地图中的位置。种群中的任意2只鸟均可以知道对方离食物的距离和对方的具体位置。假设每只鸟的飞行都是有惯性的，而每只鸟都会根据自己距离食物的距离和位置及其他鸟距离食物的距离和位置选择下一次的飞行方向。最终，所有鸟都会在信息交换的基础上，汇聚在食物地点。 \qquad 这只是对粒子群算法的一个形象的比喻，不必过多计较该模型的现实性，闲言少叙，让我们进入 算 法 步 骤 \color{red}算法步骤 算法步骤。 1.2.算法步骤 【step1】确定参数维度 N \color{blue}{N} N、参数范围（即每只鸟的初始位置），确定惯性系数 c 1 , c 2 , w c_1,c_2,w c1​,c2​,w，确定种群规模m，迭代次数n。 每个粒子的初始位置是随机的，设输入向量 x = ( x 1 , x 2 , . . . , x N ) T x=(x_1,x_2,...,x_N)^T x=(x1​,x2​,...,xN​)T必须满足参数范围限制为： { x m i n ( 1 ) &amp;lt; x 1 &amp;lt; x m a x ( 1 ) x m i n ( 2 ) &amp;lt; x 2 &amp;lt; x m a x ( 2 ) . . . x m i n ( N ) &amp;lt; x 1 &amp;lt; x m a x ( N ) \begin{cases}x_{min}^{(1)}&amp;lt;x_1&amp;lt;x_{max}^{(1)} \\x_{min}^{(2)}&amp;lt;x_2&amp;lt;x_{max}^{(2)} \\... \\x_{min}^{(N)}&amp;lt;x_1&amp;lt;x_{max}^{(N)} \end{cases} ⎩⎪⎪⎪⎨⎪⎪⎪⎧​xmin(1)​&lt;x1​&lt;xmax(1)​xmin(2)​&lt;x2​&lt;xmax(2)​...xmin(N)​&lt;x1​&lt;xmax(N)​​ 记 X m i n = ( x m i n ( 1 ) , x m i n ( 2 ) , . . . x m i n ( N ) ) , X m a x = ( x m a x ( 1 ) , x m a x ( 2 ) , . . . x m a x ( N ) ) \color{blue}X_{min}=(x_{min}^{(1)},x_{min}^{(2)},...x_{min}^{(N)}),X_{max}=(x_{max}^{(1)},x_{max}^{(2)},...x_{max}^{(N)}) Xmin​=(xmin(1)​,xmin(2)​,...xmin(N)​),Xmax​=(xmax(1)​,xmax(2)​,...xmax(N)​) 则输入向量 x x x应满足 X m i n &amp;lt; x &amp;lt; X m a x X_{min}&amp;lt;x&amp;lt;X_{max} Xmin​&lt;x&lt;Xmax​ 每个粒子的初速度定为0，即 v 0 = 0 v_0=0 v0​=0，第 j j j个粒子（ 1 ≤ j ≤ m 1≤j≤m 1≤j≤m）的下一次迭代的速度 v ( j ) v^{(j)} v(j)由三部分组成： v ( j ) = w ⋅ v 0 + c 1 ⋅ r a n d ⋅ ( P ( j ) − X ( j ) ) + c 2 ⋅ r a n d ⋅ ( P G − X ( j ) ) v^{(j)}=w\cdot v_0+c_1\cdot rand\cdot (P^{(j)}-X^{(j)})+c_2\cdot rand\cdot(P_G-X^{(j)}) v(j)=w⋅v0​+c1​⋅rand⋅(P(j)−X(j))+c2​⋅rand⋅(PG​−X(j)) 注：rand是(0,1)的随机数， v 0 v_0 v0​代表上一次粒子的速度。 第一部分为自身惯性因子，因为下一次的迭代次数保留了上一次的速度信息； 第二个部分为自身最优因子， P ( j ) \color{blue}{P^{(j)}} P(j)为第 j j j个因子在之前所有迭代次数中自适应度最高的位置，可以理解为历史上自身离食物最近的位置。 第三部分为社会因子， P G \color{blue}{P_G} PG​为种群在之前所有迭代次数中自适应度最高的位置，可以理解为历史上所有粒子离食物最近的位置中的最近的一个。 一般情况下，取 w = 1 , c 1 = c 2 = 2 w=1,c_1=c_2=2 w=1,c1​=c2​=2，当种群规模较大时，可以让 w w w的值随迭代次数减小以增加收敛速度。 【step2】按照step1的速度公式计算下一次的速度，并计算下一次的粒子位置。对于第 j j j个粒子，第 k + 1 k+1 k+1次迭代（第 k + 1 k+1 k+1代）的位置 X k + 1 ( j ) \color{blue}{X_{k+1}^{(j)}} Xk+1(j)​与第 k k k次迭代的位置 X K ( j ) \color{blue}{X_K^{(j)}} XK(j)​与速度 v k ( k + 1 ) \color{blue}{v_k^{(k+1)}} vk(k+1)​关系为： X k + 1 ( j ) = X k ( j ) + v k ( j + 1 ) ⋅ d t X^{(j)}_{k+1}=X^{(j)}_{k}+v_k^{(j+1)}\cdot dt Xk+1(j)​=Xk(j)​+vk(j+1)​⋅dt 其中 d t \color{blue}{dt} dt是仿真间隔，一般情况下可以取1，如果希望仿真得慢一点，搜索平滑一点，可以适当减小 d t \color{blue}{dt} dt。 【step3】计算每个粒子的自适应度 F k + 1 ( j ) \color{blue}{F^{(j)}_{k+1}} Fk+1(j)​，为了计算出step1公式中的 P ( j ) 和 P G \color{blue}{P^{(j)}和P_G} P(j)和PG​。为了方便起见，我们记前k次计算得到了的 P G P_G PG​为 P G ( k ) P_G^{(k)} PG(k)​，则第k+1次迭代中我们将适应度最高的粒子位置记为 P G ( k + 1 ) P_G^{(k+1)} PG(k+1)​，则最终的 P G P_G PG​为： P G = { P G ( k ) ， F ( P G ( k ) ) &amp;gt; F ( P G ( k + 1 ) ) P G ( k + 1 ) ， F ( P G ( k ) ) &amp;lt; F ( P G ( k + 1 ) ) P_G=\begin{cases}P_G^{(k)}，\qquad F(P_G^{(k)})&amp;gt;F(P_G^{(k+1)}) \\[2ex]P_G^{(k+1)}，\quad F(P_G^{(k)})&amp;lt;F(P_G^{(k+1)}) \end{cases} PG​=⎩⎨⎧​PG(k)​，F(PG(k)​)&gt;F(PG(k+1)​)PG(k+1)​，F(PG(k)​)&lt;F(PG(k+1)​)​ 同样，我们记前k次计算得到的第 j j j个粒子的位置为 P k ( j ) P^{(j)}_{k} Pk(j)​，第k+1次计算得到的第 j j j个粒子的位置为 P k + 1 ( j ) P^{(j)}_{k+1} Pk+1(j)​，则最终的 P ( j ) P^{(j)} P(j)为： P ( j ) = { P k ( j ) ， F ( P k ( j ) ) &amp;gt; F ( P k + 1 ( j ) ) P k + 1 ( j ) ， F ( P k ( j ) ) &amp;lt; F ( P k + 1 ( j ) P^{(j)}=\begin{cases}P_{k}^{(j)}，\quad F(P_{k}^{(j)})&amp;gt;F(P_{k+1}^{(j)}) \\[2ex]P_{k+1}^{(j)}，\quad F(P_{k}^{(j)})&amp;lt;F(P_{k+1}^{(j}) \end{cases} P(j)=⎩⎨⎧​Pk(j)​，F(Pk(j)​)&gt;F(Pk+1(j)​)Pk+1(j)​，F(Pk(j)​)&lt;F(Pk+1(j​)​ 【step4】更新每个粒子的信息。 由于我们在step2的位置迭代中已经更新过粒子的位置信息，在step1中的速度迭代中已经更新过粒子的速度信息，而在step3中又更新了每个粒子的历史最优位置 P ( j ) P^{(j)} P(j)及种群最优位置 P G P_G PG​，因此实际上如果仅需要知道最优解的情况下我们不需要做这一步。 但如果需要作出参数随迭代次数的改变的图的话，每次迭代产生最优解 P G ( k ) P_G^{(k)} PG(k)​及最优适应度 F ( P G ( k ) ) F(P_G^{(k)}) F(PG(k)​)需要用数组保存下来。 1.3.算法举例 \qquad 根据以上的算法步骤，本人编写了一段粒子群算法的MATLAB代码，这个代码很简单，是无约束问题下的全局粒子群算法。全局粒子群算法收敛速度快，占用内存小，但是容易陷入局部最优解，每次迭代的最优解可能存在细微差异，当然如果这个无约束问题本身是单解的话，这个差异会随着种群规模的扩大和迭代次数增加而逐渐消除。 function [Pg,fmin]=PSO(f,dimension,n,m,xmax,xmin,vmax,vmin) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 %位置限幅为[xmin,xmax]，速度限幅为[vmin,vmax] Savef=zeros(n+1,1); SaveData=zeros(m,dimension,10);%记录11代种群的位置 w=1;c1=2;c2=2;%速度惯性系数 dt=0.3;%位移仿真间隔 v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin)*rand(m,dimension)+xmin;%初始位置满足(-xmax,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=f(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); Savef(1)=fmin; N=0; for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=vmin &amp; v&lt;=vmax).*v+(v&lt;vmin).*vmin; X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*xmin; new_f=f(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 Savef(i)=fmin; if mod(i,floor(n/10))==0%每10代记录一次种群参数 N=N+1; SaveData(:,:,N)=X; end % w=w-i/n*0.7*w; end for j=1:10 figure(j) plot(SaveData(:,1,j),SaveData(:,2,j),&#39;o&#39;); xlim([-xmax,xmax]) ylim([-xmax,xmax]) axis tight end figure plot(Savef&#39;,&#39;b-&#39;) disp(Pg) disp(fmin) end 这是一个粒子群算法的函数，可以求函数在一定范围内的极小值，下面我们来定义一个测试函数测试一下： f = ( 1 − x 1 ) 2 + ( x 1 2 − 2 x 2 ) 2 f=(1-x_1)^2+(x_1^2-2x_2)^2 f=(1−x1​)2+(x12​−2x2​)2 我们很容易知道这个函数的极小值为 x ∗ = ( 1 , 0.5 ) T x^*=(1,0.5)^T x∗=(1,0.5)T 我们将X和Y方向上的限制都设定为[-40,40]，种群规模200，仿真代数100次 f=@(x)(1-x(:,1)).^2+(x(:,1).^2-2*x(:,2)).^2; [Pg,fmin]=PSO(f,2,100,200,40,-40,40,-40) 运行结果为： 序号 粒子群位置随迭代次数的变化 1 2 3 4 5 6 \qquad 读者们可以发现粒子群算法在迭代的过程中部分粒子甚至有反向运动的趋势，这是由于粒子的惯性速度过大导致的，在迭代点附近，惯性因子过大，会导致很长时间无法收敛到一个点，同时也很难找到相比上一次迭代更优的解。 \qquad 我们只需要随着迭代次数增加减少我们的惯性因子 w w w即可,在这里作者给出的表达式为 w k + 1 = w k − i / n ∗ 0.7 w k w_{k+1}=w_k-i/n*0.7w_k wk+1​=wk​−i/n∗0.7wk​ i i i为当前迭代代数， n n n为总代数。 调用同样的测试函数，种群规模、迭代次数及其他参数不变，我们得到结果如下： 和上一次对比我们可以发现fmin小了很多，即在相同的计算规模下我们的最优解更加接近于极小值，可谓一个突破性的改变，我们再看看粒子随迭代次数的分布： 序号 粒子群位置随迭代次数的变化 1 2 3 \qquad 可以发现粒子群的分布相比之前稳定得多，几乎全部收敛到了中心点，这便是减小惯性因子的作用。 2.PID自整定 2.1.基于M文件编写的PID参数自整定 \qquad 利用M文件可以制作一个简单的PID引擎，用于测试我们的PSO算法是否有效，书写简单PID引擎的代码可以参考如下链接： 【MATLAB】仿真PID控制 \qquad 我们仅需要在此基础上做一些改变并做成并行算法即可，当然，我们还需要设置一个自适应度函数，在自适应度函数的作用下，PSO算法会选择到我们满意的参数。在调整PID参数时，我们通常会关注响应曲线的超调、上升时间、调节时间、峰值时间等等。利用这些参数组合为评价函数，让评价函数越小，仿真得到的参数越好，以此作为解的好坏的对比依据（相当于鸟离食物的距离）为了简便起见，我们只选取了调节时间 t s t_s ts​和超调量 σ \sigma σ作为我们的比较依据，我们将评价函数设定为： f a c c e s s = l n ( t s 5 ⋅ 1 0 − 2 + 1 ) + l n ( σ 1 0 − 4 + 1 ) f_{access}=ln(\frac{t_s}{5\cdot 10^{-2}}+1)+ln(\frac{\sigma}{10^{-4}}+1) faccess​=ln(5⋅10−2ts​​+1)+ln(10−4σ​+1) 如果对该函数求导就可以发现： ∂ f ∂ t s ∣ t s = 5 ⋅ 1 0 − 2 = 1 2 ⋅ 5 ⋅ 1 0 − 2 \frac{\partial f}{\partial t_s}_{|t_s=5\cdot 10^{-2}}=\frac{1}{2}\cdot 5\cdot 10^{-2} ∂ts​∂f​∣ts​=5⋅10−2​=21​⋅5⋅10−2 ∂ f ∂ σ ∣ σ = 1 0 − 4 = 1 2 ⋅ 1 0 − 4 \frac{\partial f}{\partial \sigma}_{|\sigma=10^{-4}}=\frac{1}{2}\cdot 10^{-4} ∂σ∂f​∣σ=10−4​=21​⋅10−4 \qquad 因此 f a c c e s s f_{access} faccess​在 t s = 5 ⋅ 1 0 − 2 t_s=5\cdot 10^{-2} ts​=5⋅10−2的调整率为 2.5 × 1 0 − 2 2.5×10^{-2} 2.5×10−2，在 σ = 1 0 − 4 \sigma=10^{-4} σ=10−4时的调整率为 0.5 × 1 0 − 4 0.5×10^{-4} 0.5×10−4如果将期望参数定为 t s ∗ = 5 ⋅ 1 0 − 2 , σ ∗ = 1 0 − 4 t_s^*=5\cdot 10^{-2},\sigma ^*=10^{-4} ts∗​=5⋅10−2,σ∗=10−4则评价函数在小于任意一个参数的情况下就会下降，但是下降的速度会越来越大，而大于任意一个参数就会上升，但上升速率会越来越慢。由于两个参数均为正数，因此下降的速率不会大于 ∂ f ∂ t s ∣ t s = 0 = 1 \frac{\partial f}{\partial t_s}_{|t_s=0}=1 ∂ts​∂f​∣ts​=0​=1和 ∂ f ∂ σ ∣ σ = 0 = 1 \frac{\partial f}{\partial \sigma}_{|\sigma=0}=1 ∂σ∂f​∣σ=0​=1，而上升的速率可以无限小。若将评价函数小视为自适应度高，则调整过后的系统参数总是在期望值附近调整，并尽量满足$所有参数都小于期望值的情况。因为在期望值附近上升速率是越来越慢而下降速率是越来越快的，而参数最小只能取到0。因此，有多个参数大于期望值而有少个参数小于期望值的和会比有少个参数大于期望值而多个参数小于期望值的和要大得多。 \qquad 写好评价函数之后，我们可以设自适应度函数 F = − f a c c e s s F=-f_{access} F=−faccess​，因为我们的评价函数是越小越好的，而自适应度是越高越好。 \qquad 根据1.2的算法步骤我们可以编写出粒子群算法，而PID并行仿真引擎的编写需要参考上文提供的连接。（simulink的PID仿真请参考下一小节2.2.）粒子群算法每迭代出一代的参数(PSO.m)，就把这一代里面最好的参数 P G P_G PG​返还给PID引擎进行仿真(PID_sim.m)，再编写一个参数自识别的程序(parameter_cal.m)，将需要识别的指标（调节时间、超调）计算出来，传递给 f a c c e s s f_{access} faccess​进行计算(PID_access.m)，将计算得到的参数 【PID_sim.m】（PID并行仿真引擎） function [f_infty,tp,ts,sigma]=PID_sim(kp,ki,kd,debug) %kp,ki,kd为PID参数,T0为采样时间,total_t为仿真时间 Tt=5e-4;%仿真采样周期 T0=1e-2;%控制采样周期 Tf=1e-3;%微分环节的滤波器系数 alp=Tf/(Tt+Tf); total_t=1; N=floor(total_t/Tt);%样本总数 M=numel(kp);%仿真序列数 kp=reshape(kp,M,1); ki=reshape(ki,M,1); kd=reshape(kd,M,1); sys=tf(0.998,[0.021,1]); %建立被控对象传递函数，即式4.1 dsys=c2d(sys,Tt,&#39;z&#39;); %离散化 [num,den]=tfdata(dsys,&#39;v&#39;); % e_1=zeros(M,1); %前一时刻的偏差 Ee=zeros(M,1); %累积偏差 u_1=zeros(M,1); %前一时刻的控制量 y_1=zeros(M,1); %前一时刻的输出 ud_1=zeros(M,1); %前一时刻的微分输出 %预分配内存 r=1500; y=zeros(M,N); u=zeros(M,N); for k=1:1:N y(:,k)=-1*den(2).*y_1+num(2)*u_1+num(1).*u(:,k);%系统响应输出序列 e0=r-y(:,k); %误差信号 ud=alp.*ud_1+(1-alp)/T0.*kd.*(e0-e_1); u(:,k)=kp.*e0+T0*ki.*Ee+ud; %系统PID控制器输出序列 Ee=Ee+e0; %误差的累加和 u_1=u(:,k); %前一个的控制器输出值 y_1=y(:,k); %前一个的系统响应输出值 e_1=e0; %前一个误差信号的值 ud_1=ud; end if debug %非调试模式下不显示也不打印图像 plot(linspace(0,total_t,N),y) end [f_infty,tp,ts,sigma]=parameter_cal(y,Tt,2e-2,debug);%取得阶跃响应指标 end 【parameter_cal.m】（计算仿真曲线参数） function [f_infty,tp,ts,sigma]=parameter_cal(y,T0,delt_err,debug) %y是系统输出序列 %T0是采样时间，可以结合时间序列点序号算出实际时间 %delt_err是调节时间的误差精度 M=size(y,1);N=size(y,2);%M为运算维度，N为时间序列长度 f_infty=y(:,N);%稳态值序列 err=y-f_infty*ones(1,N);%通过稳态值计算误差序列 ferr=fliplr(abs(err));%倒序并取绝对值 [~,ts_i]=max(ferr&gt;delt_err*f_infty,[],2); ts_i=N*ones(M,1)-ts_i; ts=ts_i*T0;%调节时间 [fp,tp]=max(y,[],2);%峰值和函数峰值 tp=tp*T0; tp(abs(fp-f_infty)&lt;1e-5)=NaN; %过阻尼无超调，没有峰值时间 sigma=(fp-f_infty)./f_infty; if debug &amp;&amp; M==1 %非调试模式下不显示 disp([&#39;系统稳态值为&#39;,num2str(f_infty)]) disp([&#39;系统超调量为&#39;,num2str(sigma*100),&#39;%&#39;]) if isnan(tp) disp(&#39;系统不存在峰值时间&#39;) else disp([&#39;系统峰值时间为&#39;,num2str(tp),&#39;s&#39;]) end disp([&#39;系统的调节时间为&#39;,num2str(ts),&#39;s&#39;]) end end 【PID_access.m】（根据参数得出评价度的函数，程序中为评价度越低越好） function y=PID_access(para) %PID调节性能的指标参数 kp=para(:,1);ki=para(:,2);kd=para(:,3); [~,~,ts,sigma]=PID_sim(kp,ki,kd,false); y=log(ts/5e-2+1)+log(sigma/1e-2+1); end 【PSO.m】（PSO算法优化函数） function [Pg,fmin]=PSO(dimension,n,m) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 w=1;c1=2;c2=2;%速度惯性系数 sigma_data=zeros(1,n); ts_data=zeros(1,n); dt=0.3;%位移仿真间隔 vmax=1;%速度限幅 xmax=[15,50,2];%位置限幅 xmin=[0.2,0,0]; v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin).*rand(m,dimension)+xmin;%初始位置满足(xmin,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=PID_access(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); N=0; for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=-vmax &amp; v&lt;=vmax).*v+(v&lt;-vmax).*(-vmax); X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*(xmin); new_f=PID_access(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 [~,~,ts,sigma]=PID_sim(Pg(1),Pg(2),Pg(3),true) sigma_data(1,i)=sigma; ts_data(1,i)=ts; hold on end legend(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;10&#39;,&#39;11&#39;,&#39;12&#39;,&#39;13&#39;,&#39;14&#39;,&#39;15&#39;) title(&#39;响应曲线随迭代次数的变化&#39;) figure plot(ts_data) title(&#39;调节时间随迭代次数的变化&#39;) figure plot(sigma_data) title(&#39;超调量随迭代次数的变化&#39;) end 【main.m】（主函数，从这里开始） dimension=3;n=20;m=200;%PID为3位参数，n是迭代次数，m为种群规模 [Pg,fmin]=PSO(dimension,n,m) 仿真结果如下： 注：响应曲线可能要在左上角局部放大才能获得该图像。 \qquad 这是一个简单的一阶惯性系统的PID调参仿真，用于模拟直流电机的转速模型，可以看出直流电机的转速响应是越来越快的（调节时间越来越小），超调量在第一次就达到了0，因此系统不存在超调。 *2.2.复杂系统的PID自整定（基于simulink仿真） \qquad 我们以双闭环直流调速系统为例来说明PSO对PID自整定参数的作用。直流调速系统由外环（转速环）和内环（电流环）构成，转速环是一个PI调节器，调节转速为期望转速，用于抵抗负载扰动、电机参数变化带来的扰动；电流环也是一个PI调节器，与转速环不同的是，电流调节器的目的是在于让电流快速跟随给定值，以获得更好的动态特性。我们以电机的启动过程为例仿真这个系统，直流电机启动时，电流首先达到容许最大值，电机以最大加速度进行加速，到达期望转速时让电流迅速减小并达到负载转矩所需电流，电机维持期望转速不变。 2.2.1.PSO优化PID的过程详解 \qquad 下面我们设定我们需要达成的调节指标——由于启动时的电机电流会迅速上升到过载电流（允许的最大值），是一个恒定值，故会有一个电流平台，记上升到电流平台产生的超调为电流超调 σ i \sigma_i σi​，从超调回到电流平台所需的时间为电流的调节时间 t s i t_{si} tsi​，最终转速稳定前的超调记为转速超调 σ n \sigma_n σn​，转速到达稳定值区域的时间为调节时间 t s n t_{sn} tsn​。 【搭建simulink模型】 双闭环调速系统的结构框图如下： 搭建simulink仿真模型如下： 注：上图可能不够清楚，根据以下参数搭建simulink模型，并且命名为double_circle.slx（和PSO的所有程序同名） 电机的参数如下： 额定电压/电流/功率：800V/2164A 1500KW 额定转速：44r/min 过载系数： λ i = 1.5 \lambda_i=1.5 λi​=1.5 励磁：110V/191A 电枢电阻 R a R_a Ra​：0.1 Ω \Omega Ω 主回路电阻R：0.1014 Ω \Omega Ω 电枢（主回路）电感L：3.25mH 变流器放大倍数 K s K_s Ks​=80 变流器通态压降：3V 系统飞轮惯量： 8.6 × 1 0 5 N ⋅ m 2 8.6×10^5N\cdot m^2 8.6×105N⋅m2 \qquad 根据工程设计方法当然可以得到一套电流和转速的PI参数，计算的相关参数为： [ K n p , K n I , K i p , K i I ] E N = [ 7.3660 , 1.5658 , 0.8257 , 30.2773 ] [K_{np},K_{nI},K_{ip},K_{iI}]_{EN}=[7.3660 ,1.5658 ,0.8257, 30.2773] [Knp​,KnI​,Kip​,KiI​]EN​=[7.3660,1.5658,0.8257,30.2773] 通过仿真，我们得到的转速和电流曲线如下： 额定负载启动 空载启动 调用我们的参数计算程序计算一下参数可以得到： σ n = 4.07 × 1 0 − 4 % , t s n = 0.7875 , σ i = 20.38 % , t s i = 0.0172 \sigma_n=4.07×10^{-4}\%,t_{sn}=0.7875,\sigma_i=20.38\%,t_{si}=0.0172 σn​=4.07×10−4%,tsn​=0.7875,σi​=20.38%,tsi​=0.0172 \qquad 这个参数当然是比较理想的参数，如果我们不知道工程设计方法或者说工程设计方法不适用于我们的模型时，那么就可以使用PSO整定PID参数的方法。 【修改simulink模型以适应PSO的M文件调用】 \qquad 这里需要调整的参数为转速调节器ASR的 K n p ， K n I K_{np}，K_{nI} Knp​，KnI​和电流调节器ACR的 K i p , K i I K_{ip},K_{iI} Kip​,KiI​，如果我们希望能实时调整simulink的参数进行动态仿真，我们需要直接将图中的几个比例环节依次设为符号( K n p , K n I , K i p , K i I K_{np},K_{nI},K_{ip},K_{iI} Knp​,KnI​,Kip​,KiI​)，并在工作区实时修改这4个参数再进行仿真。如果我们要将实时调整PI参数的代码写在M文件中仿真，必须要将变量声明为全局（global），此时变量会在工作区里面，simulink就可以调用了。另存为PSO_double_circle.slx 【编写辅助的M文件】 cal_n.m：单组PID参数仿真结果的参数计算 function [n_sigma,ts_n,I_sigma,ts_transient_i]=cal_n(parameters) global Kpn Kin KpI KiI %将simulink所需参数导入工作区，以便仿真使用 obj_slx=&#39;PSO_double_circle&#39;; Kpn=parameters(1); Kin=parameters(2); KpI=parameters(3); KiI=parameters(4); sim(obj_slx);%对目标路径下的slx文件进行仿真 I_data=I.signals.values;n_data=n.signals.values;time=I.time; n_infty=mean(n_data(numel(n_data)-10:numel(n_data))); [i_max,tr_index]=max(I_data); diffI=[0;diff(I_data)];%电流微分 pos=find(abs(diffI)&lt;1);%找到电流波动较小的部分 pos=pos(pos&gt;tr_index);%排除启动时电流不变的情况 min_pos=min(pos); I_transient=mean(I_data(min_pos+10:min_pos+20));%恒流升速阶段的暂稳态电流值 I_sigma=(i_max-I_transient)/I_transient; ts_transient_i=time(min_pos-tr_index);%电流暂稳态的调节时间 n_max=max(n_data); n_sigma=(n_max-n_infty)/n_infty; ts_n_index=numel(n_data)-find(abs(flip(n_data)-n_infty)/n_infty&gt;2e-2,1); ts_n=time(ts_n_index); end PID_n_access.m：PID参数的仿真，以代为单位的 function [y,ts_n,n_sigma,ts_transient_i,I_sigma]=PID_n_access(parameters_list) M=size(parameters_list,1);%计算需要仿真的组数（simulink无法并行仿真） ts_n0=0.8;n_sigma0=1e-2;I_sigma0=0.02;ts_i0=1e-4;%期望值 %将simulink所需参数导入工作区，以便仿真使用 y=zeros(M,1); n_sigma=zeros(M,1);ts_n=zeros(M,1); for sim_i=1:M parameters=parameters_list(sim_i,:); [n_sigma,ts_n,I_sigma,ts_transient_i,n_err]=cal_n(parameters); y(sim_i)=log(ts_n./ts_n0+1)+log(n_sigma./n_sigma0+1)+log(I_sigma/I_sigma0+1)+log(ts_transient_i/ts_i0+1)+exp(n_err*10); end end para_cal.m：参数计算，以代为单位的 obj_slx=&#39;double_circle.slx&#39;; sim(obj_slx); I_data=I.signals.values;n_data=n.signals.values;time=I.time; I_infty=mean(I_data(numel(I_data)-10:numel(I_data))); n_infty=mean(n_data(numel(n_data)-10:numel(n_data))); [i_max,tr_index]=max(I_data); diffI=[0;diff(I_data)];%电流微分 pos=find(abs(diffI)&lt;1);%找到电流波动较小的部分 pos=pos(pos&gt;tr_index);%排除启动时电流不变的情况 min_pos=min(pos); I_transient=mean(I_data(min_pos+10:min_pos+20));%恒流升速阶段的暂稳态电流值 I_sigma=(i_max-I_transient)/I_transient; if I_sigma&lt;1e-4 tr_i=NaN; else tr_i=time(tr_index);%电流的上升时间 end ts_transient_i=time(min_pos-tr_index);%电流暂稳态的调节时间 ts_i_index=numel(I_data)-find(abs(flip(I_data)-I_infty)/I_infty&gt;2e-2,1); ts_i=time(ts_i_index);%转速稳态时电流的调节时间 [n_max,tr_index]=max(n_data); n_sigma=(n_max-n_infty)/n_infty; %参数展示 %转速参数展示 if n_sigma&lt;1e-4 tr_n=NaN; else tr_n=time(tr_index); end ts_n_index=numel(n_data)-find(abs(flip(n_data)-n_infty)/n_infty&gt;2e-2,1); ts_n=time(ts_n_index); if isnan(tr_n) disp(&#39;转速无超调&#39;) else disp([&#39;转速上升时间为&#39;,num2str(tr_n),&#39;s&#39;]) disp([&#39;转速超调量为&#39;,num2str(100*n_sigma),&#39;%&#39;]) end disp([&#39;转速调节时间为&#39;,num2str(ts_n),&#39;s&#39;]) %电流参数展示 if isnan(tr_i) disp(&#39;电流无超调&#39;) else disp([&#39;电流上升时间为&#39;,num2str(tr_i),&#39;s&#39;]) disp([&#39;电流超调量为&#39;,num2str(100*I_sigma),&#39;%&#39;]) disp([&#39;电流暂稳态调节时间为&#39;,num2str(ts_transient_i),&#39;s&#39;]) end disp([&#39;电流的最终调节时间为&#39;,num2str(ts_i),&#39;s&#39;]) draw.m:仅根据一组PID参数画出转速波形图 function draw(parameters) global Kpn Kin KpI KiI Kpn=parameters(1); Kin=parameters(2); KpI=parameters(3); KiI=parameters(4); sim(&#39;PSO_double_circle&#39;) n_data=n.signals.values;time=n.time;%获取转速序列及对应时刻 plot(time,n_data) draw_n_I.m:根据一组PID参数绘制电流和转速曲线 function draw_n_I(parameters) global Kpn KIn Kpi KIi Kpn=parameters(1); KIn=parameters(2); Kpi=parameters(3); KIi=parameters(4); sim(&#39;PSO_double_circle&#39;) n_data=n.signals.values;time=n.time;%获取转速序列及对应时刻 I_data=I.signals.values; figure subplot(211) plot(time,I_data,&#39;r-&#39;,&#39;LineWidth&#39;,1.5) title(&#39;电流波形&#39;) subplot(212) plot(time,n_data,&#39;b-&#39;,&#39;LineWidth&#39;,1.5) title(&#39;转速波形&#39;) end PSO.m：PSO优化程序 function [Pg,fmin]=PSO(n,m,xmax,xmin,cal_f,f) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 dimension=numel(xmax); w=1;c1=2;c2=2;%速度惯性系数 sigma_data=zeros(1,n); ts_data=zeros(1,n); dt=0.3;%位移仿真间隔 vmax=0.1*(xmax-xmin);%速度限幅 v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin).*rand(m,dimension)+xmin;%初始位置满足(xmin,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=f(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); last_Pg=Pg; legend_str=cell(0); legend_i=1; figure(1) legend_str{legend_i}=num2str(1); draw(Pg) for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=-vmax &amp; v&lt;=vmax).*v+(v&lt;-vmax).*(-vmax); X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*(xmin); new_f=f(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 [sigma,ts,~,~]=cal_f(Pg); sigma_data(1,i)=sigma; ts_data(1,i)=ts; if last_Pg~=Pg legend_i=legend_i+1; figure(1) legend_str{legend_i}=num2str(i); draw(Pg) hold on end last_Pg=Pg; disp([&#39;迭代次数：&#39;,num2str(i)]) end figure(1) legend(legend_str) title(&#39;响应曲线随迭代次数的变化&#39;) figure(2) plot(ts_data) title(&#39;调节时间随迭代次数的变化&#39;) figure(3) plot(sigma_data) title(&#39;超调量随迭代次数的变化&#39;) end set_para.m（设置参数程序，从这里开始） best_parameters=[8.4725,97,72,1.794,56.06]; global Kpn KIn Kpi KIi Kpn=0;KIn=0;Kpi=0;KIi=0; n=10;m=100;xmax=[20,120,10,60];xmin=[0,0,0,0];cal_f=@cal_n;f=@PID_n_access; [Pg,fmin]=PSO(n,m,xmax,xmin,cal_f,f); 我们将期望的参数设定为 σ n ∗ = 0 , 1 % , t s n ∗ = 1 , σ i ∗ = 20 % , t s i ∗ = 0.005 \sigma_n^*=0,1\%,t_{sn}^*=1,\sigma_i^*=20\%,t_{si}^*=0.005 σn∗​=0,1%,tsn∗​=1,σi∗​=20%,tsi∗​=0.005利用PSO算法构造的评价函数为 f a c c e s s = l n ( t s n 1 + 1 ) + l n ( σ n 0.001 + 1 ) + l n ( σ i 0.2 + 1 ) + l n ( t s i 0.005 + 1 ) ; f_{access}=ln(\frac{ts_n}{1}+1)+ln(\frac{\sigma_n}{0.001}+1)+ln(\frac{\sigma_i}{0.2}+1)+ln(\frac{ts_i}{0.005}+1); faccess​=ln(1tsn​​+1)+ln(0.001σn​​+1)+ln(0.2σi​​+1)+ln(0.005tsi​​+1); 得到的最佳参数为： [ K n p , K n I , K i p , K i I ] P S O = [ 18.2613 , 73.0965 , 1.6843 , 16.5703 ] P S O [K_{np},K_{nI},K_{ip},K_{iI}]_{PSO}=[18.2613,73.0965 ,1.6843,16.5703]_{PSO} [Knp​,KnI​,Kip​,KiI​]PSO​=[18.2613,73.0965,1.6843,16.5703]PSO​ 下的仿真曲线如下： 超调量和调节时间随迭代次数变化 PSO与工程设计方法电机启动曲线对比（额定负载启动） 工程设计方法 PSO方法 通过计算程序得到的参数为： σ n = 6.7556 × 1 0 − 4 % , t s n = 0.7862 , σ i = 18.83 % , t s i = 0.01341 \sigma_n=6.7556×10^{-4}\%,t_{sn}=0.7862,\sigma_i=18.83\%,t_{si}=0.01341 σn​=6.7556×10−4%,tsn​=0.7862,σi​=18.83%,tsi​=0.01341 工程设计方法的参数为： σ n = 4.07 × 1 0 − 4 % , t s n = 0.7875 , σ i = 20.38 % , t s i = 0.0172 \sigma_n=4.07×10^{-4}\%,t_{sn}=0.7875,\sigma_i=20.38\%,t_{si}=0.0172 σn​=4.07×10−4%,tsn​=0.7875,σi​=20.38%,tsi​=0.0172 \qquad 可以发现除了最后一项指标之外，其余指标均达到了期望值要求，并且和工程设计方法得出的指标相比甚至还略优于它。 2.2.2.在PSO优化过程中修改参数价值权重 \qquad 转速的超调和调节时间，电流的超调和调节时间，我们最后评估的指标除了转速无静差的基本要求外，这4项指标就是我们的评价标准，如果我们更希望牺牲某一个或多个参数去优化另一个或另一些参数时，该怎么调节我们的算法呢？ \qquad 答案也非常简单，调节的方法有2个，一个是期望值，一个是评价函数的各项系数。这里我们用调节期望值的方法做一个示范： \qquad 之前的期望值为： σ n ∗ = 0.1 % , t s n ∗ = 1 , σ i ∗ = 20 % , t s i ∗ = 0.005 \sigma_n^*=0.1\%,t_{sn}^*=1,\sigma_i^*=20\%,t_{si}^*=0.005 σn∗​=0.1%,tsn∗​=1,σi∗​=20%,tsi∗​=0.005 修改期望值为： σ n ∗ = 10 % , t s n ∗ = 0.8 , σ i ∗ = 2 % , t s i ∗ = 0.0001 \sigma_n^*=10\%,t_{sn}^*=0.8,\sigma_i^*=2\%,t_{si}^*=0.0001 σn∗​=10%,tsn∗​=0.8,σi∗​=2%,tsi∗​=0.0001 重新仿真，对比二者的结果如下： PSO1 PSO2 \qquad 可以看出转速超调量略微增大了一些，但是转速和电流的调节时间明显缩短，电流的超调量基本不变。这一点也表明多项优化指标是相互耦合的，可以牺牲一者满足另一者，只要参数在这方面是可调的。 \qquad 需要注意的是，simulink中无法使用串行的算法，因此代码中使用时是串行的，可能仿真比较慢，请大家耐心等待（每迭代一次都会打印一次） \qquad 希望本文对您有帮助，谢谢阅读！" />
<meta property="og:description" content="double_circle.slx 该文件是PSO整定PID算法的配套simulink文件（仿真直流电机启动），Matlab的版本是2017a。配套博文是【Simulink】粒子群算法整定PID参数（附代码和讲解） 立即下载 目录 0.背景 1.粒子群算法 1.1.算法简介 1.2.算法步骤 1.3.算法举例 2.PID自整定 2.1.基于M文件编写的PID参数自整定 *2.2.复杂系统的PID自整定（基于simulink仿真） 2.2.1.PSO优化PID的过程详解 2.2.2.在PSO优化过程中修改参数价值权重 0.背景 \qquad 调整PID参数时，我们常常需要按照各种方法查各种表，还要根据建立的数学模型和之前的结果做人工调整。这个过程常常是漫长的，而且最终得到的很可能也不是最优的参数。若系统的参数有改动，又要人工再调一次。而3个参数6个方向的调整，如果输入的变量很多，那么调节的可能性组合就更多了，这个工作常常不是非专业人士所能胜任的。 \qquad 现在我给大家介绍一种不需要知道内部原理也可以调整PID参数的方法，而且调整的思路是所需即所得——你需要的参数是什么样子的，这个算法就会往这个方向调整PID参数。如果这个系统是多输入多输出的，我需要让A输出的超调小一些，而B输出的调节时间可以尽量大一些，只需要调整我们的评价函数就可以让算法自动调参以满足客户需求了。那这样的算法使用起来是不是很容易呢？ 1.粒子群算法 1.1.算法简介 \qquad 粒子群算法（PSO）于1995年提出，和遗传算法一样，也是一种群体迭代算法，不同的是，粒子群算法需要整定的参数更少，不存在交叉和变异过程，所以收敛速度更快。 \qquad 由于是群体迭代算法，因此该算法一般做成并行的。如果做成串行的，也是可以运行的，就是会随着种群规模的增大越来越慢。对于Python运用熟练的朋友可以利用Python做成并行的，对于不熟悉并行算法的朋友，直接使用MATLAB就好了，因为MATLAB的矩阵运算已经集成了并行算法。 \qquad 为了让大家理解，我们做一个很形象的比喻。将我们的粒子群比作一群可以互相通讯的鸟，每只鸟不知道食物的具体位置，但是可以根据嗅觉知道离食物的距离和自己在地图中的位置。种群中的任意2只鸟均可以知道对方离食物的距离和对方的具体位置。假设每只鸟的飞行都是有惯性的，而每只鸟都会根据自己距离食物的距离和位置及其他鸟距离食物的距离和位置选择下一次的飞行方向。最终，所有鸟都会在信息交换的基础上，汇聚在食物地点。 \qquad 这只是对粒子群算法的一个形象的比喻，不必过多计较该模型的现实性，闲言少叙，让我们进入 算 法 步 骤 \color{red}算法步骤 算法步骤。 1.2.算法步骤 【step1】确定参数维度 N \color{blue}{N} N、参数范围（即每只鸟的初始位置），确定惯性系数 c 1 , c 2 , w c_1,c_2,w c1​,c2​,w，确定种群规模m，迭代次数n。 每个粒子的初始位置是随机的，设输入向量 x = ( x 1 , x 2 , . . . , x N ) T x=(x_1,x_2,...,x_N)^T x=(x1​,x2​,...,xN​)T必须满足参数范围限制为： { x m i n ( 1 ) &amp;lt; x 1 &amp;lt; x m a x ( 1 ) x m i n ( 2 ) &amp;lt; x 2 &amp;lt; x m a x ( 2 ) . . . x m i n ( N ) &amp;lt; x 1 &amp;lt; x m a x ( N ) \begin{cases}x_{min}^{(1)}&amp;lt;x_1&amp;lt;x_{max}^{(1)} \\x_{min}^{(2)}&amp;lt;x_2&amp;lt;x_{max}^{(2)} \\... \\x_{min}^{(N)}&amp;lt;x_1&amp;lt;x_{max}^{(N)} \end{cases} ⎩⎪⎪⎪⎨⎪⎪⎪⎧​xmin(1)​&lt;x1​&lt;xmax(1)​xmin(2)​&lt;x2​&lt;xmax(2)​...xmin(N)​&lt;x1​&lt;xmax(N)​​ 记 X m i n = ( x m i n ( 1 ) , x m i n ( 2 ) , . . . x m i n ( N ) ) , X m a x = ( x m a x ( 1 ) , x m a x ( 2 ) , . . . x m a x ( N ) ) \color{blue}X_{min}=(x_{min}^{(1)},x_{min}^{(2)},...x_{min}^{(N)}),X_{max}=(x_{max}^{(1)},x_{max}^{(2)},...x_{max}^{(N)}) Xmin​=(xmin(1)​,xmin(2)​,...xmin(N)​),Xmax​=(xmax(1)​,xmax(2)​,...xmax(N)​) 则输入向量 x x x应满足 X m i n &amp;lt; x &amp;lt; X m a x X_{min}&amp;lt;x&amp;lt;X_{max} Xmin​&lt;x&lt;Xmax​ 每个粒子的初速度定为0，即 v 0 = 0 v_0=0 v0​=0，第 j j j个粒子（ 1 ≤ j ≤ m 1≤j≤m 1≤j≤m）的下一次迭代的速度 v ( j ) v^{(j)} v(j)由三部分组成： v ( j ) = w ⋅ v 0 + c 1 ⋅ r a n d ⋅ ( P ( j ) − X ( j ) ) + c 2 ⋅ r a n d ⋅ ( P G − X ( j ) ) v^{(j)}=w\cdot v_0+c_1\cdot rand\cdot (P^{(j)}-X^{(j)})+c_2\cdot rand\cdot(P_G-X^{(j)}) v(j)=w⋅v0​+c1​⋅rand⋅(P(j)−X(j))+c2​⋅rand⋅(PG​−X(j)) 注：rand是(0,1)的随机数， v 0 v_0 v0​代表上一次粒子的速度。 第一部分为自身惯性因子，因为下一次的迭代次数保留了上一次的速度信息； 第二个部分为自身最优因子， P ( j ) \color{blue}{P^{(j)}} P(j)为第 j j j个因子在之前所有迭代次数中自适应度最高的位置，可以理解为历史上自身离食物最近的位置。 第三部分为社会因子， P G \color{blue}{P_G} PG​为种群在之前所有迭代次数中自适应度最高的位置，可以理解为历史上所有粒子离食物最近的位置中的最近的一个。 一般情况下，取 w = 1 , c 1 = c 2 = 2 w=1,c_1=c_2=2 w=1,c1​=c2​=2，当种群规模较大时，可以让 w w w的值随迭代次数减小以增加收敛速度。 【step2】按照step1的速度公式计算下一次的速度，并计算下一次的粒子位置。对于第 j j j个粒子，第 k + 1 k+1 k+1次迭代（第 k + 1 k+1 k+1代）的位置 X k + 1 ( j ) \color{blue}{X_{k+1}^{(j)}} Xk+1(j)​与第 k k k次迭代的位置 X K ( j ) \color{blue}{X_K^{(j)}} XK(j)​与速度 v k ( k + 1 ) \color{blue}{v_k^{(k+1)}} vk(k+1)​关系为： X k + 1 ( j ) = X k ( j ) + v k ( j + 1 ) ⋅ d t X^{(j)}_{k+1}=X^{(j)}_{k}+v_k^{(j+1)}\cdot dt Xk+1(j)​=Xk(j)​+vk(j+1)​⋅dt 其中 d t \color{blue}{dt} dt是仿真间隔，一般情况下可以取1，如果希望仿真得慢一点，搜索平滑一点，可以适当减小 d t \color{blue}{dt} dt。 【step3】计算每个粒子的自适应度 F k + 1 ( j ) \color{blue}{F^{(j)}_{k+1}} Fk+1(j)​，为了计算出step1公式中的 P ( j ) 和 P G \color{blue}{P^{(j)}和P_G} P(j)和PG​。为了方便起见，我们记前k次计算得到了的 P G P_G PG​为 P G ( k ) P_G^{(k)} PG(k)​，则第k+1次迭代中我们将适应度最高的粒子位置记为 P G ( k + 1 ) P_G^{(k+1)} PG(k+1)​，则最终的 P G P_G PG​为： P G = { P G ( k ) ， F ( P G ( k ) ) &amp;gt; F ( P G ( k + 1 ) ) P G ( k + 1 ) ， F ( P G ( k ) ) &amp;lt; F ( P G ( k + 1 ) ) P_G=\begin{cases}P_G^{(k)}，\qquad F(P_G^{(k)})&amp;gt;F(P_G^{(k+1)}) \\[2ex]P_G^{(k+1)}，\quad F(P_G^{(k)})&amp;lt;F(P_G^{(k+1)}) \end{cases} PG​=⎩⎨⎧​PG(k)​，F(PG(k)​)&gt;F(PG(k+1)​)PG(k+1)​，F(PG(k)​)&lt;F(PG(k+1)​)​ 同样，我们记前k次计算得到的第 j j j个粒子的位置为 P k ( j ) P^{(j)}_{k} Pk(j)​，第k+1次计算得到的第 j j j个粒子的位置为 P k + 1 ( j ) P^{(j)}_{k+1} Pk+1(j)​，则最终的 P ( j ) P^{(j)} P(j)为： P ( j ) = { P k ( j ) ， F ( P k ( j ) ) &amp;gt; F ( P k + 1 ( j ) ) P k + 1 ( j ) ， F ( P k ( j ) ) &amp;lt; F ( P k + 1 ( j ) P^{(j)}=\begin{cases}P_{k}^{(j)}，\quad F(P_{k}^{(j)})&amp;gt;F(P_{k+1}^{(j)}) \\[2ex]P_{k+1}^{(j)}，\quad F(P_{k}^{(j)})&amp;lt;F(P_{k+1}^{(j}) \end{cases} P(j)=⎩⎨⎧​Pk(j)​，F(Pk(j)​)&gt;F(Pk+1(j)​)Pk+1(j)​，F(Pk(j)​)&lt;F(Pk+1(j​)​ 【step4】更新每个粒子的信息。 由于我们在step2的位置迭代中已经更新过粒子的位置信息，在step1中的速度迭代中已经更新过粒子的速度信息，而在step3中又更新了每个粒子的历史最优位置 P ( j ) P^{(j)} P(j)及种群最优位置 P G P_G PG​，因此实际上如果仅需要知道最优解的情况下我们不需要做这一步。 但如果需要作出参数随迭代次数的改变的图的话，每次迭代产生最优解 P G ( k ) P_G^{(k)} PG(k)​及最优适应度 F ( P G ( k ) ) F(P_G^{(k)}) F(PG(k)​)需要用数组保存下来。 1.3.算法举例 \qquad 根据以上的算法步骤，本人编写了一段粒子群算法的MATLAB代码，这个代码很简单，是无约束问题下的全局粒子群算法。全局粒子群算法收敛速度快，占用内存小，但是容易陷入局部最优解，每次迭代的最优解可能存在细微差异，当然如果这个无约束问题本身是单解的话，这个差异会随着种群规模的扩大和迭代次数增加而逐渐消除。 function [Pg,fmin]=PSO(f,dimension,n,m,xmax,xmin,vmax,vmin) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 %位置限幅为[xmin,xmax]，速度限幅为[vmin,vmax] Savef=zeros(n+1,1); SaveData=zeros(m,dimension,10);%记录11代种群的位置 w=1;c1=2;c2=2;%速度惯性系数 dt=0.3;%位移仿真间隔 v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin)*rand(m,dimension)+xmin;%初始位置满足(-xmax,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=f(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); Savef(1)=fmin; N=0; for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=vmin &amp; v&lt;=vmax).*v+(v&lt;vmin).*vmin; X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*xmin; new_f=f(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 Savef(i)=fmin; if mod(i,floor(n/10))==0%每10代记录一次种群参数 N=N+1; SaveData(:,:,N)=X; end % w=w-i/n*0.7*w; end for j=1:10 figure(j) plot(SaveData(:,1,j),SaveData(:,2,j),&#39;o&#39;); xlim([-xmax,xmax]) ylim([-xmax,xmax]) axis tight end figure plot(Savef&#39;,&#39;b-&#39;) disp(Pg) disp(fmin) end 这是一个粒子群算法的函数，可以求函数在一定范围内的极小值，下面我们来定义一个测试函数测试一下： f = ( 1 − x 1 ) 2 + ( x 1 2 − 2 x 2 ) 2 f=(1-x_1)^2+(x_1^2-2x_2)^2 f=(1−x1​)2+(x12​−2x2​)2 我们很容易知道这个函数的极小值为 x ∗ = ( 1 , 0.5 ) T x^*=(1,0.5)^T x∗=(1,0.5)T 我们将X和Y方向上的限制都设定为[-40,40]，种群规模200，仿真代数100次 f=@(x)(1-x(:,1)).^2+(x(:,1).^2-2*x(:,2)).^2; [Pg,fmin]=PSO(f,2,100,200,40,-40,40,-40) 运行结果为： 序号 粒子群位置随迭代次数的变化 1 2 3 4 5 6 \qquad 读者们可以发现粒子群算法在迭代的过程中部分粒子甚至有反向运动的趋势，这是由于粒子的惯性速度过大导致的，在迭代点附近，惯性因子过大，会导致很长时间无法收敛到一个点，同时也很难找到相比上一次迭代更优的解。 \qquad 我们只需要随着迭代次数增加减少我们的惯性因子 w w w即可,在这里作者给出的表达式为 w k + 1 = w k − i / n ∗ 0.7 w k w_{k+1}=w_k-i/n*0.7w_k wk+1​=wk​−i/n∗0.7wk​ i i i为当前迭代代数， n n n为总代数。 调用同样的测试函数，种群规模、迭代次数及其他参数不变，我们得到结果如下： 和上一次对比我们可以发现fmin小了很多，即在相同的计算规模下我们的最优解更加接近于极小值，可谓一个突破性的改变，我们再看看粒子随迭代次数的分布： 序号 粒子群位置随迭代次数的变化 1 2 3 \qquad 可以发现粒子群的分布相比之前稳定得多，几乎全部收敛到了中心点，这便是减小惯性因子的作用。 2.PID自整定 2.1.基于M文件编写的PID参数自整定 \qquad 利用M文件可以制作一个简单的PID引擎，用于测试我们的PSO算法是否有效，书写简单PID引擎的代码可以参考如下链接： 【MATLAB】仿真PID控制 \qquad 我们仅需要在此基础上做一些改变并做成并行算法即可，当然，我们还需要设置一个自适应度函数，在自适应度函数的作用下，PSO算法会选择到我们满意的参数。在调整PID参数时，我们通常会关注响应曲线的超调、上升时间、调节时间、峰值时间等等。利用这些参数组合为评价函数，让评价函数越小，仿真得到的参数越好，以此作为解的好坏的对比依据（相当于鸟离食物的距离）为了简便起见，我们只选取了调节时间 t s t_s ts​和超调量 σ \sigma σ作为我们的比较依据，我们将评价函数设定为： f a c c e s s = l n ( t s 5 ⋅ 1 0 − 2 + 1 ) + l n ( σ 1 0 − 4 + 1 ) f_{access}=ln(\frac{t_s}{5\cdot 10^{-2}}+1)+ln(\frac{\sigma}{10^{-4}}+1) faccess​=ln(5⋅10−2ts​​+1)+ln(10−4σ​+1) 如果对该函数求导就可以发现： ∂ f ∂ t s ∣ t s = 5 ⋅ 1 0 − 2 = 1 2 ⋅ 5 ⋅ 1 0 − 2 \frac{\partial f}{\partial t_s}_{|t_s=5\cdot 10^{-2}}=\frac{1}{2}\cdot 5\cdot 10^{-2} ∂ts​∂f​∣ts​=5⋅10−2​=21​⋅5⋅10−2 ∂ f ∂ σ ∣ σ = 1 0 − 4 = 1 2 ⋅ 1 0 − 4 \frac{\partial f}{\partial \sigma}_{|\sigma=10^{-4}}=\frac{1}{2}\cdot 10^{-4} ∂σ∂f​∣σ=10−4​=21​⋅10−4 \qquad 因此 f a c c e s s f_{access} faccess​在 t s = 5 ⋅ 1 0 − 2 t_s=5\cdot 10^{-2} ts​=5⋅10−2的调整率为 2.5 × 1 0 − 2 2.5×10^{-2} 2.5×10−2，在 σ = 1 0 − 4 \sigma=10^{-4} σ=10−4时的调整率为 0.5 × 1 0 − 4 0.5×10^{-4} 0.5×10−4如果将期望参数定为 t s ∗ = 5 ⋅ 1 0 − 2 , σ ∗ = 1 0 − 4 t_s^*=5\cdot 10^{-2},\sigma ^*=10^{-4} ts∗​=5⋅10−2,σ∗=10−4则评价函数在小于任意一个参数的情况下就会下降，但是下降的速度会越来越大，而大于任意一个参数就会上升，但上升速率会越来越慢。由于两个参数均为正数，因此下降的速率不会大于 ∂ f ∂ t s ∣ t s = 0 = 1 \frac{\partial f}{\partial t_s}_{|t_s=0}=1 ∂ts​∂f​∣ts​=0​=1和 ∂ f ∂ σ ∣ σ = 0 = 1 \frac{\partial f}{\partial \sigma}_{|\sigma=0}=1 ∂σ∂f​∣σ=0​=1，而上升的速率可以无限小。若将评价函数小视为自适应度高，则调整过后的系统参数总是在期望值附近调整，并尽量满足$所有参数都小于期望值的情况。因为在期望值附近上升速率是越来越慢而下降速率是越来越快的，而参数最小只能取到0。因此，有多个参数大于期望值而有少个参数小于期望值的和会比有少个参数大于期望值而多个参数小于期望值的和要大得多。 \qquad 写好评价函数之后，我们可以设自适应度函数 F = − f a c c e s s F=-f_{access} F=−faccess​，因为我们的评价函数是越小越好的，而自适应度是越高越好。 \qquad 根据1.2的算法步骤我们可以编写出粒子群算法，而PID并行仿真引擎的编写需要参考上文提供的连接。（simulink的PID仿真请参考下一小节2.2.）粒子群算法每迭代出一代的参数(PSO.m)，就把这一代里面最好的参数 P G P_G PG​返还给PID引擎进行仿真(PID_sim.m)，再编写一个参数自识别的程序(parameter_cal.m)，将需要识别的指标（调节时间、超调）计算出来，传递给 f a c c e s s f_{access} faccess​进行计算(PID_access.m)，将计算得到的参数 【PID_sim.m】（PID并行仿真引擎） function [f_infty,tp,ts,sigma]=PID_sim(kp,ki,kd,debug) %kp,ki,kd为PID参数,T0为采样时间,total_t为仿真时间 Tt=5e-4;%仿真采样周期 T0=1e-2;%控制采样周期 Tf=1e-3;%微分环节的滤波器系数 alp=Tf/(Tt+Tf); total_t=1; N=floor(total_t/Tt);%样本总数 M=numel(kp);%仿真序列数 kp=reshape(kp,M,1); ki=reshape(ki,M,1); kd=reshape(kd,M,1); sys=tf(0.998,[0.021,1]); %建立被控对象传递函数，即式4.1 dsys=c2d(sys,Tt,&#39;z&#39;); %离散化 [num,den]=tfdata(dsys,&#39;v&#39;); % e_1=zeros(M,1); %前一时刻的偏差 Ee=zeros(M,1); %累积偏差 u_1=zeros(M,1); %前一时刻的控制量 y_1=zeros(M,1); %前一时刻的输出 ud_1=zeros(M,1); %前一时刻的微分输出 %预分配内存 r=1500; y=zeros(M,N); u=zeros(M,N); for k=1:1:N y(:,k)=-1*den(2).*y_1+num(2)*u_1+num(1).*u(:,k);%系统响应输出序列 e0=r-y(:,k); %误差信号 ud=alp.*ud_1+(1-alp)/T0.*kd.*(e0-e_1); u(:,k)=kp.*e0+T0*ki.*Ee+ud; %系统PID控制器输出序列 Ee=Ee+e0; %误差的累加和 u_1=u(:,k); %前一个的控制器输出值 y_1=y(:,k); %前一个的系统响应输出值 e_1=e0; %前一个误差信号的值 ud_1=ud; end if debug %非调试模式下不显示也不打印图像 plot(linspace(0,total_t,N),y) end [f_infty,tp,ts,sigma]=parameter_cal(y,Tt,2e-2,debug);%取得阶跃响应指标 end 【parameter_cal.m】（计算仿真曲线参数） function [f_infty,tp,ts,sigma]=parameter_cal(y,T0,delt_err,debug) %y是系统输出序列 %T0是采样时间，可以结合时间序列点序号算出实际时间 %delt_err是调节时间的误差精度 M=size(y,1);N=size(y,2);%M为运算维度，N为时间序列长度 f_infty=y(:,N);%稳态值序列 err=y-f_infty*ones(1,N);%通过稳态值计算误差序列 ferr=fliplr(abs(err));%倒序并取绝对值 [~,ts_i]=max(ferr&gt;delt_err*f_infty,[],2); ts_i=N*ones(M,1)-ts_i; ts=ts_i*T0;%调节时间 [fp,tp]=max(y,[],2);%峰值和函数峰值 tp=tp*T0; tp(abs(fp-f_infty)&lt;1e-5)=NaN; %过阻尼无超调，没有峰值时间 sigma=(fp-f_infty)./f_infty; if debug &amp;&amp; M==1 %非调试模式下不显示 disp([&#39;系统稳态值为&#39;,num2str(f_infty)]) disp([&#39;系统超调量为&#39;,num2str(sigma*100),&#39;%&#39;]) if isnan(tp) disp(&#39;系统不存在峰值时间&#39;) else disp([&#39;系统峰值时间为&#39;,num2str(tp),&#39;s&#39;]) end disp([&#39;系统的调节时间为&#39;,num2str(ts),&#39;s&#39;]) end end 【PID_access.m】（根据参数得出评价度的函数，程序中为评价度越低越好） function y=PID_access(para) %PID调节性能的指标参数 kp=para(:,1);ki=para(:,2);kd=para(:,3); [~,~,ts,sigma]=PID_sim(kp,ki,kd,false); y=log(ts/5e-2+1)+log(sigma/1e-2+1); end 【PSO.m】（PSO算法优化函数） function [Pg,fmin]=PSO(dimension,n,m) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 w=1;c1=2;c2=2;%速度惯性系数 sigma_data=zeros(1,n); ts_data=zeros(1,n); dt=0.3;%位移仿真间隔 vmax=1;%速度限幅 xmax=[15,50,2];%位置限幅 xmin=[0.2,0,0]; v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin).*rand(m,dimension)+xmin;%初始位置满足(xmin,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=PID_access(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); N=0; for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=-vmax &amp; v&lt;=vmax).*v+(v&lt;-vmax).*(-vmax); X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*(xmin); new_f=PID_access(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 [~,~,ts,sigma]=PID_sim(Pg(1),Pg(2),Pg(3),true) sigma_data(1,i)=sigma; ts_data(1,i)=ts; hold on end legend(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;10&#39;,&#39;11&#39;,&#39;12&#39;,&#39;13&#39;,&#39;14&#39;,&#39;15&#39;) title(&#39;响应曲线随迭代次数的变化&#39;) figure plot(ts_data) title(&#39;调节时间随迭代次数的变化&#39;) figure plot(sigma_data) title(&#39;超调量随迭代次数的变化&#39;) end 【main.m】（主函数，从这里开始） dimension=3;n=20;m=200;%PID为3位参数，n是迭代次数，m为种群规模 [Pg,fmin]=PSO(dimension,n,m) 仿真结果如下： 注：响应曲线可能要在左上角局部放大才能获得该图像。 \qquad 这是一个简单的一阶惯性系统的PID调参仿真，用于模拟直流电机的转速模型，可以看出直流电机的转速响应是越来越快的（调节时间越来越小），超调量在第一次就达到了0，因此系统不存在超调。 *2.2.复杂系统的PID自整定（基于simulink仿真） \qquad 我们以双闭环直流调速系统为例来说明PSO对PID自整定参数的作用。直流调速系统由外环（转速环）和内环（电流环）构成，转速环是一个PI调节器，调节转速为期望转速，用于抵抗负载扰动、电机参数变化带来的扰动；电流环也是一个PI调节器，与转速环不同的是，电流调节器的目的是在于让电流快速跟随给定值，以获得更好的动态特性。我们以电机的启动过程为例仿真这个系统，直流电机启动时，电流首先达到容许最大值，电机以最大加速度进行加速，到达期望转速时让电流迅速减小并达到负载转矩所需电流，电机维持期望转速不变。 2.2.1.PSO优化PID的过程详解 \qquad 下面我们设定我们需要达成的调节指标——由于启动时的电机电流会迅速上升到过载电流（允许的最大值），是一个恒定值，故会有一个电流平台，记上升到电流平台产生的超调为电流超调 σ i \sigma_i σi​，从超调回到电流平台所需的时间为电流的调节时间 t s i t_{si} tsi​，最终转速稳定前的超调记为转速超调 σ n \sigma_n σn​，转速到达稳定值区域的时间为调节时间 t s n t_{sn} tsn​。 【搭建simulink模型】 双闭环调速系统的结构框图如下： 搭建simulink仿真模型如下： 注：上图可能不够清楚，根据以下参数搭建simulink模型，并且命名为double_circle.slx（和PSO的所有程序同名） 电机的参数如下： 额定电压/电流/功率：800V/2164A 1500KW 额定转速：44r/min 过载系数： λ i = 1.5 \lambda_i=1.5 λi​=1.5 励磁：110V/191A 电枢电阻 R a R_a Ra​：0.1 Ω \Omega Ω 主回路电阻R：0.1014 Ω \Omega Ω 电枢（主回路）电感L：3.25mH 变流器放大倍数 K s K_s Ks​=80 变流器通态压降：3V 系统飞轮惯量： 8.6 × 1 0 5 N ⋅ m 2 8.6×10^5N\cdot m^2 8.6×105N⋅m2 \qquad 根据工程设计方法当然可以得到一套电流和转速的PI参数，计算的相关参数为： [ K n p , K n I , K i p , K i I ] E N = [ 7.3660 , 1.5658 , 0.8257 , 30.2773 ] [K_{np},K_{nI},K_{ip},K_{iI}]_{EN}=[7.3660 ,1.5658 ,0.8257, 30.2773] [Knp​,KnI​,Kip​,KiI​]EN​=[7.3660,1.5658,0.8257,30.2773] 通过仿真，我们得到的转速和电流曲线如下： 额定负载启动 空载启动 调用我们的参数计算程序计算一下参数可以得到： σ n = 4.07 × 1 0 − 4 % , t s n = 0.7875 , σ i = 20.38 % , t s i = 0.0172 \sigma_n=4.07×10^{-4}\%,t_{sn}=0.7875,\sigma_i=20.38\%,t_{si}=0.0172 σn​=4.07×10−4%,tsn​=0.7875,σi​=20.38%,tsi​=0.0172 \qquad 这个参数当然是比较理想的参数，如果我们不知道工程设计方法或者说工程设计方法不适用于我们的模型时，那么就可以使用PSO整定PID参数的方法。 【修改simulink模型以适应PSO的M文件调用】 \qquad 这里需要调整的参数为转速调节器ASR的 K n p ， K n I K_{np}，K_{nI} Knp​，KnI​和电流调节器ACR的 K i p , K i I K_{ip},K_{iI} Kip​,KiI​，如果我们希望能实时调整simulink的参数进行动态仿真，我们需要直接将图中的几个比例环节依次设为符号( K n p , K n I , K i p , K i I K_{np},K_{nI},K_{ip},K_{iI} Knp​,KnI​,Kip​,KiI​)，并在工作区实时修改这4个参数再进行仿真。如果我们要将实时调整PI参数的代码写在M文件中仿真，必须要将变量声明为全局（global），此时变量会在工作区里面，simulink就可以调用了。另存为PSO_double_circle.slx 【编写辅助的M文件】 cal_n.m：单组PID参数仿真结果的参数计算 function [n_sigma,ts_n,I_sigma,ts_transient_i]=cal_n(parameters) global Kpn Kin KpI KiI %将simulink所需参数导入工作区，以便仿真使用 obj_slx=&#39;PSO_double_circle&#39;; Kpn=parameters(1); Kin=parameters(2); KpI=parameters(3); KiI=parameters(4); sim(obj_slx);%对目标路径下的slx文件进行仿真 I_data=I.signals.values;n_data=n.signals.values;time=I.time; n_infty=mean(n_data(numel(n_data)-10:numel(n_data))); [i_max,tr_index]=max(I_data); diffI=[0;diff(I_data)];%电流微分 pos=find(abs(diffI)&lt;1);%找到电流波动较小的部分 pos=pos(pos&gt;tr_index);%排除启动时电流不变的情况 min_pos=min(pos); I_transient=mean(I_data(min_pos+10:min_pos+20));%恒流升速阶段的暂稳态电流值 I_sigma=(i_max-I_transient)/I_transient; ts_transient_i=time(min_pos-tr_index);%电流暂稳态的调节时间 n_max=max(n_data); n_sigma=(n_max-n_infty)/n_infty; ts_n_index=numel(n_data)-find(abs(flip(n_data)-n_infty)/n_infty&gt;2e-2,1); ts_n=time(ts_n_index); end PID_n_access.m：PID参数的仿真，以代为单位的 function [y,ts_n,n_sigma,ts_transient_i,I_sigma]=PID_n_access(parameters_list) M=size(parameters_list,1);%计算需要仿真的组数（simulink无法并行仿真） ts_n0=0.8;n_sigma0=1e-2;I_sigma0=0.02;ts_i0=1e-4;%期望值 %将simulink所需参数导入工作区，以便仿真使用 y=zeros(M,1); n_sigma=zeros(M,1);ts_n=zeros(M,1); for sim_i=1:M parameters=parameters_list(sim_i,:); [n_sigma,ts_n,I_sigma,ts_transient_i,n_err]=cal_n(parameters); y(sim_i)=log(ts_n./ts_n0+1)+log(n_sigma./n_sigma0+1)+log(I_sigma/I_sigma0+1)+log(ts_transient_i/ts_i0+1)+exp(n_err*10); end end para_cal.m：参数计算，以代为单位的 obj_slx=&#39;double_circle.slx&#39;; sim(obj_slx); I_data=I.signals.values;n_data=n.signals.values;time=I.time; I_infty=mean(I_data(numel(I_data)-10:numel(I_data))); n_infty=mean(n_data(numel(n_data)-10:numel(n_data))); [i_max,tr_index]=max(I_data); diffI=[0;diff(I_data)];%电流微分 pos=find(abs(diffI)&lt;1);%找到电流波动较小的部分 pos=pos(pos&gt;tr_index);%排除启动时电流不变的情况 min_pos=min(pos); I_transient=mean(I_data(min_pos+10:min_pos+20));%恒流升速阶段的暂稳态电流值 I_sigma=(i_max-I_transient)/I_transient; if I_sigma&lt;1e-4 tr_i=NaN; else tr_i=time(tr_index);%电流的上升时间 end ts_transient_i=time(min_pos-tr_index);%电流暂稳态的调节时间 ts_i_index=numel(I_data)-find(abs(flip(I_data)-I_infty)/I_infty&gt;2e-2,1); ts_i=time(ts_i_index);%转速稳态时电流的调节时间 [n_max,tr_index]=max(n_data); n_sigma=(n_max-n_infty)/n_infty; %参数展示 %转速参数展示 if n_sigma&lt;1e-4 tr_n=NaN; else tr_n=time(tr_index); end ts_n_index=numel(n_data)-find(abs(flip(n_data)-n_infty)/n_infty&gt;2e-2,1); ts_n=time(ts_n_index); if isnan(tr_n) disp(&#39;转速无超调&#39;) else disp([&#39;转速上升时间为&#39;,num2str(tr_n),&#39;s&#39;]) disp([&#39;转速超调量为&#39;,num2str(100*n_sigma),&#39;%&#39;]) end disp([&#39;转速调节时间为&#39;,num2str(ts_n),&#39;s&#39;]) %电流参数展示 if isnan(tr_i) disp(&#39;电流无超调&#39;) else disp([&#39;电流上升时间为&#39;,num2str(tr_i),&#39;s&#39;]) disp([&#39;电流超调量为&#39;,num2str(100*I_sigma),&#39;%&#39;]) disp([&#39;电流暂稳态调节时间为&#39;,num2str(ts_transient_i),&#39;s&#39;]) end disp([&#39;电流的最终调节时间为&#39;,num2str(ts_i),&#39;s&#39;]) draw.m:仅根据一组PID参数画出转速波形图 function draw(parameters) global Kpn Kin KpI KiI Kpn=parameters(1); Kin=parameters(2); KpI=parameters(3); KiI=parameters(4); sim(&#39;PSO_double_circle&#39;) n_data=n.signals.values;time=n.time;%获取转速序列及对应时刻 plot(time,n_data) draw_n_I.m:根据一组PID参数绘制电流和转速曲线 function draw_n_I(parameters) global Kpn KIn Kpi KIi Kpn=parameters(1); KIn=parameters(2); Kpi=parameters(3); KIi=parameters(4); sim(&#39;PSO_double_circle&#39;) n_data=n.signals.values;time=n.time;%获取转速序列及对应时刻 I_data=I.signals.values; figure subplot(211) plot(time,I_data,&#39;r-&#39;,&#39;LineWidth&#39;,1.5) title(&#39;电流波形&#39;) subplot(212) plot(time,n_data,&#39;b-&#39;,&#39;LineWidth&#39;,1.5) title(&#39;转速波形&#39;) end PSO.m：PSO优化程序 function [Pg,fmin]=PSO(n,m,xmax,xmin,cal_f,f) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 dimension=numel(xmax); w=1;c1=2;c2=2;%速度惯性系数 sigma_data=zeros(1,n); ts_data=zeros(1,n); dt=0.3;%位移仿真间隔 vmax=0.1*(xmax-xmin);%速度限幅 v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin).*rand(m,dimension)+xmin;%初始位置满足(xmin,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=f(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); last_Pg=Pg; legend_str=cell(0); legend_i=1; figure(1) legend_str{legend_i}=num2str(1); draw(Pg) for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=-vmax &amp; v&lt;=vmax).*v+(v&lt;-vmax).*(-vmax); X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*(xmin); new_f=f(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 [sigma,ts,~,~]=cal_f(Pg); sigma_data(1,i)=sigma; ts_data(1,i)=ts; if last_Pg~=Pg legend_i=legend_i+1; figure(1) legend_str{legend_i}=num2str(i); draw(Pg) hold on end last_Pg=Pg; disp([&#39;迭代次数：&#39;,num2str(i)]) end figure(1) legend(legend_str) title(&#39;响应曲线随迭代次数的变化&#39;) figure(2) plot(ts_data) title(&#39;调节时间随迭代次数的变化&#39;) figure(3) plot(sigma_data) title(&#39;超调量随迭代次数的变化&#39;) end set_para.m（设置参数程序，从这里开始） best_parameters=[8.4725,97,72,1.794,56.06]; global Kpn KIn Kpi KIi Kpn=0;KIn=0;Kpi=0;KIi=0; n=10;m=100;xmax=[20,120,10,60];xmin=[0,0,0,0];cal_f=@cal_n;f=@PID_n_access; [Pg,fmin]=PSO(n,m,xmax,xmin,cal_f,f); 我们将期望的参数设定为 σ n ∗ = 0 , 1 % , t s n ∗ = 1 , σ i ∗ = 20 % , t s i ∗ = 0.005 \sigma_n^*=0,1\%,t_{sn}^*=1,\sigma_i^*=20\%,t_{si}^*=0.005 σn∗​=0,1%,tsn∗​=1,σi∗​=20%,tsi∗​=0.005利用PSO算法构造的评价函数为 f a c c e s s = l n ( t s n 1 + 1 ) + l n ( σ n 0.001 + 1 ) + l n ( σ i 0.2 + 1 ) + l n ( t s i 0.005 + 1 ) ; f_{access}=ln(\frac{ts_n}{1}+1)+ln(\frac{\sigma_n}{0.001}+1)+ln(\frac{\sigma_i}{0.2}+1)+ln(\frac{ts_i}{0.005}+1); faccess​=ln(1tsn​​+1)+ln(0.001σn​​+1)+ln(0.2σi​​+1)+ln(0.005tsi​​+1); 得到的最佳参数为： [ K n p , K n I , K i p , K i I ] P S O = [ 18.2613 , 73.0965 , 1.6843 , 16.5703 ] P S O [K_{np},K_{nI},K_{ip},K_{iI}]_{PSO}=[18.2613,73.0965 ,1.6843,16.5703]_{PSO} [Knp​,KnI​,Kip​,KiI​]PSO​=[18.2613,73.0965,1.6843,16.5703]PSO​ 下的仿真曲线如下： 超调量和调节时间随迭代次数变化 PSO与工程设计方法电机启动曲线对比（额定负载启动） 工程设计方法 PSO方法 通过计算程序得到的参数为： σ n = 6.7556 × 1 0 − 4 % , t s n = 0.7862 , σ i = 18.83 % , t s i = 0.01341 \sigma_n=6.7556×10^{-4}\%,t_{sn}=0.7862,\sigma_i=18.83\%,t_{si}=0.01341 σn​=6.7556×10−4%,tsn​=0.7862,σi​=18.83%,tsi​=0.01341 工程设计方法的参数为： σ n = 4.07 × 1 0 − 4 % , t s n = 0.7875 , σ i = 20.38 % , t s i = 0.0172 \sigma_n=4.07×10^{-4}\%,t_{sn}=0.7875,\sigma_i=20.38\%,t_{si}=0.0172 σn​=4.07×10−4%,tsn​=0.7875,σi​=20.38%,tsi​=0.0172 \qquad 可以发现除了最后一项指标之外，其余指标均达到了期望值要求，并且和工程设计方法得出的指标相比甚至还略优于它。 2.2.2.在PSO优化过程中修改参数价值权重 \qquad 转速的超调和调节时间，电流的超调和调节时间，我们最后评估的指标除了转速无静差的基本要求外，这4项指标就是我们的评价标准，如果我们更希望牺牲某一个或多个参数去优化另一个或另一些参数时，该怎么调节我们的算法呢？ \qquad 答案也非常简单，调节的方法有2个，一个是期望值，一个是评价函数的各项系数。这里我们用调节期望值的方法做一个示范： \qquad 之前的期望值为： σ n ∗ = 0.1 % , t s n ∗ = 1 , σ i ∗ = 20 % , t s i ∗ = 0.005 \sigma_n^*=0.1\%,t_{sn}^*=1,\sigma_i^*=20\%,t_{si}^*=0.005 σn∗​=0.1%,tsn∗​=1,σi∗​=20%,tsi∗​=0.005 修改期望值为： σ n ∗ = 10 % , t s n ∗ = 0.8 , σ i ∗ = 2 % , t s i ∗ = 0.0001 \sigma_n^*=10\%,t_{sn}^*=0.8,\sigma_i^*=2\%,t_{si}^*=0.0001 σn∗​=10%,tsn∗​=0.8,σi∗​=2%,tsi∗​=0.0001 重新仿真，对比二者的结果如下： PSO1 PSO2 \qquad 可以看出转速超调量略微增大了一些，但是转速和电流的调节时间明显缩短，电流的超调量基本不变。这一点也表明多项优化指标是相互耦合的，可以牺牲一者满足另一者，只要参数在这方面是可调的。 \qquad 需要注意的是，simulink中无法使用串行的算法，因此代码中使用时是串行的，可能仿真比较慢，请大家耐心等待（每迭代一次都会打印一次） \qquad 希望本文对您有帮助，谢谢阅读！" />
<link rel="canonical" href="https://uzzz.org/2019/08/24/794604.html" />
<meta property="og:url" content="https://uzzz.org/2019/08/24/794604.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-24T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"double_circle.slx 该文件是PSO整定PID算法的配套simulink文件（仿真直流电机启动），Matlab的版本是2017a。配套博文是【Simulink】粒子群算法整定PID参数（附代码和讲解） 立即下载 目录 0.背景 1.粒子群算法 1.1.算法简介 1.2.算法步骤 1.3.算法举例 2.PID自整定 2.1.基于M文件编写的PID参数自整定 *2.2.复杂系统的PID自整定（基于simulink仿真） 2.2.1.PSO优化PID的过程详解 2.2.2.在PSO优化过程中修改参数价值权重 0.背景 \\qquad 调整PID参数时，我们常常需要按照各种方法查各种表，还要根据建立的数学模型和之前的结果做人工调整。这个过程常常是漫长的，而且最终得到的很可能也不是最优的参数。若系统的参数有改动，又要人工再调一次。而3个参数6个方向的调整，如果输入的变量很多，那么调节的可能性组合就更多了，这个工作常常不是非专业人士所能胜任的。 \\qquad 现在我给大家介绍一种不需要知道内部原理也可以调整PID参数的方法，而且调整的思路是所需即所得——你需要的参数是什么样子的，这个算法就会往这个方向调整PID参数。如果这个系统是多输入多输出的，我需要让A输出的超调小一些，而B输出的调节时间可以尽量大一些，只需要调整我们的评价函数就可以让算法自动调参以满足客户需求了。那这样的算法使用起来是不是很容易呢？ 1.粒子群算法 1.1.算法简介 \\qquad 粒子群算法（PSO）于1995年提出，和遗传算法一样，也是一种群体迭代算法，不同的是，粒子群算法需要整定的参数更少，不存在交叉和变异过程，所以收敛速度更快。 \\qquad 由于是群体迭代算法，因此该算法一般做成并行的。如果做成串行的，也是可以运行的，就是会随着种群规模的增大越来越慢。对于Python运用熟练的朋友可以利用Python做成并行的，对于不熟悉并行算法的朋友，直接使用MATLAB就好了，因为MATLAB的矩阵运算已经集成了并行算法。 \\qquad 为了让大家理解，我们做一个很形象的比喻。将我们的粒子群比作一群可以互相通讯的鸟，每只鸟不知道食物的具体位置，但是可以根据嗅觉知道离食物的距离和自己在地图中的位置。种群中的任意2只鸟均可以知道对方离食物的距离和对方的具体位置。假设每只鸟的飞行都是有惯性的，而每只鸟都会根据自己距离食物的距离和位置及其他鸟距离食物的距离和位置选择下一次的飞行方向。最终，所有鸟都会在信息交换的基础上，汇聚在食物地点。 \\qquad 这只是对粒子群算法的一个形象的比喻，不必过多计较该模型的现实性，闲言少叙，让我们进入 算 法 步 骤 \\color{red}算法步骤 算法步骤。 1.2.算法步骤 【step1】确定参数维度 N \\color{blue}{N} N、参数范围（即每只鸟的初始位置），确定惯性系数 c 1 , c 2 , w c_1,c_2,w c1​,c2​,w，确定种群规模m，迭代次数n。 每个粒子的初始位置是随机的，设输入向量 x = ( x 1 , x 2 , . . . , x N ) T x=(x_1,x_2,...,x_N)^T x=(x1​,x2​,...,xN​)T必须满足参数范围限制为： { x m i n ( 1 ) &amp;lt; x 1 &amp;lt; x m a x ( 1 ) x m i n ( 2 ) &amp;lt; x 2 &amp;lt; x m a x ( 2 ) . . . x m i n ( N ) &amp;lt; x 1 &amp;lt; x m a x ( N ) \\begin{cases}x_{min}^{(1)}&amp;lt;x_1&amp;lt;x_{max}^{(1)} \\\\x_{min}^{(2)}&amp;lt;x_2&amp;lt;x_{max}^{(2)} \\\\... \\\\x_{min}^{(N)}&amp;lt;x_1&amp;lt;x_{max}^{(N)} \\end{cases} ⎩⎪⎪⎪⎨⎪⎪⎪⎧​xmin(1)​&lt;x1​&lt;xmax(1)​xmin(2)​&lt;x2​&lt;xmax(2)​...xmin(N)​&lt;x1​&lt;xmax(N)​​ 记 X m i n = ( x m i n ( 1 ) , x m i n ( 2 ) , . . . x m i n ( N ) ) , X m a x = ( x m a x ( 1 ) , x m a x ( 2 ) , . . . x m a x ( N ) ) \\color{blue}X_{min}=(x_{min}^{(1)},x_{min}^{(2)},...x_{min}^{(N)}),X_{max}=(x_{max}^{(1)},x_{max}^{(2)},...x_{max}^{(N)}) Xmin​=(xmin(1)​,xmin(2)​,...xmin(N)​),Xmax​=(xmax(1)​,xmax(2)​,...xmax(N)​) 则输入向量 x x x应满足 X m i n &amp;lt; x &amp;lt; X m a x X_{min}&amp;lt;x&amp;lt;X_{max} Xmin​&lt;x&lt;Xmax​ 每个粒子的初速度定为0，即 v 0 = 0 v_0=0 v0​=0，第 j j j个粒子（ 1 ≤ j ≤ m 1≤j≤m 1≤j≤m）的下一次迭代的速度 v ( j ) v^{(j)} v(j)由三部分组成： v ( j ) = w ⋅ v 0 + c 1 ⋅ r a n d ⋅ ( P ( j ) − X ( j ) ) + c 2 ⋅ r a n d ⋅ ( P G − X ( j ) ) v^{(j)}=w\\cdot v_0+c_1\\cdot rand\\cdot (P^{(j)}-X^{(j)})+c_2\\cdot rand\\cdot(P_G-X^{(j)}) v(j)=w⋅v0​+c1​⋅rand⋅(P(j)−X(j))+c2​⋅rand⋅(PG​−X(j)) 注：rand是(0,1)的随机数， v 0 v_0 v0​代表上一次粒子的速度。 第一部分为自身惯性因子，因为下一次的迭代次数保留了上一次的速度信息； 第二个部分为自身最优因子， P ( j ) \\color{blue}{P^{(j)}} P(j)为第 j j j个因子在之前所有迭代次数中自适应度最高的位置，可以理解为历史上自身离食物最近的位置。 第三部分为社会因子， P G \\color{blue}{P_G} PG​为种群在之前所有迭代次数中自适应度最高的位置，可以理解为历史上所有粒子离食物最近的位置中的最近的一个。 一般情况下，取 w = 1 , c 1 = c 2 = 2 w=1,c_1=c_2=2 w=1,c1​=c2​=2，当种群规模较大时，可以让 w w w的值随迭代次数减小以增加收敛速度。 【step2】按照step1的速度公式计算下一次的速度，并计算下一次的粒子位置。对于第 j j j个粒子，第 k + 1 k+1 k+1次迭代（第 k + 1 k+1 k+1代）的位置 X k + 1 ( j ) \\color{blue}{X_{k+1}^{(j)}} Xk+1(j)​与第 k k k次迭代的位置 X K ( j ) \\color{blue}{X_K^{(j)}} XK(j)​与速度 v k ( k + 1 ) \\color{blue}{v_k^{(k+1)}} vk(k+1)​关系为： X k + 1 ( j ) = X k ( j ) + v k ( j + 1 ) ⋅ d t X^{(j)}_{k+1}=X^{(j)}_{k}+v_k^{(j+1)}\\cdot dt Xk+1(j)​=Xk(j)​+vk(j+1)​⋅dt 其中 d t \\color{blue}{dt} dt是仿真间隔，一般情况下可以取1，如果希望仿真得慢一点，搜索平滑一点，可以适当减小 d t \\color{blue}{dt} dt。 【step3】计算每个粒子的自适应度 F k + 1 ( j ) \\color{blue}{F^{(j)}_{k+1}} Fk+1(j)​，为了计算出step1公式中的 P ( j ) 和 P G \\color{blue}{P^{(j)}和P_G} P(j)和PG​。为了方便起见，我们记前k次计算得到了的 P G P_G PG​为 P G ( k ) P_G^{(k)} PG(k)​，则第k+1次迭代中我们将适应度最高的粒子位置记为 P G ( k + 1 ) P_G^{(k+1)} PG(k+1)​，则最终的 P G P_G PG​为： P G = { P G ( k ) ， F ( P G ( k ) ) &amp;gt; F ( P G ( k + 1 ) ) P G ( k + 1 ) ， F ( P G ( k ) ) &amp;lt; F ( P G ( k + 1 ) ) P_G=\\begin{cases}P_G^{(k)}，\\qquad F(P_G^{(k)})&amp;gt;F(P_G^{(k+1)}) \\\\[2ex]P_G^{(k+1)}，\\quad F(P_G^{(k)})&amp;lt;F(P_G^{(k+1)}) \\end{cases} PG​=⎩⎨⎧​PG(k)​，F(PG(k)​)&gt;F(PG(k+1)​)PG(k+1)​，F(PG(k)​)&lt;F(PG(k+1)​)​ 同样，我们记前k次计算得到的第 j j j个粒子的位置为 P k ( j ) P^{(j)}_{k} Pk(j)​，第k+1次计算得到的第 j j j个粒子的位置为 P k + 1 ( j ) P^{(j)}_{k+1} Pk+1(j)​，则最终的 P ( j ) P^{(j)} P(j)为： P ( j ) = { P k ( j ) ， F ( P k ( j ) ) &amp;gt; F ( P k + 1 ( j ) ) P k + 1 ( j ) ， F ( P k ( j ) ) &amp;lt; F ( P k + 1 ( j ) P^{(j)}=\\begin{cases}P_{k}^{(j)}，\\quad F(P_{k}^{(j)})&amp;gt;F(P_{k+1}^{(j)}) \\\\[2ex]P_{k+1}^{(j)}，\\quad F(P_{k}^{(j)})&amp;lt;F(P_{k+1}^{(j}) \\end{cases} P(j)=⎩⎨⎧​Pk(j)​，F(Pk(j)​)&gt;F(Pk+1(j)​)Pk+1(j)​，F(Pk(j)​)&lt;F(Pk+1(j​)​ 【step4】更新每个粒子的信息。 由于我们在step2的位置迭代中已经更新过粒子的位置信息，在step1中的速度迭代中已经更新过粒子的速度信息，而在step3中又更新了每个粒子的历史最优位置 P ( j ) P^{(j)} P(j)及种群最优位置 P G P_G PG​，因此实际上如果仅需要知道最优解的情况下我们不需要做这一步。 但如果需要作出参数随迭代次数的改变的图的话，每次迭代产生最优解 P G ( k ) P_G^{(k)} PG(k)​及最优适应度 F ( P G ( k ) ) F(P_G^{(k)}) F(PG(k)​)需要用数组保存下来。 1.3.算法举例 \\qquad 根据以上的算法步骤，本人编写了一段粒子群算法的MATLAB代码，这个代码很简单，是无约束问题下的全局粒子群算法。全局粒子群算法收敛速度快，占用内存小，但是容易陷入局部最优解，每次迭代的最优解可能存在细微差异，当然如果这个无约束问题本身是单解的话，这个差异会随着种群规模的扩大和迭代次数增加而逐渐消除。 function [Pg,fmin]=PSO(f,dimension,n,m,xmax,xmin,vmax,vmin) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 %位置限幅为[xmin,xmax]，速度限幅为[vmin,vmax] Savef=zeros(n+1,1); SaveData=zeros(m,dimension,10);%记录11代种群的位置 w=1;c1=2;c2=2;%速度惯性系数 dt=0.3;%位移仿真间隔 v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin)*rand(m,dimension)+xmin;%初始位置满足(-xmax,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=f(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); Savef(1)=fmin; N=0; for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=vmin &amp; v&lt;=vmax).*v+(v&lt;vmin).*vmin; X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*xmin; new_f=f(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 Savef(i)=fmin; if mod(i,floor(n/10))==0%每10代记录一次种群参数 N=N+1; SaveData(:,:,N)=X; end % w=w-i/n*0.7*w; end for j=1:10 figure(j) plot(SaveData(:,1,j),SaveData(:,2,j),&#39;o&#39;); xlim([-xmax,xmax]) ylim([-xmax,xmax]) axis tight end figure plot(Savef&#39;,&#39;b-&#39;) disp(Pg) disp(fmin) end 这是一个粒子群算法的函数，可以求函数在一定范围内的极小值，下面我们来定义一个测试函数测试一下： f = ( 1 − x 1 ) 2 + ( x 1 2 − 2 x 2 ) 2 f=(1-x_1)^2+(x_1^2-2x_2)^2 f=(1−x1​)2+(x12​−2x2​)2 我们很容易知道这个函数的极小值为 x ∗ = ( 1 , 0.5 ) T x^*=(1,0.5)^T x∗=(1,0.5)T 我们将X和Y方向上的限制都设定为[-40,40]，种群规模200，仿真代数100次 f=@(x)(1-x(:,1)).^2+(x(:,1).^2-2*x(:,2)).^2; [Pg,fmin]=PSO(f,2,100,200,40,-40,40,-40) 运行结果为： 序号 粒子群位置随迭代次数的变化 1 2 3 4 5 6 \\qquad 读者们可以发现粒子群算法在迭代的过程中部分粒子甚至有反向运动的趋势，这是由于粒子的惯性速度过大导致的，在迭代点附近，惯性因子过大，会导致很长时间无法收敛到一个点，同时也很难找到相比上一次迭代更优的解。 \\qquad 我们只需要随着迭代次数增加减少我们的惯性因子 w w w即可,在这里作者给出的表达式为 w k + 1 = w k − i / n ∗ 0.7 w k w_{k+1}=w_k-i/n*0.7w_k wk+1​=wk​−i/n∗0.7wk​ i i i为当前迭代代数， n n n为总代数。 调用同样的测试函数，种群规模、迭代次数及其他参数不变，我们得到结果如下： 和上一次对比我们可以发现fmin小了很多，即在相同的计算规模下我们的最优解更加接近于极小值，可谓一个突破性的改变，我们再看看粒子随迭代次数的分布： 序号 粒子群位置随迭代次数的变化 1 2 3 \\qquad 可以发现粒子群的分布相比之前稳定得多，几乎全部收敛到了中心点，这便是减小惯性因子的作用。 2.PID自整定 2.1.基于M文件编写的PID参数自整定 \\qquad 利用M文件可以制作一个简单的PID引擎，用于测试我们的PSO算法是否有效，书写简单PID引擎的代码可以参考如下链接： 【MATLAB】仿真PID控制 \\qquad 我们仅需要在此基础上做一些改变并做成并行算法即可，当然，我们还需要设置一个自适应度函数，在自适应度函数的作用下，PSO算法会选择到我们满意的参数。在调整PID参数时，我们通常会关注响应曲线的超调、上升时间、调节时间、峰值时间等等。利用这些参数组合为评价函数，让评价函数越小，仿真得到的参数越好，以此作为解的好坏的对比依据（相当于鸟离食物的距离）为了简便起见，我们只选取了调节时间 t s t_s ts​和超调量 σ \\sigma σ作为我们的比较依据，我们将评价函数设定为： f a c c e s s = l n ( t s 5 ⋅ 1 0 − 2 + 1 ) + l n ( σ 1 0 − 4 + 1 ) f_{access}=ln(\\frac{t_s}{5\\cdot 10^{-2}}+1)+ln(\\frac{\\sigma}{10^{-4}}+1) faccess​=ln(5⋅10−2ts​​+1)+ln(10−4σ​+1) 如果对该函数求导就可以发现： ∂ f ∂ t s ∣ t s = 5 ⋅ 1 0 − 2 = 1 2 ⋅ 5 ⋅ 1 0 − 2 \\frac{\\partial f}{\\partial t_s}_{|t_s=5\\cdot 10^{-2}}=\\frac{1}{2}\\cdot 5\\cdot 10^{-2} ∂ts​∂f​∣ts​=5⋅10−2​=21​⋅5⋅10−2 ∂ f ∂ σ ∣ σ = 1 0 − 4 = 1 2 ⋅ 1 0 − 4 \\frac{\\partial f}{\\partial \\sigma}_{|\\sigma=10^{-4}}=\\frac{1}{2}\\cdot 10^{-4} ∂σ∂f​∣σ=10−4​=21​⋅10−4 \\qquad 因此 f a c c e s s f_{access} faccess​在 t s = 5 ⋅ 1 0 − 2 t_s=5\\cdot 10^{-2} ts​=5⋅10−2的调整率为 2.5 × 1 0 − 2 2.5×10^{-2} 2.5×10−2，在 σ = 1 0 − 4 \\sigma=10^{-4} σ=10−4时的调整率为 0.5 × 1 0 − 4 0.5×10^{-4} 0.5×10−4如果将期望参数定为 t s ∗ = 5 ⋅ 1 0 − 2 , σ ∗ = 1 0 − 4 t_s^*=5\\cdot 10^{-2},\\sigma ^*=10^{-4} ts∗​=5⋅10−2,σ∗=10−4则评价函数在小于任意一个参数的情况下就会下降，但是下降的速度会越来越大，而大于任意一个参数就会上升，但上升速率会越来越慢。由于两个参数均为正数，因此下降的速率不会大于 ∂ f ∂ t s ∣ t s = 0 = 1 \\frac{\\partial f}{\\partial t_s}_{|t_s=0}=1 ∂ts​∂f​∣ts​=0​=1和 ∂ f ∂ σ ∣ σ = 0 = 1 \\frac{\\partial f}{\\partial \\sigma}_{|\\sigma=0}=1 ∂σ∂f​∣σ=0​=1，而上升的速率可以无限小。若将评价函数小视为自适应度高，则调整过后的系统参数总是在期望值附近调整，并尽量满足$所有参数都小于期望值的情况。因为在期望值附近上升速率是越来越慢而下降速率是越来越快的，而参数最小只能取到0。因此，有多个参数大于期望值而有少个参数小于期望值的和会比有少个参数大于期望值而多个参数小于期望值的和要大得多。 \\qquad 写好评价函数之后，我们可以设自适应度函数 F = − f a c c e s s F=-f_{access} F=−faccess​，因为我们的评价函数是越小越好的，而自适应度是越高越好。 \\qquad 根据1.2的算法步骤我们可以编写出粒子群算法，而PID并行仿真引擎的编写需要参考上文提供的连接。（simulink的PID仿真请参考下一小节2.2.）粒子群算法每迭代出一代的参数(PSO.m)，就把这一代里面最好的参数 P G P_G PG​返还给PID引擎进行仿真(PID_sim.m)，再编写一个参数自识别的程序(parameter_cal.m)，将需要识别的指标（调节时间、超调）计算出来，传递给 f a c c e s s f_{access} faccess​进行计算(PID_access.m)，将计算得到的参数 【PID_sim.m】（PID并行仿真引擎） function [f_infty,tp,ts,sigma]=PID_sim(kp,ki,kd,debug) %kp,ki,kd为PID参数,T0为采样时间,total_t为仿真时间 Tt=5e-4;%仿真采样周期 T0=1e-2;%控制采样周期 Tf=1e-3;%微分环节的滤波器系数 alp=Tf/(Tt+Tf); total_t=1; N=floor(total_t/Tt);%样本总数 M=numel(kp);%仿真序列数 kp=reshape(kp,M,1); ki=reshape(ki,M,1); kd=reshape(kd,M,1); sys=tf(0.998,[0.021,1]); %建立被控对象传递函数，即式4.1 dsys=c2d(sys,Tt,&#39;z&#39;); %离散化 [num,den]=tfdata(dsys,&#39;v&#39;); % e_1=zeros(M,1); %前一时刻的偏差 Ee=zeros(M,1); %累积偏差 u_1=zeros(M,1); %前一时刻的控制量 y_1=zeros(M,1); %前一时刻的输出 ud_1=zeros(M,1); %前一时刻的微分输出 %预分配内存 r=1500; y=zeros(M,N); u=zeros(M,N); for k=1:1:N y(:,k)=-1*den(2).*y_1+num(2)*u_1+num(1).*u(:,k);%系统响应输出序列 e0=r-y(:,k); %误差信号 ud=alp.*ud_1+(1-alp)/T0.*kd.*(e0-e_1); u(:,k)=kp.*e0+T0*ki.*Ee+ud; %系统PID控制器输出序列 Ee=Ee+e0; %误差的累加和 u_1=u(:,k); %前一个的控制器输出值 y_1=y(:,k); %前一个的系统响应输出值 e_1=e0; %前一个误差信号的值 ud_1=ud; end if debug %非调试模式下不显示也不打印图像 plot(linspace(0,total_t,N),y) end [f_infty,tp,ts,sigma]=parameter_cal(y,Tt,2e-2,debug);%取得阶跃响应指标 end 【parameter_cal.m】（计算仿真曲线参数） function [f_infty,tp,ts,sigma]=parameter_cal(y,T0,delt_err,debug) %y是系统输出序列 %T0是采样时间，可以结合时间序列点序号算出实际时间 %delt_err是调节时间的误差精度 M=size(y,1);N=size(y,2);%M为运算维度，N为时间序列长度 f_infty=y(:,N);%稳态值序列 err=y-f_infty*ones(1,N);%通过稳态值计算误差序列 ferr=fliplr(abs(err));%倒序并取绝对值 [~,ts_i]=max(ferr&gt;delt_err*f_infty,[],2); ts_i=N*ones(M,1)-ts_i; ts=ts_i*T0;%调节时间 [fp,tp]=max(y,[],2);%峰值和函数峰值 tp=tp*T0; tp(abs(fp-f_infty)&lt;1e-5)=NaN; %过阻尼无超调，没有峰值时间 sigma=(fp-f_infty)./f_infty; if debug &amp;&amp; M==1 %非调试模式下不显示 disp([&#39;系统稳态值为&#39;,num2str(f_infty)]) disp([&#39;系统超调量为&#39;,num2str(sigma*100),&#39;%&#39;]) if isnan(tp) disp(&#39;系统不存在峰值时间&#39;) else disp([&#39;系统峰值时间为&#39;,num2str(tp),&#39;s&#39;]) end disp([&#39;系统的调节时间为&#39;,num2str(ts),&#39;s&#39;]) end end 【PID_access.m】（根据参数得出评价度的函数，程序中为评价度越低越好） function y=PID_access(para) %PID调节性能的指标参数 kp=para(:,1);ki=para(:,2);kd=para(:,3); [~,~,ts,sigma]=PID_sim(kp,ki,kd,false); y=log(ts/5e-2+1)+log(sigma/1e-2+1); end 【PSO.m】（PSO算法优化函数） function [Pg,fmin]=PSO(dimension,n,m) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 w=1;c1=2;c2=2;%速度惯性系数 sigma_data=zeros(1,n); ts_data=zeros(1,n); dt=0.3;%位移仿真间隔 vmax=1;%速度限幅 xmax=[15,50,2];%位置限幅 xmin=[0.2,0,0]; v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin).*rand(m,dimension)+xmin;%初始位置满足(xmin,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=PID_access(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); N=0; for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=-vmax &amp; v&lt;=vmax).*v+(v&lt;-vmax).*(-vmax); X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*(xmin); new_f=PID_access(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 [~,~,ts,sigma]=PID_sim(Pg(1),Pg(2),Pg(3),true) sigma_data(1,i)=sigma; ts_data(1,i)=ts; hold on end legend(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;10&#39;,&#39;11&#39;,&#39;12&#39;,&#39;13&#39;,&#39;14&#39;,&#39;15&#39;) title(&#39;响应曲线随迭代次数的变化&#39;) figure plot(ts_data) title(&#39;调节时间随迭代次数的变化&#39;) figure plot(sigma_data) title(&#39;超调量随迭代次数的变化&#39;) end 【main.m】（主函数，从这里开始） dimension=3;n=20;m=200;%PID为3位参数，n是迭代次数，m为种群规模 [Pg,fmin]=PSO(dimension,n,m) 仿真结果如下： 注：响应曲线可能要在左上角局部放大才能获得该图像。 \\qquad 这是一个简单的一阶惯性系统的PID调参仿真，用于模拟直流电机的转速模型，可以看出直流电机的转速响应是越来越快的（调节时间越来越小），超调量在第一次就达到了0，因此系统不存在超调。 *2.2.复杂系统的PID自整定（基于simulink仿真） \\qquad 我们以双闭环直流调速系统为例来说明PSO对PID自整定参数的作用。直流调速系统由外环（转速环）和内环（电流环）构成，转速环是一个PI调节器，调节转速为期望转速，用于抵抗负载扰动、电机参数变化带来的扰动；电流环也是一个PI调节器，与转速环不同的是，电流调节器的目的是在于让电流快速跟随给定值，以获得更好的动态特性。我们以电机的启动过程为例仿真这个系统，直流电机启动时，电流首先达到容许最大值，电机以最大加速度进行加速，到达期望转速时让电流迅速减小并达到负载转矩所需电流，电机维持期望转速不变。 2.2.1.PSO优化PID的过程详解 \\qquad 下面我们设定我们需要达成的调节指标——由于启动时的电机电流会迅速上升到过载电流（允许的最大值），是一个恒定值，故会有一个电流平台，记上升到电流平台产生的超调为电流超调 σ i \\sigma_i σi​，从超调回到电流平台所需的时间为电流的调节时间 t s i t_{si} tsi​，最终转速稳定前的超调记为转速超调 σ n \\sigma_n σn​，转速到达稳定值区域的时间为调节时间 t s n t_{sn} tsn​。 【搭建simulink模型】 双闭环调速系统的结构框图如下： 搭建simulink仿真模型如下： 注：上图可能不够清楚，根据以下参数搭建simulink模型，并且命名为double_circle.slx（和PSO的所有程序同名） 电机的参数如下： 额定电压/电流/功率：800V/2164A 1500KW 额定转速：44r/min 过载系数： λ i = 1.5 \\lambda_i=1.5 λi​=1.5 励磁：110V/191A 电枢电阻 R a R_a Ra​：0.1 Ω \\Omega Ω 主回路电阻R：0.1014 Ω \\Omega Ω 电枢（主回路）电感L：3.25mH 变流器放大倍数 K s K_s Ks​=80 变流器通态压降：3V 系统飞轮惯量： 8.6 × 1 0 5 N ⋅ m 2 8.6×10^5N\\cdot m^2 8.6×105N⋅m2 \\qquad 根据工程设计方法当然可以得到一套电流和转速的PI参数，计算的相关参数为： [ K n p , K n I , K i p , K i I ] E N = [ 7.3660 , 1.5658 , 0.8257 , 30.2773 ] [K_{np},K_{nI},K_{ip},K_{iI}]_{EN}=[7.3660 ,1.5658 ,0.8257, 30.2773] [Knp​,KnI​,Kip​,KiI​]EN​=[7.3660,1.5658,0.8257,30.2773] 通过仿真，我们得到的转速和电流曲线如下： 额定负载启动 空载启动 调用我们的参数计算程序计算一下参数可以得到： σ n = 4.07 × 1 0 − 4 % , t s n = 0.7875 , σ i = 20.38 % , t s i = 0.0172 \\sigma_n=4.07×10^{-4}\\%,t_{sn}=0.7875,\\sigma_i=20.38\\%,t_{si}=0.0172 σn​=4.07×10−4%,tsn​=0.7875,σi​=20.38%,tsi​=0.0172 \\qquad 这个参数当然是比较理想的参数，如果我们不知道工程设计方法或者说工程设计方法不适用于我们的模型时，那么就可以使用PSO整定PID参数的方法。 【修改simulink模型以适应PSO的M文件调用】 \\qquad 这里需要调整的参数为转速调节器ASR的 K n p ， K n I K_{np}，K_{nI} Knp​，KnI​和电流调节器ACR的 K i p , K i I K_{ip},K_{iI} Kip​,KiI​，如果我们希望能实时调整simulink的参数进行动态仿真，我们需要直接将图中的几个比例环节依次设为符号( K n p , K n I , K i p , K i I K_{np},K_{nI},K_{ip},K_{iI} Knp​,KnI​,Kip​,KiI​)，并在工作区实时修改这4个参数再进行仿真。如果我们要将实时调整PI参数的代码写在M文件中仿真，必须要将变量声明为全局（global），此时变量会在工作区里面，simulink就可以调用了。另存为PSO_double_circle.slx 【编写辅助的M文件】 cal_n.m：单组PID参数仿真结果的参数计算 function [n_sigma,ts_n,I_sigma,ts_transient_i]=cal_n(parameters) global Kpn Kin KpI KiI %将simulink所需参数导入工作区，以便仿真使用 obj_slx=&#39;PSO_double_circle&#39;; Kpn=parameters(1); Kin=parameters(2); KpI=parameters(3); KiI=parameters(4); sim(obj_slx);%对目标路径下的slx文件进行仿真 I_data=I.signals.values;n_data=n.signals.values;time=I.time; n_infty=mean(n_data(numel(n_data)-10:numel(n_data))); [i_max,tr_index]=max(I_data); diffI=[0;diff(I_data)];%电流微分 pos=find(abs(diffI)&lt;1);%找到电流波动较小的部分 pos=pos(pos&gt;tr_index);%排除启动时电流不变的情况 min_pos=min(pos); I_transient=mean(I_data(min_pos+10:min_pos+20));%恒流升速阶段的暂稳态电流值 I_sigma=(i_max-I_transient)/I_transient; ts_transient_i=time(min_pos-tr_index);%电流暂稳态的调节时间 n_max=max(n_data); n_sigma=(n_max-n_infty)/n_infty; ts_n_index=numel(n_data)-find(abs(flip(n_data)-n_infty)/n_infty&gt;2e-2,1); ts_n=time(ts_n_index); end PID_n_access.m：PID参数的仿真，以代为单位的 function [y,ts_n,n_sigma,ts_transient_i,I_sigma]=PID_n_access(parameters_list) M=size(parameters_list,1);%计算需要仿真的组数（simulink无法并行仿真） ts_n0=0.8;n_sigma0=1e-2;I_sigma0=0.02;ts_i0=1e-4;%期望值 %将simulink所需参数导入工作区，以便仿真使用 y=zeros(M,1); n_sigma=zeros(M,1);ts_n=zeros(M,1); for sim_i=1:M parameters=parameters_list(sim_i,:); [n_sigma,ts_n,I_sigma,ts_transient_i,n_err]=cal_n(parameters); y(sim_i)=log(ts_n./ts_n0+1)+log(n_sigma./n_sigma0+1)+log(I_sigma/I_sigma0+1)+log(ts_transient_i/ts_i0+1)+exp(n_err*10); end end para_cal.m：参数计算，以代为单位的 obj_slx=&#39;double_circle.slx&#39;; sim(obj_slx); I_data=I.signals.values;n_data=n.signals.values;time=I.time; I_infty=mean(I_data(numel(I_data)-10:numel(I_data))); n_infty=mean(n_data(numel(n_data)-10:numel(n_data))); [i_max,tr_index]=max(I_data); diffI=[0;diff(I_data)];%电流微分 pos=find(abs(diffI)&lt;1);%找到电流波动较小的部分 pos=pos(pos&gt;tr_index);%排除启动时电流不变的情况 min_pos=min(pos); I_transient=mean(I_data(min_pos+10:min_pos+20));%恒流升速阶段的暂稳态电流值 I_sigma=(i_max-I_transient)/I_transient; if I_sigma&lt;1e-4 tr_i=NaN; else tr_i=time(tr_index);%电流的上升时间 end ts_transient_i=time(min_pos-tr_index);%电流暂稳态的调节时间 ts_i_index=numel(I_data)-find(abs(flip(I_data)-I_infty)/I_infty&gt;2e-2,1); ts_i=time(ts_i_index);%转速稳态时电流的调节时间 [n_max,tr_index]=max(n_data); n_sigma=(n_max-n_infty)/n_infty; %参数展示 %转速参数展示 if n_sigma&lt;1e-4 tr_n=NaN; else tr_n=time(tr_index); end ts_n_index=numel(n_data)-find(abs(flip(n_data)-n_infty)/n_infty&gt;2e-2,1); ts_n=time(ts_n_index); if isnan(tr_n) disp(&#39;转速无超调&#39;) else disp([&#39;转速上升时间为&#39;,num2str(tr_n),&#39;s&#39;]) disp([&#39;转速超调量为&#39;,num2str(100*n_sigma),&#39;%&#39;]) end disp([&#39;转速调节时间为&#39;,num2str(ts_n),&#39;s&#39;]) %电流参数展示 if isnan(tr_i) disp(&#39;电流无超调&#39;) else disp([&#39;电流上升时间为&#39;,num2str(tr_i),&#39;s&#39;]) disp([&#39;电流超调量为&#39;,num2str(100*I_sigma),&#39;%&#39;]) disp([&#39;电流暂稳态调节时间为&#39;,num2str(ts_transient_i),&#39;s&#39;]) end disp([&#39;电流的最终调节时间为&#39;,num2str(ts_i),&#39;s&#39;]) draw.m:仅根据一组PID参数画出转速波形图 function draw(parameters) global Kpn Kin KpI KiI Kpn=parameters(1); Kin=parameters(2); KpI=parameters(3); KiI=parameters(4); sim(&#39;PSO_double_circle&#39;) n_data=n.signals.values;time=n.time;%获取转速序列及对应时刻 plot(time,n_data) draw_n_I.m:根据一组PID参数绘制电流和转速曲线 function draw_n_I(parameters) global Kpn KIn Kpi KIi Kpn=parameters(1); KIn=parameters(2); Kpi=parameters(3); KIi=parameters(4); sim(&#39;PSO_double_circle&#39;) n_data=n.signals.values;time=n.time;%获取转速序列及对应时刻 I_data=I.signals.values; figure subplot(211) plot(time,I_data,&#39;r-&#39;,&#39;LineWidth&#39;,1.5) title(&#39;电流波形&#39;) subplot(212) plot(time,n_data,&#39;b-&#39;,&#39;LineWidth&#39;,1.5) title(&#39;转速波形&#39;) end PSO.m：PSO优化程序 function [Pg,fmin]=PSO(n,m,xmax,xmin,cal_f,f) %全局粒子群算法,f为目标函数,dimension为维度,n为代数,m为种群规模 dimension=numel(xmax); w=1;c1=2;c2=2;%速度惯性系数 sigma_data=zeros(1,n); ts_data=zeros(1,n); dt=0.3;%位移仿真间隔 vmax=0.1*(xmax-xmin);%速度限幅 v=zeros(m,dimension);%初始速度为0 X=(xmax-xmin).*rand(m,dimension)+xmin;%初始位置满足(xmin,xmax)内均匀分布 P=X;%P为每个粒子每代的最优位置 last_f=f(X); [fmin,min_i]=min(last_f);%Pg为所有代中的最优位置 Pg=X(min_i,:); last_Pg=Pg; legend_str=cell(0); legend_i=1; figure(1) legend_str{legend_i}=num2str(1); draw(Pg) for i=1:n v=w*v+c1*rand*(P-X)+c2*rand*(ones(m,1)*Pg-X); v=(v&gt;vmax).*vmax+(v&gt;=-vmax &amp; v&lt;=vmax).*v+(v&lt;-vmax).*(-vmax); X=X+v*dt; X=(X&gt;xmax).*xmax+(X&gt;=xmin &amp; X&lt;=xmax).*X+(X&lt;xmin).*(xmin); new_f=f(X);%新的目标函数值 update_j=find(new_f&lt;last_f); P(update_j,:)=X(update_j,:);%修正每个粒子的历史最优值 [new_fmin,min_i]=min(new_f); new_Pg=X(min_i,:); Pg=(new_fmin&lt;fmin)*new_Pg+(new_fmin&gt;=fmin)*Pg; last_f=new_f;%保存当前的函数值 fmin=min(new_fmin,fmin);%更新函数最小值 [sigma,ts,~,~]=cal_f(Pg); sigma_data(1,i)=sigma; ts_data(1,i)=ts; if last_Pg~=Pg legend_i=legend_i+1; figure(1) legend_str{legend_i}=num2str(i); draw(Pg) hold on end last_Pg=Pg; disp([&#39;迭代次数：&#39;,num2str(i)]) end figure(1) legend(legend_str) title(&#39;响应曲线随迭代次数的变化&#39;) figure(2) plot(ts_data) title(&#39;调节时间随迭代次数的变化&#39;) figure(3) plot(sigma_data) title(&#39;超调量随迭代次数的变化&#39;) end set_para.m（设置参数程序，从这里开始） best_parameters=[8.4725,97,72,1.794,56.06]; global Kpn KIn Kpi KIi Kpn=0;KIn=0;Kpi=0;KIi=0; n=10;m=100;xmax=[20,120,10,60];xmin=[0,0,0,0];cal_f=@cal_n;f=@PID_n_access; [Pg,fmin]=PSO(n,m,xmax,xmin,cal_f,f); 我们将期望的参数设定为 σ n ∗ = 0 , 1 % , t s n ∗ = 1 , σ i ∗ = 20 % , t s i ∗ = 0.005 \\sigma_n^*=0,1\\%,t_{sn}^*=1,\\sigma_i^*=20\\%,t_{si}^*=0.005 σn∗​=0,1%,tsn∗​=1,σi∗​=20%,tsi∗​=0.005利用PSO算法构造的评价函数为 f a c c e s s = l n ( t s n 1 + 1 ) + l n ( σ n 0.001 + 1 ) + l n ( σ i 0.2 + 1 ) + l n ( t s i 0.005 + 1 ) ; f_{access}=ln(\\frac{ts_n}{1}+1)+ln(\\frac{\\sigma_n}{0.001}+1)+ln(\\frac{\\sigma_i}{0.2}+1)+ln(\\frac{ts_i}{0.005}+1); faccess​=ln(1tsn​​+1)+ln(0.001σn​​+1)+ln(0.2σi​​+1)+ln(0.005tsi​​+1); 得到的最佳参数为： [ K n p , K n I , K i p , K i I ] P S O = [ 18.2613 , 73.0965 , 1.6843 , 16.5703 ] P S O [K_{np},K_{nI},K_{ip},K_{iI}]_{PSO}=[18.2613,73.0965 ,1.6843,16.5703]_{PSO} [Knp​,KnI​,Kip​,KiI​]PSO​=[18.2613,73.0965,1.6843,16.5703]PSO​ 下的仿真曲线如下： 超调量和调节时间随迭代次数变化 PSO与工程设计方法电机启动曲线对比（额定负载启动） 工程设计方法 PSO方法 通过计算程序得到的参数为： σ n = 6.7556 × 1 0 − 4 % , t s n = 0.7862 , σ i = 18.83 % , t s i = 0.01341 \\sigma_n=6.7556×10^{-4}\\%,t_{sn}=0.7862,\\sigma_i=18.83\\%,t_{si}=0.01341 σn​=6.7556×10−4%,tsn​=0.7862,σi​=18.83%,tsi​=0.01341 工程设计方法的参数为： σ n = 4.07 × 1 0 − 4 % , t s n = 0.7875 , σ i = 20.38 % , t s i = 0.0172 \\sigma_n=4.07×10^{-4}\\%,t_{sn}=0.7875,\\sigma_i=20.38\\%,t_{si}=0.0172 σn​=4.07×10−4%,tsn​=0.7875,σi​=20.38%,tsi​=0.0172 \\qquad 可以发现除了最后一项指标之外，其余指标均达到了期望值要求，并且和工程设计方法得出的指标相比甚至还略优于它。 2.2.2.在PSO优化过程中修改参数价值权重 \\qquad 转速的超调和调节时间，电流的超调和调节时间，我们最后评估的指标除了转速无静差的基本要求外，这4项指标就是我们的评价标准，如果我们更希望牺牲某一个或多个参数去优化另一个或另一些参数时，该怎么调节我们的算法呢？ \\qquad 答案也非常简单，调节的方法有2个，一个是期望值，一个是评价函数的各项系数。这里我们用调节期望值的方法做一个示范： \\qquad 之前的期望值为： σ n ∗ = 0.1 % , t s n ∗ = 1 , σ i ∗ = 20 % , t s i ∗ = 0.005 \\sigma_n^*=0.1\\%,t_{sn}^*=1,\\sigma_i^*=20\\%,t_{si}^*=0.005 σn∗​=0.1%,tsn∗​=1,σi∗​=20%,tsi∗​=0.005 修改期望值为： σ n ∗ = 10 % , t s n ∗ = 0.8 , σ i ∗ = 2 % , t s i ∗ = 0.0001 \\sigma_n^*=10\\%,t_{sn}^*=0.8,\\sigma_i^*=2\\%,t_{si}^*=0.0001 σn∗​=10%,tsn∗​=0.8,σi∗​=2%,tsi∗​=0.0001 重新仿真，对比二者的结果如下： PSO1 PSO2 \\qquad 可以看出转速超调量略微增大了一些，但是转速和电流的调节时间明显缩短，电流的超调量基本不变。这一点也表明多项优化指标是相互耦合的，可以牺牲一者满足另一者，只要参数在这方面是可调的。 \\qquad 需要注意的是，simulink中无法使用串行的算法，因此代码中使用时是串行的，可能仿真比较慢，请大家耐心等待（每迭代一次都会打印一次） \\qquad 希望本文对您有帮助，谢谢阅读！","@type":"BlogPosting","url":"https://uzzz.org/2019/08/24/794604.html","headline":"【Simulink】粒子群算法（PSO）整定PID参数（附代码和讲解）","dateModified":"2019-08-24T00:00:00+08:00","datePublished":"2019-08-24T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uzzz.org/2019/08/24/794604.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>【Simulink】粒子群算法（PSO）整定PID参数（附代码和讲解）</h1>
        
        
        <ul style="display: block;">
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
 	    <li><a href="/donate/" style="line-height: unset;" target="_blank"><strong>Donate</strong></a></li>
        </ul>
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
<!-- match content ads -->
	        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<ins class="adsbygoogle"
			     style="display:block"
			     data-ad-format="autorelaxed"
			     data-ad-client="ca-pub-8889449066804352"
			     data-ad-slot="1928667997"></ins>
			<script>
			     (adsbygoogle = window.adsbygoogle || []).push({});
			</script>	



        <div id="article_resource" class="article_resource"> 
 <div class="article_resource_content"> 
  <dl> 
   <dt>
    <img src="https://csdnimg.cn/release/download/old_static/images/minetype/unkonw.svg" alt="">
   </dt> 
   <dd> 
    <p class="article_resource_title">double_circle.slx</p> 
    <p class="article_resource_describe">该文件是PSO整定PID算法的配套simulink文件（仿真直流电机启动），Matlab的版本是2017a。配套博文是【Simulink】粒子群算法整定PID参数（附代码和讲解）</p> 
   </dd> 
  </dl> 
 </div> 
 <div class="article_resource_down"> 
  <a href="https://download.csdn.net/download/weixin_44044411/11609837" target="_blank">立即下载</a> 
 </div> 
</div> 
<div id="article_content" class="article_content clearfix">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <p></p>
  <div class="toc">
   <h3>目录</h3>
   <ul>
    <li><a href="#font_colorpurple0_1" rel="nofollow" data-token="b44aad5115eedf607ff977d4f426161f"><font color="purple">0.背景</font></a></li>
    <li><a href="#font_color19C1_4" rel="nofollow" data-token="29fcdfbeefec1f8cfb58d98ae3749122"><font color="#19C">1.粒子群算法</font></a></li>
    <ul>
     <li><a href="#font_colorcany11_5" rel="nofollow" data-token="006e6a0e3f35c5fd6e1ac06e2d9e0e24"><font color="cany">1.1.算法简介</font></a></li>
     <li><a href="#font_colorcany12_10" rel="nofollow" data-token="6beaa326694a76f85196e48e449a0b21"><font color="cany">1.2.算法步骤</font></a></li>
     <li><a href="#font_colorcany13_42" rel="nofollow" data-token="a2112aea3e315877b26d49640548ae0c"><font color="cany">1.3.算法举例</font></a></li>
    </ul>
    <li><a href="#font_color19C2PID_125" rel="nofollow" data-token="885c1c2ddd2880970632eed5c08ee96b"><font color="#19C">2.PID自整定</font></a></li>
    <ul>
     <li><a href="#font_colorcany21MPID_126" rel="nofollow" data-token="6f5d535cd2e65b9ba007722239a03b73"><font color="cany">2.1.基于M文件编写的PID参数自整定</font></a></li>
     <li><a href="#font_colorcany22PIDsimulink_276" rel="nofollow" data-token="307fb2c8959a682b0a5b21ada0f89fb5"><font color="cany">*2.2.复杂系统的PID自整定（基于simulink仿真）</font></a></li>
     <ul>
      <li><a href="#font_colorC2019221PSOPID_278" rel="nofollow" data-token="61e562abec4a1727ffe764d40f7d61b6"><font color="#C2019">2.2.1.PSO优化PID的过程详解</font></a></li>
      <li><a href="#font_colorC2019222PSO_518" rel="nofollow" data-token="e67a401b9666b272dd1e14a949369791"><font color="#C2019">2.2.2.在PSO优化过程中修改参数价值权重</font></a></li>
     </ul>
    </ul>
   </ul>
  </div>
  <p></p> 
  <h1><a id="font_colorpurple0_1"></a><font color="purple">0.背景</font></h1> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>调整PID参数时，我们常常需要按照各种方法查各种表，还要根据建立的数学模型和之前的结果做人工调整。这个过程常常是漫长的，而且最终得到的很可能也不是最优的参数。若系统的参数有改动，又要人工再调一次。而3个参数6个方向的调整，如果输入的变量很多，那么调节的可能性组合就更多了，这个工作常常不是非专业人士所能胜任的。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>现在我给大家介绍一种不需要知道内部原理也可以调整PID参数的方法，而且调整的思路是所需即所得——你需要的参数是什么样子的，这个算法就会往这个方向调整PID参数。如果这个系统是多输入多输出的，我需要让A输出的超调小一些，而B输出的调节时间可以尽量大一些，只需要调整我们的评价函数就可以让算法自动调参以满足客户需求了。那这样的算法使用起来是不是很容易呢？</p> 
  <h1><a id="font_color19C1_4"></a><font color="#19C">1.粒子群算法</font></h1> 
  <h2><a id="font_colorcany11_5"></a><font color="cany">1.1.算法简介</font></h2> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>粒子群算法（PSO）于1995年提出，和遗传算法一样，也是一种群体迭代算法，不同的是，粒子群算法需要整定的参数更少，不存在交叉和变异过程，所以收敛速度更快。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>由于是群体迭代算法，因此该算法一般做成并行的。如果做成串行的，也是可以运行的，就是会随着种群规模的增大越来越慢。对于Python运用熟练的朋友可以利用Python做成并行的，对于不熟悉并行算法的朋友，直接使用MATLAB就好了，因为MATLAB的矩阵运算已经集成了并行算法。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>为了让大家理解，我们做一个很形象的比喻。将我们的粒子群比作一群可以互相通讯的鸟，每只鸟不知道食物的具体位置，但是可以根据嗅觉知道离食物的距离和自己在地图中的位置。种群中的任意2只鸟均可以知道对方离食物的距离和对方的具体位置。假设每只鸟的飞行都是有惯性的，而每只鸟都会根据自己距离食物的距离和位置及其他鸟距离食物的距离和位置选择下一次的飞行方向。最终，所有鸟都会在信息交换的基础上，汇聚在食物地点。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>这只是对粒子群算法的一个形象的比喻，不必过多计较该模型的现实性，闲言少叙，让我们进入<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mstyle mathcolor="red">
          <mi mathvariant="normal">
           算
          </mi>
          <mi mathvariant="normal">
           法
          </mi>
          <mi mathvariant="normal">
           步
          </mi>
          <mi mathvariant="normal">
           骤
          </mi>
         </mstyle>
        </mrow>
        <annotation encoding="application/x-tex">
         \color{red}算法步骤
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback" style="color: red;">算</span><span class="mord cjk_fallback" style="color: red;">法</span><span class="mord cjk_fallback" style="color: red;">步</span><span class="mord cjk_fallback" style="color: red;">骤</span></span></span></span></span>。</p> 
  <h2><a id="font_colorcany12_10"></a><font color="cany">1.2.算法步骤</font></h2> 
  <p>【step1】确定参数维度<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mstyle mathcolor="blue">
          <mi>
           N
          </mi>
         </mstyle>
        </mrow>
        <annotation encoding="application/x-tex">
         \color{blue}{N}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.10903em; color: blue;">N</span></span></span></span></span></span>、参数范围（即每只鸟的初始位置），确定<font color="blue">惯性系数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            c
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            c
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           w
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          c_1,c_2,w
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>，确定种群规模m，迭代次数n。<font color="black"><br> 每个粒子的初始位置是随机的，设输入向量<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            x
           </mi>
           <mo>
            =
           </mo>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             N
            </mi>
           </msub>
           <msup>
            <mo>
             )
            </mo>
            <mi>
             T
            </mi>
           </msup>
          </mrow>
          <annotation encoding="application/x-tex">
           x=(x_1,x_2,...,x_N)^T
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>必须满足参数范围限制为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <mo fence="true">
             {
            </mo>
            <mtable>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="false">
                <mrow>
                 <msubsup>
                  <mi>
                   x
                  </mi>
                  <mrow>
                   <mi>
                    m
                   </mi>
                   <mi>
                    i
                   </mi>
                   <mi>
                    n
                   </mi>
                  </mrow>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mn>
                    1
                   </mn>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                 <mo>
                  &amp;lt;
                 </mo>
                 <msub>
                  <mi>
                   x
                  </mi>
                  <mn>
                   1
                  </mn>
                 </msub>
                 <mo>
                  &amp;lt;
                 </mo>
                 <msubsup>
                  <mi>
                   x
                  </mi>
                  <mrow>
                   <mi>
                    m
                   </mi>
                   <mi>
                    a
                   </mi>
                   <mi>
                    x
                   </mi>
                  </mrow>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mn>
                    1
                   </mn>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="false">
                <mrow>
                 <msubsup>
                  <mi>
                   x
                  </mi>
                  <mrow>
                   <mi>
                    m
                   </mi>
                   <mi>
                    i
                   </mi>
                   <mi>
                    n
                   </mi>
                  </mrow>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mn>
                    2
                   </mn>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                 <mo>
                  &amp;lt;
                 </mo>
                 <msub>
                  <mi>
                   x
                  </mi>
                  <mn>
                   2
                  </mn>
                 </msub>
                 <mo>
                  &amp;lt;
                 </mo>
                 <msubsup>
                  <mi>
                   x
                  </mi>
                  <mrow>
                   <mi>
                    m
                   </mi>
                   <mi>
                    a
                   </mi>
                   <mi>
                    x
                   </mi>
                  </mrow>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mn>
                    2
                   </mn>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="false">
                <mrow>
                 <mi mathvariant="normal">
                  .
                 </mi>
                 <mi mathvariant="normal">
                  .
                 </mi>
                 <mi mathvariant="normal">
                  .
                 </mi>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="false">
                <mrow>
                 <msubsup>
                  <mi>
                   x
                  </mi>
                  <mrow>
                   <mi>
                    m
                   </mi>
                   <mi>
                    i
                   </mi>
                   <mi>
                    n
                   </mi>
                  </mrow>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mi>
                    N
                   </mi>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                 <mo>
                  &amp;lt;
                 </mo>
                 <msub>
                  <mi>
                   x
                  </mi>
                  <mn>
                   1
                  </mn>
                 </msub>
                 <mo>
                  &amp;lt;
                 </mo>
                 <msubsup>
                  <mi>
                   x
                  </mi>
                  <mrow>
                   <mi>
                    m
                   </mi>
                   <mi>
                    a
                   </mi>
                   <mi>
                    x
                   </mi>
                  </mrow>
                  <mrow>
                   <mo>
                    (
                   </mo>
                   <mi>
                    N
                   </mi>
                   <mo>
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
           <annotation encoding="application/x-tex">
            \begin{cases}x_{min}^{(1)}&amp;lt;x_1&amp;lt;x_{max}^{(1)} \\x_{min}^{(2)}&amp;lt;x_2&amp;lt;x_{max}^{(2)} \\... \\x_{min}^{(N)}&amp;lt;x_1&amp;lt;x_{max}^{(N)} \end{cases}
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.8704em; vertical-align: -2.6852em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95002em;"><span class="" style="top: -1.59999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -1.59999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -1.89999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -4.60001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -4.90001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -5.20002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.1852em;"><span class="" style="top: -5.1852em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.7084em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.2684em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span class="" style="top: -0.7916em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.6852em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 记<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msub>
             <mi>
              X
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               i
              </mi>
              <mi>
               n
              </mi>
             </mrow>
            </msub>
            <mo>
             =
            </mo>
            <mo>
             (
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               i
              </mi>
              <mi>
               n
              </mi>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mn>
               1
              </mn>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo separator="true">
             ,
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               i
              </mi>
              <mi>
               n
              </mi>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mn>
               2
              </mn>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo separator="true">
             ,
            </mo>
            <mi mathvariant="normal">
             .
            </mi>
            <mi mathvariant="normal">
             .
            </mi>
            <mi mathvariant="normal">
             .
            </mi>
            <msubsup>
             <mi>
              x
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               i
              </mi>
              <mi>
               n
              </mi>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               N
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo>
             )
            </mo>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              X
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               a
              </mi>
              <mi>
               x
              </mi>
             </mrow>
            </msub>
            <mo>
             =
            </mo>
            <mo>
             (
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               a
              </mi>
              <mi>
               x
              </mi>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mn>
               1
              </mn>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo separator="true">
             ,
            </mo>
            <msubsup>
             <mi>
              x
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               a
              </mi>
              <mi>
               x
              </mi>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mn>
               2
              </mn>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo separator="true">
             ,
            </mo>
            <mi mathvariant="normal">
             .
            </mi>
            <mi mathvariant="normal">
             .
            </mi>
            <mi mathvariant="normal">
             .
            </mi>
            <msubsup>
             <mi>
              x
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               a
              </mi>
              <mi>
               x
              </mi>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               N
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo>
             )
            </mo>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}X_{min}=(x_{min}^{(1)},x_{min}^{(2)},...x_{min}^{(N)}),X_{max}=(x_{max}^{(1)},x_{max}^{(2)},...x_{max}^{(N)})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.07847em; color: blue;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">i</span><span class="mord mathit mtight" style="color: blue;">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.32166em; vertical-align: -0.276864em;"></span><span class="mopen" style="color: blue;">(</span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">i</span><span class="mord mathit mtight" style="color: blue;">n</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mtight" style="color: blue;">1</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mpunct" style="color: blue;">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">i</span><span class="mord mathit mtight" style="color: blue;">n</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mtight" style="color: blue;">2</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mpunct" style="color: blue;">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: blue;">.</span><span class="mord" style="color: blue;">.</span><span class="mord" style="color: blue;">.</span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">i</span><span class="mord mathit mtight" style="color: blue;">n</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.10903em; color: blue;">N</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mclose" style="color: blue;">)</span><span class="mpunct" style="color: blue;">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.07847em; color: blue;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">a</span><span class="mord mathit mtight" style="color: blue;">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.2948em; vertical-align: -0.25em;"></span><span class="mopen" style="color: blue;">(</span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">a</span><span class="mord mathit mtight" style="color: blue;">x</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mtight" style="color: blue;">1</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span><span class="mpunct" style="color: blue;">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">a</span><span class="mord mathit mtight" style="color: blue;">x</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mtight" style="color: blue;">2</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span><span class="mpunct" style="color: blue;">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: blue;">.</span><span class="mord" style="color: blue;">.</span><span class="mord" style="color: blue;">.</span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">m</span><span class="mord mathit mtight" style="color: blue;">a</span><span class="mord mathit mtight" style="color: blue;">x</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.10903em; color: blue;">N</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span><span class="mclose" style="color: blue;">)</span></span></span></span></span><br> 则输入向量<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            x
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           x
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>应满足<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             X
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mi>
              i
             </mi>
             <mi>
              n
             </mi>
            </mrow>
           </msub>
           <mo>
            &amp;lt;
           </mo>
           <mi>
            x
           </mi>
           <mo>
            &amp;lt;
           </mo>
           <msub>
            <mi>
             X
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mi>
              a
             </mi>
             <mi>
              x
             </mi>
            </mrow>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           X_{min}&amp;lt;x&amp;lt;X_{max}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> 每个粒子的初速度定为0，即<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             v
            </mi>
            <mn>
             0
            </mn>
           </msub>
           <mo>
            =
           </mo>
           <mn>
            0
           </mn>
          </mrow>
          <annotation encoding="application/x-tex">
           v_0=0
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>，第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            j
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个粒子（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mn>
            1
           </mn>
           <mo>
            ≤
           </mo>
           <mi>
            j
           </mi>
           <mo>
            ≤
           </mo>
           <mi>
            m
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           1≤j≤m
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.78041em; vertical-align: -0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>）的下一次迭代的速度<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msup>
            <mi>
             v
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
          </mrow>
          <annotation encoding="application/x-tex">
           v^{(j)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>由三部分组成：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <msup>
             <mi>
              v
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo>
             =
            </mo>
            <mi>
             w
            </mi>
            <mo>
             ⋅
            </mo>
            <msub>
             <mi>
              v
             </mi>
             <mn>
              0
             </mn>
            </msub>
            <mo>
             +
            </mo>
            <msub>
             <mi>
              c
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo>
             ⋅
            </mo>
            <mi>
             r
            </mi>
            <mi>
             a
            </mi>
            <mi>
             n
            </mi>
            <mi>
             d
            </mi>
            <mo>
             ⋅
            </mo>
            <mo>
             (
            </mo>
            <msup>
             <mi>
              P
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo>
             −
            </mo>
            <msup>
             <mi>
              X
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo>
             )
            </mo>
            <mo>
             +
            </mo>
            <msub>
             <mi>
              c
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <mo>
             ⋅
            </mo>
            <mi>
             r
            </mi>
            <mi>
             a
            </mi>
            <mi>
             n
            </mi>
            <mi>
             d
            </mi>
            <mo>
             ⋅
            </mo>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              P
             </mi>
             <mi>
              G
             </mi>
            </msub>
            <mo>
             −
            </mo>
            <msup>
             <mi>
              X
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo>
             )
            </mo>
           </mrow>
           <annotation encoding="application/x-tex">
            v^{(j)}=w\cdot v_0+c_1\cdot rand\cdot (P^{(j)}-X^{(j)})+c_2\cdot rand\cdot(P_G-X^{(j)}) 
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.938em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.59445em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.59445em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 注：rand是(0,1)的随机数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             v
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           v_0
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>代表上一次粒子的速度。<br> 第一部分为自身惯性因子，因为下一次的迭代次数保留了上一次的速度信息；<br> 第二个部分为自身最优因子，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msup>
             <mi>
              P
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{P^{(j)}}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.13889em; color: blue;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em; color: blue;">j</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span>为第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            j
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个因子在之前所有迭代次数中自适应度最高的位置，可以理解为历史上自身离食物最近的位置。<br> 第三部分为社会因子，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msub>
             <mi>
              P
             </mi>
             <mi>
              G
             </mi>
            </msub>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{P_G}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.13889em; color: blue;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>为种群在之前所有迭代次数中自适应度最高的位置，可以理解为历史上所有粒子离食物最近的位置中的最近的一个。<br> 一般情况下，取<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            w
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             c
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             c
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo>
            =
           </mo>
           <mn>
            2
           </mn>
          </mrow>
          <annotation encoding="application/x-tex">
           w=1,c_1=c_2=2
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span>，当种群规模较大时，可以让<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            w
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           w
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>的值随迭代次数减小以增加收敛速度。<br> 【step2】按照step1的速度公式计算下一次的速度，并计算下一次的粒子位置。对于第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            j
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个粒子，第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            k
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <annotation encoding="application/x-tex">
           k+1
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>次迭代（第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            k
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <annotation encoding="application/x-tex">
           k+1
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>代）的位置<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msubsup>
             <mi>
              X
             </mi>
             <mrow>
              <mi>
               k
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{X_{k+1}^{(j)}}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.40444em; vertical-align: -0.359639em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.07847em; color: blue;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="margin-right: 0.03148em; color: blue;">k</span><span class="mbin mtight" style="color: blue;">+</span><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em; color: blue;">j</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>与第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            k
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           k
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span></span></span></span></span>次迭代的位置<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msubsup>
             <mi>
              X
             </mi>
             <mi>
              K
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{X_K^{(j)}}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.07847em; color: blue;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mathit mtight" style="margin-right: 0.07153em; color: blue;">K</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em; color: blue;">j</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>与速度<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msubsup>
             <mi>
              v
             </mi>
             <mi>
              k
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               k
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{v_k^{(k+1)}}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.03588em; color: blue;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mathit mtight" style="margin-right: 0.03148em; color: blue;">k</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em; color: blue;">k</span><span class="mbin mtight" style="color: blue;">+</span><span class="mord mtight" style="color: blue;">1</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>关系为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <msubsup>
             <mi>
              X
             </mi>
             <mrow>
              <mi>
               k
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo>
             =
            </mo>
            <msubsup>
             <mi>
              X
             </mi>
             <mi>
              k
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo>
             +
            </mo>
            <msubsup>
             <mi>
              v
             </mi>
             <mi>
              k
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
            <mo>
             ⋅
            </mo>
            <mi>
             d
            </mi>
            <mi>
             t
            </mi>
           </mrow>
           <annotation encoding="application/x-tex">
            X^{(j)}_{k+1}=X^{(j)}_{k}+v_k^{(j+1)}\cdot dt
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.40444em; vertical-align: -0.359639em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span></span></span><br> 其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <mrow>
             <mi>
              d
             </mi>
             <mi>
              t
             </mi>
            </mrow>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{dt}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">d</span><span class="mord mathit" style="color: blue;">t</span></span></span></span></span></span>是仿真间隔，一般情况下可以取1，如果希望仿真得慢一点，搜索平滑一点，可以适当减小<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <mrow>
             <mi>
              d
             </mi>
             <mi>
              t
             </mi>
            </mrow>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{dt}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord" style="color: blue;"><span class="mord mathit" style="color: blue;">d</span><span class="mord mathit" style="color: blue;">t</span></span></span></span></span></span>。<br> 【step3】计算每个粒子的自适应度<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <msubsup>
             <mi>
              F
             </mi>
             <mrow>
              <mi>
               k
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msubsup>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{F^{(j)}_{k+1}}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.40444em; vertical-align: -0.359639em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.13889em; color: blue;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mathit mtight" style="margin-right: 0.03148em; color: blue;">k</span><span class="mbin mtight" style="color: blue;">+</span><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em; color: blue;">j</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，为了计算出step1公式中的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mstyle mathcolor="blue">
            <mrow>
             <msup>
              <mi>
               P
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                j
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mi mathvariant="normal">
              和
             </mi>
             <msub>
              <mi>
               P
              </mi>
              <mi>
               G
              </mi>
             </msub>
            </mrow>
           </mstyle>
          </mrow>
          <annotation encoding="application/x-tex">
           \color{blue}{P^{(j)}和P_G}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.038em; vertical-align: -0.15em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.13889em; color: blue;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mopen mtight" style="color: blue;">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em; color: blue;">j</span><span class="mclose mtight" style="color: blue;">)</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback" style="color: blue;">和</span><span class="mord" style="color: blue;"><span class="mord mathit" style="margin-right: 0.13889em; color: blue;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mathit mtight" style="color: blue;">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>。为了方便起见，我们记前k次计算得到了的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           P_G
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msubsup>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              k
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           P_G^{(k)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，则第k+1次迭代中我们将适应度最高的粒子位置记为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msubsup>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              k
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           P_G^{(k+1)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，则最终的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           P_G
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <msub>
             <mi>
              P
             </mi>
             <mi>
              G
             </mi>
            </msub>
            <mo>
             =
            </mo>
            <mrow>
             <mo fence="true">
              {
             </mo>
             <mtable>
              <mtr>
               <mtd>
                <mstyle scriptlevel="0" displaystyle="false">
                 <mrow>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    G
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     k
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mi mathvariant="normal">
                   ，
                  </mi>
                  <mspace width="2em"></mspace>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    G
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     k
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                  <mo>
                   &amp;gt;
                  </mo>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    G
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     k
                    </mi>
                    <mo>
                     +
                    </mo>
                    <mn>
                     1
                    </mn>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </mstyle>
               </mtd>
              </mtr>
              <mtr>
               <mtd>
                <mstyle scriptlevel="0" displaystyle="false">
                 <mrow>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    G
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     k
                    </mi>
                    <mo>
                     +
                    </mo>
                    <mn>
                     1
                    </mn>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mi mathvariant="normal">
                   ，
                  </mi>
                  <mspace width="1em"></mspace>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    G
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     k
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                  <mo>
                   &amp;lt;
                  </mo>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    G
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     k
                    </mi>
                    <mo>
                     +
                    </mo>
                    <mn>
                     1
                    </mn>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </mstyle>
               </mtd>
              </mtr>
             </mtable>
            </mrow>
           </mrow>
           <annotation encoding="application/x-tex">
            P_G=\begin{cases}P_G^{(k)}，\qquad F(P_G^{(k)})&amp;gt;F(P_G^{(k+1)}) \\[2ex]P_G^{(k+1)}，\quad F(P_G^{(k)})&amp;lt;F(P_G^{(k+1)}) \end{cases}
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.8156em; vertical-align: -1.6578em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.49999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.30002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.1578em;"><span class="" style="top: -4.1578em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.819em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.6578em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 同样，我们记前k次计算得到的第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            j
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个粒子的位置为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msubsup>
            <mi>
             P
            </mi>
            <mi>
             k
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           P^{(j)}_{k}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，第k+1次计算得到的第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            j
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           j
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个粒子的位置为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msubsup>
            <mi>
             P
            </mi>
            <mrow>
             <mi>
              k
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           P^{(j)}_{k+1}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.40444em; vertical-align: -0.359639em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，则最终的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msup>
            <mi>
             P
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
          </mrow>
          <annotation encoding="application/x-tex">
           P^{(j)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
         <math>
          <semantics>
           <mrow>
            <msup>
             <mi>
              P
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mi>
               j
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </msup>
            <mo>
             =
            </mo>
            <mrow>
             <mo fence="true">
              {
             </mo>
             <mtable>
              <mtr>
               <mtd>
                <mstyle scriptlevel="0" displaystyle="false">
                 <mrow>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    k
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     j
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mi mathvariant="normal">
                   ，
                  </mi>
                  <mspace width="1em"></mspace>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    k
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     j
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                  <mo>
                   &amp;gt;
                  </mo>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mrow>
                    <mi>
                     k
                    </mi>
                    <mo>
                     +
                    </mo>
                    <mn>
                     1
                    </mn>
                   </mrow>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     j
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </mstyle>
               </mtd>
              </mtr>
              <mtr>
               <mtd>
                <mstyle scriptlevel="0" displaystyle="false">
                 <mrow>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mrow>
                    <mi>
                     k
                    </mi>
                    <mo>
                     +
                    </mo>
                    <mn>
                     1
                    </mn>
                   </mrow>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     j
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mi mathvariant="normal">
                   ，
                  </mi>
                  <mspace width="1em"></mspace>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mi>
                    k
                   </mi>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     j
                    </mi>
                    <mo>
                     )
                    </mo>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                  <mo>
                   &amp;lt;
                  </mo>
                  <mi>
                   F
                  </mi>
                  <mo>
                   (
                  </mo>
                  <msubsup>
                   <mi>
                    P
                   </mi>
                   <mrow>
                    <mi>
                     k
                    </mi>
                    <mo>
                     +
                    </mo>
                    <mn>
                     1
                    </mn>
                   </mrow>
                   <mrow>
                    <mo>
                     (
                    </mo>
                    <mi>
                     j
                    </mi>
                   </mrow>
                  </msubsup>
                  <mo>
                   )
                  </mo>
                 </mrow>
                </mstyle>
               </mtd>
              </mtr>
             </mtable>
            </mrow>
           </mrow>
           <annotation encoding="application/x-tex">
            P^{(j)}=\begin{cases}P_{k}^{(j)}，\quad F(P_{k}^{(j)})&amp;gt;F(P_{k+1}^{(j)}) \\[2ex]P_{k+1}^{(j)}，\quad F(P_{k}^{(j)})&amp;lt;F(P_{k+1}^{(j}) \end{cases}
           </annotation>
          </semantics>
         </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.938em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.8156em; vertical-align: -1.6578em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.49999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.30002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.1578em;"><span class="" style="top: -4.1578em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.819em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.6578em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 【step4】更新每个粒子的信息。<br> 由于我们在step2的位置迭代中已经更新过粒子的位置信息，在step1中的速度迭代中已经更新过粒子的速度信息，而在step3中又更新了每个粒子的历史最优位置<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msup>
            <mi>
             P
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
          </mrow>
          <annotation encoding="application/x-tex">
           P^{(j)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>及种群最优位置<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           P_G
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，因此实际上如果仅需要知道最优解的情况下我们不需要做这一步。<br> 但如果需要作出参数随迭代次数的改变的图的话，每次迭代产生最优解<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msubsup>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              k
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
          </mrow>
          <annotation encoding="application/x-tex">
           P_G^{(k)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span></span>及最优适应度<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            F
           </mi>
           <mo>
            (
           </mo>
           <msubsup>
            <mi>
             P
            </mi>
            <mi>
             G
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              k
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msubsup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           F(P_G^{(k)})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>需要用数组保存下来。</font></font></p> 
  <h2><a id="font_colorcany13_42"></a><font color="cany">1.3.算法举例</font></h2> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>根据以上的算法步骤，本人编写了一段粒子群算法的MATLAB代码，这个代码很简单，是无约束问题下的全局粒子群算法。全局粒子群算法收敛速度快，占用内存小，但是容易陷入局部最优解，每次迭代的最优解可能存在细微差异，当然如果这个无约束问题本身是单解的话，这个差异会随着种群规模的扩大和迭代次数增加而逐渐消除。</p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>Pg<span class="token punctuation">,</span>fmin<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PSO</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>dimension<span class="token punctuation">,</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>xmax<span class="token punctuation">,</span>xmin<span class="token punctuation">,</span>vmax<span class="token punctuation">,</span>vmin<span class="token punctuation">)</span>
<span class="token operator">%</span>全局粒子群算法<span class="token punctuation">,</span>f为目标函数<span class="token punctuation">,</span>dimension为维度<span class="token punctuation">,</span>n为代数<span class="token punctuation">,</span>m为种群规模
<span class="token operator">%</span>位置限幅为<span class="token punctuation">[</span>xmin<span class="token punctuation">,</span>xmax<span class="token punctuation">]</span>，速度限幅为<span class="token punctuation">[</span>vmin<span class="token punctuation">,</span>vmax<span class="token punctuation">]</span>
    Savef<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    SaveData<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>记录<span class="token number">11</span>代种群的位置
    w<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>c1<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>c2<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token operator">%</span>速度惯性系数
    dt<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">;</span><span class="token operator">%</span>位移仿真间隔
    v<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>初始速度为<span class="token number">0</span>
    X<span class="token operator">=</span><span class="token punctuation">(</span>xmax<span class="token operator">-</span>xmin<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">rand</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">)</span><span class="token operator">+</span>xmin<span class="token punctuation">;</span><span class="token operator">%</span>初始位置满足<span class="token punctuation">(</span><span class="token operator">-</span>xmax<span class="token punctuation">,</span>xmax<span class="token punctuation">)</span>内均匀分布
    P<span class="token operator">=</span>X<span class="token punctuation">;</span><span class="token operator">%</span>P为每个粒子每代的最优位置
    last_f<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>fmin<span class="token punctuation">,</span>min_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>last_f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>Pg为所有代中的最优位置 
    Pg<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>min_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Savef</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>fmin<span class="token punctuation">;</span>
    N<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>n
        v<span class="token operator">=</span>w<span class="token operator">*</span>v<span class="token operator">+</span>c1<span class="token operator">*</span>rand<span class="token operator">*</span><span class="token punctuation">(</span>P<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token operator">+</span>c2<span class="token operator">*</span>rand<span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Pg<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v<span class="token operator">=</span><span class="token punctuation">(</span>v<span class="token operator">&gt;</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>vmax<span class="token operator">+</span><span class="token punctuation">(</span>v<span class="token operator">&gt;=</span>vmin <span class="token operator">&amp;</span> v<span class="token operator">&lt;=</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>v<span class="token operator">+</span><span class="token punctuation">(</span>v<span class="token operator">&lt;</span>vmin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>vmin<span class="token punctuation">;</span>
        X<span class="token operator">=</span>X<span class="token operator">+</span>v<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        X<span class="token operator">=</span><span class="token punctuation">(</span>X<span class="token operator">&gt;</span>xmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>xmax<span class="token operator">+</span><span class="token punctuation">(</span>X<span class="token operator">&gt;=</span>xmin <span class="token operator">&amp;</span> X<span class="token operator">&lt;=</span>xmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>X<span class="token operator">+</span><span class="token punctuation">(</span>X<span class="token operator">&lt;</span>xmin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>xmin<span class="token punctuation">;</span>
        new_f<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>新的目标函数值
        update_j<span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span>new_f<span class="token operator">&lt;</span>last_f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">P</span><span class="token punctuation">(</span>update_j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>update_j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>修正每个粒子的历史最优值
        <span class="token punctuation">[</span>new_fmin<span class="token punctuation">,</span>min_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>new_f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        new_Pg<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>min_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Pg<span class="token operator">=</span><span class="token punctuation">(</span>new_fmin<span class="token operator">&lt;</span>fmin<span class="token punctuation">)</span><span class="token operator">*</span>new_Pg<span class="token operator">+</span><span class="token punctuation">(</span>new_fmin<span class="token operator">&gt;=</span>fmin<span class="token punctuation">)</span><span class="token operator">*</span>Pg<span class="token punctuation">;</span>
        last_f<span class="token operator">=</span>new_f<span class="token punctuation">;</span><span class="token operator">%</span>保存当前的函数值
        fmin<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>new_fmin<span class="token punctuation">,</span>fmin<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>更新函数最小值
         <span class="token function">Savef</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>fmin<span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token function">mod</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token function">floor</span><span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">%</span>每<span class="token number">10</span>代记录一次种群参数
             N<span class="token operator">=</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">SaveData</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>X<span class="token punctuation">;</span>
         end
<span class="token operator">%</span>         w<span class="token operator">=</span>w<span class="token operator">-</span>i<span class="token operator">/</span>n<span class="token operator">*</span><span class="token number">0.7</span><span class="token operator">*</span>w<span class="token punctuation">;</span>
    end
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">10</span>
        <span class="token function">figure</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        <span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">SaveData</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SaveData</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">xlim</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span>xmax<span class="token punctuation">,</span>xmax<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token function">ylim</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span>xmax<span class="token punctuation">,</span>xmax<span class="token punctuation">]</span><span class="token punctuation">)</span>
        axis tight
    end
    figure
    <span class="token function">plot</span><span class="token punctuation">(</span>Savef<span class="token string">','</span>b<span class="token operator">-</span>'<span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span>Pg<span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span>fmin<span class="token punctuation">)</span>
end
</code></pre> 
  <p>这是一个粒子群算法的函数，可以求函数在一定范围内的极小值，下面我们来定义一个测试函数测试一下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           f
          </mi>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <msup>
           <mo>
            )
           </mo>
           <mn>
            2
           </mn>
          </msup>
          <mo>
           +
          </mo>
          <mo>
           (
          </mo>
          <msubsup>
           <mi>
            x
           </mi>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </msubsup>
          <mo>
           −
          </mo>
          <mn>
           2
          </mn>
          <msub>
           <mi>
            x
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <msup>
           <mo>
            )
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          f=(1-x_1)^2+(x_1^2-2x_2)^2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 我们很容易知道这个函数的极小值为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           x
          </mi>
          <mo>
           ∗
          </mo>
         </msup>
         <mo>
          =
         </mo>
         <mo>
          (
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          0.5
         </mn>
         <msup>
          <mo>
           )
          </mo>
          <mi>
           T
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         x^*=(1,0.5)^T
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><br> 我们将X和Y方向上的限制都设定为[-40,40]，种群规模200，仿真代数100次</p> 
  <pre><code class="prism language-c">f<span class="token operator">=</span>@<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>Pg<span class="token punctuation">,</span>fmin<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PSO</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
</code></pre> 
  <p>运行结果为：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609212808870.png#pic_center=20%C3%9720" alt="Alt"></p> 
  <table> 
   <thead> 
    <tr> 
     <th>序号</th> 
     <th>粒子群位置随迭代次数的变化</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>1</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609220418679.png#pic_center=30%C3%9730" alt="Alt"></td> 
    </tr> 
    <tr> 
     <td>2</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609220809841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td>3</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609221024283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td>4</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609221051775.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td>5</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609221119120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td>6</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609221151198.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
   </tbody> 
  </table>
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>读者们可以发现粒子群算法在迭代的过程中部分粒子甚至有反向运动的趋势，这是由于粒子的惯性速度过大导致的，在迭代点附近，惯性因子过大，会导致很长时间无法收敛到一个点，同时也很难找到相比上一次迭代更优的解。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>我们只需要随着迭代次数增加减少我们的惯性因子<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          w
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         w
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span></span></span></span></span>即可,在这里作者给出的表达式为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            w
           </mi>
           <mrow>
            <mi>
             k
            </mi>
            <mo>
             +
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mi>
            k
           </mi>
          </msub>
          <mo>
           −
          </mo>
          <mi>
           i
          </mi>
          <mi mathvariant="normal">
           /
          </mi>
          <mi>
           n
          </mi>
          <mo>
           ∗
          </mo>
          <mn>
           0.7
          </mn>
          <msub>
           <mi>
            w
           </mi>
           <mi>
            k
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          w_{k+1}=w_k-i/n*0.7w_k
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">i</span><span class="mord">/</span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.79444em; vertical-align: -0.15em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span>为当前迭代代数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          n
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         n
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span>为总代数。<br> 调用同样的测试函数，种群规模、迭代次数及其他参数不变，我们得到结果如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609222424254.png#pic_center" alt="在这里插入图片描述"><br> 和上一次对比我们可以发现fmin小了很多，即在相同的计算规模下我们的最优解更加接近于极小值，可谓一个突破性的改变，我们再看看粒子随迭代次数的分布：</p> 
  <table> 
   <thead> 
    <tr> 
     <th>序号</th> 
     <th>粒子群位置随迭代次数的变化</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>1</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609222705414.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td>2</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609222738912.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td>3</td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609222802901.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></td> 
    </tr> 
   </tbody> 
  </table>
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>可以发现粒子群的分布相比之前稳定得多，几乎全部收敛到了中心点，这便是减小惯性因子的作用。</p> 
  <h1><a id="font_color19C2PID_125"></a><font color="#19C">2.PID自整定</font></h1> 
  <h2><a id="font_colorcany21MPID_126"></a><font color="cany">2.1.基于M文件编写的PID参数自整定</font></h2> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>利用M文件可以制作一个简单的PID引擎，用于测试我们的PSO算法是否有效，书写简单PID引擎的代码可以参考如下链接：<br> <a href="https://blog.csdn.net/weixin_44044411/article/details/85891109" rel="nofollow" data-token="5d35817c647ecca7da5c9cfdab9e5d13">【MATLAB】仿真PID控制</a><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>我们仅需要在此基础上做一些改变并做成并行算法即可，当然，我们还需要设置一个自适应度函数，在自适应度函数的作用下，PSO算法会选择到我们满意的参数。在调整PID参数时，我们通常会关注响应曲线的超调、上升时间、调节时间、峰值时间等等。利用这些参数组合为评价函数，让评价函数越小，仿真得到的参数越好，以此作为解的好坏的对比依据（相当于鸟离食物的距离）为了简便起见，我们只选取了调节时间<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         t_s
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76508em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和超调量<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          σ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \sigma
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">σ</span></span></span></span></span>作为我们的比较依据，我们将评价函数设定为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             a
            </mi>
            <mi>
             c
            </mi>
            <mi>
             c
            </mi>
            <mi>
             e
            </mi>
            <mi>
             s
            </mi>
            <mi>
             s
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <mfrac>
           <msub>
            <mi>
             t
            </mi>
            <mi>
             s
            </mi>
           </msub>
           <mrow>
            <mn>
             5
            </mn>
            <mo>
             ⋅
            </mo>
            <mn>
             1
            </mn>
            <msup>
             <mn>
              0
             </mn>
             <mrow>
              <mo>
               −
              </mo>
              <mn>
               2
              </mn>
             </mrow>
            </msup>
           </mrow>
          </mfrac>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <mfrac>
           <mi>
            σ
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <msup>
             <mn>
              0
             </mn>
             <mrow>
              <mo>
               −
              </mo>
              <mn>
               4
              </mn>
             </mrow>
            </msup>
           </mrow>
          </mfrac>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_{access}=ln(\frac{t_s}{5\cdot 10^{-2}}+1)+ln(\frac{\sigma}{10^{-4}}+1)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.97808em; vertical-align: -0.686em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.29208em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.740108em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.79356em; vertical-align: -0.686em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.740108em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></span><br> 如果对该函数求导就可以发现：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mfrac>
            <mrow>
             <mi mathvariant="normal">
              ∂
             </mi>
             <mi>
              f
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="normal">
              ∂
             </mi>
             <msub>
              <mi>
               t
              </mi>
              <mi>
               s
              </mi>
             </msub>
            </mrow>
           </mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∣
            </mi>
            <msub>
             <mi>
              t
             </mi>
             <mi>
              s
             </mi>
            </msub>
            <mo>
             =
            </mo>
            <mn>
             5
            </mn>
            <mo>
             ⋅
            </mo>
            <mn>
             1
            </mn>
            <msup>
             <mn>
              0
             </mn>
             <mrow>
              <mo>
               −
              </mo>
              <mn>
               2
              </mn>
             </mrow>
            </msup>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
          <mo>
           ⋅
          </mo>
          <mn>
           5
          </mn>
          <mo>
           ⋅
          </mo>
          <mn>
           1
          </mn>
          <msup>
           <mn>
            0
           </mn>
           <mrow>
            <mo>
             −
            </mo>
            <mn>
             2
            </mn>
           </mrow>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          \frac{\partial f}{\partial t_s}_{|t_s=5\cdot 10^{-2}}=\frac{1}{2}\cdot 5\cdot 10^{-2}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.43214em; vertical-align: -1.0607em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit" style="margin-right: 0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.8143em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">5</span><span class="mbin mtight">⋅</span><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.746314em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0607em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.00744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mfrac>
            <mrow>
             <mi mathvariant="normal">
              ∂
             </mi>
             <mi>
              f
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="normal">
              ∂
             </mi>
             <mi>
              σ
             </mi>
            </mrow>
           </mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mi>
             σ
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
            <msup>
             <mn>
              0
             </mn>
             <mrow>
              <mo>
               −
              </mo>
              <mn>
               4
              </mn>
             </mrow>
            </msup>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
          <mo>
           ⋅
          </mo>
          <mn>
           1
          </mn>
          <msup>
           <mn>
            0
           </mn>
           <mrow>
            <mo>
             −
            </mo>
            <mn>
             4
            </mn>
           </mrow>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          \frac{\partial f}{\partial \sigma}_{|\sigma=10^{-4}}=\frac{1}{2}\cdot 10^{-4}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.28214em; vertical-align: -0.9107em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit" style="margin-right: 0.03588em;">σ</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit" style="margin-right: 0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.9643em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">σ</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.746314em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9107em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.00744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>因此<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            a
           </mi>
           <mi>
            c
           </mi>
           <mi>
            c
           </mi>
           <mi>
            e
           </mi>
           <mi>
            s
           </mi>
           <mi>
            s
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         f_{access}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          5
         </mn>
         <mo>
          ⋅
         </mo>
         <mn>
          1
         </mn>
         <msup>
          <mn>
           0
          </mn>
          <mrow>
           <mo>
            −
           </mo>
           <mn>
            2
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         t_s=5\cdot 10^{-2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76508em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>的调整率为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          2.5
         </mn>
         <mo>
          ×
         </mo>
         <mn>
          1
         </mn>
         <msup>
          <mn>
           0
          </mn>
          <mrow>
           <mo>
            −
           </mo>
           <mn>
            2
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         2.5×10^{-2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>，在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          σ
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <msup>
          <mn>
           0
          </mn>
          <mrow>
           <mo>
            −
           </mo>
           <mn>
            4
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \sigma=10^{-4}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span>时的调整率为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          0.5
         </mn>
         <mo>
          ×
         </mo>
         <mn>
          1
         </mn>
         <msup>
          <mn>
           0
          </mn>
          <mrow>
           <mo>
            −
           </mo>
           <mn>
            4
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         0.5×10^{-4}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span>如果将期望参数定为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
          <mo>
           ∗
          </mo>
         </msubsup>
         <mo>
          =
         </mo>
         <mn>
          5
         </mn>
         <mo>
          ⋅
         </mo>
         <mn>
          1
         </mn>
         <msup>
          <mn>
           0
          </mn>
          <mrow>
           <mo>
            −
           </mo>
           <mn>
            2
           </mn>
          </mrow>
         </msup>
         <mo separator="true">
          ,
         </mo>
         <msup>
          <mi>
           σ
          </mi>
          <mo>
           ∗
          </mo>
         </msup>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <msup>
          <mn>
           0
          </mn>
          <mrow>
           <mo>
            −
           </mo>
           <mn>
            4
           </mn>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         t_s^*=5\cdot 10^{-2},\sigma ^*=10^{-4}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.935696em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span>则评价函数在小于任意一个参数的情况下就会下降，但是下降的速度会越来越大，而大于任意一个参数就会上升，但上升速率会越来越慢。由于两个参数均为正数，因此下降的速率不会大于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             f
            </mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <msub>
             <mi>
              t
             </mi>
             <mi>
              s
             </mi>
            </msub>
           </mrow>
          </mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∣
           </mi>
           <msub>
            <mi>
             t
            </mi>
            <mi>
             s
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <mn>
            0
           </mn>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial f}{\partial t_s}_{|t_s=0}=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.60202em; vertical-align: -0.6698em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.932216em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.44611em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.0302em;"><span class="" style="top: -2.2052em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.6698em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             f
            </mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             σ
            </mi>
           </mrow>
          </mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            σ
           </mi>
           <mo>
            =
           </mo>
           <mn>
            0
           </mn>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial f}{\partial \sigma}_{|\sigma=0}=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.50192em; vertical-align: -0.5697em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.932216em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">σ</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.44611em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1303em;"><span class="" style="top: -2.3053em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">σ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5697em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，而上升的速率可以无限小。若将评价函数小视为自适应度高，则调整过后的系统参数总是在期望值附近调整，并尽量满足$所有参数都小于期望值的情况。因为在期望值附近上升速率是越来越慢而下降速率是越来越快的，而参数最小只能取到0。因此，有多个参数大于期望值而有少个参数小于期望值的和会比有少个参数大于期望值而多个参数小于期望值的和要大得多。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>写好评价函数之后，我们可以设自适应度函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          F
         </mi>
         <mo>
          =
         </mo>
         <mo>
          −
         </mo>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            a
           </mi>
           <mi>
            c
           </mi>
           <mi>
            c
           </mi>
           <mi>
            e
           </mi>
           <mi>
            s
           </mi>
           <mi>
            s
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         F=-f_{access}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，因为我们的评价函数是越小越好的，而自适应度是越高越好。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>根据1.2的算法步骤我们可以编写出粒子群算法，而PID并行仿真引擎的编写需要参考上文提供的连接。（simulink的PID仿真请参考下一小节2.2.）粒子群算法每迭代出一代的参数(PSO.m)，就把这一代里面最好的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           P
          </mi>
          <mi>
           G
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         P_G
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>返还给PID引擎进行仿真(PID_sim.m)，再编写一个参数自识别的程序(parameter_cal.m)，将需要识别的指标（调节时间、超调）计算出来，传递给<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            a
           </mi>
           <mi>
            c
           </mi>
           <mi>
            c
           </mi>
           <mi>
            e
           </mi>
           <mi>
            s
           </mi>
           <mi>
            s
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         f_{access}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>进行计算(PID_access.m)，将计算得到的参数</p> 
  <p><font color="red">【PID_sim.m】（PID并行仿真引擎）</font></p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>f_infty<span class="token punctuation">,</span>tp<span class="token punctuation">,</span>ts<span class="token punctuation">,</span>sigma<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PID_sim</span><span class="token punctuation">(</span>kp<span class="token punctuation">,</span>ki<span class="token punctuation">,</span>kd<span class="token punctuation">,</span>debug<span class="token punctuation">)</span>
    <span class="token operator">%</span>kp<span class="token punctuation">,</span>ki<span class="token punctuation">,</span>kd为PID参数<span class="token punctuation">,</span>T0为采样时间<span class="token punctuation">,</span>total_t为仿真时间
    Tt<span class="token operator">=</span><span class="token number">5e-4</span><span class="token punctuation">;</span><span class="token operator">%</span>仿真采样周期
    T0<span class="token operator">=</span><span class="token number">1e-2</span><span class="token punctuation">;</span><span class="token operator">%</span>控制采样周期
    Tf<span class="token operator">=</span><span class="token number">1e-3</span><span class="token punctuation">;</span><span class="token operator">%</span>微分环节的滤波器系数
    alp<span class="token operator">=</span>Tf<span class="token operator">/</span><span class="token punctuation">(</span>Tt<span class="token operator">+</span>Tf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    total_t<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    N<span class="token operator">=</span><span class="token function">floor</span><span class="token punctuation">(</span>total_t<span class="token operator">/</span>Tt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>样本总数
    M<span class="token operator">=</span><span class="token function">numel</span><span class="token punctuation">(</span>kp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>仿真序列数
    kp<span class="token operator">=</span><span class="token function">reshape</span><span class="token punctuation">(</span>kp<span class="token punctuation">,</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ki<span class="token operator">=</span><span class="token function">reshape</span><span class="token punctuation">(</span>ki<span class="token punctuation">,</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    kd<span class="token operator">=</span><span class="token function">reshape</span><span class="token punctuation">(</span>kd<span class="token punctuation">,</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sys<span class="token operator">=</span><span class="token function">tf</span><span class="token punctuation">(</span><span class="token number">0.998</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.021</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>建立被控对象传递函数，即式<span class="token number">4.1</span>
    dsys<span class="token operator">=</span><span class="token function">c2d</span><span class="token punctuation">(</span>sys<span class="token punctuation">,</span>Tt<span class="token punctuation">,</span><span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">%</span>离散化
    <span class="token punctuation">[</span>num<span class="token punctuation">,</span>den<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">tfdata</span><span class="token punctuation">(</span>dsys<span class="token punctuation">,</span><span class="token string">'v'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>
    e_1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">%</span>前一时刻的偏差      
    Ee<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token operator">%</span>累积偏差
    u_1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">%</span>前一时刻的控制量
    y_1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token operator">%</span>前一时刻的输出
    ud_1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token operator">%</span>前一时刻的微分输出
    <span class="token operator">%</span>预分配内存
    r<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">;</span>
    y<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    u<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span>N
        <span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span><span class="token function">den</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>y_1<span class="token operator">+</span><span class="token function">num</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>u_1<span class="token operator">+</span><span class="token function">num</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>系统响应输出序列
        e0<span class="token operator">=</span>r<span class="token operator">-</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>误差信号
        ud<span class="token operator">=</span>alp<span class="token punctuation">.</span><span class="token operator">*</span>ud_1<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>alp<span class="token punctuation">)</span><span class="token operator">/</span>T0<span class="token punctuation">.</span><span class="token operator">*</span>kd<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span>e0<span class="token operator">-</span>e_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span>kp<span class="token punctuation">.</span><span class="token operator">*</span>e0<span class="token operator">+</span>T0<span class="token operator">*</span>ki<span class="token punctuation">.</span><span class="token operator">*</span>Ee<span class="token operator">+</span>ud<span class="token punctuation">;</span> <span class="token operator">%</span>系统PID控制器输出序列
        Ee<span class="token operator">=</span>Ee<span class="token operator">+</span>e0<span class="token punctuation">;</span>    <span class="token operator">%</span>误差的累加和
        u_1<span class="token operator">=</span><span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>    	<span class="token operator">%</span>前一个的控制器输出值
        y_1<span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>    	<span class="token operator">%</span>前一个的系统响应输出值
        e_1<span class="token operator">=</span>e0<span class="token punctuation">;</span>		<span class="token operator">%</span>前一个误差信号的值
        ud_1<span class="token operator">=</span>ud<span class="token punctuation">;</span>
    end
    <span class="token keyword">if</span> debug <span class="token operator">%</span>非调试模式下不显示也不打印图像
        <span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>total_t<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span>
    end
    <span class="token punctuation">[</span>f_infty<span class="token punctuation">,</span>tp<span class="token punctuation">,</span>ts<span class="token punctuation">,</span>sigma<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">parameter_cal</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>Tt<span class="token punctuation">,</span><span class="token number">2e-2</span><span class="token punctuation">,</span>debug<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>取得阶跃响应指标
end
</code></pre> 
  <p><font color="red">【parameter_cal.m】（计算仿真曲线参数）</font></p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>f_infty<span class="token punctuation">,</span>tp<span class="token punctuation">,</span>ts<span class="token punctuation">,</span>sigma<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">parameter_cal</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>T0<span class="token punctuation">,</span>delt_err<span class="token punctuation">,</span>debug<span class="token punctuation">)</span>
<span class="token operator">%</span>y是系统输出序列
<span class="token operator">%</span>T0是采样时间，可以结合时间序列点序号算出实际时间
<span class="token operator">%</span>delt_err是调节时间的误差精度
    M<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>N<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>M为运算维度，N为时间序列长度
    f_infty<span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>稳态值序列
    err<span class="token operator">=</span>y<span class="token operator">-</span>f_infty<span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>通过稳态值计算误差序列
    ferr<span class="token operator">=</span><span class="token function">fliplr</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>倒序并取绝对值
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>ts_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>ferr<span class="token operator">&gt;</span>delt_err<span class="token operator">*</span>f_infty<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ts_i<span class="token operator">=</span>N<span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>ts_i<span class="token punctuation">;</span>
    ts<span class="token operator">=</span>ts_i<span class="token operator">*</span>T0<span class="token punctuation">;</span><span class="token operator">%</span>调节时间
    <span class="token punctuation">[</span>fp<span class="token punctuation">,</span>tp<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>峰值和函数峰值
    tp<span class="token operator">=</span>tp<span class="token operator">*</span>T0<span class="token punctuation">;</span>
    <span class="token function">tp</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>fp<span class="token operator">-</span>f_infty<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1e-5</span><span class="token punctuation">)</span><span class="token operator">=</span>NaN<span class="token punctuation">;</span> <span class="token operator">%</span>过阻尼无超调，没有峰值时间
    sigma<span class="token operator">=</span><span class="token punctuation">(</span>fp<span class="token operator">-</span>f_infty<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">/</span>f_infty<span class="token punctuation">;</span>
    <span class="token keyword">if</span> debug <span class="token operator">&amp;&amp;</span> M<span class="token operator">==</span><span class="token number">1</span> <span class="token operator">%</span>非调试模式下不显示
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'系统稳态值为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>f_infty<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'系统超调量为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>sigma<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>tp<span class="token punctuation">)</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'系统不存在峰值时间'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'系统峰值时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>tp<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        end
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'系统的调节时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    end
end
</code></pre> 
  <p><font color="red">【PID_access.m】（根据参数得出评价度的函数，程序中为评价度越低越好）</font></p> 
  <pre><code class="prism language-c">function y<span class="token operator">=</span><span class="token function">PID_access</span><span class="token punctuation">(</span>para<span class="token punctuation">)</span>
<span class="token operator">%</span>PID调节性能的指标参数
kp<span class="token operator">=</span><span class="token function">para</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ki<span class="token operator">=</span><span class="token function">para</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kd<span class="token operator">=</span><span class="token function">para</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">,</span>ts<span class="token punctuation">,</span>sigma<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PID_sim</span><span class="token punctuation">(</span>kp<span class="token punctuation">,</span>ki<span class="token punctuation">,</span>kd<span class="token punctuation">,</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span>
y<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span>ts<span class="token operator">/</span><span class="token number">5e-2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">log</span><span class="token punctuation">(</span>sigma<span class="token operator">/</span><span class="token number">1e-2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
</code></pre> 
  <p><font color="red">【PSO.m】（PSO算法优化函数）</font></p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>Pg<span class="token punctuation">,</span>fmin<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PSO</span><span class="token punctuation">(</span>dimension<span class="token punctuation">,</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span>
<span class="token operator">%</span>全局粒子群算法<span class="token punctuation">,</span>f为目标函数<span class="token punctuation">,</span>dimension为维度<span class="token punctuation">,</span>n为代数<span class="token punctuation">,</span>m为种群规模
    w<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>c1<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>c2<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token operator">%</span>速度惯性系数
    sigma_data<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ts_data<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dt<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">;</span><span class="token operator">%</span>位移仿真间隔
    vmax<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>速度限幅
    xmax<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span>位置限幅
    xmin<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    v<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>初始速度为<span class="token number">0</span>
    X<span class="token operator">=</span><span class="token punctuation">(</span>xmax<span class="token operator">-</span>xmin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">rand</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">)</span><span class="token operator">+</span>xmin<span class="token punctuation">;</span><span class="token operator">%</span>初始位置满足<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span>xmax<span class="token punctuation">)</span>内均匀分布
    P<span class="token operator">=</span>X<span class="token punctuation">;</span><span class="token operator">%</span>P为每个粒子每代的最优位置
    last_f<span class="token operator">=</span><span class="token function">PID_access</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>fmin<span class="token punctuation">,</span>min_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>last_f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>Pg为所有代中的最优位置 
    Pg<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>min_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    N<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>n
        v<span class="token operator">=</span>w<span class="token operator">*</span>v<span class="token operator">+</span>c1<span class="token operator">*</span>rand<span class="token operator">*</span><span class="token punctuation">(</span>P<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token operator">+</span>c2<span class="token operator">*</span>rand<span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Pg<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v<span class="token operator">=</span><span class="token punctuation">(</span>v<span class="token operator">&gt;</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>vmax<span class="token operator">+</span><span class="token punctuation">(</span>v<span class="token operator">&gt;=</span><span class="token operator">-</span>vmax <span class="token operator">&amp;</span> v<span class="token operator">&lt;=</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>v<span class="token operator">+</span><span class="token punctuation">(</span>v<span class="token operator">&lt;</span><span class="token operator">-</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">-</span>vmax<span class="token punctuation">)</span><span class="token punctuation">;</span>
        X<span class="token operator">=</span>X<span class="token operator">+</span>v<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        X<span class="token operator">=</span><span class="token punctuation">(</span>X<span class="token operator">&gt;</span>xmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>xmax<span class="token operator">+</span><span class="token punctuation">(</span>X<span class="token operator">&gt;=</span>xmin <span class="token operator">&amp;</span> X<span class="token operator">&lt;=</span>xmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>X<span class="token operator">+</span><span class="token punctuation">(</span>X<span class="token operator">&lt;</span>xmin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span>xmin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        new_f<span class="token operator">=</span><span class="token function">PID_access</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>新的目标函数值
        update_j<span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span>new_f<span class="token operator">&lt;</span>last_f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">P</span><span class="token punctuation">(</span>update_j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>update_j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>修正每个粒子的历史最优值
        <span class="token punctuation">[</span>new_fmin<span class="token punctuation">,</span>min_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>new_f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        new_Pg<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>min_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Pg<span class="token operator">=</span><span class="token punctuation">(</span>new_fmin<span class="token operator">&lt;</span>fmin<span class="token punctuation">)</span><span class="token operator">*</span>new_Pg<span class="token operator">+</span><span class="token punctuation">(</span>new_fmin<span class="token operator">&gt;=</span>fmin<span class="token punctuation">)</span><span class="token operator">*</span>Pg<span class="token punctuation">;</span>
        last_f<span class="token operator">=</span>new_f<span class="token punctuation">;</span><span class="token operator">%</span>保存当前的函数值
        fmin<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>new_fmin<span class="token punctuation">,</span>fmin<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>更新函数最小值
        <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">,</span>ts<span class="token punctuation">,</span>sigma<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PID_sim</span><span class="token punctuation">(</span><span class="token function">Pg</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Pg</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Pg</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>true<span class="token punctuation">)</span>
        <span class="token function">sigma_data</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">=</span>sigma<span class="token punctuation">;</span>
        <span class="token function">ts_data</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">=</span>ts<span class="token punctuation">;</span>
        hold on
    end
    <span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">,</span><span class="token string">'6'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">,</span><span class="token string">'8'</span><span class="token punctuation">,</span><span class="token string">'9'</span><span class="token punctuation">,</span><span class="token string">'10'</span><span class="token punctuation">,</span><span class="token string">'11'</span><span class="token punctuation">,</span><span class="token string">'12'</span><span class="token punctuation">,</span><span class="token string">'13'</span><span class="token punctuation">,</span><span class="token string">'14'</span><span class="token punctuation">,</span><span class="token string">'15'</span><span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'响应曲线随迭代次数的变化'</span><span class="token punctuation">)</span>
    figure
    <span class="token function">plot</span><span class="token punctuation">(</span>ts_data<span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'调节时间随迭代次数的变化'</span><span class="token punctuation">)</span>
    figure
    <span class="token function">plot</span><span class="token punctuation">(</span>sigma_data<span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'超调量随迭代次数的变化'</span><span class="token punctuation">)</span>
end
</code></pre> 
  <p><font color="red">【main.m】（主函数，从这里开始）</font></p> 
  <pre><code class="prism language-c">dimension<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>n<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>m<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span><span class="token operator">%</span>PID为<span class="token number">3</span>位参数，n是迭代次数，m为种群规模
<span class="token punctuation">[</span>Pg<span class="token punctuation">,</span>fmin<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PSO</span><span class="token punctuation">(</span>dimension<span class="token punctuation">,</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span>
</code></pre> 
  <p>仿真结果如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609235034353.png#pic_center" alt="在这里插入图片描述"><br> 注：响应曲线可能要在左上角局部放大才能获得该图像。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019060923510898.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190609235124408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>这是一个简单的一阶惯性系统的PID调参仿真，用于模拟直流电机的转速模型，可以看出直流电机的转速响应是越来越快的（调节时间越来越小），超调量在第一次就达到了0，因此系统不存在超调。</p> 
  <h2><a id="font_colorcany22PIDsimulink_276"></a><font color="cany">*2.2.复杂系统的PID自整定（基于simulink仿真）</font></h2> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>我们以双闭环直流调速系统为例来说明PSO对PID自整定参数的作用。直流调速系统由外环（转速环）和内环（电流环）构成，转速环是一个PI调节器，调节转速为期望转速，用于抵抗负载扰动、电机参数变化带来的扰动；电流环也是一个PI调节器，与转速环不同的是，电流调节器的目的是在于让电流快速跟随给定值，以获得更好的动态特性。我们以电机的启动过程为例仿真这个系统，直流电机启动时，电流首先达到容许最大值，电机以最大加速度进行加速，到达期望转速时让电流迅速减小并达到负载转矩所需电流，电机维持期望转速不变。</p> 
  <h3><a id="font_colorC2019221PSOPID_278"></a><font color="#C2019">2.2.1.PSO优化PID的过程详解</font></h3> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>下面我们设定我们需要达成的调节指标——由于启动时的电机电流会迅速上升到过载电流（允许的最大值），是一个恒定值，故会有一个电流平台，记上升到电流平台产生的超调为电流超调<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           σ
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \sigma_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，从超调回到电流平台所需的时间为电流的调节时间<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           t
          </mi>
          <mrow>
           <mi>
            s
           </mi>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         t_{si}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76508em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，最终转速稳定前的超调记为转速超调<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           σ
          </mi>
          <mi>
           n
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \sigma_n
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，转速到达稳定值区域的时间为调节时间<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           t
          </mi>
          <mrow>
           <mi>
            s
           </mi>
           <mi>
            n
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         t_{sn}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76508em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。<br> 【搭建simulink模型】<br> 双闭环调速系统的结构框图如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190610000844746.png#pic_center" alt="在这里插入图片描述"><br> 搭建simulink仿真模型如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190610000137663.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 注：上图可能不够清楚，根据以下参数搭建simulink模型，并且命名为double_circle.slx（和PSO的所有程序同名）<br> 电机的参数如下：</p> 
  <ul> 
   <li>额定电压/电流/功率：800V/2164A 1500KW</li> 
   <li>额定转速：44r/min</li> 
   <li>过载系数：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            λ
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           1.5
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda_i=1.5
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span></span></span></span></span></li> 
   <li>励磁：110V/191A</li> 
   <li>电枢电阻<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            R
           </mi>
           <mi>
            a
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          R_a
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：0.1<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="normal">
           Ω
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \Omega
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Ω</span></span></span></span></span></li> 
   <li>主回路电阻R：0.1014<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi mathvariant="normal">
           Ω
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \Omega
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Ω</span></span></span></span></span></li> 
   <li>电枢（主回路）电感L：3.25mH</li> 
   <li>变流器放大倍数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            K
           </mi>
           <mi>
            s
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          K_s
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>=80</li> 
   <li>变流器通态压降：3V</li> 
   <li>系统飞轮惯量：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mn>
           8.6
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           1
          </mn>
          <msup>
           <mn>
            0
           </mn>
           <mn>
            5
           </mn>
          </msup>
          <mi>
           N
          </mi>
          <mo>
           ⋅
          </mo>
          <msup>
           <mi>
            m
           </mi>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          8.6×10^5N\cdot m^2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">8</span><span class="mord">.</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></li> 
  </ul> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>根据工程设计方法当然可以得到一套电流和转速的PI参数，计算的相关参数为：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mo>
           [
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             n
            </mi>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             n
            </mi>
            <mi>
             I
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             I
            </mi>
           </mrow>
          </msub>
          <msub>
           <mo>
            ]
           </mo>
           <mrow>
            <mi>
             E
            </mi>
            <mi>
             N
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <mn>
           7.3660
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           1.5658
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           0.8257
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           30.2773
          </mn>
          <mo>
           ]
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          [K_{np},K_{nI},K_{ip},K_{iI}]_{EN}=[7.3660 ,1.5658 ,0.8257, 30.2773]
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05764em;">E</span><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">7</span><span class="mord">.</span><span class="mord">3</span><span class="mord">6</span><span class="mord">6</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord">6</span><span class="mord">5</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord">2</span><span class="mord">5</span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">7</span><span class="mord">7</span><span class="mord">3</span><span class="mclose">]</span></span></span></span></span></span><br> 通过仿真，我们得到的转速和电流曲线如下：</p> 
  <table> 
   <thead> 
    <tr> 
     <th>额定负载启动</th> 
     <th>空载启动</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190610003823900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190610003917916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA0NDQxMQ==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></td> 
    </tr> 
   </tbody> 
  </table>
  <p>调用我们的参数计算程序计算一下参数可以得到：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            σ
           </mi>
           <mi>
            n
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           4.07
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           1
          </mn>
          <msup>
           <mn>
            0
           </mn>
           <mrow>
            <mo>
             −
            </mo>
            <mn>
             4
            </mn>
           </mrow>
          </msup>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.7875
          </mn>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            σ
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           20.38
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.0172
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sigma_n=4.07×10^{-4}\%,t_{sn}=0.7875,\sigma_i=20.38\%,t_{si}=0.0172
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">0</span><span class="mord">7</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.05855em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">8</span><span class="mord">7</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94444em; vertical-align: -0.19444em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">8</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mord">2</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>这个参数当然是比较理想的参数，如果我们不知道工程设计方法或者说工程设计方法不适用于我们的模型时，那么就可以使用PSO整定PID参数的方法。<br> 【修改simulink模型以适应PSO的M文件调用】<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>这里需要调整的参数为转速调节器ASR的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
         <mi mathvariant="normal">
          ，
         </mi>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mi>
            I
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         K_{np}，K_{nI}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和电流调节器ACR的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            I
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         K_{ip},K_{iI}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，如果我们希望能实时调整simulink的参数进行动态仿真，我们需要直接将图中的几个比例环节依次设为符号(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            n
           </mi>
           <mi>
            I
           </mi>
          </mrow>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            p
           </mi>
          </mrow>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            I
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         K_{np},K_{nI},K_{ip},K_{iI}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>)，并在工作区实时修改这4个参数再进行仿真。如果我们要将实时调整PI参数的代码写在M文件中仿真，必须要将变量声明为全局（global），此时变量会在工作区里面，simulink就可以调用了。另存为PSO_double_circle.slx<br> 【编写辅助的M文件】<br> <strong>cal_n.m</strong>：单组PID参数仿真结果的参数计算</p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>n_sigma<span class="token punctuation">,</span>ts_n<span class="token punctuation">,</span>I_sigma<span class="token punctuation">,</span>ts_transient_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cal_n</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span>
    global Kpn Kin KpI KiI
    <span class="token operator">%</span>将simulink所需参数导入工作区，以便仿真使用
    obj_slx<span class="token operator">=</span><span class="token string">'PSO_double_circle'</span><span class="token punctuation">;</span>
    Kpn<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Kin<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KpI<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KiI<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sim</span><span class="token punctuation">(</span>obj_slx<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>对目标路径下的slx文件进行仿真
    I_data<span class="token operator">=</span>I<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>n_data<span class="token operator">=</span>n<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>time<span class="token operator">=</span>I<span class="token punctuation">.</span>time<span class="token punctuation">;</span>
    n_infty<span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">n_data</span><span class="token punctuation">(</span><span class="token function">numel</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token function">numel</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>i_max<span class="token punctuation">,</span>tr_index<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    diffI<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token function">diff</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span>电流微分
    pos<span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>diffI<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>找到电流波动较小的部分
    pos<span class="token operator">=</span><span class="token function">pos</span><span class="token punctuation">(</span>pos<span class="token operator">&gt;</span>tr_index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>排除启动时电流不变的情况
    min_pos<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    I_transient<span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">I_data</span><span class="token punctuation">(</span>min_pos<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">:</span>min_pos<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>恒流升速阶段的暂稳态电流值
    I_sigma<span class="token operator">=</span><span class="token punctuation">(</span>i_max<span class="token operator">-</span>I_transient<span class="token punctuation">)</span><span class="token operator">/</span>I_transient<span class="token punctuation">;</span>
    ts_transient_i<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>min_pos<span class="token operator">-</span>tr_index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>电流暂稳态的调节时间
    n_max<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    n_sigma<span class="token operator">=</span><span class="token punctuation">(</span>n_max<span class="token operator">-</span>n_infty<span class="token punctuation">)</span><span class="token operator">/</span>n_infty<span class="token punctuation">;</span>
    ts_n_index<span class="token operator">=</span><span class="token function">numel</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">flip</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token operator">-</span>n_infty<span class="token punctuation">)</span><span class="token operator">/</span>n_infty<span class="token operator">&gt;</span><span class="token number">2e-2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ts_n<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>ts_n_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
</code></pre> 
  <p><strong>PID_n_access.m</strong>：PID参数的仿真，以代为单位的</p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>y<span class="token punctuation">,</span>ts_n<span class="token punctuation">,</span>n_sigma<span class="token punctuation">,</span>ts_transient_i<span class="token punctuation">,</span>I_sigma<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PID_n_access</span><span class="token punctuation">(</span>parameters_list<span class="token punctuation">)</span>
    M<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>parameters_list<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算需要仿真的组数（simulink无法并行仿真）
    ts_n0<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">;</span>n_sigma0<span class="token operator">=</span><span class="token number">1e-2</span><span class="token punctuation">;</span>I_sigma0<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">;</span>ts_i0<span class="token operator">=</span><span class="token number">1e-4</span><span class="token punctuation">;</span><span class="token operator">%</span>期望值
    <span class="token operator">%</span>将simulink所需参数导入工作区，以便仿真使用
    y<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    n_sigma<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ts_n<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> sim_i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>M
        parameters<span class="token operator">=</span><span class="token function">parameters_list</span><span class="token punctuation">(</span>sim_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>n_sigma<span class="token punctuation">,</span>ts_n<span class="token punctuation">,</span>I_sigma<span class="token punctuation">,</span>ts_transient_i<span class="token punctuation">,</span>n_err<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cal_n</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">y</span><span class="token punctuation">(</span>sim_i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span>ts_n<span class="token punctuation">.</span><span class="token operator">/</span>ts_n0<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">log</span><span class="token punctuation">(</span>n_sigma<span class="token punctuation">.</span><span class="token operator">/</span>n_sigma0<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">log</span><span class="token punctuation">(</span>I_sigma<span class="token operator">/</span>I_sigma0<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">log</span><span class="token punctuation">(</span>ts_transient_i<span class="token operator">/</span>ts_i0<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">exp</span><span class="token punctuation">(</span>n_err<span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end
</code></pre> 
  <p><strong>para_cal.m</strong>：参数计算，以代为单位的</p> 
  <pre><code class="prism language-c">obj_slx<span class="token operator">=</span><span class="token string">'double_circle.slx'</span><span class="token punctuation">;</span>
<span class="token function">sim</span><span class="token punctuation">(</span>obj_slx<span class="token punctuation">)</span><span class="token punctuation">;</span>
I_data<span class="token operator">=</span>I<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>n_data<span class="token operator">=</span>n<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>time<span class="token operator">=</span>I<span class="token punctuation">.</span>time<span class="token punctuation">;</span>
I_infty<span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">I_data</span><span class="token punctuation">(</span><span class="token function">numel</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token function">numel</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
n_infty<span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">n_data</span><span class="token punctuation">(</span><span class="token function">numel</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token function">numel</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>i_max<span class="token punctuation">,</span>tr_index<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
diffI<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token function">diff</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span>电流微分
pos<span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>diffI<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>找到电流波动较小的部分
pos<span class="token operator">=</span><span class="token function">pos</span><span class="token punctuation">(</span>pos<span class="token operator">&gt;</span>tr_index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>排除启动时电流不变的情况
min_pos<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
I_transient<span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">I_data</span><span class="token punctuation">(</span>min_pos<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">:</span>min_pos<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>恒流升速阶段的暂稳态电流值
I_sigma<span class="token operator">=</span><span class="token punctuation">(</span>i_max<span class="token operator">-</span>I_transient<span class="token punctuation">)</span><span class="token operator">/</span>I_transient<span class="token punctuation">;</span>
<span class="token keyword">if</span> I_sigma<span class="token operator">&lt;</span><span class="token number">1e-4</span>
    tr_i<span class="token operator">=</span>NaN<span class="token punctuation">;</span>    
<span class="token keyword">else</span>
    tr_i<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>tr_index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>电流的上升时间
end
ts_transient_i<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>min_pos<span class="token operator">-</span>tr_index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>电流暂稳态的调节时间
ts_i_index<span class="token operator">=</span><span class="token function">numel</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">flip</span><span class="token punctuation">(</span>I_data<span class="token punctuation">)</span><span class="token operator">-</span>I_infty<span class="token punctuation">)</span><span class="token operator">/</span>I_infty<span class="token operator">&gt;</span><span class="token number">2e-2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ts_i<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>ts_i_index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>转速稳态时电流的调节时间
<span class="token punctuation">[</span>n_max<span class="token punctuation">,</span>tr_index<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
n_sigma<span class="token operator">=</span><span class="token punctuation">(</span>n_max<span class="token operator">-</span>n_infty<span class="token punctuation">)</span><span class="token operator">/</span>n_infty<span class="token punctuation">;</span>
<span class="token operator">%</span>参数展示
<span class="token operator">%</span>转速参数展示
<span class="token keyword">if</span> n_sigma<span class="token operator">&lt;</span><span class="token number">1e-4</span>
    tr_n<span class="token operator">=</span>NaN<span class="token punctuation">;</span>
<span class="token keyword">else</span>
    tr_n<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>tr_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
ts_n_index<span class="token operator">=</span><span class="token function">numel</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">flip</span><span class="token punctuation">(</span>n_data<span class="token punctuation">)</span><span class="token operator">-</span>n_infty<span class="token punctuation">)</span><span class="token operator">/</span>n_infty<span class="token operator">&gt;</span><span class="token number">2e-2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ts_n<span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span>ts_n_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>tr_n<span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'转速无超调'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'转速上升时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>tr_n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'转速超调量为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>n_sigma<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
end
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'转速调节时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>ts_n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">%</span>电流参数展示
<span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>tr_i<span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'电流无超调'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'电流上升时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>tr_i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'电流超调量为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>I_sigma<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'电流暂稳态调节时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>ts_transient_i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
end
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'电流的最终调节时间为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>ts_i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
  <p><strong>draw.m</strong>:仅根据一组PID参数画出转速波形图</p> 
  <pre><code class="prism language-c">function <span class="token function">draw</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span>
    global Kpn Kin KpI KiI
    Kpn<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Kin<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KpI<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KiI<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sim</span><span class="token punctuation">(</span><span class="token string">'PSO_double_circle'</span><span class="token punctuation">)</span>
    n_data<span class="token operator">=</span>n<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>time<span class="token operator">=</span>n<span class="token punctuation">.</span>time<span class="token punctuation">;</span><span class="token operator">%</span>获取转速序列及对应时刻
    <span class="token function">plot</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span>n_data<span class="token punctuation">)</span>
</code></pre> 
  <p><strong>draw_n_I.m</strong>:根据一组PID参数绘制电流和转速曲线</p> 
  <pre><code class="prism language-c">function <span class="token function">draw_n_I</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span>
    global Kpn KIn Kpi KIi
    Kpn<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KIn<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Kpi<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KIi<span class="token operator">=</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sim</span><span class="token punctuation">(</span><span class="token string">'PSO_double_circle'</span><span class="token punctuation">)</span>
    n_data<span class="token operator">=</span>n<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>time<span class="token operator">=</span>n<span class="token punctuation">.</span>time<span class="token punctuation">;</span><span class="token operator">%</span>获取转速序列及对应时刻
    I_data<span class="token operator">=</span>I<span class="token punctuation">.</span>signals<span class="token punctuation">.</span>values<span class="token punctuation">;</span>
    figure
    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">)</span>
    <span class="token function">plot</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span>I_data<span class="token punctuation">,</span><span class="token string">'r-'</span><span class="token punctuation">,</span><span class="token string">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'电流波形'</span><span class="token punctuation">)</span>
    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">212</span><span class="token punctuation">)</span>
    <span class="token function">plot</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span>n_data<span class="token punctuation">,</span><span class="token string">'b-'</span><span class="token punctuation">,</span><span class="token string">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'转速波形'</span><span class="token punctuation">)</span>
end
</code></pre> 
  <p><strong>PSO.m</strong>：PSO优化程序</p> 
  <pre><code class="prism language-c">function <span class="token punctuation">[</span>Pg<span class="token punctuation">,</span>fmin<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PSO</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>xmax<span class="token punctuation">,</span>xmin<span class="token punctuation">,</span>cal_f<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
<span class="token operator">%</span>全局粒子群算法<span class="token punctuation">,</span>f为目标函数<span class="token punctuation">,</span>dimension为维度<span class="token punctuation">,</span>n为代数<span class="token punctuation">,</span>m为种群规模
    dimension<span class="token operator">=</span><span class="token function">numel</span><span class="token punctuation">(</span>xmax<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>c1<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>c2<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token operator">%</span>速度惯性系数
    sigma_data<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ts_data<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dt<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">;</span><span class="token operator">%</span>位移仿真间隔
    vmax<span class="token operator">=</span><span class="token number">0.1</span><span class="token operator">*</span><span class="token punctuation">(</span>xmax<span class="token operator">-</span>xmin<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>速度限幅
    v<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>初始速度为<span class="token number">0</span>
    X<span class="token operator">=</span><span class="token punctuation">(</span>xmax<span class="token operator">-</span>xmin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">rand</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>dimension<span class="token punctuation">)</span><span class="token operator">+</span>xmin<span class="token punctuation">;</span><span class="token operator">%</span>初始位置满足<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span>xmax<span class="token punctuation">)</span>内均匀分布
    P<span class="token operator">=</span>X<span class="token punctuation">;</span><span class="token operator">%</span>P为每个粒子每代的最优位置
    last_f<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>fmin<span class="token punctuation">,</span>min_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>last_f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>Pg为所有代中的最优位置 
    Pg<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>min_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    last_Pg<span class="token operator">=</span>Pg<span class="token punctuation">;</span>
    legend_str<span class="token operator">=</span><span class="token function">cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    legend_i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    legend_str<span class="token punctuation">{</span>legend_i<span class="token punctuation">}</span><span class="token operator">=</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">draw</span><span class="token punctuation">(</span>Pg<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>n
        v<span class="token operator">=</span>w<span class="token operator">*</span>v<span class="token operator">+</span>c1<span class="token operator">*</span>rand<span class="token operator">*</span><span class="token punctuation">(</span>P<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token operator">+</span>c2<span class="token operator">*</span>rand<span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Pg<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v<span class="token operator">=</span><span class="token punctuation">(</span>v<span class="token operator">&gt;</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>vmax<span class="token operator">+</span><span class="token punctuation">(</span>v<span class="token operator">&gt;=</span><span class="token operator">-</span>vmax <span class="token operator">&amp;</span> v<span class="token operator">&lt;=</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>v<span class="token operator">+</span><span class="token punctuation">(</span>v<span class="token operator">&lt;</span><span class="token operator">-</span>vmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">-</span>vmax<span class="token punctuation">)</span><span class="token punctuation">;</span>
        X<span class="token operator">=</span>X<span class="token operator">+</span>v<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        X<span class="token operator">=</span><span class="token punctuation">(</span>X<span class="token operator">&gt;</span>xmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>xmax<span class="token operator">+</span><span class="token punctuation">(</span>X<span class="token operator">&gt;=</span>xmin <span class="token operator">&amp;</span> X<span class="token operator">&lt;=</span>xmax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>X<span class="token operator">+</span><span class="token punctuation">(</span>X<span class="token operator">&lt;</span>xmin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span>xmin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        new_f<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>新的目标函数值
        update_j<span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span>new_f<span class="token operator">&lt;</span>last_f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">P</span><span class="token punctuation">(</span>update_j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>update_j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>修正每个粒子的历史最优值
        <span class="token punctuation">[</span>new_fmin<span class="token punctuation">,</span>min_i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>new_f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        new_Pg<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span>min_i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Pg<span class="token operator">=</span><span class="token punctuation">(</span>new_fmin<span class="token operator">&lt;</span>fmin<span class="token punctuation">)</span><span class="token operator">*</span>new_Pg<span class="token operator">+</span><span class="token punctuation">(</span>new_fmin<span class="token operator">&gt;=</span>fmin<span class="token punctuation">)</span><span class="token operator">*</span>Pg<span class="token punctuation">;</span>
        last_f<span class="token operator">=</span>new_f<span class="token punctuation">;</span><span class="token operator">%</span>保存当前的函数值
        fmin<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>new_fmin<span class="token punctuation">,</span>fmin<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>更新函数最小值
        <span class="token punctuation">[</span>sigma<span class="token punctuation">,</span>ts<span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cal_f</span><span class="token punctuation">(</span>Pg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sigma_data</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">=</span>sigma<span class="token punctuation">;</span>
        <span class="token function">ts_data</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">=</span>ts<span class="token punctuation">;</span>
        <span class="token keyword">if</span> last_Pg<span class="token operator">~</span><span class="token operator">=</span>Pg
            legend_i<span class="token operator">=</span>legend_i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            legend_str<span class="token punctuation">{</span>legend_i<span class="token punctuation">}</span><span class="token operator">=</span><span class="token function">num2str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">draw</span><span class="token punctuation">(</span>Pg<span class="token punctuation">)</span>
            hold on
        end
        last_Pg<span class="token operator">=</span>Pg<span class="token punctuation">;</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'迭代次数：'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    end
    <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">legend</span><span class="token punctuation">(</span>legend_str<span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'响应曲线随迭代次数的变化'</span><span class="token punctuation">)</span>
    <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">plot</span><span class="token punctuation">(</span>ts_data<span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'调节时间随迭代次数的变化'</span><span class="token punctuation">)</span>
    <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token function">plot</span><span class="token punctuation">(</span>sigma_data<span class="token punctuation">)</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'超调量随迭代次数的变化'</span><span class="token punctuation">)</span>
end
</code></pre> 
  <p>set_para.m（设置参数程序，从这里开始）</p> 
  <pre><code class="prism language-c">best_parameters<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8.4725</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">1.794</span><span class="token punctuation">,</span><span class="token number">56.06</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
global Kpn KIn Kpi KIi
Kpn<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>KIn<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>Kpi<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>KIi<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>m<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>xmax<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">;</span>xmin<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>cal_f<span class="token operator">=</span>@cal_n<span class="token punctuation">;</span>f<span class="token operator">=</span>@PID_n_access<span class="token punctuation">;</span>
<span class="token punctuation">[</span>Pg<span class="token punctuation">,</span>fmin<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PSO</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>xmax<span class="token punctuation">,</span>xmin<span class="token punctuation">,</span>cal_f<span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
  <p>我们将期望的参数设定为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi>
            σ
           </mi>
           <mi>
            n
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           1
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             n
            </mi>
           </mrow>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            σ
           </mi>
           <mi>
            i
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           20
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             i
            </mi>
           </mrow>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           0.005
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sigma_n^*=0,1\%,t_{sn}^*=1,\sigma_i^*=20\%,t_{si}^*=0.005
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.997em; vertical-align: -0.247em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.997em; vertical-align: -0.247em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">5</span></span></span></span></span></span>利用PSO算法构造的评价函数为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             a
            </mi>
            <mi>
             c
            </mi>
            <mi>
             c
            </mi>
            <mi>
             e
            </mi>
            <mi>
             s
            </mi>
            <mi>
             s
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <mfrac>
           <mrow>
            <mi>
             t
            </mi>
            <msub>
             <mi>
              s
             </mi>
             <mi>
              n
             </mi>
            </msub>
           </mrow>
           <mn>
            1
           </mn>
          </mfrac>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <mfrac>
           <msub>
            <mi>
             σ
            </mi>
            <mi>
             n
            </mi>
           </msub>
           <mn>
            0.001
           </mn>
          </mfrac>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <mfrac>
           <msub>
            <mi>
             σ
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mn>
            0.2
           </mn>
          </mfrac>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <mfrac>
           <mrow>
            <mi>
             t
            </mi>
            <msub>
             <mi>
              s
             </mi>
             <mi>
              i
             </mi>
            </msub>
           </mrow>
           <mn>
            0.005
           </mn>
          </mfrac>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo separator="true">
           ;
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_{access}=ln(\frac{ts_n}{1}+1)+ln(\frac{\sigma_n}{0.001}+1)+ln(\frac{\sigma_i}{0.2}+1)+ln(\frac{ts_i}{0.005}+1);
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.97808em; vertical-align: -0.686em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.29208em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">t</span><span class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.79356em; vertical-align: -0.686em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.79356em; vertical-align: -0.686em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.97808em; vertical-align: -0.686em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.29208em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">5</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">t</span><span class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">;</span></span></span></span></span></span><br> 得到的最佳参数为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mo>
           [
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             n
            </mi>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             n
            </mi>
            <mi>
             I
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            K
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             I
            </mi>
           </mrow>
          </msub>
          <msub>
           <mo>
            ]
           </mo>
           <mrow>
            <mi>
             P
            </mi>
            <mi>
             S
            </mi>
            <mi>
             O
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <mn>
           18.2613
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           73.0965
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           1.6843
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           16.5703
          </mn>
          <msub>
           <mo>
            ]
           </mo>
           <mrow>
            <mi>
             P
            </mi>
            <mi>
             S
            </mi>
            <mi>
             O
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          [K_{np},K_{nI},K_{ip},K_{iI}]_{PSO}=[18.2613,73.0965 ,1.6843,16.5703]_{PSO}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mord mathit mtight" style="margin-right: 0.05764em;">S</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">O</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mord">8</span><span class="mord">.</span><span class="mord">2</span><span class="mord">6</span><span class="mord">1</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">7</span><span class="mord">3</span><span class="mord">.</span><span class="mord">0</span><span class="mord">9</span><span class="mord">6</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">.</span><span class="mord">5</span><span class="mord">7</span><span class="mord">0</span><span class="mord">3</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mord mathit mtight" style="margin-right: 0.05764em;">S</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">O</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 下的仿真曲线如下：<br> <strong>超调量和调节时间随迭代次数变化</strong><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190824212728973.png" alt="在这里插入图片描述"><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190824212707352.png" alt="在这里插入图片描述"><br> PSO与工程设计方法电机启动曲线对比（额定负载启动）</p> 
  <table> 
   <thead> 
    <tr> 
     <th>工程设计方法</th> 
     <th>PSO方法</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190824215121545.png" alt="在这里插入图片描述"></td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190824215139143.png" alt="在这里插入图片描述"></td> 
    </tr> 
    <tr> 
     <td></td> 
     <td></td> 
    </tr> 
   </tbody> 
  </table>
  <p>通过计算程序得到的参数为：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            σ
           </mi>
           <mi>
            n
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           6.7556
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           1
          </mn>
          <msup>
           <mn>
            0
           </mn>
           <mrow>
            <mo>
             −
            </mo>
            <mn>
             4
            </mn>
           </mrow>
          </msup>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.7862
          </mn>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            σ
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           18.83
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.01341
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sigma_n=6.7556×10^{-4}\%,t_{sn}=0.7862,\sigma_i=18.83\%,t_{si}=0.01341
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">6</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span><span class="mord">5</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.05855em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">8</span><span class="mord">6</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94444em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">.</span><span class="mord">8</span><span class="mord">3</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mord">3</span><span class="mord">4</span><span class="mord">1</span></span></span></span></span></span><br> 工程设计方法的参数为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            σ
           </mi>
           <mi>
            n
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           4.07
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           1
          </mn>
          <msup>
           <mn>
            0
           </mn>
           <mrow>
            <mo>
             −
            </mo>
            <mn>
             4
            </mn>
           </mrow>
          </msup>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.7875
          </mn>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            σ
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           20.38
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.0172
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sigma_n=4.07×10^{-4}\%,t_{sn}=0.7875,\sigma_i=20.38\%,t_{si}=0.0172
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">0</span><span class="mord">7</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.05855em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">8</span><span class="mord">7</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94444em; vertical-align: -0.19444em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">8</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mord">2</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>可以发现除了最后一项指标之外，其余指标均达到了期望值要求，并且和工程设计方法得出的指标相比甚至还略优于它。</p> 
  <h3><a id="font_colorC2019222PSO_518"></a><font color="#C2019">2.2.2.在PSO优化过程中修改参数价值权重</font></h3> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>转速的超调和调节时间，电流的超调和调节时间，我们最后评估的指标除了转速无静差的基本要求外，这4项指标就是我们的评价标准，如果我们更希望牺牲某一个或多个参数去优化另一个或另一些参数时，该怎么调节我们的算法呢？<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>答案也非常简单，调节的方法有2个，一个是期望值，一个是评价函数的各项系数。这里我们用调节期望值的方法做一个示范：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>之前的期望值为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi>
            σ
           </mi>
           <mi>
            n
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           0.1
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             n
            </mi>
           </mrow>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            σ
           </mi>
           <mi>
            i
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           20
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             i
            </mi>
           </mrow>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           0.005
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sigma_n^*=0.1\%,t_{sn}^*=1,\sigma_i^*=20\%,t_{si}^*=0.005
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.997em; vertical-align: -0.247em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.997em; vertical-align: -0.247em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">5</span></span></span></span></span></span><br> 修改期望值为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi>
            σ
           </mi>
           <mi>
            n
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           10
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             n
            </mi>
           </mrow>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           0.8
          </mn>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            σ
           </mi>
           <mi>
            i
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           2
          </mn>
          <mi mathvariant="normal">
           %
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            t
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             i
            </mi>
           </mrow>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mn>
           0.0001
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sigma_n^*=10\%,t_{sn}^*=0.8,\sigma_i^*=2\%,t_{si}^*=0.0001
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.997em; vertical-align: -0.247em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.997em; vertical-align: -0.247em;"></span><span class="mord">2</span><span class="mord">%</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span></span></span></span></span></span><br> 重新仿真，对比二者的结果如下：</p> 
  <table> 
   <thead> 
    <tr> 
     <th>PSO1</th> 
     <th>PSO2</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td></td> 
     <td></td> 
    </tr> 
    <tr> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/201908242210243.png" alt="在这里插入图片描述"></td> 
     <td><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190824221033809.png" alt="在这里插入图片描述"></td> 
    </tr> 
   </tbody> 
  </table>
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>可以看出转速超调量略微增大了一些，但是转速和电流的调节时间明显缩短，电流的超调量基本不变。这一点也表明多项优化指标是相互耦合的，可以牺牲一者满足另一者，只要参数在这方面是可调的。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>需要注意的是，simulink中无法使用串行的算法，因此代码中使用时是串行的，可能仿真比较慢，请大家耐心等待（每迭代一次都会打印一次）<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="2em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \qquad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span><font color="purple">希望本文对您有帮助，谢谢阅读！</font></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e44c3c0e64.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d293c49e1e4bfe8f276695a5aa953300";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
