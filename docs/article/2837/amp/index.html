<!DOCTYPE html>
<html amp lang="en-US" i-amphtml-layout="" i-amphtml-no-boilerplate="" transformed="self;v=1">
<head><meta charset="utf-8"><style amp-runtime="" i-amphtml-version="012111242025001">html{overflow-x:hidden!important}html.i-amphtml-fie{height:100%!important;width:100%!important}html:not([amp4ads]),html:not([amp4ads]) body{height:auto!important}html:not([amp4ads]) body{margin:0!important}body{-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}html.i-amphtml-singledoc.i-amphtml-embedded{-ms-touch-action:pan-y pinch-zoom;touch-action:pan-y pinch-zoom}html.i-amphtml-fie>body,html.i-amphtml-singledoc>body{overflow:visible!important}html.i-amphtml-fie:not(.i-amphtml-inabox)>body,html.i-amphtml-singledoc:not(.i-amphtml-inabox)>body{position:relative!important}html.i-amphtml-ios-embed-legacy>body{overflow-x:hidden!important;overflow-y:auto!important;position:absolute!important}html.i-amphtml-ios-embed{overflow-y:auto!important;position:static}#i-amphtml-wrapper{overflow-x:hidden!important;overflow-y:auto!important;position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;margin:0!important;display:block!important}html.i-amphtml-ios-embed.i-amphtml-ios-overscroll,html.i-amphtml-ios-embed.i-amphtml-ios-overscroll>#i-amphtml-wrapper{-webkit-overflow-scrolling:touch!important}#i-amphtml-wrapper>body{position:relative!important;border-top:1px solid transparent!important}#i-amphtml-wrapper+body{visibility:visible}#i-amphtml-wrapper+body .i-amphtml-lightbox-element,#i-amphtml-wrapper+body[i-amphtml-lightbox]{visibility:hidden}#i-amphtml-wrapper+body[i-amphtml-lightbox] .i-amphtml-lightbox-element{visibility:visible}#i-amphtml-wrapper.i-amphtml-scroll-disabled,.i-amphtml-scroll-disabled{overflow-x:hidden!important;overflow-y:hidden!important}amp-instagram{padding:54px 0px 0px!important;background-color:#fff}amp-iframe iframe{box-sizing:border-box!important}[amp-access][amp-access-hide]{display:none}[subscriptions-dialog],body:not(.i-amphtml-subs-ready) [subscriptions-action],body:not(.i-amphtml-subs-ready) [subscriptions-section]{display:none!important}amp-experiment,amp-live-list>[update]{display:none}amp-list[resizable-children]>.i-amphtml-loading-container.amp-hidden{display:none!important}amp-list [fetch-error],amp-list[load-more] [load-more-button],amp-list[load-more] [load-more-end],amp-list[load-more] [load-more-failed],amp-list[load-more] [load-more-loading]{display:none}amp-list[diffable] div[role=list]{display:block}amp-story-page,amp-story[standalone]{min-height:1px!important;display:block!important;height:100%!important;margin:0!important;padding:0!important;overflow:hidden!important;width:100%!important}amp-story[standalone]{background-color:#000!important;position:relative!important}amp-story-page{background-color:#757575}amp-story .amp-active>div,amp-story .i-amphtml-loader-background{display:none!important}amp-story-page:not(:first-of-type):not([distance]):not([active]){transform:translateY(1000vh)!important}amp-autocomplete{position:relative!important;display:inline-block!important}amp-autocomplete>input,amp-autocomplete>textarea{padding:0.5rem;border:1px solid rgba(0,0,0,0.33)}.i-amphtml-autocomplete-results,amp-autocomplete>input,amp-autocomplete>textarea{font-size:1rem;line-height:1.5rem}[amp-fx^=fly-in]{visibility:hidden}amp-script[nodom],amp-script[sandboxed]{position:fixed!important;top:0!important;width:1px!important;height:1px!important;overflow:hidden!important;visibility:hidden}
/*# sourceURL=/css/ampdoc.css*/[hidden]{display:none!important}.i-amphtml-element{display:inline-block}.i-amphtml-blurry-placeholder{transition:opacity 0.3s cubic-bezier(0.0,0.0,0.2,1)!important;pointer-events:none}[layout=nodisplay]:not(.i-amphtml-element){display:none!important}.i-amphtml-layout-fixed,[layout=fixed][width][height]:not(.i-amphtml-layout-fixed){display:inline-block;position:relative}.i-amphtml-layout-responsive,[layout=responsive][width][height]:not(.i-amphtml-layout-responsive),[width][height][heights]:not([layout]):not(.i-amphtml-layout-responsive),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-layout-responsive){display:block;position:relative}.i-amphtml-layout-intrinsic,[layout=intrinsic][width][height]:not(.i-amphtml-layout-intrinsic){display:inline-block;position:relative;max-width:100%}.i-amphtml-layout-intrinsic .i-amphtml-sizer{max-width:100%}.i-amphtml-intrinsic-sizer{max-width:100%;display:block!important}.i-amphtml-layout-container,.i-amphtml-layout-fixed-height,[layout=container],[layout=fixed-height][height]:not(.i-amphtml-layout-fixed-height){display:block;position:relative}.i-amphtml-layout-fill,.i-amphtml-layout-fill.i-amphtml-notbuilt,[layout=fill]:not(.i-amphtml-layout-fill),body noscript>*{display:block;overflow:hidden!important;position:absolute;top:0;left:0;bottom:0;right:0}body noscript>*{position:absolute!important;width:100%;height:100%;z-index:2}body noscript{display:inline!important}.i-amphtml-layout-flex-item,[layout=flex-item]:not(.i-amphtml-layout-flex-item){display:block;position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.i-amphtml-layout-fluid{position:relative}.i-amphtml-layout-size-defined{overflow:hidden!important}.i-amphtml-layout-awaiting-size{position:absolute!important;top:auto!important;bottom:auto!important}i-amphtml-sizer{display:block!important}@supports (aspect-ratio:1/1){i-amphtml-sizer.i-amphtml-disable-ar{display:none!important}}.i-amphtml-blurry-placeholder,.i-amphtml-fill-content{display:block;height:0;max-height:100%;max-width:100%;min-height:100%;min-width:100%;width:0;margin:auto}.i-amphtml-layout-size-defined .i-amphtml-fill-content{position:absolute;top:0;left:0;bottom:0;right:0}.i-amphtml-replaced-content,.i-amphtml-screen-reader{padding:0!important;border:none!important}.i-amphtml-screen-reader{position:fixed!important;top:0px!important;left:0px!important;width:4px!important;height:4px!important;opacity:0!important;overflow:hidden!important;margin:0!important;display:block!important;visibility:visible!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:8px!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:12px!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:16px!important}.i-amphtml-unresolved{position:relative;overflow:hidden!important}.i-amphtml-select-disabled{-webkit-user-select:none!important;-ms-user-select:none!important;user-select:none!important}.i-amphtml-notbuilt,[layout]:not(.i-amphtml-element),[width][height][heights]:not([layout]):not(.i-amphtml-element),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-element){position:relative;overflow:hidden!important;color:transparent!important}.i-amphtml-notbuilt:not(.i-amphtml-layout-container)>*,[layout]:not([layout=container]):not(.i-amphtml-element)>*,[width][height][heights]:not([layout]):not(.i-amphtml-element)>*,[width][height][sizes]:not([layout]):not(.i-amphtml-element)>*{display:none}amp-img:not(.i-amphtml-element)[i-amphtml-ssr]>img.i-amphtml-fill-content{display:block}.i-amphtml-notbuilt:not(.i-amphtml-layout-container),[layout]:not([layout=container]):not(.i-amphtml-element),[width][height][heights]:not([layout]):not(.i-amphtml-element),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-element){color:transparent!important;line-height:0!important}.i-amphtml-ghost{visibility:hidden!important}.i-amphtml-element>[placeholder],[layout]:not(.i-amphtml-element)>[placeholder],[width][height][heights]:not([layout]):not(.i-amphtml-element)>[placeholder],[width][height][sizes]:not([layout]):not(.i-amphtml-element)>[placeholder]{display:block;line-height:normal}.i-amphtml-element>[placeholder].amp-hidden,.i-amphtml-element>[placeholder].hidden{visibility:hidden}.i-amphtml-element:not(.amp-notsupported)>[fallback],.i-amphtml-layout-container>[placeholder].amp-hidden,.i-amphtml-layout-container>[placeholder].hidden{display:none}.i-amphtml-layout-size-defined>[fallback],.i-amphtml-layout-size-defined>[placeholder]{position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;z-index:1}amp-img[i-amphtml-ssr]:not(.i-amphtml-element)>[placeholder]{z-index:auto}.i-amphtml-notbuilt>[placeholder]{display:block!important}.i-amphtml-hidden-by-media-query{display:none!important}.i-amphtml-element-error{background:red!important;color:#fff!important;position:relative!important}.i-amphtml-element-error:before{content:attr(error-message)}i-amp-scroll-container,i-amphtml-scroll-container{position:absolute;top:0;left:0;right:0;bottom:0;display:block}i-amp-scroll-container.amp-active,i-amphtml-scroll-container.amp-active{overflow:auto;-webkit-overflow-scrolling:touch}.i-amphtml-loading-container{display:block!important;pointer-events:none;z-index:1}.i-amphtml-notbuilt>.i-amphtml-loading-container{display:block!important}.i-amphtml-loading-container.amp-hidden{visibility:hidden}.i-amphtml-element>[overflow]{cursor:pointer;position:relative;z-index:2;visibility:hidden;display:initial;line-height:normal}.i-amphtml-layout-size-defined>[overflow]{position:absolute}.i-amphtml-element>[overflow].amp-visible{visibility:visible}template{display:none!important}.amp-border-box,.amp-border-box *,.amp-border-box :after,.amp-border-box :before{box-sizing:border-box}amp-pixel{display:none!important}amp-analytics,amp-auto-ads,amp-story-auto-ads{position:fixed!important;top:0!important;width:1px!important;height:1px!important;overflow:hidden!important;visibility:hidden}html.i-amphtml-fie>amp-analytics{position:initial!important}[visible-when-invalid]:not(.visible),form [submit-error],form [submit-success],form [submitting]{display:none}amp-accordion{display:block!important}@media (min-width:1px){:where(amp-accordion>section)>:first-child{margin:0;background-color:#efefef;padding-right:20px;border:1px solid #dfdfdf}:where(amp-accordion>section)>:last-child{margin:0}}amp-accordion>section{float:none!important}amp-accordion>section>*{float:none!important;display:block!important;overflow:hidden!important;position:relative!important}amp-accordion,amp-accordion>section{margin:0}amp-accordion:not(.i-amphtml-built)>section>:last-child{display:none!important}amp-accordion:not(.i-amphtml-built)>section[expanded]>:last-child{display:block!important}
/*# sourceURL=/css/ampshared.css*/</style><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1"><title>Android移动客户端性能测试浅谈——电量 - 有组织在!</title><link rel="preconnect" href="https://cdn.ampproject.org"><link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js"><script async="" src="https://cdn.ampproject.org/v0.js"></script><style amp-custom="">.amp-wp-enforced-sizes{max-width:100%;margin:0 auto}amp-img.amp-wp-enforced-sizes[layout="intrinsic"] > img{object-fit:contain}html{background:#0a89c0}body{background:#fff;color:#353535;font-family:Georgia,"Times New Roman",Times,Serif;font-weight:300;line-height:1.75em}p,ul{margin:0 0 1em;padding:0}a,a:visited{color:#0a89c0}a:hover,a:active,a:focus{color:#353535}.amp-wp-meta,.amp-wp-header div,.amp-wp-title,.amp-wp-tax-category,.amp-wp-footer p,.back-to-top{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue",sans-serif}.amp-wp-header{background-color:#0a89c0}.amp-wp-header div{color:#fff;font-size:1em;font-weight:400;margin:0 auto;max-width:calc(840px - 32px);padding:.875em 16px;position:relative}.amp-wp-header a{color:#fff;text-decoration:none}.amp-wp-header .amp-wp-site-icon{background-color:#fff;border:1px solid #fff;border-radius:50%;position:absolute;right:18px;top:10px}.amp-wp-article{color:#353535;font-weight:400;margin:1.5em auto;max-width:840px;overflow-wrap:break-word;word-wrap:break-word}.amp-wp-article-header{align-items:center;align-content:stretch;display:flex;flex-wrap:wrap;justify-content:space-between;margin:1.5em 16px 0}.amp-wp-title{color:#353535;display:block;flex:1 0 100%;font-weight:900;margin:0 0 .625em;width:100%}.amp-wp-meta{color:#696969;display:inline-block;flex:2 1 50%;font-size:.875em;line-height:1.5em;margin:0 0 1.5em;padding:0}.amp-wp-article-header .amp-wp-meta:last-of-type{text-align:right}.amp-wp-article-header .amp-wp-meta:first-of-type{text-align:left}.amp-wp-byline amp-img,.amp-wp-byline .amp-wp-author{display:inline-block;vertical-align:middle}.amp-wp-byline amp-img{border:1px solid #0a89c0;border-radius:50%;position:relative;margin-right:6px}.amp-wp-posted-on{text-align:right}.amp-wp-article-content{margin:0 16px}.amp-wp-article-content ul{margin-left:1em}.amp-wp-article-content amp-img{margin:0 auto}.amp-wp-article-footer .amp-wp-meta{display:block}.amp-wp-tax-category{color:#696969;font-size:.875em;line-height:1.5em;margin:1.5em 16px}.amp-wp-footer{border-top:1px solid #c2c2c2;margin:calc(1.5em - 1px) 0 0}.amp-wp-footer div{margin:0 auto;max-width:calc(840px - 32px);padding:1.25em 16px 1.25em;position:relative}.amp-wp-footer h2{font-size:1em;line-height:1.375em;margin:0 0 .5em}.amp-wp-footer p{color:#696969;font-size:.8em;line-height:1.5em;margin:0 85px 0 0}.amp-wp-footer a{text-decoration:none}.back-to-top{bottom:1.275em;font-size:.8em;font-weight:600;line-height:2em;position:absolute;right:16px}.htmledit_views em,.htmledit_views span[lang]{font-style:italic}.htmledit_views{font-family:-apple-system,SF UI Text,Arial,PingFang SC,Hiragino Sans GB,Microsoft YaHei,WenQuanYi Micro Hei,sans-serif,SimHei,SimSun}.htmledit_views a>amp-img{padding:1px;margin:1px;border:none;outline:#0782c1 solid 1px}.htmledit_views p{font-size:16px;color:#4d4d4d;font-weight:400;line-height:26px;margin:0 0 16px;overflow-x:auto}.htmledit_views amp-img{max-width:100%}.htmledit_views strong,.htmledit_views strong span{font-weight:700}.htmledit_views *{box-sizing:border-box}.htmledit_views h1,.htmledit_views h2,.htmledit_views h3,.htmledit_views h5{color:#4f4f4f;margin:8px 0 16px;font-weight:700}.htmledit_views ul{margin:0 0 24px;padding:0;font-size:16px}.htmledit_views ul li{list-style-type:disc;margin:8px 0 0 32px}.htmledit_views h1{font-size:28px;line-height:36px}.htmledit_views h2{font-size:24px;line-height:32px}.htmledit_views h3{font-size:22px;line-height:30px}.htmledit_views h5{font-size:18px;line-height:26px}.htmledit_views pre{white-space:pre-wrap;word-wrap:break-word;margin:0 0 24px;overflow-x:auto;padding:8px}.htmledit_views pre{font-family:Consolas,Inconsolata,Courier,monospace;font-size:14px;line-height:22px;color:#000}.htmledit_views a{color:#4ea1db;text-decoration:none}.htmledit_views a:focus,.htmledit_views a:hover{color:#ca0c16}.htmledit_views a:visited{color:#6795b5}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-76d4a29{color:#333;font-size:14px;background-color:#fff}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-dd7e280{font-size:16px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-94e4cab{font-size:16px;font-family:"微软雅黑"}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-9bd93d3{font-size:12px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-40919af{color:#333}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-993a887{color:#333;font-family:helvetica,"Hiragino Sans GB","Microsoft YaHei","微软雅黑","宋体","宋体";background-color:#fff}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-0884ef9{font-size:12px;font-family:"微软雅黑"}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-4270a0d{font-size:10px;font-family:"微软雅黑"}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-08a0c47{font-family:"微软雅黑";font-size:10px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-fa7a22d{font-family:"微软雅黑";font-size:12px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-3ee0a83{color:#333;font-family:helvetica,"Hiragino Sans GB","Microsoft YaHei","微软雅黑","宋体","宋体";font-size:14px;background-color:#fff}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-644b7c8{font-family:"微软雅黑"}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-74439c6{color:#454545;font-size:10px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-49f0646{font-size:10px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-6c0cd1f{color:#454545}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-9b328ad{color:#1a1a1a;font-family:"-apple-system",BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Microsoft YaHei","Source Han Sans SC","Noto Sans CJK SC","WenQuanYi Micro Hei",sans-serif;font-size:15px}

/*# sourceURL=amp-custom.css */</style><script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://uzzz.org/#website","url":"https://uzzz.org/","name":"\u6709\u7ec4\u7ec7\u5728!","potentialAction":{"@type":"SearchAction","target":"https://uzzz.org/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://uzzz.org/article/2837/#primaryimage","url":"http://nos.netease.com/knowledge/6586c809-312e-4369-b3d6-fc46ac696468"},{"@type":"WebPage","@id":"https://uzzz.org/article/2837/#webpage","url":"https://uzzz.org/article/2837/","inLanguage":"en-US","name":"Android\u79fb\u52a8\u5ba2\u6237\u7aef\u6027\u80fd\u6d4b\u8bd5\u6d45\u8c08\u2014\u2014\u7535\u91cf - \u6709\u7ec4\u7ec7\u5728!","isPartOf":{"@id":"https://uzzz.org/#website"},"primaryImageOfPage":{"@id":"https://uzzz.org/article/2837/#primaryimage"},"datePublished":"2018-12-13T03:53:56+00:00","dateModified":"2018-12-13T03:53:56+00:00","author":{"@id":"https://uzzz.org/#/schema/person/29673f1347b0abda5882803c72ee5a3f"}},{"@type":["Person"],"@id":"https://uzzz.org/#/schema/person/29673f1347b0abda5882803c72ee5a3f","name":"fandyvon","sameAs":[]}]}</script><link rel="canonical" href="https://uzzz.org/article/2837/"></head>

<body class="">

<header id="top" class="amp-wp-header">
	<div>
		<a href="https://uzzz.org/">
										<amp-img src="https://uzzz.org/wp-content/uploads/2019/10/cropped-icon-32x32.png" width="32" height="32" class="amp-wp-site-icon i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:32px;height:32px;" i-amphtml-layout="fixed"></amp-img>
						<span class="amp-site-title">
				有组织在!			</span>
		</a>

					</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">Android移动客户端性能测试浅谈——电量</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/e786821a74ef0467825a7d60183307bc?s=24&d=mm&r=g" alt="fandyvon" width="24" height="24" layout="fixed" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:24px;height:24px;" i-amphtml-layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">fandyvon</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2018-12-13T11:53:56+00:00">
		3 years ago	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<div id="article_content" class="article_content clearfix">
 <br>
 
 
 
<div class="htmledit_views" id="content_views">
<p>本文由作者张迎贞授权网易云社区发布。</p>
<p></p>
<p><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">APP性能测试除了需要监控PCU、内存占用、流量等，还需要获取APP的电量数据，测试在可接受范围内，避免APP出现过度消耗电量的现象。<br>手机有很多硬件模块：CPU，蓝牙，GPS，显示屏，Wifi，射频(Cellular Radio)等，在手机使用过程中，这些硬件模块可能处于不同的状态，譬如WIFI打开或关闭，屏幕是亮还是暗，CPU运行或休眠。 硬件模块在不同的状态下的耗电量是不同的。Android在进行电量统计时，并不是采用直接记录电流消耗量的方式，而是跟踪硬件模块在不同状态下的使用时间，收集一些可用信息，用来近似的计算出电池消耗量。<br>从用户使用层面来看，Android需要统计出应用程序的耗电量。应用程序的耗电量由很多部分组成，可能使用了GPS，蓝牙等模块，可能应用程序要求长时间亮屏(譬如游戏、视频类应用)。 一个应用程序的电量统计，可以采用累计应用程序使用所有硬件模块时间这种方式近似计算出来。<br>举一个例子，假定某个APP使用了GPS，使用时间用 <em>t</em> 表示。GPS模块单位时间的耗电量用 <em>w</em> 表示，那么，这个APK使用GPS的耗电量就可以按照如下方式计算：<br>耗电量 = 单位时间耗电量(w) × 使用时间(t)</span></span></p>
<p><strong><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8">测试方法多种多样：</span></strong></p>
<p><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">1、CPU空闲时，停留在主界面不退出，打开网络然后锁屏，12小时后查看电量、流量变化<br>2、APP在操作运行时（此过程可借助使用monkey进行压力测试），1小时后查看电量、流量变化<br>3、第三方APP进行步骤1、2相同的场景测试<br>4、对比竞品APP的耗电量。<br>期望结果：APP在静止状态时无没有明显的耗电情况，在运行状态时耗电量在可接受范围内。</span></span></p>
<h2 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:16px;" class="amp-wp-dd7e280">方法1——手机自带</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"></span></span></h2>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">有的手机设置菜单里面会有流量和电量统计类，只需在测试前后记录下电量值，便可获取消耗电量数值。</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><amp-img src="http://nos.netease.com/knowledge/6586c809-312e-4369-b3d6-fc46ac696468" alt="6586c809-312e-4369-b3d6-fc46ac696468" width="461" height="798" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22798%22%20width=%22461%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/6586c809-312e-4369-b3d6-fc46ac696468" alt="6586c809-312e-4369-b3d6-fc46ac696468" width="461" height="798" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"> </span></p>
<h2 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:16px;" class="amp-wp-dd7e280">方法2——使用第三方工具</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"></span></span></h2>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">已知公式 ： 耗电量 = 电流 * 时间<br>例：平均电流为150mA，测试时间30min，则，30min内耗电量为：150 * 30 /60=75mAh（毫安小时）。<br>通过耗电量和使用手机电量的百分比，可得出手机电池容量（理论值）。<br>一个系统走一遍基础功能耗电不应超过20%。</span></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"> </span><strong>1、</strong><strong>Emmagee</strong></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47"><a href="https://github.com/NetEase/Emmagee" rel="nofollow" data-token="67aa0b8052b162f4a0c830cc15e7ee90" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">https://github.com/NetEase/Emmagee</a></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">Emmagee是网易杭州研究院QA团队开发的一个简单易上手的Android性能监测小工具，主要用于监控单个App的CPU，内存，流量，启动耗时，电量，电流等性能状态的变化，且用户可自定义配置监控的频率以及性能的实时显示，并最终生成一份性能统计文件。</span></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><amp-img src="http://nos.netease.com/knowledge/149a9028-d4ab-4906-bebb-d9b6c9467067" alt="149a9028-d4ab-4906-bebb-d9b6c9467067" width="389" height="638" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22638%22%20width=%22389%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/149a9028-d4ab-4906-bebb-d9b6c9467067" alt="149a9028-d4ab-4906-bebb-d9b6c9467067" width="389" height="638" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/a2fbe08a-a921-4413-ac26-c2902ba92059?imageView&thumbnail=980x0" alt="a2fbe08a-a921-4413-ac26-c2902ba92059?imageView&thumbnail=980x0" width="980" height="205" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22205%22%20width=%22980%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/a2fbe08a-a921-4413-ac26-c2902ba92059?imageView&thumbnail=980x0" alt="a2fbe08a-a921-4413-ac26-c2902ba92059?imageView&thumbnail=980x0" width="980" height="205" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><strong><span data-amp-original-style="font-size:12px;font-family:'微软雅黑';" class="amp-wp-0884ef9">2、腾讯GT</span></strong></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><a href="http://gt.tencent.com/download.html" rel="nofollow" data-token="810ff5e19666576ff72b071f707cee10" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">http://gt.tencent.com/download.html</a></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8">此apk是一款可以对APP进行测试的软件，可以在任何情况下快速测试手机app的CPU、内存、流量、电量、帧率/流畅度等性能测试。<br>使用方法：</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><amp-img src="http://nos.netease.com/knowledge/ce66d479-9fc7-48cf-8a72-3ce2b219bbe1?imageView&thumbnail=980x0" alt="ce66d479-9fc7-48cf-8a72-3ce2b219bbe1?imageView&thumbnail=980x0" width="980" height="587" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22587%22%20width=%22980%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/ce66d479-9fc7-48cf-8a72-3ce2b219bbe1?imageView&thumbnail=980x0" alt="ce66d479-9fc7-48cf-8a72-3ce2b219bbe1?imageView&thumbnail=980x0" width="980" height="587" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">打开GT，点击选择被测应用，选中自己要测的app，选择关注的测试点，cup、net(流量)、内存（pss）等，点击“启动”，在gt的插件标签里有耗电测试，导出文件查看电量使用。</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/e6192170-9f3d-4742-b873-7f9483b7193d" alt="e6192170-9f3d-4742-b873-7f9483b7193d" width="404" height="217" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22217%22%20width=%22404%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/e6192170-9f3d-4742-b873-7f9483b7193d" alt="e6192170-9f3d-4742-b873-7f9483b7193d" width="404" height="217" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><strong><span data-amp-original-style="font-family:'微软雅黑';font-size:12px;" class="amp-wp-fa7a22d">3</span><span data-amp-original-style="font-family:'微软雅黑';font-size:12px;" class="amp-wp-fa7a22d">、其他各种常见耗电量监控工具</span></strong></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47"><strong>金山电池医生：</strong>能够记录CPU耗时、流量消耗随时间的变化曲线，这样可以查看app耗电在哪些时间点.<br><strong>GSam Battery Pro</strong><strong>：</strong>耗电量信息显示详细，包括了唤醒锁数，前后台占用cpu的时间，可以导出数据，支持多种监控起始时间点设置<br><strong>P</strong><strong>owerTutor</strong><strong>：</strong>1.显示系统电量消耗水平，记录耗电量的焦耳值，不是百分比，包括LCD/OLED，CPU,WiFi，3G，GPS和Audio；2.查看某段时间内所有运行中的应用程序的耗电量<br><strong>Battery Monitor Widget</strong><strong>：</strong>高度可定制化的电量监控小工具，不仅可以显示当前电量，估算剩余电量支撑时间，还可以一目了然地检测出各个APP的耗电历史，从而方便进行比较。<br><strong>Smart Battery Monitor</strong>：除了可以在状态栏显示电池消耗百分比外，还可以显示电池的温度，以及已充电时间。<br><strong>Battery Indicator</strong>：亮点是轻便、小巧，甚至使用它时不会消耗电池。当然，它可以显示电池的电量百分比、电池的温度、以及电池的健康信息。<br><strong>Battery Widget</strong>：这个工具不仅是一个电池Widget，还可以作为显示选项，GPS，WiFi，蓝牙选项等的快捷方式。<br><strong>Battery Saver</strong>：被称为管理电池的最强大应用之一。除了显示电量信息，电池温度和健康信息外，它还可以快速管理一些耗电量大的应用如：GPS，WiFi，蓝牙等。另外：该工具可以查看一天之内的哪个时间点电池的耗电量最大。|<br>等等等等</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><br></span></p>
<h3 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-size:16px;font-family:'微软雅黑';" class="amp-wp-94e4cab">方法3——Battery Historian</span></h3>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">Android框架层通过一个名为batterystats的系统服务，电池的信息，电压，温度，充电状态等等，都是由BatteryService来提供的。电池的这些信息是BatteryService通过广播主动把数据传送给所关心的应用程序。实现了电量统计的功能，batterystats实现原理可以查阅<strong><a href="http://duanqz.github.io/2015-07-21-batterystats-part1" rel="nofollow" data-token="10c1234a68c083c82118d5d6840e5cfe" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">电量统计服务</a><br></strong>Android</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">提供的<strong>dumpsys</strong>命令用于查看系统服务的信息(实现原理可以查阅<a href="http://duanqz.github.io/2015-07-19-Intro-to-dumpsys" rel="nofollow" data-token="eed1f71a06b547d7c3183b00205479d2" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">dumpsys介绍</a>)， 将<strong>batterystats</strong>作为参数，就能输出完整的电量统计信息。</span></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><strong><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8">执行：</span></strong></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">手机连接usb执行：</span></p>
<pre data-amp-original-style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-76d4a29">adb shell dumpsys batterystats --enable full-wake-history 
adb shell dumpsys batterystats –reset //清空电池的历史状态</pre>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">断开USB,打开目标应用，执行monkey，正常使用5分钟左右。</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">连接USB，执行：</span></p>
<pre data-amp-original-style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-76d4a29">adb bugreport > bugreport.txt
也可以用adb shell dumpsys batterystats > com.nt.topline > toplinepower1.txt //得到指定app相关的电量消耗信息。
python historian.py -a bugreport.txt > batterystats.html</pre>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">上面的historian.py脚本是python写的，所以需要python环境，从<a href="https://github.com/google/battery-historian" rel="nofollow" data-token="4fb0787f34e71c0b5ea9b363ef7cabd6" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">github</a>上下载这个脚本。Chrome浏览器打开生成的battery.html文件，打开查看。</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><br></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/1ed08c0a-fa5c-4bc3-9fc0-3eac4ba48ce8?imageView&thumbnail=980x0" alt="1ed08c0a-fa5c-4bc3-9fc0-3eac4ba48ce8?imageView&thumbnail=980x0" width="980" height="593" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22593%22%20width=%22980%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/1ed08c0a-fa5c-4bc3-9fc0-3eac4ba48ce8?imageView&thumbnail=980x0" alt="1ed08c0a-fa5c-4bc3-9fc0-3eac4ba48ce8?imageView&thumbnail=980x0" width="980" height="593" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"> </span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">html中信息都能从bugreport.txt中找到相应的信息。 </span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><strong><span data-amp-original-style="font-size:12px;font-family:'微软雅黑';" class="amp-wp-0884ef9">分析各个指标代表的意义：</span></strong></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/3ad7d3c7-fb4e-4db7-b11f-75d6520a6c19?imageView&thumbnail=980x0" alt="3ad7d3c7-fb4e-4db7-b11f-75d6520a6c19?imageView&thumbnail=980x0" width="980" height="65" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%2265%22%20width=%22980%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/3ad7d3c7-fb4e-4db7-b11f-75d6520a6c19?imageView&thumbnail=980x0" alt="3ad7d3c7-fb4e-4db7-b11f-75d6520a6c19?imageView&thumbnail=980x0" width="980" height="65" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">上面的10，20代表的就是秒的意思，它是以一分钟为周期，到第60秒的时候变为0。横坐标就是一个时间范围，咱们的例子中统计的数据是以重置为起点，获取bugreport内容时刻为终点。我们一共采集了多长时间的数据，图表下也有信息说明。（经其他人的反馈，这个坐标间隔是会随着时间的长度发生改变，所以要以你的实际情况为准）<br></span><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">battery_level：</span><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">电量，可以看出电量的变化。比如上图中的数据显示刚开始电量是100%，然后在第11秒-12秒中间的某个时刻降到了99%。</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/2745ad06-c40c-4a73-a9ae-7dd07597430a" alt="2745ad06-c40c-4a73-a9ae-7dd07597430a" width="554" height="112" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22112%22%20width=%22554%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/2745ad06-c40c-4a73-a9ae-7dd07597430a" alt="2745ad06-c40c-4a73-a9ae-7dd07597430a" width="554" height="112" class=""></noscript></amp-img></span></p>
<h5 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47"><a></a>plugged： 充电状态，这一栏显示是否进行了充电，以及充电的时间范围。例如上图反映了我们在第22s插入了数据线，然后一直持续了数据采集结束。<br>screen： 屏幕是否点亮，这一点可以考虑到睡眠状态和点亮状态下电量的使用信息。<br>top：该栏显示当前时刻哪个app处于最上层，就是当前手机运行的app，用来判断某个app对手机电量的影响，这样也能判断出该app的耗电量信息。该栏记录了应用在某一个时刻启动，以及运行的时间，这对我们比对不同应用对性能的影响有很大的帮助。<br>wake_lock*： <a href="http://blog.csdn.net/g_salamander/article/details/7978772" rel="nofollow" data-token="ca56c437103e4a5c1d3e9797a2ea5e32" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">wake_lock</a> 该属性是记录wake_lock模块的工作时间。是否有停止的时候等。Android的休眠唤醒主要基于wake_lock机制，只要系统中存在任一有效的wake_lock，系统就不能进入深度休眠，但可以进行设备的浅度休眠操作。wake_lock一般在关闭lcd、tp但系统仍然需要正常运行的情况下使用，比如听歌、传输很大的文件等。<br>running：界面的状态，主要判断是否处于idle的状态。用来判断无操作状态下电量的消耗。<br>wake_lock_in：wake_lock有不同的组件，这个地方记录在某一个时刻，有哪些部件开始工作，以及工作的时间。<br>data_conn：数据连接方式的改变，上面的edge是说明采用的gprs的方式连接网络的。此数据可以看出手机是使用2g，3g，4g还是wifi进行数据交换的。这一栏可以看出不同的连接方式对电量使用的影响。<br>status：电池状态信息，有充电，放电，未充电，已充满，未知等不同状态。 这一栏记录了电池状态的改变信息。<br>phone_signal_strength：手机信号状态的改变。 这一栏记录手机信号的强弱变化图，依次来判断手机信号对电量的影响。<br>health：电池健康状态的信息，这个信息一定程度上反映了这块电池使用了多长时间。 这一栏记录电池状态在何时发生改变，上面的图中电池状态一直处于good状态。<br>plug：充电方式，usb或者插座，以及显示连接的时间。 这一栏显示了不同的充电方式对电量使用的影响。<br>gps：gps是否开启<br>phone_in_call :是否进行通话<br>Sync :是否跟后台同步，可以把鼠标停在某一项上面。可以看到何时sync同步 启动的，持续时间Duration多久。电池容量不会显示单一行为消耗的具体电量，这里只能显示使用电池的频率和时长，你可以看分时段的剩余电量来了解具体消耗了多少电量。 </span></h5>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/936ccaef-06d7-427a-976e-e864fa629384" alt="936ccaef-06d7-427a-976e-e864fa629384" width="448" height="142" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22142%22%20width=%22448%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/936ccaef-06d7-427a-976e-e864fa629384" alt="936ccaef-06d7-427a-976e-e864fa629384" width="448" height="142" class=""></noscript></amp-img></span></p>
<h5 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">Job ：后台的工作，比如服务service的运行。从下面图中可以看到qihoo的AppStore和鲁大师都在运行后台服务。 <br><amp-img src="http://nos.netease.com/knowledge/7b3fefbe-d1dd-4308-a613-3db8c4a3ef3d" alt="7b3fefbe-d1dd-4308-a613-3db8c4a3ef3d" width="554" height="199" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22199%22%20width=%22554%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/7b3fefbe-d1dd-4308-a613-3db8c4a3ef3d" alt="7b3fefbe-d1dd-4308-a613-3db8c4a3ef3d" width="554" height="199" class=""></noscript></amp-img><br>data_conn：数据连接方式的改变，上面的edge是说明采用的gprs的方式连接网络的。此数据可以看出手机是使用2g，3g，4g还是wifi进行数据交换的。这一栏可以看出不同的连接方式对电量使用的影响。<br>status ：电池状态信息，有充电，放电，未充电，已充满，未知等不同状态。 这一栏记录了电池状态的改变信息。<br>phone_signal_strength ：手机信号状态的改变。 这一栏记录手机信号的强弱变化图，依次来判断手机信号对电量的影响。</span></h5>
<h3 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:12px;" class="amp-wp-9bd93d3">结果分析：</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"></span></span></h3>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">通过前面学习到的Battery Historian我们可以得到设备的电量消耗数据.<br></span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">例如拿移动网络举例，如果数据中的移动蜂窝网络(Mobile Radio)电量消耗呈现下面的情况，间隔很小，又频繁断断续续的出现，说明电量消耗性能很不好：</span></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/0737c4a1-96d3-4881-9ced-d7646ee7c3a7" alt="0737c4a1-96d3-4881-9ced-d7646ee7c3a7" width="813" height="397" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22397%22%20width=%22813%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/0737c4a1-96d3-4881-9ced-d7646ee7c3a7" alt="0737c4a1-96d3-4881-9ced-d7646ee7c3a7" width="813" height="397" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">经过优化之后，如果呈现下面的图示，说明电量消耗的性能是良好的：</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/d5e00cf1-eafc-4b70-bb7d-8fe693e9e13e" alt="d5e00cf1-eafc-4b70-bb7d-8fe693e9e13e" width="827" height="384" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22384%22%20width=%22827%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/d5e00cf1-eafc-4b70-bb7d-8fe693e9e13e" alt="d5e00cf1-eafc-4b70-bb7d-8fe693e9e13e" width="827" height="384" class=""></noscript></amp-img></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d">另外WiFi连接下，网络传输的电量消耗要比移动网络少很多，应该尽量减少移动网络下的数据传输，多在WiFi环境下传输数据。</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><amp-img src="http://nos.netease.com/knowledge/71899429-b564-4888-8675-38abaf0cd60f" alt="71899429-b564-4888-8675-38abaf0cd60f" width="760" height="292" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;charset=utf-8,<svg%20height=%22292%22%20width=%22760%22%20xmlns=%22http://www.w3.org/2000/svg%22%20version=%221.1%22/>"></i-amphtml-sizer><noscript><img src="http://nos.netease.com/knowledge/71899429-b564-4888-8675-38abaf0cd60f" alt="71899429-b564-4888-8675-38abaf0cd60f" width="760" height="292" class=""></noscript></amp-img></span></p>
<h2 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:16px;" class="amp-wp-dd7e280">耗电原因分析</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"></span></span></h2>
<p><strong><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8">主要造成耗电的几大原因：</span></strong></p>
<p><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"></span></p>
<ul class="list-paddingleft-2">
<li>
<p>屏幕唤醒</p>
</li>
<li>
<p>CPU唤醒</p>
</li>
<li>
<p>蜂窝数据</p>
</li>
<li>
<p>传感器</p>
</li>
</ul>
<h3 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:12px;" class="amp-wp-9bd93d3">可能造成耗电的原因</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"></span></span></h3>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"></p>
<p><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"></span></p>
<ul class="list-paddingleft-2">
<li>
<p>网络请求耗电，而且手机数据网络进行http请求比无线网进行http请求更加耗电，因为数据网络调用到一些底层的硬件模块，就如GPS一样，当手机打开GPS功能后，也是启动了一些硬件模块就会明显增加耗电</p>
</li>
<li>
<p>高频的刷新UI界面，刷新UI界面其实就是进行layout的绘制，如果一个Activity的布局嵌套太多层，那么每一层layout都会刷新一次，例如动画等等这些都会造成耗电</p>
</li>
<li>
<p>数据库，SD卡文件操作，这些都是属于耗时操作，当操作次数很少的时候基本不会有耗电问题，但是当短时间内操作次数很多的话，也会明显的增加耗电，同时也有可能造成页面卡顿</p>
</li>
<li>
<p>AlarmManager<span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">，例如一些推送的心跳包实现，AlarmManager会定时唤醒CPU去执行一些任务，也是造成耗电的一大源头</span></p>
</li>
<li>
<p>手机网络环境不好的时候会频繁的切换网络，因为网络数据交互的时候，系统也是会被唤醒的，所以APP如果在监听了网络切换广播后做了大量的操作，一样会增加耗电</p>
</li>
<li>
<p>针对一些任务队列的处理，如果队列堆积的任务太多，导致循环执行太久也会造成耗电，因为占用了CPU资源去执行代码，我们的log日志工具保存到文件就是用任务队列实现的，当压力测试SDK一次性接受1万条消息的时候，那内存就表上来了，跟了下发现日志保存队列里面积压了4千多个任务，这时候即使手机锁屏，也还会不断的把队列中的任务执行完然后CPU才会休眠下去的，同样会造成严重的耗电，耗内存，好在release版本的日志都是关闭的</p>
</li>
<li>
<p>执行一些高运算量的代码，例如json数据解析，一些二进制协议的数据编码和解码</p>
</li>
<li>
<p>接收系统的一分钟广播，然后做一些程序逻辑处理，其实接收一分钟广播不耗电，耗电的是一分钟执行一次程序处理</p>
</li>
<li>
<p>Wake Lock<span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">使用不当导致没有及时的释放，Wake Lock可以阻止cpu进入休眠的，如果没有及时的release会造成cpu无法休眠，程序耗电严重</span></p>
</li>
<li>
<p>如果程序中有定时任务，在cpu休眠之后，定时任务就会被挂起不执行，这时候并不会造成太大的耗电，但是如果这个定时任务的时间间隔很短，1秒执行一次，那么当手机app集成了推送，推送就会有心跳包通过AlarmManager来唤醒，每次唤醒的时候就会再去执行挂起的定时任务，虽然执行定时任务的耗电量可能比心跳包的耗电量少很多，不过还是需要注意的，积少成多</p>
</li>
<li>
<p>其实android中的Log日志的打印也会耗电的，在日常开发中，我们可能不仅会把log打印到AndroidStudio里面，有可能还会保存起来，而且可能在打印对象信息数据的时候会用到json格式转换，这些都会增加耗电，但是在正式发布的apk包中日志管理一般都是关闭的</p>
</li>
<li>
<p>在手机锁屏后，CPU会过一段时间才休眠，如果程序中有定时任务，在CPU休眠后会被挂起不执行，但是在CPU休眠之前，定时任务还是会一直的执行的，之前遇到过这么一个问题，我们采用Picasso库：Picasso.with(context)</p>
</li>
</ul>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646"> </span> </span></p>
<h2 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-size:16px;font-family:'微软雅黑';" class="amp-wp-94e4cab">优化建议:</span></h2>
<h3 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8">针对主要耗电原因的优化：</span></h3>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">  o   传感器的使用,比如gps，如果业务上非频繁使用并且要求精度不高，那么就在业务上优化定位时机和精度.<br>  o   如果业务上需要有长时间的service，那么要考虑到CPU weak lock，防止后台任务没有完成，但是cpu睡眠,或者任务已经完成，仍然持有weak lock<br>  o   我们也许会在手机充电时，做一些日志上传操作的定时任务，那么注意重试次数和成功后处理，防止用户一夜充电不到80%，然后手机厂商为我们背锅的情况<br>  o   已知屏幕唤醒是耗电大户，原因是屏幕渲染,绘制消耗资源，所以我们在自定义视图,布局的时候，要尽量做到Android性能优化里要求<br>  o   同理,各种优化,平时编码的习惯，都会影响我们脆弱的电量<br>  o   为了减少电量的消耗，在蜂窝移动网络下，最好做到批量执行网络请求，尽量避免频繁的间隔网络请求。</span><br><span data-amp-original-style="font-size:12px;" class="amp-wp-9bd93d3"><strong><br></strong></span><strong>针对Http请求优化： </strong></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">  o    对http请求数据做GZIP压缩，当前流行的http第三方看默认都支持GZIP压缩<br> o    Http缓存，Http协议有一个Cache机制，当发出http请求的时候会先到指定目录下检查是否已经存在这个请求的数据，如果存在并且还没过时，那么就会直接返回；而一些第三方例如OkHttp也有有自己的缓存    机制<a href="http://blog.csdn.net/copy_yuan/article/details/51524907" rel="nofollow" data-token="c9cd57ec5a40a19707d8244d1111e1ee" data-amp-original-style="color:rgb(51,51,51);" class="amp-wp-40919af">OKHTTP缓存</a><br>  o    合并Http请求来减少Http请求次数，因为Http底层也是TCP连接，对于每个Http请求，发出请求的时候都会创建TCP连接，请求结束后会断开TCP连接，那么当Http请求次数很多的时候就会频繁的创建和断开TCP连接，如果把当中一些请求进行合理的合并，那么就会减少Http请求次数<br>  o    制定合理的Http请求数据格式和返回数据格式，做到请求数据中没有冗余字<br>  o    可以在Http请求数据格式里面加一个字段dataVersion代表本地已有数据的版本号，然后传到服务器，服务器的数据表中也有一个字段是dataVersion，当服务器数据被修改的时候，dataVersion就加一，当检测到客户端传上来的dataVersion小于服务器数据表中的dataVersion的时候就返回最新数据，否则可以直接返回空数据代表当前本地数据已经是最新数据，这样就不会每次请求http的时候都会返回大量数据，当数据没有被改变的时候直接返回空，减少了http请求过程中的数据交互（但是要考虑一点，只有一些请求数据量比较大的才适合，因为增加了dataVersion字段后无论给客户端还是服务端也都相应的增加了维护的成本）</span></span></p>
<h3 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-size:12px;font-family:'微软雅黑';" class="amp-wp-0884ef9"><br></span></h3>
<h3 data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';background-color:rgb(255,255,255);" class="amp-wp-993a887"><span data-amp-original-style="font-size:12px;font-family:'微软雅黑';" class="amp-wp-0884ef9">针对数据库，SD卡文件操作： </span></h3>
<p><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">o</span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">  APP在对数据库或者SD卡文件操作的时候无非也是涉及到一些数据的转换，json转换，可以采用json解析效率高的第三方库，例如fast json，Jackson，gson<br>o   可以把一些需要持久化到数据库或者文件中的数据先缓存在内存中，然后在一个时间点一起触发一同更新到数据库或者文件中；例如，在进入Activity的时候会首先从数据库中搜索出帐户信息并且展示在界面，然后会再去发Http请求服务器的帐户信息数据，再把服务器最新的帐户信息数据刷新到界面中，同时也存在一个内存对象中，这时候先不更新到数据库，当退出这个Activity界面的时候可以去检测帐户数据是否发生改变，如果改变了就更新到数据中；这么做的好处是：如果在Activity界面多次修改数据，那最新的数据都是只更新到内存中的，当Activity退出后才把最新的帐户信息数据更新到数据库中，没必要更改一次就同时把数据更新一次到数据库<br>o    SD卡的文件读写操作比数据库要快，数据库也是属于文件，但是在写数据的时候还要经过sqlite的一些列数据库操作，但是SD卡在写数据的时候是直接写到文件中的，所以针对与简单数据，标志变量或者数据条数很少的数据，而且安全性要求也不高的数据可以直接存在文件中，例如SharedPreferences中，只有关系型的数据，数据安全性较高的，数据记录条数比较多的可以选择数据库存储，而且如果数据库进行加密后，对于数据库的读写操作会更慢了<br>o    针对数据库操作尽量不要直接使用android里面的Sqlite来手写读写的那些sql语句，可以选择一些orm框架库，例如ormlite，GreenDao等等，我们选择的是ormlite，因为ormlite数据库加密已经有现成的库可以提供使用。</span></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-size:10px;font-family:'微软雅黑';" class="amp-wp-4270a0d"><br></span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';font-size:10px;" class="amp-wp-08a0c47">以上！感谢！分析不够全面的部分欢迎交流补充！</span></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><strong><span data-amp-original-style="font-family:'微软雅黑';font-size:12px;" class="amp-wp-fa7a22d">参考：</span></strong></p>
<p data-amp-original-style="color:rgb(51,51,51);font-family:helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', '宋体', '宋体';font-size:14px;background-color:rgb(255,255,255);" class="amp-wp-3ee0a83"><span data-amp-original-style="font-family:'微软雅黑';" class="amp-wp-644b7c8"><span data-amp-original-style="color:#454545;font-size:10px;" class="amp-wp-74439c6">http://blog.csdn.net/itfootball/article/details/44084159<br></span><span data-amp-original-style="font-size:10px;" class="amp-wp-49f0646">http://blog.csdn.net/itfootball/article/details/49004699<br><span data-amp-original-style="color:#454545;" class="amp-wp-6c0cd1f">http://news.mydrivers.com/1/282/282933.htm<br></span>https://github.com/google/battery-historian<br>http://hukai.me/android-performance-battery/<br><span data-amp-original-style="color:#454545;" class="amp-wp-6c0cd1f">https://juejin.im/entry/589d66c686b599006b2e07a8<br></span>http://xusx1024.com/2018/01/08/battery-historian-2/<br>http://gityuan.com/2016/01/10/power_rank/<br>http://hukai.me/android-performance-patterns/<br>http://duanqz.github.io/2015-07-21-batterystats-part1<br>http://duanqz.github.io/2015-07-19-Intro-to-dumpsys</span></span></p>
<p></p>
<p data-amp-original-style="color:rgb(26,26,26);font-family:'-apple-system', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Microsoft YaHei', 'Source Han Sans SC', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', sans-serif;font-size:15px;" class="amp-wp-9b328ad"><a href="https://www.163yun.com/free?tag=M_tg_930_70" rel="nofollow" data-token="6304679227d9ac63eea79e30f3c07474">免费领取验证码、内容安全、短信发送、直播点播体验包及云服务器等套餐</a></p>
<p data-amp-original-style="color:rgb(26,26,26);font-family:'-apple-system', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Microsoft YaHei', 'Source Han Sans SC', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', sans-serif;font-size:15px;" class="amp-wp-9b328ad">更多网易技术、产品、运营经验分享请访问<a href="https://sq.163yun.com/blog?tag=M_tg_930_70" rel="nofollow" data-token="55f8b1754e9fee81001ff415a4e98e5f">网易云社区</a>。</p>
<p></p>
<p>相关文章：<br>【推荐】 <a href="https://blog.csdn.net/jessicaiu/article/details/84134086" rel="nofollow" data-token="1191977a26e5f7d9feb2a4490af5c75f">知物由学 | 人工智能、机器学习和深度学习如何在网络安全领域中应用？</a><br>【推荐】 <a href="https://www.cnblogs.com/163yun/p/9083655.html" rel="nofollow" data-token="6c8d5d14c8e361374214a22ced1c4331">棋牌游戏大咖会：人工智能与运营、安全方面的那些事</a></p>
</div>
</div>
	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: Uncategorized	</div>

	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>有组织在!</h2>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>




</body></html>
