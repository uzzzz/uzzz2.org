<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>App &#8211; 有组织在!</title>
	<atom:link href="https://uzzz.org/category/app/feed" rel="self" type="application/rss+xml" />
	<link>https://uzzz.org/</link>
	<description></description>
	<lastBuildDate>Sat, 15 Jun 2019 15:08:26 +0000</lastBuildDate>
	<language>zh-CN</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.4</generator>

<image>
	<url>https://uzzz.org/wp-content/uploads/2019/10/cropped-icon-32x32.png</url>
	<title>App &#8211; 有组织在!</title>
	<link>https://uzzz.org/</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>WWDC2019 &#8212;&#8212;iOS13适配（持续更新）</title>
		<link>https://uzzz.org/article/1333.html</link>
				<pubDate>Sat, 15 Jun 2019 15:08:26 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[iOS]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1333.html</guid>
				<description><![CDATA[第一、Web Content适配 https://developer.apple.com/videos/play/wwdc2019/511/ https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme 问题展示 先看两张图： 如上图所示，如果h5未适配dark模式，]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<h1>第一、Web Content适配</h1>
<p><a href="https://developer.apple.com/videos/play/wwdc2019/511/" rel="nofollow" data-token="db1a7093653219e7a45ee0938eb01598">https://developer.apple.com/videos/play/wwdc2019/511/</a></p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme" rel="nofollow" data-token="ccdd9b15b3cc1cafc76ae55f1420d3e1">https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme</a></p>
<h2>问题展示</h2>
<p>先看两张图：</p>
<p><img alt="" class="has" height="500" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190615223143824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTI0MTM5NTU=,size_16,color_FFFFFF,t_70" width="300"><img alt="" class="has" height="500" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190615223309706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTI0MTM5NTU=,size_16,color_FFFFFF,t_70" width="300"></p>
<p>如上图所示，如果h5未适配dark模式，则在dark模式下原来的页面内容展示就就存在问题。</p>
<h2>适配方法</h2>
<p>这里主要介绍基于CSS样式的修改来适配web内容</p>
<p>首先，一定要声明当前支持的color-scheme有两种样式，这一句很重要，用东北话说就是“必须的”</p>
<pre class="has">
<code class="language-css">:root {
    color-scheme: light dark;
}</code></pre>
<p>适配的策略就是为两种color-scheme设置不同的颜色样式。</p>
<h3>1、文本适配</h3>
<p>如图一，它的CSS描述为</p>
<pre class="has">
<code class="language-css"> body {
     color: black;
 }
 h1 {
     color: #333;
 }
 .header {
    background-color: #593a78;
    color: white;
 }</code></pre>
<p>这里相关的颜色样式都是写死的，所以dark模式下才会出现图二的情况。现在我们来看如何适配下面这段代码：</p>
<pre class="has">
<code class="language-css">
h1 {
    color: #333;
}
.header {
    background-color: #593a78;
    color: white;
}</code></pre>
<p>然后可用如下方式改造：</p>
<pre class="has">
<code class="language-css">:root {
    color-scheme: light dark; 
    --post-title-color: #333;
    --header-bg-color: #593a78;
    --header-txt-color: white;
}


h1 {
    color: var(--post-title-color);
}
.header {
    background-color: var(--header-bg-color);
    color: var(--header-txt-color);
}</code></pre>
<p>这里所做的工作实际上是抽象了颜色的值的setter和getter，即不同模式下的值统一定义，然后使用时通过var()去自动获取。</p>
<p>而结合@media与prefers-color-scheme,颜色值的定义可以更加清晰：</p>
<pre class="has">
<code class="language-css">@media (prefers-color-scheme: dark) {
    :root {
        --post-title-color: white;
        --header-bg-color: #513d66;
        --header-txt-color: #eee;
    }
}</code></pre>
<p>同理可以定义light模式下的色值。</p>
<h3>2、图片适配</h3>
<p>假设原文件有一幅图片资源，其CSS描述如下：</p>
<pre class="has">
<code class="language-css">&lt;img src="mojave-day.jpg"&gt;</code></pre>
<p>那么，可以通过下面的方式来达到适配两种模式的目的：</p>
<pre class="has">
<code class="language-css">&lt;picture&gt;
    &lt;source srcset="mojave-night.jpg" media="(prefers-color-scheme: dark)"&gt;
    &lt;img src="mojave-day.jpg"&gt;
&lt;/picture&gt;</code></pre>
<h3>3、动态内容适配</h3>
<p>动态内容适配需要注意：WebKit提供了获取指定模式下需要适配的多媒体项的能力，以及不同模式间切换的通知，一般情况下，通过下面的方式可以完成适配：</p>
<pre class="has">
<code class="language-css">// Adapting dynamic content to dark mode with JavaScript
let darkModeMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
function updateForDarkModeChange() {
    if (darkModeMediaQuery.matches) {
        ...
    } else {
        ...
    }
}
darkModeMediaQuery.addListener(updateForDarkModeChange);
updateForDarkModeChange(); // Handle if Dark Mode is already active.</code></pre>
<p>所以，这里很显然要处理light2dark和dark2light等情形。&nbsp; &nbsp;</p>
<p>如果需要更深度的定制，需h5与客户端评估是否需要注入js变量来判断当前模式。如果涉及服务端的直接适配，则可考虑在UA中添加识别信息。</p>
<h3>4、小结：</h3>
<ul>
<li>使用 color-scheme 来声明支持的模式；</li>
<li>利用prefers-color-scheme来设置不同模式下的配置；</li>
<li>利用&lt;picture&gt; 标签设置不同模式下的图片；</li>
<li>利用var() 方法来适配不同模式下的变量取值；</li>
<li>动态内容适配视具体情况而定。</li>
</ul>
<p>&nbsp;</p>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Flutter资源管理</title>
		<link>https://uzzz.org/article/1507.html</link>
				<pubDate>Thu, 16 May 2019 11:41:22 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[前端]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1507.html</guid>
				<description><![CDATA[资源管理 Flutter应用程序可以包含代码和 assets（有时称为资源）。assets是会打包到程序安装包中的，可在运行时访问。常见类型的assets包括静态数据（例如JSON文件）、配置文件、图标和图片（JPEG，WebP，GIF，动画WebP / GIF，PNG，BMP和WBMP）等。 指定 assets 和包管理一样，Flutter也使用pubsp]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<h1 id="资源管理">资源管理</h1>
<p>Flutter应用程序可以包含代码和 assets（有时称为资源）。assets是会打包到程序安装包中的，可在运行时访问。常见类型的assets包括静态数据（例如JSON文件）、配置文件、图标和图片（JPEG，WebP，GIF，动画WebP / GIF，PNG，BMP和WBMP）等。</p>
<h2 id="指定-assets">指定 assets</h2>
<p>和包管理一样，Flutter也使用<a href="https://www.dartlang.org/tools/pub/pubspec" rel="nofollow" data-token="bccfdb318f058c1c47375f5bbba695a7"><code>pubspec.yaml</code></a>文件来管理应用程序所需的资源。举一个例子:</p>
<pre class="has">
<code>flutter:
  assets:
    - assets/my_icon.png
    - assets/background.png
</code></pre>
<p><code>assets</code>指定应包含在应用程序中的文件。 每个asset都通过相对于<code>pubspec.yaml</code>文件所在位置的显式路径进行标识。asset的声明顺序是无关紧要的。asset的实际目录可以是任意文件夹（在本示例中是assets）。</p>
<p>在构建期间，Flutter将asset放置到称为&nbsp;<em>asset bundle</em>&nbsp;的特殊存档中，应用程序可以在运行时读取它们（但不能修改）。</p>
<h2 id="asset-变体（variant）">Asset 变体（variant）</h2>
<p>构建过程支持asset变体的概念：不同版本的asset可能会显示在不同的上下文中。 在<code>pubspec.yaml</code>的assets部分中指定asset路径时，构建过程中，会在相邻子目录中查找具有相同名称的任何文件。这些文件随后会与指定的asset一起被包含在asset bundle中。</p>
<p>例如，如果应用程序目录中有以下文件:</p>
<ul>
<li>…/pubspec.yaml</li>
<li>…/graphics/my_icon.png</li>
<li>…/graphics/background.png</li>
<li>…/graphics/dark/background.png</li>
<li>…etc.</li>
</ul>
<p>然后<code>pubspec.yaml</code>文件中只需包含:</p>
<pre class="has">
<code>flutter:
  assets:
    - graphics/background.png
</code></pre>
<p>那么这两个<code>graphics/background.png</code>和<code>graphics/dark/background.png</code>&nbsp;都将包含在您的asset bundle中。前者被认为是<em>main asset</em>&nbsp;（主资源），后者被认为是一种变体（variant）。</p>
<p>在选择匹配当前设备分辨率的图片时，Flutter会使用到asset变体（见下文），将来，Flutter可能会将这种机制扩展到本地化、阅读提示等方面。</p>
<h2 id="加载-assets">加载 assets</h2>
<p>您的应用可以通过<a href="https://docs.flutter.io/flutter/services/AssetBundle-class.html" rel="nofollow" data-token="7f3725a47b86a66f1ca07c2b4c151540"><code>AssetBundle</code></a>对象访问其asset 。有两种主要方法允许从Asset bundle中加载字符串或图片(二进制)文件。</p>
<h3 id="加载文本assets">加载文本assets</h3>
<ul>
<li>通过<a href="https://docs.flutter.io/flutter/services/rootBundle.html" rel="nofollow" data-token="1cf0d9d4630245bea0dc925cbeff037a"><code>rootBundle</code></a>&nbsp;对象加载：每个Flutter应用程序都有一个<a href="https://docs.flutter.io/flutter/services/rootBundle.html" rel="nofollow" data-token="1cf0d9d4630245bea0dc925cbeff037a"><code>rootBundle</code></a>对象， 通过它可以轻松访问主资源包，直接使用<code>package:flutter/services.dart</code>中全局静态的<code>rootBundle</code>对象来加载asset即可。</li>
<li>通过&nbsp;<a href="https://docs.flutter.io/flutter/widgets/DefaultAssetBundle-class.html" rel="nofollow" data-token="011e1ccf48027e1851d805dc257b0d64"><code>DefaultAssetBundle</code></a>&nbsp;加载：建议使用&nbsp;<a href="https://docs.flutter.io/flutter/widgets/DefaultAssetBundle-class.html" rel="nofollow" data-token="011e1ccf48027e1851d805dc257b0d64"><code>DefaultAssetBundle</code></a>&nbsp;来获取当前BuildContext的AssetBundle。 这种方法不是使用应用程序构建的默认asset bundle，而是使父级widget在运行时动态替换的不同的AssetBundle，这对于本地化或测试场景很有用。</li>
</ul>
<p>通常，可以使用<code>DefaultAssetBundle.of()</code>在应用运行时来间接加载asset（例如JSON文件），而在widget上下文之外，或其它<code>AssetBundle</code>句柄不可用时，可以使用<code>rootBundle</code>直接加载这些asset，例如：</p>
<pre class="has">
<code>import 'dart:async' show Future;
import 'package:flutter/services.dart' show rootBundle;

Future&lt;String&gt; loadAsset() async {
  return await rootBundle.loadString('assets/config.json');
}
</code></pre>
<h3 id="加载图片">加载图片</h3>
<p>类似于原生开发，Flutter也可以为当前设备加载适合其分辨率的图像。</p>
<p>声明分辨率相关的图片 assets</p>
<p><a href="https://docs.flutter.io/flutter/painting/AssetImage-class.html" rel="nofollow" data-token="f55c31f4385082daf84f7a4b91cc8094"><code>AssetImage</code></a>&nbsp;可以将asset的请求逻辑映射到最接近当前设备像素比例(dpi)的asset。为了使这种映射起作用，必须根据特定的目录结构来保存asset：</p>
<ul>
<li>…/image.png</li>
<li>…/<strong>M</strong>x/image.png</li>
<li>…/<strong>N</strong>x/image.png</li>
<li>…etc.</li>
</ul>
<p>其中M和N是数字标识符，对应于其中包含的图像的分辨率，也就是说，它们指定不同设备像素比例的图片。</p>
<p>主资源默认对应于1.0倍的分辨率图片。看一个例子：</p>
<ul>
<li>…/my_icon.png</li>
<li>…/2.0x/my_icon.png</li>
<li>…/3.0x/my_icon.png</li>
</ul>
<p>在设备像素比率为1.8的设备上，<code>.../2.0x/my_icon.png</code>&nbsp;将被选择。对于2.7的设备像素比率，<code>.../3.0x/my_icon.png</code>将被选择。</p>
<p>如果未在<code>Image</code>&nbsp;widget上指定渲染图像的宽度和高度，那么<code>Image</code>&nbsp;widget将占用与主资源相同的屏幕空间大小。 也就是说，如果<code>.../my_icon.png</code>是72px乘72px，那么<code>.../3.0x/my_icon.png</code>应该是216px乘216px; 但如果未指定宽度和高度，它们都将渲染为72像素×72像素（以逻辑像素为单位）。</p>
<p><code>pubspec.yaml</code>中asset部分中的每一项都应与实际文件相对应，但主资源项除外。当主资源缺少某个资源时，会按分辨率从低到高的顺序去选择 ，也就是说1x中没有的话会在2x中找，2x中还没有的话就在3x中找。</p>
<p>加载图片</p>
<p>要加载图片，可以使用&nbsp;<a href="https://docs.flutter.io/flutter/painting/AssetImage-class.html" rel="nofollow" data-token="f55c31f4385082daf84f7a4b91cc8094"><code>AssetImage</code></a>类。例如，我们可以从上面的asset声明中加载背景图片：</p>
<pre class="has">
<code>Widget build(BuildContext context) {
  return new DecoratedBox(
    decoration: new BoxDecoration(
      image: new DecorationImage(
        image: new AssetImage('graphics/background.png'),
      ),
    ),
  );
}
</code></pre>
<p>注意，<code>AssetImage</code>&nbsp;并非是一个widget， 它实际上是一个<code>ImageProvider</code>，有些时候你可能期望直接得到一个显示图片的widget，那么你可以使用<code>Image.asset()</code>方法，如：</p>
<pre class="has">
<code>Widget build(BuildContext context) {
  return Image.asset('graphics/background.png');
}
</code></pre>
<p>使用默认的 asset bundle 加载资源时，内部会自动处理分辨率等，这些处理对开发者来说是无感知的。 (如果使用一些更低级别的类，如&nbsp;<a href="https://docs.flutter.io/flutter/painting/ImageStream-class.html" rel="nofollow" data-token="a1646f087a00269aafc1693814a4a9e3"><code>ImageStream</code></a>或&nbsp;<a href="https://docs.flutter.io/flutter/painting/ImageCache-class.html" rel="nofollow" data-token="f53a0ed69d58cf3aeee6c54ec8917cd9"><code>ImageCache</code></a>&nbsp;时你会注意到有与缩放相关的参数)</p>
<p>依赖包中的资源图片</p>
<p>要加载依赖包中的图像，必须给<code>AssetImage</code>提供<code>package</code>参数。</p>
<p>例如，假设您的应用程序依赖于一个名为“my_icons”的包，它具有如下目录结构：</p>
<ul>
<li>…/pubspec.yaml</li>
<li>…/icons/heart.png</li>
<li>…/icons/1.5x/heart.png</li>
<li>…/icons/2.0x/heart.png</li>
<li>…etc.</li>
</ul>
<p>然后加载图像，使用:</p>
<pre class="has">
<code> new AssetImage('icons/heart.png', package: 'my_icons')
</code></pre>
<p>或</p>
<pre class="has">
<code>new Image.asset('icons/heart.png', package: 'my_icons')
</code></pre>
<p><strong>注意：包在使用本身的资源时也应该加上<code>package</code>参数来获取</strong>。</p>
<p>打包包中的 assets</p>
<p>如果在<code>pubspec.yaml</code>文件中声明了期望的资源，它将会打包到相应的package中。特别是，包本身使用的资源必须在<code>pubspec.yaml</code>中指定。</p>
<p>包也可以选择在其<code>lib/</code>文件夹中包含未在其<code>pubspec.yaml</code>文件中声明的资源。在这种情况下，对于要打包的图片，应用程序必须在<code>pubspec.yaml</code>中指定包含哪些图像。 例如，一个名为“fancy_backgrounds”的包，可能包含以下文件：</p>
<ul>
<li>…/lib/backgrounds/background1.png</li>
<li>…/lib/backgrounds/background2.png</li>
<li>…/lib/backgrounds/background3.png</li>
</ul>
<p>要包含第一张图像，必须在<code>pubspec.yaml</code>的assets部分中声明它：</p>
<pre class="has">
<code>flutter:
  assets:
    - packages/fancy_backgrounds/backgrounds/background1.png
</code></pre>
<p><code>lib/</code>是隐含的，所以它不应该包含在资产路径中。</p>
<h3 id="特定平台-assets">特定平台 assets</h3>
<p>上面的资源都是flutter应用中的，这些资源只有在Flutter框架运行之后才能使用，如果要给我们的应用设置APP图标或者添加启动图，那我们必须使用特定平台的assets。</p>
<p>设置APP图标</p>
<p>更新Flutter应用程序启动图标的方式与在本机Android或iOS应用程序中更新启动图标的方式相同。</p>
<ul>
<li>
<p>Android</p>
<p>在Flutter项目的根目录中，导航到<code>.../android/app/src/main/res</code>目录，里面包含了各种资源文件夹（如<code>mipmap-hdpi</code>已包含占位符图像”ic_launcher.png”）。 只需按照<a href="https://developer.android.com/guide/practices/ui_guidelines/icon_design_launcher.html#size" rel="nofollow" data-token="8d75fea0312e94b3570e000d496411ee">Android开发人员指南</a>中的说明， 将其替换为所需的资源，并遵守每种屏幕密度（dpi）的建议图标大小标准。</p>
<p><img alt="Android icon location" class="has" src="https://flutterchina.club/images/assets-and-images/android-icon-path.png"></p>
<blockquote>
<p><strong>注意:</strong>&nbsp;如果您重命名.png文件，则还必须在您<code>AndroidManifest.xml</code>的<code>&lt;application&gt;</code>标签的<code>android:icon</code>属性中更新名称。</p>
</blockquote>
</li>
<li>
<p>iOS</p>
<p>在Flutter项目的根目录中，导航到<code>.../ios/Runner</code>。该目录中<code>Assets.xcassets/AppIcon.appiconset</code>已经包含占位符图片。 只需将它们替换为适当大小的图片。保留原始文件名称。</p>
<p><img alt="iOS icon location" class="has" src="https://flutterchina.club/images/assets-and-images/ios-icon-path.png"></p>
</li>
</ul>
<p>更新启动页</p>
<p><img alt="Launch screen" class="has" src="https://flutterchina.club/images/assets-and-images/launch-screen.png"></p>
<p>在Flutter框架加载时，Flutter会使用本地平台机制绘制启动页。此启动页将持续到Flutter渲染应用程序的第一帧时。</p>
<blockquote>
<p><strong>注意:</strong>&nbsp;这意味着如果您不在应用程序的<code>main()</code>方法中调用<a href="https://docs.flutter.io/flutter/widgets/runApp.html" rel="nofollow" data-token="05c81e56468227aee5a5026b2bddbb44">runApp</a>&nbsp;函数 （或者更具体地说，如果您不调用<a href="https://docs.flutter.io/flutter/dart-ui/Window/render.html" rel="nofollow" data-token="5120b5441a4b77401dcf27d415ad6367"><code>window.render</code></a>去响应<a href="https://docs.flutter.io/flutter/dart-ui/Window/onDrawFrame.html" rel="nofollow" data-token="25780fdacfb07a475adb0baf6f572017"><code>window.onDrawFrame</code></a>）的话， 启动屏幕将永远持续显示。</p>
</blockquote>
<p>Android</p>
<p>要将启动屏幕（splash screen）添加到您的Flutter应用程序， 请导航至<code>.../android/app/src/main</code>。在<code>res/drawable/launch_background.xml</code>，通过自定义drawable来实现自定义启动界面（你也可以直接换一张图片）。</p>
<p>iOS</p>
<p>要将图片添加到启动屏幕（splash screen）的中心，请导航至<code>.../ios/Runner</code>。在<code>Assets.xcassets/LaunchImage.imageset</code>， 拖入图片，并命名为<code>LaunchImage.png</code>、<code>LaunchImage@2x.png</code>、<code>LaunchImage@3x.png</code>。 如果你使用不同的文件名，那您还必须更新同一目录中的<code>Contents.json</code>文件，图片的具体尺寸可以查看苹果官方的标准。</p>
<p>您也可以通过打开Xcode完全自定义storyboard。在Project Navigator中导航到<code>Runner/Runner</code>然后通过打开<code>Assets.xcassets</code>拖入图片，或者通过在LaunchScreen.storyboard中使用Interface Builder进行自定义。</p>
<p><img alt="Adding launch icons in Xcode" class="has" src="https://flutterchina.club/images/assets-and-images/ios-launchscreen-xcode.png"></p>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Activity页面变暗并且不可点击只能返回的问题</title>
		<link>https://uzzz.org/article/987.html</link>
				<pubDate>Fri, 12 Apr 2019 02:28:58 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/987.html</guid>
				<description><![CDATA[场景：一个Activity请求网络，当出现网络问题请求出错时，会弹出一个Dialog提示。但是，在结果返回之前就跳到了另一个Activity，使得之前那个Activity处于后台，此时如果回到之前的Activity会出现页面变暗，而且任何地方不能点击的现象。这是由于Activity处于后台，弹Dialog遇到问题没有弹出来，但是页面已经变暗了，并抢占了焦点，]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<p>场景：一个Activity请求网络，当出现网络问题请求出错时，会弹出一个Dialog提示。但是，在结果返回之前就跳到了另一个Activity，使得之前那个Activity处于后台，此时如果回到之前的Activity会出现页面变暗，而且任何地方不能点击的现象。这是由于Activity处于后台，弹Dialog遇到问题没有弹出来，但是页面已经变暗了，并抢占了焦点，使得底部的控件看得见但不可点击。给人的感觉就是App死机了，只有点返回键才能激活页面。查了半天，只遇到一个知己遇到和我一样的问题，并提出来了。有人给了一些方案。如下：<a href="https://www.iteye.com/problems/77129" rel="nofollow" data-token="582c54994dec9d7e00e845d3139d625d">https://www.iteye.com/problems/77129</a></p>
<p>我的场景不太一样，Dialog弹出没有那么重要，极端情况下Dialog可以不弹出，只要页面不变暗并且不可点击。所以我的思路是：只要Activity不是可见的，就不在当前Activity上调用弹出Dialog的操作。具体操作如下：</p>
<p>在我的网络请求框架MyGernericCallback上作如下判断：</p>
<pre class="has">
<code>       //只有当Activity处于前台时，才在当前Activity上弹Dialog
        if (IsActivityForegroundUtil.isForeground((Activity) mContext)) {
            try {
                dialog.show();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }</code></pre>
<p>IsActvityForegroundUtil.java</p>
<pre class="has">
<code>import android.app.Activity;
import android.app.ActivityManager;
import android.content.ComponentName;
import android.content.Context;
import android.text.TextUtils;

import java.util.List;

public class IsActivityForegroundUtil {

    /**
     * 判断某个界面是否在前台
     *
     * @param activity 要判断的Activity
     * @return 是否在前台显示
     */
    public static boolean isForeground(Activity activity) {
        return isForeground(activity, activity.getClass().getName());
    }

    /**
     * 判断某个界面是否在前台
     *
     * @param context   Context
     * @param className 界面的类名
     * @return 是否在前台显示
     */
    public static boolean isForeground(Context context, String className) {
        if (context == null || TextUtils.isEmpty(className))
            return false;
        ActivityManager am = (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);
        List&lt;ActivityManager.RunningTaskInfo&gt; list = am.getRunningTasks(1);
        if (list != null &amp;&amp; list.size() &gt; 0) {
            ComponentName cpn = list.get(0).topActivity;
            if (className.equals(cpn.getClassName()))
                return true;
        }
        return false;

    }
}
</code></pre>
<p>&nbsp;</p>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>webView中导入百度地图和设置样式</title>
		<link>https://uzzz.org/article/1383.html</link>
				<pubDate>Sat, 28 Apr 2018 04:15:33 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[java]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1383.html</guid>
				<description><![CDATA[首先看效果图： ####怎样获取百度地图api 第一种方式：找到“百度地图api” 第二种方式：”百度地图生成器“ 注意此方式生成的地图使用的是百度地图api1.1 ####设置地图样式 博主使用的是用百度地图生成器生成的地图，可以先保存成html格式，查看地图是否需要改进 &#8211; 消除百度地图的logo 方法：使用Google浏览器打开刚刚保存的H]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<p>首先看效果图：<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428111638955?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>####怎样获取百度地图api<br /> 第一种方式：找到“百度地图api”<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428112144334?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428112526844?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/2018042811310574?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>第二种方式：”百度地图生成器“<br /> 注意此方式生成的地图使用的是<strong>百度地图api1.1</strong><br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428113419632?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>####设置地图样式<br /> 博主使用的是用百度地图生成器生成的地图，可以先保存成html格式，查看地图是否需要改进</p>
<h5><a id="_logo_17"></a>&#8211; 消除百度地图的logo</h5>
<p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428114233438?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br /> 方法：使用Google浏览器打开刚刚保存的HTML，打开开发者模式（或者按F12）<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428114836683?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>添加样式消除logo</p>
<pre><code>.BMap_cpyCtrl {
    display: none;
}

.anchorBL {
    display: none;
}
</code></pre>
<p>#####设置背景色<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428115212845?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br /> 因为这个样式在百度地图api1.0中不起效，所以我把JavaScript换成了3.0</p>
<pre><code>原js:
&lt;script type="text/javascript" src="http://api.map.baidu.com/api?key=&amp;v=1.1&amp;services=true"&gt;&lt;/script&gt;
换成api3.0
 &lt;script type="text/javascript"src="http://api.map.baidu.com/api?v=3.0&amp;ak=SWxEiZYKTcujcC6rTY5MvBsWHETIlT97"&gt;&lt;/script&gt;
</code></pre>
<p>#####设置地图的大小<br /> 这里设置充满屏幕，需要改动三个地方，是否还有其他方法不太清楚，但是博主是这样做的（可能我太菜了）<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428120300805?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428120312294?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428120325172?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>暂时博主就只设置这几个样式，最终效果图如下：<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428120547575?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>####使用webView加载百度地图<br /> 这里我使用Javafx中的webView组件，详情可见：<a href="http://www.javafxchina.net/blog/2015/07/html_webview/" rel="nofollow" data-token="b11e3c7c8af1b296a9af23c1b6cf64ab">WebView组件概览</a></p>
<p>目录结构：<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428121205308?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<pre><code>package work.javaee.maptest;

import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.layout.BorderPane;
import javafx.scene.web.WebEngine;
import javafx.scene.web.WebView;
import javafx.stage.Stage;

public class Main  extends Application{
    @Override
    public void start(Stage primaryStage) throws Exception {

        //设置窗体布局
        BorderPane borderPane = new BorderPane();
        //创建scene
        Scene scene = new Scene(borderPane);

		//创建WebView和WebEngine对象
        WebView webView = new WebView();
        WebEngine webEngine = webView.getEngine();
        //使用类加载器加载本地HTML代码
        webEngine.load(ClassLoader.getSystemClassLoader().getResource("html/map.html").toExternalForm());

        borderPane.setCenter(webView);

        primaryStage.setScene(scene);
        primaryStage.show();

    }

    public static void main(String[] args) {
        launch(args);
    }
}

</code></pre>
<pre><code>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/&gt;
    &lt;title&gt;百度地图API自定义地图&lt;/title&gt;
    &lt;!--引用百度地图API--&gt;
    &lt;style type="text/css"&gt;
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        .iw_poi_title {
            color: #CC5522;
            font-size: 14px;
            font-weight: bold;
            overflow: hidden;
            padding-right: 13px;
            white-space: nowrap
        }

        .iw_poi_content {
            font: 12px arial, sans-serif;
            overflow: visible;
            padding-top: 4px;
            white-space: -moz-pre-wrap;
            word-wrap: break-word
        }

        .BMap_cpyCtrl {
            display: none;
        }

        .anchorBL {
            display: none;
        }

        body {
            width: 100%;
            height: 100%;
        }
    &lt;/style&gt;
    &lt;script type="text/javascript"
            src="http://api.map.baidu.com/api?v=3.0&amp;ak=PlhFWpA02aoURjAOpnWcRGqw7AI8EEyO"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"
            src="http://api.map.baidu.com/library/AreaRestriction/1.2/src/AreaRestriction_min.js"&gt;&lt;/script&gt;

&lt;/head&gt;

&lt;body&gt;
&lt;!--百度地图容器--&gt;
&lt;div style="width:100%;height:100%;border:#ccc solid 1px;" id="dituContent"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;script type="text/javascript"&gt;
    //创建和初始化地图函数
    function initMap() {
        createMap();//创建地图
        setMapEvent();//设置地图事件
        addMapControl();//向地图添加控件
    }

    //创建地图函数＿
    function createMap() {
        var map = new BMap.Map("dituContent");//在百度地图容器中创建一个地图
        var mapStyle = {style: "dark"};
        map.setMapStyle(mapStyle);
        var point = new BMap.Point(115.915423, 28.681691);//定义一个中心点坐标
        map.centerAndZoom(point, 7);//设定地图的中心点和坐标并将地图显示在地图容器
        window.map = map;//将map变量存储在全局
    }

    //地图事件设置函数
    function setMapEvent() {
        map.enableDragging();//启用地图拖拽事件，默认启用(可不写)
        map.enableScrollWheelZoom();//启用地图滚轮放大缩小
        map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)
        map.enableKeyboard();//启用键盘上下左右键移动地图
    }

    //地图控件添加函数：
    function addMapControl() {
        //向地图中添加缩放控件
        var ctrl_nav = new BMap.NavigationControl({anchor: BMAP_ANCHOR_TOP_RIGHT, type: BMAP_NAVIGATION_CONTROL_SMALL});
        map.addControl(ctrl_nav);
        //向地图中添加缩略图控件
        var ctrl_ove = new BMap.OverviewMapControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT, isOpen: 0});
        map.addControl(ctrl_ove);
        //向地图中添加比例尺控件
        var ctrl_sca = new BMap.ScaleControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT});
        map.addControl(ctrl_sca);
    }


    initMap();//创建和初始化地图
&lt;/script&gt;
&lt;/html&gt;
</code></pre>
<p>最终效果图如下：<br /> <img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180428121448465?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1Y2tFbm91Z2g=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
</p></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Android Deep Link</title>
		<link>https://uzzz.org/article/1665.html</link>
				<pubDate>Sun, 17 Dec 2017 13:22:03 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[资讯]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1665.html</guid>
				<description><![CDATA[Android Deep Link 官网参考文档 使用场景 用户在网页点击了一个链接以后，直接引导用户在本地应用中查看对应的内容。 原理 当我们点击或者自动化的网络请求会生成一个web URI intent，Android系统按照一定顺序去处理这个请求。 处理顺序为：1.打开所有可以处理本URL应用中用户默认选择的；2.打开唯一能处理这个URL的应用；3.将]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<h1 id="android-deep-link">Android Deep Link</h1>
<p><a href="https://developer.android.com/training/app-links/deep-linking.html" rel="nofollow noopener noreferrer" target="_blank" data-token="577a5a854275b19010dac43688c7260c">官网参考文档</a></p>
<h2 id="使用场景">使用场景</h2>
<p>用户在网页点击了一个链接以后，直接引导用户在本地应用中查看对应的内容。</p>
<h2 id="原理">原理</h2>
<p>当我们点击或者自动化的网络请求会生成一个web URI intent，Android系统按照一定顺序去处理这个请求。 <br /> 处理顺序为：1.打开所有可以处理本URL应用中用户默认选择的；2.打开唯一能处理这个URL的应用；3.将所有可以处理这个URL的应用展示在Dialog中让用户选择</p>
<h2 id="基本步骤">基本步骤</h2>
<ol>
<li>在manifest文件中定义IntentFilter</li>
<li>建立对应处理的Activity</li>
<li>(对于Android App Link而言)将本地内容与URL地址通过服务器上的Digital Asset Links文件关联起来</li>
</ol>
<h2 id="辅助工具">辅助工具</h2>
<p>Android Studio的App Link Assistant使用说明：<a href="https://developer.android.com/studio/write/app-link-indexing.html#intent" rel="nofollow noopener noreferrer" target="_blank" data-token="5ae40f6271fd3125f0e6a219d1dd01af">官方使用指南</a></p>
<h2 id="分类">分类</h2>
<p><strong>Deep Link</strong>,<strong>Android App Link</strong></p>
<h2 id="deep-link">Deep Link</h2>
<h3 id="配置">配置</h3>
<ol>
<li>在Manifest中增加intent filter <br /> 
<ul>
<li><code>&lt;action&gt;</code>: ACTION_VIEW</li>
<li><code>&lt;category&gt;</code>: 包含BROWSABLE,DEFAULT.BROWSABLE(必须包含，才可以处理来至l浏览器的Intent Filter)</li>
<li><code>&lt;data&gt;</code>: 指定可以响应的URI信息，至少包含scheme标签，可以使用path,pathPattern或者pathPrefix去处理相似的URI</li>
</ul>
</li>
</ol>
<pre class="prettyprint"><code class=" hljs xml">    // 可以响应example://gizmos 和 http://www.example.com/gizmos的Activity
    <span class="hljs-tag">&lt;<span class="hljs-title">activity </span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.example.android.GizmosActivity"</span> <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"@string/title_gizmos"</span> &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"@string/filter_view_http_gizmos"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- Accepts URIs that begin with "http://www.example.com/gizmos” --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"http"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"www.example.com"</span> <span class="hljs-attribute">android:pathPrefix</span>=<span class="hljs-value">"/gizmos"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- note that the leading "/" is required for pathPrefix--&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"@string/filter_view_example_gizmos"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- Accepts URIs that begin with "example://gizmos” --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"example"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"gizmos"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<p><em>注意点</em> <br /> 同一个Intent Filter中的<code>&lt;data&gt;</code>会进行合并组合</p>
<pre class="prettyprint"><code class=" hljs r">&lt;intent-filter&gt;
  <span class="hljs-keyword">...</span>
  &lt;data android:scheme=<span class="hljs-string">"https"</span> android:host=<span class="hljs-string">"www.example.com"</span> /&gt;
  &lt;data android:scheme=<span class="hljs-string">"app"</span> android:host=<span class="hljs-string">"open.my.app"</span> /&gt;
&lt;/intent-filter&gt;
// 会生成app://www.example.com 和 https://open.my.app</code></pre>
<h3 id="从intent获取数据">从Intent获取数据</h3>
<p>一旦系统通过Intent Filter打开你的界面,可以从Intent中获取数据</p>
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-annotation">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Intent intent = getIntent();
    String action = intent.getAction();
    Uri data = intent.getData();
}</code></pre>
<p>mainfest文件里定义了定义了应用与网页的关系和如何处理这些链接</p>
<h3 id="测试配置">测试配置</h3>
<pre class="prettyprint"><code class=" hljs haml">$ adb shell am start
        -<span class="ruby"><span class="hljs-constant">W</span> -a android.intent.action.<span class="hljs-constant">VIEW</span> </span>        -<span class="ruby">d &lt;<span class="hljs-constant">URI</span>&gt; &lt;<span class="hljs-constant">PACKAGE</span>&gt;</span></code></pre>
<h2 id="android-app-link">Android App Link</h2>
<ul>
<li>原因：将自己的应用作为URI的默认处理应用，从而减少弹出选择处理对应应用的对话框</li>
<li>本质：一种特殊的Deep Link</li>
<li>查看本机已经支持Android App Link的应用</li>
</ul>
<pre class="prettyprint"><code class=" hljs lua">adb shell dumpsys <span class="hljs-built_in">package</span> domain-preferred-apps
或
adb shell dumpsys <span class="hljs-built_in">package</span> d</code></pre>
<ul>
<li>安装应用后系统至少需要20s去自动认证</li>
</ul>
<h3 id="认证链接verify-android-app-link">认证链接(verify android app link)</h3>
<p>第一步：在mainfest中定义可以处理的URI <br /> 第二步：认证URL与app,让系统认证你拥有这个url,系统自动的将URL定位至你的应用</p>
<h4 id="认证步骤">认证步骤</h4>
<h4 id="app端开启认证能力">App端开启认证能力</h4>
<p>在任一IntentFilter中添加android:autoVerify=”true”,6.0及以上系统自动认证所有符合如下条件IntentFilter中的URL，步骤如下 <br /> 1. 查找所有有</p>
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-label">Action:</span> android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.action</span><span class="hljs-preprocessor">.VIEW</span>
<span class="hljs-label">Categories:</span> android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.category</span><span class="hljs-preprocessor">.BROWSABLE</span>
Data scheme: http <span class="hljs-keyword">or</span> https，host为URL域名</code></pre>
<p>标签的IntentFilter <br /> 2. 对在1过程中找到的所有URL,Android会向对应的网址<a href="https://hostname/.well-known/assetlinks.json" rel="nofollow noopener noreferrer" target="_blank" data-token="8d62097cdb74a044a085dc91108b20ff">https://hostname/.well-known/assetlinks.json</a>中的Digital Asset Links file认证。 <br /> 3. 只有当找到所有在AndroidMainfest中的网址时都被认证时，才能作为对应URL唯一响应App</p>
<h4 id="服务端发布认证文件">服务端发布认证文件</h4>
<ul>
<li>发布的地址：<a href="https://domain.name/.well-known/assetlinks.json" rel="nofollow noopener noreferrer" target="_blank" data-token="0ac84cafb0c996a466357a7cee1d1874">https://domain.name/.well-known/assetlinks.json</a></li>
<li>需要标明文件类型：content-type application/json</li>
<li>需要https获取</li>
<li>可以直接获取，不能有任何的重定位(比如301或者302)而且可以被robots抓取</li>
<li>如果你的应用支持多个网址，在每个对应网址下都要放置对应文件</li>
<li>网址要公众网，避免不能被正确获取</li>
</ul>
<pre class="prettyprint"><code class=" hljs json">[{
  "<span class="hljs-attribute">relation</span>": <span class="hljs-value">[<span class="hljs-string">"delegate_permission/common.handle_all_urls"</span>]</span>,
  "<span class="hljs-attribute">target</span>": <span class="hljs-value">{ "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"android_app"</span></span>, "<span class="hljs-attribute">package_name</span>": <span class="hljs-value"><span class="hljs-string">"com.example"</span></span>, "<span class="hljs-attribute">sha256_cert_fingerprints</span>": <span class="hljs-value">[<span class="hljs-string">"14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"</span>] </span>} </span>}]</code></pre>
<p>package_name:build.gradle file文件中的application id <br /> sha256_cert_fingerprints:keystore的密匙，可以使用keytool -list -v -keystore my-release-key.keystore获取</p>
<h3 id="android-app-link组合情况说明">Android App Link组合情况说明</h3>
<ul>
<li>一个Actvity对应多个URL</li>
</ul>
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">”MainActivity”</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:autoVerify</span>=<span class="hljs-value">"true"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"http"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"www.example.com"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<ul>
<li>复杂的子域名</li>
</ul>
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">”MainActivity”</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:autoVerify</span>=<span class="hljs-value">"true"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"www.example.com"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"mobile.example.com"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span>
// 特例对于*.example.com的服务器端文件需要放置在example.com中
<span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">”MainActivity”</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:autoVerify</span>=<span class="hljs-value">"true"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"*.example.com"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<ul>
<li>一个RUL对应多个App <br /> 在服务器文件配置</li>
</ul>
<pre class="prettyprint"><code class=" hljs json">[{
  "<span class="hljs-attribute">relation</span>": <span class="hljs-value">[<span class="hljs-string">"delegate_permission/common.handle_all_urls"</span>]</span>,
  "<span class="hljs-attribute">target</span>": <span class="hljs-value">{ "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"android_app"</span></span>, "<span class="hljs-attribute">package_name</span>": <span class="hljs-value"><span class="hljs-string">"com.example.puppies.app"</span></span>, "<span class="hljs-attribute">sha256_cert_fingerprints</span>": <span class="hljs-value">[<span class="hljs-string">"14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"</span>] </span>} </span>},
  {
  "<span class="hljs-attribute">relation</span>": <span class="hljs-value">[<span class="hljs-string">"delegate_permission/common.handle_all_urls"</span>]</span>,
  "<span class="hljs-attribute">target</span>": <span class="hljs-value">{ "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"android_app"</span></span>, "<span class="hljs-attribute">package_name</span>": <span class="hljs-value"><span class="hljs-string">"com.example.monkeys.app"</span></span>, "<span class="hljs-attribute">sha256_cert_fingerprints</span>": <span class="hljs-value">[<span class="hljs-string">"14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"</span>] </span>} </span>}]</code></pre>
<ul>
<li>一个App对应多个域名 <br /> 在各个域名添加.well-known/assetlinks.json文件</li>
</ul>
<h3 id="测试android-app-link是否配置成功">测试Android App Link是否配置成功</h3>
<h4 id="检测应用端是否配置正确">检测应用端是否配置正确</h4>
<pre class="prettyprint"><code class=" hljs avrasm">adb shell am start -a android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.action</span><span class="hljs-preprocessor">.VIEW</span> 
    -c android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.category</span><span class="hljs-preprocessor">.BROWSABLE</span> 
    -d <span class="hljs-string">"http://domain.name:optional_port"</span></code></pre>
<h4 id="检测服务器文件是否配置成功">检测服务器文件是否配置成功</h4>
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-label">https:</span>//digitalassetlinks<span class="hljs-preprocessor">.googleapis</span><span class="hljs-preprocessor">.com</span>/v1/statements:list?
   source<span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.site</span>=https://domain<span class="hljs-preprocessor">.name</span>:optional_port&amp;
   relation=delegate_permission/common<span class="hljs-preprocessor">.handle</span>_all_urls</code></pre>
<h2 id="deeplink与android-app-link区别">DeepLink与Android App Link区别</h2>
<ul>
<li>deeplink 是一个intent filter让用户直接进入应用中的某个页面。在有多个可以处理的应用时会弹出一个对话框让你选择对应的处理应用</li>
<li>Android App Link是一个经过认证的基于你的url的特殊deeplink,可以立即调起你的应用，而不必弹出对话框选择 <br /> <img src="https://github.com/jiaozidev/images/blob/master/difference%20bewteen%20Deep%20Link%20and%20Android%20App%20Link.png" alt="" title=""></li>
</ul>
<h2 id="建议">建议</h2>
<ul>
<li>跳转界面的设置：android:noHistory=”true”</li>
</ul>
<h2 id="注意点">注意点</h2>
<ul>
<li><code>&lt;data&gt;</code>标签的匹配模式需要注意</li>
</ul>
<h2 id="微信等问题记录">微信等问题记录</h2>
<ul>
<li>qq浏览器，uc浏览器拦截http与https协议的web URI intent,chrome正常</li>
<li>微信内置浏览器拦截web URI intent,可以借助应用宝的微下载实现基本跳转，微下载扩展功能的使用条件 <br /> <img src="https://github.com/jiaozidev/images/blob/master/%E5%BA%94%E7%94%A8%E5%AE%9D%E5%BE%AE%E4%B8%8B%E8%BD%BDapplink%E7%94%B3%E8%AF%B7%E6%9D%A1%E4%BB%B6.png" alt="扩展条件" title=""> </li>
</ul></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Android Deep Link</title>
		<link>https://uzzz.org/article/1597.html</link>
				<pubDate>Sun, 17 Dec 2017 13:22:03 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[资讯]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1597.html</guid>
				<description><![CDATA[Android Deep Link 官网参考文档 使用场景 用户在网页点击了一个链接以后，直接引导用户在本地应用中查看对应的内容。 原理 当我们点击或者自动化的网络请求会生成一个web URI intent，Android系统按照一定顺序去处理这个请求。 处理顺序为：1.打开所有可以处理本URL应用中用户默认选择的；2.打开唯一能处理这个URL的应用；3.将]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<h1 id="android-deep-link">Android Deep Link</h1>
<p><a href="https://developer.android.com/training/app-links/deep-linking.html" rel="nofollow noopener noreferrer" target="_blank" data-token="577a5a854275b19010dac43688c7260c">官网参考文档</a></p>
<h2 id="使用场景">使用场景</h2>
<p>用户在网页点击了一个链接以后，直接引导用户在本地应用中查看对应的内容。</p>
<h2 id="原理">原理</h2>
<p>当我们点击或者自动化的网络请求会生成一个web URI intent，Android系统按照一定顺序去处理这个请求。 <br /> 处理顺序为：1.打开所有可以处理本URL应用中用户默认选择的；2.打开唯一能处理这个URL的应用；3.将所有可以处理这个URL的应用展示在Dialog中让用户选择</p>
<h2 id="基本步骤">基本步骤</h2>
<ol>
<li>在manifest文件中定义IntentFilter</li>
<li>建立对应处理的Activity</li>
<li>(对于Android App Link而言)将本地内容与URL地址通过服务器上的Digital Asset Links文件关联起来</li>
</ol>
<h2 id="辅助工具">辅助工具</h2>
<p>Android Studio的App Link Assistant使用说明：<a href="https://developer.android.com/studio/write/app-link-indexing.html#intent" rel="nofollow noopener noreferrer" target="_blank" data-token="5ae40f6271fd3125f0e6a219d1dd01af">官方使用指南</a></p>
<h2 id="分类">分类</h2>
<p><strong>Deep Link</strong>,<strong>Android App Link</strong></p>
<h2 id="deep-link">Deep Link</h2>
<h3 id="配置">配置</h3>
<ol>
<li>在Manifest中增加intent filter <br /> 
<ul>
<li><code>&lt;action&gt;</code>: ACTION_VIEW</li>
<li><code>&lt;category&gt;</code>: 包含BROWSABLE,DEFAULT.BROWSABLE(必须包含，才可以处理来至l浏览器的Intent Filter)</li>
<li><code>&lt;data&gt;</code>: 指定可以响应的URI信息，至少包含scheme标签，可以使用path,pathPattern或者pathPrefix去处理相似的URI</li>
</ul>
</li>
</ol>
<pre class="prettyprint"><code class=" hljs xml">    // 可以响应example://gizmos 和 http://www.example.com/gizmos的Activity
    <span class="hljs-tag">&lt;<span class="hljs-title">activity </span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.example.android.GizmosActivity"</span> <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"@string/title_gizmos"</span> &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"@string/filter_view_http_gizmos"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- Accepts URIs that begin with "http://www.example.com/gizmos” --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"http"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"www.example.com"</span> <span class="hljs-attribute">android:pathPrefix</span>=<span class="hljs-value">"/gizmos"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- note that the leading "/" is required for pathPrefix--&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"@string/filter_view_example_gizmos"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- Accepts URIs that begin with "example://gizmos” --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"example"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"gizmos"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<p><em>注意点</em> <br /> 同一个Intent Filter中的<code>&lt;data&gt;</code>会进行合并组合</p>
<pre class="prettyprint"><code class=" hljs r">&lt;intent-filter&gt;
  <span class="hljs-keyword">...</span>
  &lt;data android:scheme=<span class="hljs-string">"https"</span> android:host=<span class="hljs-string">"www.example.com"</span> /&gt;
  &lt;data android:scheme=<span class="hljs-string">"app"</span> android:host=<span class="hljs-string">"open.my.app"</span> /&gt;
&lt;/intent-filter&gt;
// 会生成app://www.example.com 和 https://open.my.app</code></pre>
<h3 id="从intent获取数据">从Intent获取数据</h3>
<p>一旦系统通过Intent Filter打开你的界面,可以从Intent中获取数据</p>
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-annotation">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Intent intent = getIntent();
    String action = intent.getAction();
    Uri data = intent.getData();
}</code></pre>
<p>mainfest文件里定义了定义了应用与网页的关系和如何处理这些链接</p>
<h3 id="测试配置">测试配置</h3>
<pre class="prettyprint"><code class=" hljs haml">$ adb shell am start
        -<span class="ruby"><span class="hljs-constant">W</span> -a android.intent.action.<span class="hljs-constant">VIEW</span> </span>        -<span class="ruby">d &lt;<span class="hljs-constant">URI</span>&gt; &lt;<span class="hljs-constant">PACKAGE</span>&gt;</span></code></pre>
<h2 id="android-app-link">Android App Link</h2>
<ul>
<li>原因：将自己的应用作为URI的默认处理应用，从而减少弹出选择处理对应应用的对话框</li>
<li>本质：一种特殊的Deep Link</li>
<li>查看本机已经支持Android App Link的应用</li>
</ul>
<pre class="prettyprint"><code class=" hljs lua">adb shell dumpsys <span class="hljs-built_in">package</span> domain-preferred-apps
或
adb shell dumpsys <span class="hljs-built_in">package</span> d</code></pre>
<ul>
<li>安装应用后系统至少需要20s去自动认证</li>
</ul>
<h3 id="认证链接verify-android-app-link">认证链接(verify android app link)</h3>
<p>第一步：在mainfest中定义可以处理的URI <br /> 第二步：认证URL与app,让系统认证你拥有这个url,系统自动的将URL定位至你的应用</p>
<h4 id="认证步骤">认证步骤</h4>
<h4 id="app端开启认证能力">App端开启认证能力</h4>
<p>在任一IntentFilter中添加android:autoVerify=”true”,6.0及以上系统自动认证所有符合如下条件IntentFilter中的URL，步骤如下 <br /> 1. 查找所有有</p>
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-label">Action:</span> android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.action</span><span class="hljs-preprocessor">.VIEW</span>
<span class="hljs-label">Categories:</span> android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.category</span><span class="hljs-preprocessor">.BROWSABLE</span>
Data scheme: http <span class="hljs-keyword">or</span> https，host为URL域名</code></pre>
<p>标签的IntentFilter <br /> 2. 对在1过程中找到的所有URL,Android会向对应的网址<a href="https://hostname/.well-known/assetlinks.json" rel="nofollow noopener noreferrer" target="_blank" data-token="8d62097cdb74a044a085dc91108b20ff">https://hostname/.well-known/assetlinks.json</a>中的Digital Asset Links file认证。 <br /> 3. 只有当找到所有在AndroidMainfest中的网址时都被认证时，才能作为对应URL唯一响应App</p>
<h4 id="服务端发布认证文件">服务端发布认证文件</h4>
<ul>
<li>发布的地址：<a href="https://domain.name/.well-known/assetlinks.json" rel="nofollow noopener noreferrer" target="_blank" data-token="0ac84cafb0c996a466357a7cee1d1874">https://domain.name/.well-known/assetlinks.json</a></li>
<li>需要标明文件类型：content-type application/json</li>
<li>需要https获取</li>
<li>可以直接获取，不能有任何的重定位(比如301或者302)而且可以被robots抓取</li>
<li>如果你的应用支持多个网址，在每个对应网址下都要放置对应文件</li>
<li>网址要公众网，避免不能被正确获取</li>
</ul>
<pre class="prettyprint"><code class=" hljs json">[{
  "<span class="hljs-attribute">relation</span>": <span class="hljs-value">[<span class="hljs-string">"delegate_permission/common.handle_all_urls"</span>]</span>,
  "<span class="hljs-attribute">target</span>": <span class="hljs-value">{ "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"android_app"</span></span>, "<span class="hljs-attribute">package_name</span>": <span class="hljs-value"><span class="hljs-string">"com.example"</span></span>, "<span class="hljs-attribute">sha256_cert_fingerprints</span>": <span class="hljs-value">[<span class="hljs-string">"14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"</span>] </span>} </span>}]</code></pre>
<p>package_name:build.gradle file文件中的application id <br /> sha256_cert_fingerprints:keystore的密匙，可以使用keytool -list -v -keystore my-release-key.keystore获取</p>
<h3 id="android-app-link组合情况说明">Android App Link组合情况说明</h3>
<ul>
<li>一个Actvity对应多个URL</li>
</ul>
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">”MainActivity”</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:autoVerify</span>=<span class="hljs-value">"true"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"http"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"www.example.com"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<ul>
<li>复杂的子域名</li>
</ul>
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">”MainActivity”</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:autoVerify</span>=<span class="hljs-value">"true"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"www.example.com"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"mobile.example.com"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span>
// 特例对于*.example.com的服务器端文件需要放置在example.com中
<span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">”MainActivity”</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span> <span class="hljs-attribute">android:autoVerify</span>=<span class="hljs-value">"true"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"https"</span> <span class="hljs-attribute">android:host</span>=<span class="hljs-value">"*.example.com"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<ul>
<li>一个RUL对应多个App <br /> 在服务器文件配置</li>
</ul>
<pre class="prettyprint"><code class=" hljs json">[{
  "<span class="hljs-attribute">relation</span>": <span class="hljs-value">[<span class="hljs-string">"delegate_permission/common.handle_all_urls"</span>]</span>,
  "<span class="hljs-attribute">target</span>": <span class="hljs-value">{ "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"android_app"</span></span>, "<span class="hljs-attribute">package_name</span>": <span class="hljs-value"><span class="hljs-string">"com.example.puppies.app"</span></span>, "<span class="hljs-attribute">sha256_cert_fingerprints</span>": <span class="hljs-value">[<span class="hljs-string">"14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"</span>] </span>} </span>},
  {
  "<span class="hljs-attribute">relation</span>": <span class="hljs-value">[<span class="hljs-string">"delegate_permission/common.handle_all_urls"</span>]</span>,
  "<span class="hljs-attribute">target</span>": <span class="hljs-value">{ "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"android_app"</span></span>, "<span class="hljs-attribute">package_name</span>": <span class="hljs-value"><span class="hljs-string">"com.example.monkeys.app"</span></span>, "<span class="hljs-attribute">sha256_cert_fingerprints</span>": <span class="hljs-value">[<span class="hljs-string">"14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"</span>] </span>} </span>}]</code></pre>
<ul>
<li>一个App对应多个域名 <br /> 在各个域名添加.well-known/assetlinks.json文件</li>
</ul>
<h3 id="测试android-app-link是否配置成功">测试Android App Link是否配置成功</h3>
<h4 id="检测应用端是否配置正确">检测应用端是否配置正确</h4>
<pre class="prettyprint"><code class=" hljs avrasm">adb shell am start -a android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.action</span><span class="hljs-preprocessor">.VIEW</span> 
    -c android<span class="hljs-preprocessor">.intent</span><span class="hljs-preprocessor">.category</span><span class="hljs-preprocessor">.BROWSABLE</span> 
    -d <span class="hljs-string">"http://domain.name:optional_port"</span></code></pre>
<h4 id="检测服务器文件是否配置成功">检测服务器文件是否配置成功</h4>
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-label">https:</span>//digitalassetlinks<span class="hljs-preprocessor">.googleapis</span><span class="hljs-preprocessor">.com</span>/v1/statements:list?
   source<span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.site</span>=https://domain<span class="hljs-preprocessor">.name</span>:optional_port&amp;
   relation=delegate_permission/common<span class="hljs-preprocessor">.handle</span>_all_urls</code></pre>
<h2 id="deeplink与android-app-link区别">DeepLink与Android App Link区别</h2>
<ul>
<li>deeplink 是一个intent filter让用户直接进入应用中的某个页面。在有多个可以处理的应用时会弹出一个对话框让你选择对应的处理应用</li>
<li>Android App Link是一个经过认证的基于你的url的特殊deeplink,可以立即调起你的应用，而不必弹出对话框选择 <br /> <img src="https://github.com/jiaozidev/images/blob/master/difference%20bewteen%20Deep%20Link%20and%20Android%20App%20Link.png" alt="" title=""></li>
</ul>
<h2 id="建议">建议</h2>
<ul>
<li>跳转界面的设置：android:noHistory=”true”</li>
</ul>
<h2 id="注意点">注意点</h2>
<ul>
<li><code>&lt;data&gt;</code>标签的匹配模式需要注意</li>
</ul>
<h2 id="微信等问题记录">微信等问题记录</h2>
<ul>
<li>qq浏览器，uc浏览器拦截http与https协议的web URI intent,chrome正常</li>
<li>微信内置浏览器拦截web URI intent,可以借助应用宝的微下载实现基本跳转，微下载扩展功能的使用条件 <br /> <img src="https://github.com/jiaozidev/images/blob/master/%E5%BA%94%E7%94%A8%E5%AE%9D%E5%BE%AE%E4%B8%8B%E8%BD%BDapplink%E7%94%B3%E8%AF%B7%E6%9D%A1%E4%BB%B6.png" alt="扩展条件" title=""> </li>
</ul></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Deep linking 深度链接</title>
		<link>https://uzzz.org/article/1655.html</link>
				<pubDate>Thu, 23 Nov 2017 10:30:20 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[移动开发]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1655.html</guid>
				<description><![CDATA[使用安卓或ios软件的过程中经常碰到这样一种情况：当我在浏览器打开一个页面时，时常会自动打开相对应的app，并进入相应的app页面中，这就用到一项技术-Deep Linking，下面就来介绍一下如何在自己的android APP中使用这项技术。 1。假设已经有了一个app项目，我们需要在项目中新建一个Activity。我们暂且取名为ViewActivity，]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<p>使用安卓或ios软件的过程中经常碰到这样一种情况：当我在浏览器打开一个页面时，时常会自动打开相对应的app，并进入相应的app页面中，这就用到一项技术-Deep Linking，下面就来介绍一下如何在自己的android APP中使用这项技术。</p>
<p>1。假设已经有了一个app项目，我们需要在项目中新建一个Activity。我们暂且取名为ViewActivity，在AndroidManifest.xml文件中的ViewActivity标签中添加Intent-filter：</p>
<pre class="prettyprint"><code class=" hljs xml">  <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">".activity.ViewActivity"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"myapp"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<p>2。此时在网页中就可调用这个地址就可以打开我们的app，下面是我写的一个测试deep linking的html代码：</p>
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"{CHARSET}"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"myapp://"</span>&gt;</span>打开我的app<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre>
<p>在手机上打开这个网页，点击链接“打开我的app”就可以自动打开我们的app了，并且能自动进入ViewActivity这个页面中。其实并不是只有myapp://这个链接可以进入我们的app，只要开头为myapp://的链接都可以自动进入我们的app。</p>
<p>3.但是我们的要求不是自动进入app的ViewActivity页面，我们的ViewActivity只是作为一个处理deep linking 的一个过渡页面。总不能在每个页面都要写这么一套代码吧，当然不能，下面我就来介绍如何根据schema内容来引导app进入页面 <br /> 1).在ViewActivity中取出我们的URI值。在此顺带讲解一下URI值中的各个属性，可能有些代码在我们这个测试项目中用不到，只是作为demo讲解一下（我的项目使用kotlin写的，暂时就用kotlin给大家讲解了，我相信懂java的应该都能看懂kotlin）</p>
<pre class="prettyprint"><code class=" hljs cs"> val uri = intent.data<span class="hljs-comment">//链接地址</span>
 val host = uri.host<span class="hljs-comment">//域名</span>
 <span class="hljs-keyword">var</span> query=uri.query<span class="hljs-comment">//获取参数列表</span>
 <span class="hljs-keyword">var</span> <span class="hljs-keyword">params</span> = query.toString().split(<span class="hljs-string">"&amp;"</span>)
 <span class="hljs-keyword">var</span> bundle=Bundle()<span class="hljs-comment">//bundle容器，用来保存传递链接问号后带的参数</span>
 <span class="hljs-keyword">if</span>(<span class="hljs-keyword">null</span>!=<span class="hljs-keyword">params</span>){
 <span class="hljs-keyword">for</span> (key_value <span class="hljs-keyword">in</span> <span class="hljs-keyword">params</span>) {
     bundle.putString(key_value.split(<span class="hljs-string">"="</span>)[<span class="hljs-number">0</span>],key_value.split(<span class="hljs-string">"="</span>)[<span class="hljs-number">1</span>])
   }
 }
 intent.putExtras(bundle)
 <span class="hljs-keyword">var</span> pageName=uri.getHost()<span class="hljs-comment">//这就是我们链接中传递过来的页面名字，因为很多情况下需要统一android与IOS的页面跳转，所以这个名字并不是我们严格意义上的项目中的页面名，而是我们私下里商量好的那个字符串对应哪个页面</span>
 when(pageName){
   <span class="hljs-string">"page1"</span> -&gt;{
     intent.setClass(<span class="hljs-keyword">this</span>,Page1::class.java)
     startActivity(intent)
   }
   <span class="hljs-string">"page2"</span> -&gt;{
     intent.setClass(<span class="hljs-keyword">this</span>.Page2::class.java)
     startActivity(intent)
   }
}
 finish()
</code></pre>
<p>大功告成，至此我们的deep link基础就讲解完了，app此时就可以根据事先的约定根据链接打开并跳转到相应的app了，并且携带了链接后带的参数传到相应的Activity中，下面要做的就是你与html约定好链接的参数问题了</p>
</p></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Deep linking 深度链接</title>
		<link>https://uzzz.org/article/1587.html</link>
				<pubDate>Thu, 23 Nov 2017 10:30:20 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[移动开发]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1587.html</guid>
				<description><![CDATA[使用安卓或ios软件的过程中经常碰到这样一种情况：当我在浏览器打开一个页面时，时常会自动打开相对应的app，并进入相应的app页面中，这就用到一项技术-Deep Linking，下面就来介绍一下如何在自己的android APP中使用这项技术。 1。假设已经有了一个app项目，我们需要在项目中新建一个Activity。我们暂且取名为ViewActivity，]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<p>使用安卓或ios软件的过程中经常碰到这样一种情况：当我在浏览器打开一个页面时，时常会自动打开相对应的app，并进入相应的app页面中，这就用到一项技术-Deep Linking，下面就来介绍一下如何在自己的android APP中使用这项技术。</p>
<p>1。假设已经有了一个app项目，我们需要在项目中新建一个Activity。我们暂且取名为ViewActivity，在AndroidManifest.xml文件中的ViewActivity标签中添加Intent-filter：</p>
<pre class="prettyprint"><code class=" hljs xml">  <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">".activity.ViewActivity"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"myapp"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span></code></pre>
<p>2。此时在网页中就可调用这个地址就可以打开我们的app，下面是我写的一个测试deep linking的html代码：</p>
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"{CHARSET}"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"myapp://"</span>&gt;</span>打开我的app<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre>
<p>在手机上打开这个网页，点击链接“打开我的app”就可以自动打开我们的app了，并且能自动进入ViewActivity这个页面中。其实并不是只有myapp://这个链接可以进入我们的app，只要开头为myapp://的链接都可以自动进入我们的app。</p>
<p>3.但是我们的要求不是自动进入app的ViewActivity页面，我们的ViewActivity只是作为一个处理deep linking 的一个过渡页面。总不能在每个页面都要写这么一套代码吧，当然不能，下面我就来介绍如何根据schema内容来引导app进入页面 <br /> 1).在ViewActivity中取出我们的URI值。在此顺带讲解一下URI值中的各个属性，可能有些代码在我们这个测试项目中用不到，只是作为demo讲解一下（我的项目使用kotlin写的，暂时就用kotlin给大家讲解了，我相信懂java的应该都能看懂kotlin）</p>
<pre class="prettyprint"><code class=" hljs cs"> val uri = intent.data<span class="hljs-comment">//链接地址</span>
 val host = uri.host<span class="hljs-comment">//域名</span>
 <span class="hljs-keyword">var</span> query=uri.query<span class="hljs-comment">//获取参数列表</span>
 <span class="hljs-keyword">var</span> <span class="hljs-keyword">params</span> = query.toString().split(<span class="hljs-string">"&amp;"</span>)
 <span class="hljs-keyword">var</span> bundle=Bundle()<span class="hljs-comment">//bundle容器，用来保存传递链接问号后带的参数</span>
 <span class="hljs-keyword">if</span>(<span class="hljs-keyword">null</span>!=<span class="hljs-keyword">params</span>){
 <span class="hljs-keyword">for</span> (key_value <span class="hljs-keyword">in</span> <span class="hljs-keyword">params</span>) {
     bundle.putString(key_value.split(<span class="hljs-string">"="</span>)[<span class="hljs-number">0</span>],key_value.split(<span class="hljs-string">"="</span>)[<span class="hljs-number">1</span>])
   }
 }
 intent.putExtras(bundle)
 <span class="hljs-keyword">var</span> pageName=uri.getHost()<span class="hljs-comment">//这就是我们链接中传递过来的页面名字，因为很多情况下需要统一android与IOS的页面跳转，所以这个名字并不是我们严格意义上的项目中的页面名，而是我们私下里商量好的那个字符串对应哪个页面</span>
 when(pageName){
   <span class="hljs-string">"page1"</span> -&gt;{
     intent.setClass(<span class="hljs-keyword">this</span>,Page1::class.java)
     startActivity(intent)
   }
   <span class="hljs-string">"page2"</span> -&gt;{
     intent.setClass(<span class="hljs-keyword">this</span>.Page2::class.java)
     startActivity(intent)
   }
}
 finish()
</code></pre>
<p>大功告成，至此我们的deep link基础就讲解完了，app此时就可以根据事先的约定根据链接打开并跳转到相应的app了，并且携带了链接后带的参数传到相应的Activity中，下面要做的就是你与html约定好链接的参数问题了</p>
</p></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Android踩坑日记：点击变暗效果的ImageView实现原理</title>
		<link>https://uzzz.org/article/1005.html</link>
				<pubDate>Sat, 21 Oct 2017 02:00:57 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>
		<category><![CDATA[java]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1005.html</guid>
				<description><![CDATA[很多时候我们使用ImagView显示图片，无论是Gilde，Fresco等图片显示框架，比如设置中心更换头像，网格相册点击预览，选择等情况，会遇到点击变暗的交互需求。 源码分析 &#160;&#160;&#160;&#160;我们想的办法是自定义一个ImageView，当点击图片时，是不是有回调方法来同时改变图片的滤镜或者蒙版等。 &#160;&#160;&]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<blockquote>
<p><font size="4">很多时候我们使用ImagView显示图片，无论是Gilde，Fresco等图片显示框架，比如设置中心更换头像，网格相册点击预览，选择等情况，会遇到点击变暗的交互需求。</font></p>
</blockquote>
<ul>
<li><font size="5">源码分析</font> <br /> <font size="4">&nbsp;&nbsp;&nbsp;&nbsp;我们想的办法是自定义一个ImageView，当点击图片时，是不是有回调方法来同时改变图片的滤镜或者蒙版等。 <br /> &nbsp;&nbsp;&nbsp;&nbsp;特意去看了View.java的源码（ImageView继承View），想看看View被点击之后是是否有回调函数可用。</font></li>
</ul>
<pre class="prettyprint"><code class=" hljs cs">View的onTouchEvent()方法
<span class="hljs-keyword">case</span> MotionEvent.ACTION_DOWN:  
            mHasPerformedLongPress = <span class="hljs-keyword">false</span>;  
           <span class="hljs-keyword">if</span> (performButtonActionOnTouchDown(<span class="hljs-keyword">event</span>)) {  
                        <span class="hljs-keyword">break</span>;  
              }  
          <span class="hljs-comment">// Walk up the hierarchy to determine if we're inside a scrolling container. </span>
          boolean isInScrollingContainer = isInScrollingContainer();  
          <span class="hljs-comment">// For views inside a scrolling container, delay the pressed feedback for </span>
          <span class="hljs-comment">// a short period in case this is a scroll. </span>
           <span class="hljs-keyword">if</span> (isInScrollingContainer) {  
                 mPrivateFlags |= PFLAG_PREPRESSED;  
                 <span class="hljs-keyword">if</span> (mPendingCheckForTap == <span class="hljs-keyword">null</span>) {  
                            mPendingCheckForTap = <span class="hljs-keyword">new</span> CheckForTap();  
                   }  
                     postDelayed(mPendingCheckForTap, ViewConfiguration.getTapTimeout());  
                   } <span class="hljs-keyword">else</span> {  
                        <span class="hljs-comment">// Not inside a scrolling container, so show the feedback right away </span>
                        setPressed(<span class="hljs-keyword">true</span>);  
                        checkForLongClick(<span class="hljs-number">0</span>);  
                    }  
                    <span class="hljs-keyword">break</span>;  
</code></pre>
<p><font size="4">意思就是case: MotionEvent.ACTION_DOWN,按下去的时候事件发生时，检测View是否被点击了，如果点击了就<strong>setPressed</strong>(true);把状态标记为已点击 <br /> 对应的case: MotionEvent.ACTION_UP,松开手的时候会检测是否是unpressed，如果是就<strong>setPressed</strong>(false);把状态标记为未点击。</font></p>
<p>setPress(boolean pressed)这个方法，定义如下</p>
<pre class="prettyprint"><code class=" hljs java">  <span class="hljs-javadoc">/** * Sets the pressed state for this view. * *<span class="hljs-javadoctag"> @see</span> #isClickable() *<span class="hljs-javadoctag"> @see</span> #setClickable(boolean) * *<span class="hljs-javadoctag"> @param</span> pressed Pass true to set the View's internal state to "pressed", or false to reverts * the View's internal state from a previously set "pressed" state. */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPressed</span>(<span class="hljs-keyword">boolean</span> pressed) {
        <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> needsRefresh = pressed != ((mPrivateFlags &amp; PFLAG_PRESSED) == PFLAG_PRESSED);

        <span class="hljs-keyword">if</span> (pressed) {
            mPrivateFlags |= PFLAG_PRESSED;
        } <span class="hljs-keyword">else</span> {
            mPrivateFlags &amp;= ~PFLAG_PRESSED;
        }

        <span class="hljs-keyword">if</span> (needsRefresh) {
            refreshDrawableState();
        }
        dispatchSetPressed(pressed);
    }</code></pre>
<p><font size="4">就是说View按下时会调用这个方法改变view的状态，那么我们就可以在这个方法中做文章，重写这个方法。当参数是true时，使用颜色矩阵ColorMetrix来改变drawable的滤镜，当参数是false时，还原图像</font></p>
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-comment">/*点击变暗效果的ImageView*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MaskImageView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ImageView</span> {</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> touchEffect = <span class="hljs-keyword">true</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">float</span>[] BG_PRESSED = <span class="hljs-keyword">new</span> <span class="hljs-keyword">float</span>[] { <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span> };
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">float</span>[] BG_NOT_PRESSED = <span class="hljs-keyword">new</span> <span class="hljs-keyword">float</span>[] { <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span> };

    <span class="hljs-keyword">public</span> <span class="hljs-title">MaskImageView</span>(Context context) {
        <span class="hljs-keyword">super</span>(context);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title">MaskImageView</span>(Context context, AttributeSet attrs) {
        <span class="hljs-keyword">super</span>(context, attrs);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title">MaskImageView</span>(Context context, AttributeSet attrs, <span class="hljs-keyword">int</span> defStyle) {
        <span class="hljs-keyword">super</span>(context, attrs, defStyle);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-title">MaskImageView</span>(Context context, AttributeSet attrs, <span class="hljs-keyword">int</span> defStyleAttr, <span class="hljs-keyword">int</span> defStyleRes) {
        <span class="hljs-keyword">super</span>(context, attrs, defStyleAttr, defStyleRes);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPressed</span>(<span class="hljs-keyword">boolean</span> pressed) {
        updateView(pressed);
        <span class="hljs-keyword">super</span>.setPressed(pressed);
    }

    <span class="hljs-javadoc">/** * 根据是否按下去来刷新bg和src * *<span class="hljs-javadoctag"> @param</span> pressed */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateView</span>(<span class="hljs-keyword">boolean</span> pressed){
        <span class="hljs-comment">//如果没有点击效果</span>
        <span class="hljs-keyword">if</span>( !touchEffect ){
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span>( pressed ){
            <span class="hljs-javadoc">/** * 通过设置滤镜来改变图片亮度 */</span>
            <span class="hljs-keyword">this</span>.setDrawingCacheEnabled(<span class="hljs-keyword">true</span>);
            <span class="hljs-keyword">this</span>.setColorFilter( <span class="hljs-keyword">new</span> ColorMatrixColorFilter(BG_PRESSED) ) ;
            <span class="hljs-comment">//此为src，背景用getBackground()</span>
            <span class="hljs-keyword">this</span>.getDrawable().setColorFilter( <span class="hljs-keyword">new</span> ColorMatrixColorFilter(BG_PRESSED) );
        }<span class="hljs-keyword">else</span>{

            <span class="hljs-keyword">this</span>.setColorFilter( <span class="hljs-keyword">new</span> ColorMatrixColorFilter(BG_NOT_PRESSED) ) ;
            <span class="hljs-keyword">this</span>.getDrawable().setColorFilter( <span class="hljs-keyword">new</span> ColorMatrixColorFilter(BG_NOT_PRESSED) );
        }
    }
}</code></pre>
</p></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>[FAQ17385]录像打开EIS后画面变的突然很暗</title>
		<link>https://uzzz.org/article/1000.html</link>
				<pubDate>Tue, 29 Aug 2017 11:05:38 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[App]]></category>

		<guid isPermaLink="false">http://wp.uzzz.org/article/1000.html</guid>
				<description><![CDATA[[DESCRIPTION] &#160; &#160; 录像打开EIS后,画面变得很暗. &#160; &#160; [SOLUTION] &#160; [MT6735/53,MT6755,MT6732/52] &#160; &#160;1. 没开EIS, recording是动态帧率. &#160; &#160;2. 打开EIS后, recording是固]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:18px;">[DESCRIPTION]</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;<br />
   <span style="font-size:10pt;">录像打开EIS后,画面变得很暗.</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
<div style="visibility:visible;">
    <span style="font-size:18px;">[SOLUTION]</span>
   </div>
<div style="visibility:visible;">
    &nbsp;
   </div>
<div style="visibility:visible;">
    <span style="color:rgb(255,0,0);font-size:10pt;">[MT6735/53,MT6755,MT6732/52]</span>
   </div>
<div style="visibility:visible;">
    &nbsp;
   </div>
</p></div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:10pt;">&nbsp;1. 没开EIS, recording是动态帧率.</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:10pt;">&nbsp;2. 打开EIS后, recording是固定帧率为30fps.</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:10pt;">&nbsp;帧率固定以后,画面会变暗.</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:10pt;">&nbsp;解决办法:</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:10pt;">/vendor/mediatek/proprietary/custom/[platform]/hal/camera/camera_custom_eis.cpp</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
<p><span style="font-size:10pt;">&nbsp;</span></p>
<p><span style="font-size:10pt;">bool GetEisLinkWithDfr()</span></p>
<p><span style="font-size:10pt;">{</span></p>
<p><span style="font-size:10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;&nbsp;&nbsp;<span style="color:rgb(255,0,0);font-size:8pt;">&nbsp;// true : dynamic frame rate off when eis on; false : dynamic frame rate on when eis on&nbsp;</span></span></p>
<p><span style="font-size:10pt;">}</span></p>
</p></div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
    &nbsp;
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-size:12px;">&nbsp;将return ture修改为false, 打开EIS后不会固定录像的帧率.</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="font-family:Cambria;font-size:18px;">&nbsp;</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
   <span style="color:rgb(255,0,0);font-family:Cambria;font-size:10pt;">[MT6580]</span>
  </div>
<div style="color:rgb(53,54,48);font-family:RionaSans, Helvetica, '微軟雅黑', 'Microsoft YaHei', Song, PMingLiU, sans-serif;visibility:visible;">
<p><span style="font-size:10pt;">alps\vendor\mediatek\proprietary\platform\mt6580\hardware\mtkcam\v1\hal\adapter\mtkdefault\MtkDefaultCamParameter.cpp</span><br /><span style="font-size:10pt;">status_t&nbsp;</span><span style="font-size:10pt;">CamAdapter::</span><span style="font-size:10pt;">setParameters()</span><br /><span style="font-size:10pt;">{</span></p>
<p><span style="font-size:10pt;">&nbsp;<span style="font-size:8pt;">&nbsp; &nbsp;&#8230;</span></span></p>
<p><span style="font-size:8pt;">&nbsp;&nbsp;&nbsp; cam3aParam.u4ShotMode&nbsp;&nbsp; = mpParamsMgr-&gt;getShotMode();</span><br /><span style="font-size:8pt;">&nbsp;&nbsp;&nbsp; cam3aParam.u4CamMode&nbsp;&nbsp;&nbsp; = mpParamsMgr-&gt;getHalAppMode();</span><br /><span style="font-size:8pt;">&nbsp;&nbsp;&nbsp; cam3aParam.i4RotateDegree = mpParamsMgr-&gt;getInt(MtkCameraParameters::KEY_ROTATION);</span><br /><span style="font-size:8pt;">////////将下面这行////</span><br /><span style="font-size:8pt;">&nbsp;&nbsp;&nbsp; cam3aParam.bVideoStabilization = (mpParamsMgr-&gt;getVideoStabilization();&nbsp;</span><br /><span style="font-size:8pt;">/////////////////改成/////</span><br /><span style="font-size:8pt;">cam3aParam.bVideoStabilization = 0;</span></p>
</p></div>
</p></div>
</div>
]]></content:encoded>
										</item>
	</channel>
</rss>
