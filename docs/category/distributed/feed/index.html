<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Distributed &#8211; 有组织在!</title>
	<atom:link href="https://uzzz.org/category/distributed/feed" rel="self" type="application/rss+xml" />
	<link>http://uzzz.org/</link>
	<description></description>
	<lastBuildDate>Wed, 11 Apr 2018 17:32:54 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.4</generator>

<image>
	<url>https://uzzz.org/wp-content/uploads/2019/10/cropped-icon-32x32.png</url>
	<title>Distributed &#8211; 有组织在!</title>
	<link>http://uzzz.org/</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>2018 Scrapy Environment Enhance(2)Proxy to Tor Network</title>
		<link>https://uzzz.org/article/1210.html</link>
				<pubDate>Wed, 11 Apr 2018 17:32:54 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[Distributed]]></category>
		<category><![CDATA[Summary]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/1210.html</guid>
				<description><![CDATA[2018 Scrapy Environment Enhance(2)Proxy to Tor Network Follow this Blog and Set the Proxy https://gist.github.com/DusanMadar/8d11026b7ce0bce6a67f7dd87b999f6b https://stackoverflow.com/questions/45009940/scrapy-with-privoxy-and-tor-how-to-renew-ip Install Tor thing and Verify &#62; apt update &#62; apt install tor Install Client Tool &#62; apt install netcat Set Up Tor &#62; echo &#8220;ControlPort 9051&#8221; &#62;&#62; /etc/tor/torrc &#62; echo HashedControlPassword $(tor &#8211;hash-password &#8220;mypassword&#8221; &#124; tail -n 1) &#62;&#62; /etc/tor/torrcpassword Start Tor &#62; service tor start Exception: /etc/init.d/tor: line 140: ulimit: open files: cannot modify limit: Operation not permitted Solution: ? Verify the thing &#62; echo -e &#8216;AUTHENTICATE &#8220;password&#8221;&#8216; &#124; nc 127.0.0.1 9051 Check the Public IP &#62; apt install curl My Local IP &#62; curl http://icanhazip.com/ xxx.xxx.244.5 My Proxy IP &#62; torify curl http://icanhazip.com/ 185.56.80.242 Change the IP &#62; echo -e &#8216;AUTHENTICATE &#8220;password&#8221;\r\nsignal NEWNYM\r\nQUIT&#8217; &#124; nc 127.0.0.1 9051 &#62; torify curl http://icanhazip.com/ 51.15.86.162 Change and Check IP in Python &#62; pip install stem &#62; python Python 3.5.2 (default, Nov 23 2017, 16:37:01) [GCC 5.4.0 20160609] on linux Type &#8220;help&#8221;, &#8220;copyright&#8221;, &#8220;credits&#8221; or &#8220;license&#8221; for more information. &#62;&#62;&#62; &#62;&#62;&#62; from stem import Signal &#62;&#62;&#62; from stem.control import Controller &#62;&#62;&#62; with Controller.from_port(port=9051) as controller: &#8230;]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
   2018 Scrapy Environment Enhance(2)Proxy to Tor Network</p>
<p>Follow this Blog and Set the Proxy<br />
  <br />https://gist.github.com/DusanMadar/8d11026b7ce0bce6a67f7dd87b999f6b<br />
  <br />https://stackoverflow.com/questions/45009940/scrapy-with-privoxy-and-tor-how-to-renew-ip</p>
<p>Install Tor thing and Verify<br />
  <br />&gt; apt update<br />
  <br />&gt; apt install tor</p>
<p>Install Client Tool<br />
  <br />&gt; apt install netcat</p>
<p>Set Up Tor<br />
  <br />&gt; echo &#8220;ControlPort 9051&#8221; &gt;&gt; /etc/tor/torrc<br />
  <br />&gt; echo HashedControlPassword $(tor &#8211;hash-password &#8220;mypassword&#8221; | tail -n 1) &gt;&gt; /etc/tor/torrcpassword</p>
<p>Start Tor<br />
  <br />&gt; service tor start</p>
<p>Exception:<br />
  <br />/etc/init.d/tor: line 140: ulimit: open files: cannot modify limit: Operation not permitted</p>
<p>Solution:<br />
  <br />?</p>
<p>Verify the thing<br />
  <br />&gt; echo -e &#8216;AUTHENTICATE &#8220;password&#8221;&#8216; | nc 127.0.0.1 9051</p>
<p>Check the Public IP<br />
  <br />&gt; apt install curl</p>
<p>My Local IP<br />
  <br />&gt; curl http://icanhazip.com/<br />
  <br />xxx.xxx.244.5</p>
<p>My Proxy IP<br />
  <br />&gt; torify curl http://icanhazip.com/<br />
  <br />185.56.80.242</p>
<p>Change the IP<br />
  <br />&gt; echo -e &#8216;AUTHENTICATE &#8220;password&#8221;\r\nsignal NEWNYM\r\nQUIT&#8217; | nc 127.0.0.1 9051</p>
<p>&gt; torify curl http://icanhazip.com/<br />
  <br />51.15.86.162</p>
<p>Change and Check IP in Python<br />
  <br />&gt; pip install stem<br />
  <br />&gt; python<br />
  <br />Python 3.5.2 (default, Nov 23 2017, 16:37:01)<br />
  <br />[GCC 5.4.0 20160609] on linux<br />
  <br />Type &#8220;help&#8221;, &#8220;copyright&#8221;, &#8220;credits&#8221; or &#8220;license&#8221; for more information.<br />
  <br />&gt;&gt;&gt;<br />
  <br />&gt;&gt;&gt; from stem import Signal<br />
  <br />&gt;&gt;&gt; from stem.control import Controller<br />
  <br />&gt;&gt;&gt; with Controller.from_port(port=9051) as controller:<br />
  <br />&#8230; controller.authenticate()<br />
  <br />&#8230; controller.signal(Signal.NEWNYM)<br />
  <br />&#8230;<br />
  <br />&gt;&gt;&gt; exit()</p>
<p>&gt; torify curl http://icanhazip.com/<br />
  <br />142.4.211.161</p>
<p>Install Privoxy and Check<br />
  <br />&gt; apt install privoxy<br />
  <br />Configure to connect to Tor<br />
  <br />&gt; echo &#8220;forward-socks5t / 127.0.0.1:9050 .&#8221; &gt;&gt; /etc/privoxy/config</p>
<p>Start the Service<br />
  <br />&gt; service privoxy start</p>
<p>&gt; curl -x 127.0.0.1:8118 http://icanhazip.com/<br />
  <br />142.4.211.161</p>
<p>Check all the things in Python3<br />
  <br />&gt; pip install requests<br />
  <br />&gt; python<br />
  <br />Python 3.5.2 (default, Nov 23 2017, 16:37:01)<br />
  <br />[GCC 5.4.0 20160609] on linux<br />
  <br />Type &#8220;help&#8221;, &#8220;copyright&#8221;, &#8220;credits&#8221; or &#8220;license&#8221; for more information.<br />
  <br />&gt;&gt;&gt;<br />
  <br />&gt;&gt;&gt; import requests<br />
  <br />&gt;&gt;&gt; from stem import Signal<br />
  <br />&gt;&gt;&gt; from stem.control import Controller<br />
  <br />&gt;&gt;&gt; response = requests.get(&#8216;http://icanhazip.com/&#8217;, proxies={&#8216;http&#8217;: &#8216;127.0.0.1:8118&#8217;})<br />
  <br />&gt;&gt;&gt; response.text.strip()<br />
  <br />&#8216;142.4.211.161&#8217;<br />
  <br />&gt;&gt;&gt; with Controller.from_port(port=9051) as controller:<br />
  <br />&#8230; controller.authenticate(password=&#8217;password&#8217;)<br />
  <br />&#8230; controller.signal(Signal.NEWNYM)<br />
  <br />&#8230;<br />
  <br />&gt;&gt;&gt; response = requests.get(&#8216;http://icanhazip.com/&#8217;, proxies={&#8216;http&#8217;: &#8216;127.0.0.1:8118&#8217;})<br />
  <br />&gt;&gt;&gt; response.text.strip()<br />
  <br />&#8216;95.128.43.164&#8217;</p>
<p>At least it works there in Scrapy framework<br />
  <br />class ChromeHeadlessMiddleware(object):<br />
  <br /> def process_request(self, request, spider):<br />
  <br /> #by pass the access deny<br />
  <br /> #https://intoli.com/blog/making-chrome-headless-undetectable/<br />
  <br /> options = webdriver.ChromeOptions()</p>
<p> options.add_argument(&#8216;headless&#8217;)<br />
  <br /> options.add_argument(&#8216;no-sandbox&#8217;)<br />
  <br /> options.add_argument(&#8216;window-size=800&#215;600&#8217;)<br />
  <br /> options.add_argument(&#8216;user-agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.50 Safari/537.36&#8217;)<br />
  <br /> options.add_argument(&#8216;&#8211;proxy-server=127.0.0.1:8118&#8217;)</p>
<p> browser = webdriver.Chrome(chrome_options=options)<br />
  <br /> browser.switch_to.window(browser.window_handles[0])</p>
<p> browser.get(request.url)<br />
  <br /> body = browser.page_source<br />
  <br /> return HtmlResponse(browser.current_url, body=body, encoding=&#8217;utf-8&#8242;, request=request)</p>
<p>References:<br />
  <br />http://sillycat.iteye.com/blog/2418229</p>
<p>http://neuralfoundry.com/scrapy-in-a-container-docker-development-environment/<br />
  <br />https://github.com/dataisbeautiful/scrapy-development-docker<br />
  <br />https://github.com/scrapy-plugins/scrapy-splash<br />
  <br />https://www.jianshu.com/p/4052926bc12c<br />
  <br />https://www.cnblogs.com/jclian91/p/8590617.html</p>
<p>IP Proxy Setting<br />
  <br />https://free-proxy-list.net/<br />
  <br />https://github.com/cnu/scrapy-random-useragent<br />
  <br />https://github.com/aivarsk/scrapy-proxies<br />
  <br />https://gist.github.com/seagatesoft/e7de4e3878035726731d<br />
  <br />https://stackoverflow.com/questions/28852057/change-ip-address-dynamically<br />
  <br />http://danielphil.github.io/raspberrypi/http/proxy/2015/04/01/raspberry-pi-http-proxy.html<br />
  <br />https://docs.proxymesh.com/article/4-python-proxy-configuration<br />
  <br />https://gist.github.com/DusanMadar/8d11026b7ce0bce6a67f7dd87b999f6b
 </div>
</div>
]]></content:encoded>
										</item>
	</channel>
</rss>
